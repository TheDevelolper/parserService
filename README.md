# ParserService

Originally authored by Donald Jones.

# What it does:

This Git project provides a webservice which allows parsers to be written that convert flat text files into interactive message sequence charts (MSCs).

![simple MSC](https://igit.comm.ad.roke.co.uk/dmj/parserService/raw/master/doc/simple_msc.png)

Supported MSC objects are made up of either:

- messages between two nodes

- events which take place on a particular node. These can be assigned a severity which will control the fill colour for that event.

- state changes (Similar to an event, but with additional metadata relating to the trigger for the state change)

- spanning boxes. There work like events, but span between two nodes.

All interactions can be allocated a timestamp and / or tags, which can be used to differentiate interactions occurring in parallel, e.g. call IDs.

![simple MSC](https://igit.comm.ad.roke.co.uk/dmj/parserService/raw/master/doc/sip_msg.png)

For a given parser it is possible to configure a particular order of nodes, via a <parser>/config.xml file

# Target pages:

[Parser entry page](http://localhost:8080/) - Allows selection of a parser to run against the input text file, and also upload of the file in question.

# Interactions:

Once a message sequence chart has been generated, there are multiple interactions which can be achieved:

Click on the MSC event line number will jump back to the line number of the original flat text file.

Click on the graphical event itself will (by default) take you to the line number of the original text file. Alternatively, for a given parser it could take you to an optional URL if appropriate.

There is also the ability to filter the events visible in the MSC by either:

- the node that they are attached to

- the tag of the event.

# Parser types:

simple - by using a basic notation it is possible to easily build simple MSCs

sip_msg - example MSC which is generated by parsing a wireshark text export, specifically focussing on SIP messaging flows.

## [Developer Guide](doc/Documentation.md)

# Installation Pre-requisites

There are some pre-requisites which need to be installed on the target PC.

**1) Virtual Box**  (\\\\US-Seattle\Software\Freeware\Virtualbox\) 

Read the Roke Installation Guide.txt
    
(Reboot required before installing Vagrant)

**2) Vagrant** (\\\\US-Seattle\Software\Developer\Vagrant\)

**3) TortoiseGit - optional (developers only)** (\\\\US-Seattle\Software\Developer\TortoiseGit\)

**4) Putty - optional (developers only)** (\\\\US-Seattle\Software\Freeware\Putty\)

Reboot after they have all been installed to ensure that they all are aware of each other.

# Installation

1) Open a DOS command window on windows

    In the Windows 'Search programs and files' box, enter 'CMD'

2) Copy the GIT repository to your folder either: 

* (for users) download the files from the repository

    These will be delivered as a .zip file, which should be unzipped in the desired location

* (for developers) use Tortoise GIT

```
git clone git@igit.comm.ad.roke.co.uk:dmj/wwwvideo_test.git
cd wwwvideo_test
```

3) Install Vagrant triggers and start the vagrant instance to create a new Virtual Machine

```
vagrant plugin install vagrant-triggers
vagrant up
```

    On a new installation this may take a while (10-15 mins) as it will download an instance of ubuntu, and will then install the necessary modules (e.g. apache2) for it.

4) Use the website: [http://localhost:8080/mockup.html](http://localhost:8080/mockup.html)
    


# Optional configuration of Putty for your vagrant VM.

1. Setup putty for this:

Set Host and Port address in Putty Session

**Host:** 127.0.0.1

**Port:** 2222

![Set Host and Port](https://igit.comm.ad.roke.co.uk/dmj/skills_plotter_vagrant/raw/master/doc/putty_config_session.png)

Set username on the Connection/Data section

**Username:** vagrant

![Set Username](https://igit.comm.ad.roke.co.uk/dmj/skills_plotter_vagrant/raw/master/doc/putty_config_connection_data.png)

**Private key:** <installation folder>/.vagrant/machines/default/virtualbox/private_key

![Set Private Key](https://igit.comm.ad.roke.co.uk/dmj/skills_plotter_vagrant/raw/master/doc/putty_config_connection_ssh_auth.png)

Save these settings as 'vagrant' and press save

![Save settings](https://igit.comm.ad.roke.co.uk/dmj/skills_plotter_vagrant/raw/master/doc/putty_config_session_save.png)

2) Open Putty and login to the VM.


![Example output](https://igit.comm.ad.roke.co.uk/dmj/skills_plotter_vagrant/raw/master/doc/putty_start_flask.png)






