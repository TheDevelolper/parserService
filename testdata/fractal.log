15:44:02.617 INFO    Started on 12/01/2017
15:44:02.625 INFO    Suite: All of the PRIME tests.
15:44:02.649 INFO    Suite:   All of the Optional Module tests.
15:44:02.662 INFO    Suite:     All the test for the ICM.
15:44:02.672 INFO    Suite:       Tests for ICM/IR exchanges.
15:44:02.683 INFO    Suite:         ICM Inf CA certificate requesting tests.
15:44:02.699 INFO              Memory (RSS) before suite setup: 101.68 MByte  (101.68)
15:44:02.706 INFO              Memory (Virt) before suite setup: 205.92 MByte  (205.92)
15:44:02.762 DEBUG             New credentials: UsmUserData(userName='fred', authKey=<AUTHKEY>, privKey=<PRIVKEY>, authProtocol=(1, 3, 6, 1, 6, 3, 10, 1, 1, 3), privProtocol=(1, 3, 6, 1, 6, 3, 10, 1, 2, 4), securityEngineId='<DEFAULT>', securityName='fred')
15:44:02.831 DEBUG             LoadMIB BONDSTONE-REGISTRATION-MIB
15:44:02.831 DEBUG             LoadMIB TURNGATE-CKA-MIB
15:44:02.831 DEBUG             LoadMIB BONDSTONE-DEVICE-MIB
15:44:02.831 DEBUG             LoadMIB PRIME-NETWORKING-MIB
15:44:02.832 DEBUG             LoadMIB BONDSTONE-ICM-MIB
15:44:02.832 DEBUG             LoadMIB BSTG-CERTMAN-MIB
15:44:02.832 DEBUG             LoadMIB MISSION-ROOT-MIB
15:44:02.832 DEBUG             LoadMIB BONDSTONE-IR-MIB
15:44:02.832 DEBUG             LoadMIB PRIME-KEY-MIB
15:44:02.832 DEBUG             LoadMIB TURNGATE-MCKM-MIB
15:44:02.833 DEBUG             LoadMIB PRIME-DEVICE-MIB
15:44:03.032 DEBUG             UUT Control chain:
|                              0:   SNMPConnection
|                              1:   OptimusControlAugmentConnection
|                                      inactive -> TODOModularOptimusMissingSNMPAugment
15:44:03.032 DEBUG                     inactive -> TODOOptimusMissingSNMPAugment
15:44:03.057 INFO              Memory (RSS) after suite setup: 103.56 MByte  (1.88)
15:44:03.070 INFO              Memory (Virt) after suite setup: 207.52 MByte  (1.60)
15:44:06.006 DEBUG             cmd optimus > cmdcomplete on
15:44:06.058 DEBUG             cmd optimus > log path /tmp/optimus.log
15:44:06.060 DEBUG             cmd optimus > log set CRTNG debug
15:44:06.061 DEBUG             cmd optimus > log set CRLXF debug
15:44:06.061 DEBUG             cmd optimus > log set PTFTP debug
15:44:06.066 INFO              Setting SNMP v3 security to use authPriv with auth=123456789 priv=987654321
15:44:06.066 DEBUG             cmd optimus > snmp security 123456789 987654321
15:44:06.068 DEBUG             Optimus has been restarted
15:44:06.128 DEBUG             Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:44:06.128 DEBUG             Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:44:06.149 DEBUG             Generating certificate signature for serial: 88084
15:44:06.159 DEBUG             Added keymat IR-INF-CA: serial=88084 auth=0xc9020cefbb66368c subj=0x9e78f60d4fe2e75b
15:44:06.179 DEBUG             Generating certificate signature for serial: 87832
15:44:06.188 DEBUG             Added keymat IR-INF-IA: serial=87832 auth=0x9e78f60d4fe2e75b subj=0x5e5c3199d9a31e8e
15:44:06.210 DEBUG             Generating certificate signature for serial: 83235
15:44:06.219 DEBUG             Added keymat IR-INF-CRL-CA: serial=83235 auth=0xc9020cefbb66368c subj=0xfed28ce8cd9f9057
15:44:06.241 DEBUG             Generating certificate signature for serial: 88829
15:44:06.250 DEBUG             Added keymat IR-INF-CRL-IA: serial=88829 auth=0xfed28ce8cd9f9057 subj=0xdfa0c60c455b79e6
15:44:06.268 DEBUG             Generating certificate signature for serial: 5
15:44:06.278 DEBUG             Added keymat FACT-IA: serial=5 auth=0xd0ac6db9f782d9ff subj=0xd0ac6db9f782d9ff
15:44:06.289 DEBUG             Generating message signature using cert with serial: 87832
15:44:06.349 DEBUG             Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:44:06.405 DEBUG             Added keymat FACT-IA: serial=5 auth=0xd0ac6db9f782d9ff subj=0xd0ac6db9f782d9ff
15:44:06.411 DEBUG             Creating SKD message file /tmp/icmIaReq
15:44:06.429 DEBUG             Generating message signature using cert with serial: 5
15:44:06.509 DEBUG             IR: Handling Certificate Signing Request.
15:44:06.509 DEBUG             Creating temporary CA cert to issue IA
15:44:06.528 DEBUG             Generating certificate signature for serial: 83823
15:44:06.538 DEBUG             Added keymat IR-INF-CA-TMP: serial=83823 auth=0xc9020cefbb66368c subj=0xe6b1ada04e7b9898
15:44:06.538 DEBUG             Generating InfIA certificate (serialNumber: 20000L)
15:44:06.551 DEBUG             Generating certificate signature for serial: 20000
15:44:06.562 DEBUG             Creating SKD message file /tmp/icmIaResp
15:44:06.567 DEBUG             Generating message signature using cert with serial: 87832
15:44:06.791 INFO              SKD: IR ---> ICM CertificateSigningResponse
15:44:06.792 DEBUG             Received Inf IA response
15:44:06.792 DEBUG             Added keymat IR-INF-CA: serial=83823 auth=0xc9020cefbb66368c subj=0xe6b1ada04e7b9898
15:44:06.792 DEBUG             Added keymat ICM-INF-IA: serial=20000 auth=0xe6b1ada04e7b9898 subj=0x1bac6e7bdd0bd152
15:44:06.810 DEBUG             Generating certificate signature for serial: 5
15:44:06.819 DEBUG             Added keymat FACT-IA: serial=5 auth=0x33530b2f8e77bb46 subj=0x33530b2f8e77bb46
15:44:06.837 DEBUG             Generating message signature using cert with serial: 20000
15:44:06.906 DEBUG             Creating SKD message file /tmp/icmCaReq
15:44:06.938 DEBUG             Generating message signature using cert with serial: 20000
15:44:07.068 DEBUG             IR: Handling Certificate Signing Request.
15:44:07.069 DEBUG             Generating InfCA certificate (serialNumber: 20001L)
15:44:07.075 DEBUG             Generating certificate signature for serial: 20001
15:44:07.082 DEBUG             Creating SKD message file /tmp/icmCaResp
15:44:07.085 DEBUG             Generating message signature using cert with serial: 87832
15:44:07.192 INFO              SKD: IR ---> ICM CertificateSigningResponse
15:44:07.193 DEBUG             Received Inf CA response
15:44:07.193 DEBUG             Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x51a6601efc12bcf5
15:44:07.193 INFO              Listening for ('128.10.1.4', 80)
15:44:07.200 DEBUG             Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:44:07.204 DEBUG             Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:44:07.205 DEBUG             Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:44:07.261 DEBUG             Added keymat FACT-IA: serial=5 auth=0x33530b2f8e77bb46 subj=0x33530b2f8e77bb46
15:44:07.271 DEBUG             Creating SKD message file /tmp/icmIaReq
15:44:07.291 DEBUG             Generating message signature using cert with serial: 5
15:44:07.371 DEBUG             Generating InfIA certificate (serialNumber: 20000L)
15:44:07.378 DEBUG             Generating certificate signature for serial: 20000
15:44:07.385 DEBUG             Creating SKD message file /tmp/icmIaResp
15:44:07.388 DEBUG             Generating message signature using cert with serial: 20000
15:44:07.510 DEBUG             Received Inf IA response
15:44:07.511 DEBUG             Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x51a6601efc12bcf5
15:44:07.511 DEBUG             Added keymat MR-INF-IA: serial=20000 auth=0x51a6601efc12bcf5 subj=0x714a5caec7fe4795
15:44:07.515 DEBUG             Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:44:07.520 DEBUG             Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:44:07.578 DEBUG             Added keymat FACT-IA: serial=5 auth=0x33530b2f8e77bb46 subj=0x33530b2f8e77bb46
15:44:07.578 INFO              Listening for ('128.10.1.6', 80)
15:44:07.579 DEBUG             MCKM requesting Inf IA from ICM.
15:44:07.585 INFO              SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:44:07.605 DEBUG             Generating message signature using cert with serial: 5
15:44:07.628 INFO              Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:44:07.629 INFO              SKD: Client ---> Server CMC-request (1342 bytes)
15:44:07.629 INFO              Sent CSR for Inf IA certificate.
15:44:07.630 DEBUG             112592208: Connect accepted from Client
15:44:07.679 DEBUG             Connected to Server
15:44:07.731 DEBUG             Sending HTTP POST /fullcmc message.
15:44:07.731 DEBUG             Removing HTTP POST /fullcmc message from Q.
15:44:07.789 INFO              SKD: Client ---> ICM CertificateSigningRequest
15:44:07.791 DEBUG             Generating InfIA certificate (serialNumber: 20001L)
15:44:07.798 DEBUG             Generating certificate signature for serial: 20001
15:44:07.809 DEBUG             Generating message signature using cert with serial: 20000
15:44:07.867 INFO              SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:44:07.869 DEBUG             HTTP Status: 200 - OK
15:44:07.869 INFO              SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3137 bytes)
15:44:07.938 INFO              MCKM: Handling incoming CertificateSigningResponse
15:44:07.939 DEBUG             Received Inf IA response
15:44:07.939 DEBUG             Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x51a6601efc12bcf5
15:44:07.939 DEBUG             Added keymat MCKM-INF-IA: serial=20001 auth=0x51a6601efc12bcf5 subj=0x3711746011c44ff3
15:44:09.635 DEBUG             Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:44:09.692 DEBUG             Added keymat FACT-IA: serial=5 auth=0x33530b2f8e77bb46 subj=0x33530b2f8e77bb46
15:44:09.692 DEBUG             CKA requesting Inf IA from ICM.
15:44:09.698 INFO              SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:44:09.715 DEBUG             Generating message signature using cert with serial: 5
15:44:09.734 INFO              Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:44:09.734 INFO              SKD: Client ---> Server CMC-request (1330 bytes)
15:44:09.734 INFO              Sent CSR for Inf IA certificate.
15:44:09.735 DEBUG             112592208: Connect accepted from Client
15:44:09.735 DEBUG             Connect closed for Server
15:44:09.736 DEBUG             Connect closed for Server
15:44:09.786 DEBUG             Connected to Server
15:44:09.836 DEBUG             Sending HTTP POST /fullcmc message.
15:44:09.836 DEBUG             Removing HTTP POST /fullcmc message from Q.
15:44:09.886 INFO              SKD: Client ---> ICM CertificateSigningRequest
15:44:09.887 DEBUG             Generating InfIA certificate (serialNumber: 20002L)
15:44:09.893 DEBUG             Generating certificate signature for serial: 20002
15:44:09.904 DEBUG             Generating message signature using cert with serial: 20000
15:44:09.967 INFO              SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:44:09.968 DEBUG             HTTP Status: 200 - OK
15:44:09.968 INFO              SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3126 bytes)
15:44:10.045 DEBUG             CKA: Handling, ('CertificateSigningResponse',)
15:44:10.046 DEBUG             Received Inf IA response
15:44:10.046 DEBUG             Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x51a6601efc12bcf5
15:44:10.046 DEBUG             Added keymat CKA-INF-IA: serial=20002 auth=0x51a6601efc12bcf5 subj=0x761510bb12932323
15:44:13.950 DEBUG             ########## Mocks complete ##########
15:44:14.368 DEBUG             UUT Control: Applying all recent configuration changes
15:44:15.046 DEBUG             change classification to 'S'
15:44:15.046 DEBUG             cmd optimus > class S
15:44:15.047 INFO              20-CRYPT: Loading Suite Plugins...
15:44:15.053 INFO              20-KEYST: Loading Key Parser Plugins...
15:44:15.057 INFO              20-KEYST:   Key Parser TRUSTANCHOR loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.057 INFO              20-KEYST:   Key Parser KEK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.057 INFO              20-KEYST:   Key Parser PSK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.058 INFO              20-KEYST:   Key Parser PPK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.058 INFO              20-KEYST:   Key Parser X509 loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.059 INFO              20-KEYST:   Key Parser CCOI loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.059 INFO              20-KEYST:   Key Parser CRL loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.059 INFO              20-KEYST:   Key Parser KEYPACK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.060 INFO              20-KEYST: Loading Key Store Plugins...
15:44:15.064 INFO              20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.KEYTA loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.067 INFO              20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PKITA loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.068 INFO              20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.KEK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.068 INFO              20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PSK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.068 INFO              20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PACKAGES loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.069 INFO              20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CCOI loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.069 INFO              20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CACERT loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.070 INFO              20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.EECERT loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.070 INFO              20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CRL loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.071 INFO              20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PPK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:44:15.129 DEBUG             cmd optimus > skdhttp quick on
15:44:15.626 DEBUG             Convert value '0x800a0102' as OCTET STRING
15:44:17.407 DEBUG             Convert value '0x800a0100' as OCTET STRING
15:44:17.671 DEBUG             Generating certificate signature for serial: 5
15:44:17.680 DEBUG             Added keymat FACT-IA: serial=5 auth=0x46a77cf9884b8c7c subj=0x46a77cf9884b8c7c
15:44:17.695 DEBUG             Generating message signature using cert with serial: 87832
15:44:17.723 DEBUG             Sending SKD message:
|                              KeyPackageFile:
|                                  version == 3
|                                  digestAlgorithm = AlgorithmIdentifier:
|                                      algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                  eContent = List:
|                                      [0]:
|                                          OneAsymmetricKey:
|                                              version == 0
|                                              privateKeyAlgorithm = AlgorithmIdentifier:
|                                                  algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                  parameters = ECParameters:
|                                                      namedCurve = OID(secp384r1:1.3.132.0.34)
|                                              privateKey = ECPrivateKey:
|                                                  version = 1L
|                                                  privateKey = Octets(0x3238383338353031343530363735383638373732353830303437353631313031303939333638343933363035323733323333313935343135323636323939313733363134373035333636333537333631373131373733373333363230333236313730373335393634393030393238363833393037)
|                                              attributes:
|                                                [0] = UserCertificateAttr:
|                                                  id == OID(userCertificate:2.5.4.36)
|                                                  userCertificate = Certificate:
|                                                      tbsCertificate = TBSCertificate:
|                                                          version == 2
|                                                          serialNumber = 5L
|                                                          signatureAlgorithmID = AlgorithmIdentifier:
|                                                              algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                          issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                          validity = 170112154417Z..99991231235959Z
|                                                          subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                          subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                              algorithm = AlgorithmIdentifier:
|                                                                  algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                  parameters = ECParameters:
|                                                                      namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                              subjectPublicKey = long768:444452861343314801640951073408841444450979592550466667042905444143932640887352344604386996194616104847159667300614814248553380091756160183256302997101523008006532815579484605031149586713443638322596634303315286663839995676834106492
|                                                          _extensions = CertificateExtensions
|                                                            [0] AuthorityKeyIdentifier_CertExt:
|                                                                  extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                  keyIdentifier = Octets(0x46a77cf9884b8c7c)
|                                                            [1] SubjectKeyIdentifier_CertExt:
|                                                                  extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                  id = Octets(0x46a77cf9884b8c7c)
|                                                            [2] KeyUsage_CertExt:
|                                                                  extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                  critical = True
|                                                                  uses = ['digitalSignature']
|                                                            [3] CertificatePolicies_CertExt:
|                                                                  extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                  critical = True
|                                                                  policies:
|                                                                    [0] = PolicyInformation:
|                                                                      id = OID(1.2.826.0.1145.0.1.0.4)
|                                                      signatureAlgorithm = AlgorithmIdentifier:
|                                                          algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                      signature = Signature:
|                                                          r = long384:21967784159392681109814152602199665289175530778298993145734027915449594618369470947309545105327252683456663165128115
|                                                          s = long384:35814509854118014034911309730620704434596197123044269089667256926749630453011717561256072228868220552872910651086070
|                                  certificates (1 chains, 2 certificates) = 
|                                    Chains summary:
|                                      0x5e5c3199d9a31e8e-->0x9e78f60d4fe2e75b-->0xc9020cefbb66368c
|                                    Chains details:
|                                      Chain[0] =
|                                          [0.0] = Certificate:
|                                          tbsCertificate = TBSCertificate:
|                                              version == 2
|                                              serialNumber = 87832L
|                                              signatureAlgorithmID = AlgorithmIdentifier:
|                                                  algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                              issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                              validity = 170112154406Z..99991231235959Z
|                                              subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                              subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                  algorithm = AlgorithmIdentifier:
|                                                      algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                      parameters = ECParameters:
|                                                          namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                  subjectPublicKey = long768:838352907116922636432328278697750416879690866292656067814708737803101263269657984173525489441238965357992552623163324600596941242310216129260420410200552586701902681110220589683952092105909066837145909011493103395104794237336755854
|                                              _extensions = CertificateExtensions
|                                                [0] KeyUsage_CertExt:
|                                                      extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                      critical = True
|                                                      uses = ['digitalSignature']
|                                                [1] CertificatePolicies_CertExt:
|                                                      extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                      critical = True
|                                                      policies:
|                                                        [0] = PolicyInformation:
|                                                          id = OID(1.2.826.0.1145.0.1.0.4)
|                                                [2] AuthorityKeyIdentifier_CertExt:
|                                                      extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                      keyIdentifier = Octets(0x9e78f60d4fe2e75b)
|                                                [3] SubjectKeyIdentifier_CertExt:
|                                                      extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                      id = Octets(0x5e5c3199d9a31e8e)
|                                                [4] CRLDistributionPoints_CertExt:
|                                                      extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                      distributionPoints:
|                                                        [0] = DistributionPoint:
|                                                          cRLIssuer:
|                                                            [0] = GeneralName:
|                                                              directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                [5] SubjectDirectoryAttributes_CertExt:
|                                                      extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                      attributes:
|                                                        [0] = DeviceFunctionAttribute:
|                                                          id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                          deviceFunctions:
|                                                            [0] = 1.2.826.0.1145.0.10.4
|                                                            [1] = 1.2.826.0.1145.0.10.3
|                                          signatureAlgorithm = AlgorithmIdentifier:
|                                              algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                          signature = Signature:
|                                              r = long384:38378057820242516778522360838879046258709794692679493119379159120264717061785878798283841658835159026511376210127304
|                                              s = long384:22658588277354828768109642911697086154160723583069059877533778294516900407766544902799618210250822967103706809310993
|                                          [0.1] = Certificate:
|                                          tbsCertificate = TBSCertificate:
|                                              version == 2
|                                              serialNumber = 88084L
|                                              signatureAlgorithmID = AlgorithmIdentifier:
|                                                  algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                              issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                              validity = 170112154406Z..99991231235959Z
|                                              subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                              subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                  algorithm = AlgorithmIdentifier:
|                                                      algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                      parameters = ECParameters:
|                                                          namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                  subjectPublicKey = long768:735965990704017235062942971328966202873993416692927822663059041135722727671560109141512520755064930586633706440426600835596790534783038373380775782969552136656687295501875269316054450496006469267771443498086458910159235078640822107
|                                              _extensions = CertificateExtensions
|                                                [0] KeyUsage_CertExt:
|                                                      extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                      critical = True
|                                                      uses = ['keyCertSign']
|                                                [1] CertificatePolicies_CertExt:
|                                                      extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                      critical = True
|                                                      policies:
|                                                        [0] = PolicyInformation:
|                                                          id = OID(1.2.826.0.1145.0.1.0.4)
|                                                [2] AuthorityKeyIdentifier_CertExt:
|                                                      extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                      keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                [3] SubjectKeyIdentifier_CertExt:
|                                                      extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                      id = Octets(0x9e78f60d4fe2e75b)
|                                                [4] CRLDistributionPoints_CertExt:
|                                                      extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                      distributionPoints:
|                                                        [0] = DistributionPoint:
|                                                          cRLIssuer:
|                                                            [0] = GeneralName:
|                                                              directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                [5] CertificateConstraints_CertExt:
|                                                      extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                      critical = True
|                                                      constraints = CertificateConstraints:
|                                                          range = EsnRange:
|                                                              startEsn = 'D8EFF0000000'
|                                                              endEsn = 'D8EFF9999999'
|                                                          deviceFunctions = OIDList[2]:
|                                                            0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                            1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                          signatureAlgorithm = AlgorithmIdentifier:
|                                              algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                          signature = Signature:
|                                              r = long384:36447429867376798326679780420183016838005856436082614718366416159886219425209591611618908980319742360509086146876802
|                                              s = long384:8529993533289468827898533869856235622223766267964442963183093045333700239856569015349403303909670178058642606857987
|                                  signerInfo = SignerInfo:
|                                      version == 3
|                                      sid = SignerIdentifier:
|                                          subjectKeyIdentifier = Octets(0x5e5c3199d9a31e8e)
|                                      digestAlgorithm = AlgorithmIdentifier:
|                                          algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                      signedAttrs:
|                                        [0] = ContentTypeAttribute:
|                                          id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                          type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                        [1] = MessageDigestAttribute:
|                                          id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                          digest = Octets(0x2ff7f8cf9ed6adc264b039137807ef1297ef762b04ccd86e22b72930e3cf4d9c0abc1ea5875aed2167160446f6c2e4b4)
|                                        [2] = SigningTimeAttribute:
|                                          id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                          time = UTCTime(170112154417Z)
|                                      signatureAlgorithm = AlgorithmIdentifier:
|                                          algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                      signature = OctSignature:
|                                          r = long384:35423342984539395473179379871154716761291601145072880416223717494181466525974348270607952541226632239748711184725540
|                                          s = long384:7406718019224849570048151947506176544717526442393564599546741096273969574568287731758501174025113768369108562960577
15:44:17.736 DEBUG             cmd optimus > keydir
15:44:17.748 DEBUG             cmd optimus > keydir /tmp/
15:44:17.849 DEBUG             Factory IA ESN: 
15:44:17.954 DEBUG             cmd optimus > keydir ../Keys/
15:44:18.106 DEBUG             Factory IA ESN: D8EFF0000005
15:44:20.309 DEBUG             Received SKD message:
|                              CertificateSigningRequest:
|                                  version == 3
|                                  digestAlgorithm = AlgorithmIdentifier:
|                                      algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                  eContent = CertificationRequest:
|                                      certificationRequestInfo = CertificationRequestInfo:
|                                          version == 0
|                                          subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                          subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                              algorithm = AlgorithmIdentifier:
|                                                  algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                  parameters = ECParameters:
|                                                      namedCurve = OID(secp384r1:1.3.132.0.34)
|                                              subjectPublicKey = long768:845742207014139347592156358314435843332134248584214422378837411542199258125876533676624576528531099872847995188553754475845062625206454408144399876181206532166146099708745109318714940880918555527718415219943370675826881619523962223
|                                              x = 21464445307648569715360912025171537489853518167630749432022264316889523384554201791971467556308818886767550256010062
|                                              y = 18875774350365112817641731703971280215829595879005944265218213442248673524500916700590479094273714292451436160779631
|                                          attributes:
|                                            [0] = SKDCertReqTypeAttribute:
|                                              id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                              type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                            [1] = ExtensionReqAttribute:
|                                              id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                              extns = List:
|                                                  [0]:
|                                                      KeyUsage_CertExt:
|                                                          extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                          critical = True
|                                                          uses = ['digitalSignature']
|                                                  [1]:
|                                                      SubjectDirectoryAttributes_CertExt:
|                                                          extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                          attributes:
|                                                            [0] = DeviceFunctionAttribute:
|                                                              id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                              deviceFunctions:
|                                                                [0] = 1.2.826.0.1145.0.10.3
|                                      signatureAlgorithm = AlgorithmIdentifier:
|                                          algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                      signature = Signature:
|                                          r = long384:5661814395664229259946764632251289515599626583069923187353661448173245114140358652114256601997296366526984718653061
|                                          s = long384:2076878813371482206509838340119013334647357472143465238513180914387185729536523041993509361223640746724585425659493
|                                  certificates (1 chains, 1 certificates) = 
|                                    Chains summary:
|                                      0x46a77cf9884b8c7c-->0x46a77cf9884b8c7c
|                                    Chains details:
|                                      Chain[0] =
|                                          [0.0] = Certificate:
|                                          tbsCertificate = TBSCertificate:
|                                              version == 2
|                                              serialNumber = 5L
|                                              signatureAlgorithmID = AlgorithmIdentifier:
|                                                  algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                              issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                              validity = 170112154417Z..99991231235959Z
|                                              subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                              subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                  algorithm = AlgorithmIdentifier:
|                                                      algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                      parameters = ECParameters:
|                                                          namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                  subjectPublicKey = long768:444452861343314801640951073408841444450979592550466667042905444143932640887352344604386996194616104847159667300614814248553380091756160183256302997101523008006532815579484605031149586713443638322596634303315286663839995676834106492
|                                                  x = 11279955115178498558108610329739382354747270076609259594344249852464484741685480914083286112694966922742431688265963
|                                                  y = 3669646923456885077071038976706134695888404038583583226802838977016112160001209485730051726216516097754705454402684
|                                              _extensions = CertificateExtensions
|                                                [0] AuthorityKeyIdentifier_CertExt:
|                                                      extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                      keyIdentifier = Octets(0x46a77cf9884b8c7c)
|                                                [1] SubjectKeyIdentifier_CertExt:
|                                                      extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                      id = Octets(0x46a77cf9884b8c7c)
|                                                [2] KeyUsage_CertExt:
|                                                      extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                      critical = True
|                                                      uses = ['digitalSignature']
|                                                [3] CertificatePolicies_CertExt:
|                                                      extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                      critical = True
|                                                      policies:
|                                                        [0] = PolicyInformation:
|                                                          id = OID(1.2.826.0.1145.0.1.0.4)
|                                          signatureAlgorithm = AlgorithmIdentifier:
|                                              algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                          signature = Signature:
|                                              r = long384:21967784159392681109814152602199665289175530778298993145734027915449594618369470947309545105327252683456663165128115
|                                              s = long384:35814509854118014034911309730620704434596197123044269089667256926749630453011717561256072228868220552872910651086070
|                                  signerInfo = SignerInfo:
|                                      version == 3
|                                      sid = SignerIdentifier:
|                                          subjectKeyIdentifier = Octets(0x46a77cf9884b8c7c)
|                                      digestAlgorithm = AlgorithmIdentifier:
|                                          algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                      signedAttrs:
|                                        [0] = ContentTypeAttribute:
|                                          id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                          type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                        [1] = ExchangeAttribute:
|                                          id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                          exchange = SKDExchange:
|                                              exchangeID = ExchangeID: certReq
|                                              requestMessage = True
|                                              responseExpected = True
|                                        [2] = SigningTimeAttribute:
|                                          id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                          time = UTCTime(170112154418Z)
|                                        [3] = MessageIDAttribute:
|                                          id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                          messageID = SKDMessageID:
|                                              stateID = Octets(0xaaaabbbbb4673dab)
|                                              msgCount = 0L
|                                        [4] = MessageDigestAttribute:
|                                          id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                          digest = Octets(0x3971265195f0b128e9f0f265d8d69ab7f9cac3498f700ef4abbb31f29882cef17f982ebb183f903e223ec7522cf23b25)
|                                      signatureAlgorithm = AlgorithmIdentifier:
|                                          algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                      signature = OctSignature:
|                                          r = long384:27739054558905127827671648465899035348504051006500841885281617618109707428747545611259273686181000749856430919319459
|                                          s = long384:21069913399206295832630306888119450335551778836390745763850858742527522647755346344972732188429817253916221696836742
15:44:20.310 DEBUG             IR: Handling Certificate Signing Request.
15:44:20.310 DEBUG             Creating temporary CA cert to issue IA
15:44:20.322 DEBUG             Generating certificate signature for serial: 89392
15:44:20.328 DEBUG             Added keymat IR-INF-CA-TMP: serial=89392 auth=0xc9020cefbb66368c subj=0xbf435cd148e600b0
15:44:20.329 DEBUG             Generating InfIA certificate (serialNumber: 20002L)
15:44:20.335 DEBUG             Generating certificate signature for serial: 20002
15:44:20.342 DEBUG             Creating SKD message file /tmp/infia.resp
15:44:20.346 DEBUG             Generating message signature using cert with serial: 87832
15:44:20.386 DEBUG             Sending SKD message:
|                              CertificateSigningResponse:
|                                  version == 3
|                                  digestAlgorithm = AlgorithmIdentifier:
|                                      algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                  eContent = PKIResponse:
|                                      controlSequence:
|                                        [0] = TaggedAttribute:
|                                          bodyPartID = 1L
|                                          attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                          attrValues = CMCStatusInfoV2:
|                                              cMCStatus = 0
|                                  certificates (2 chains, 4 certificates) = 
|                                    Chains summary:
|                                      0xc56eb9ca19f2856f-->0xbf435cd148e600b0-->0xc9020cefbb66368c
|                                      0x5e5c3199d9a31e8e-->0x9e78f60d4fe2e75b-->0xc9020cefbb66368c
|                                    Chains details:
|                                      Chain[0] =
|                                          [0.0] = Certificate:
|                                          tbsCertificate = TBSCertificate:
|                                              version == 2
|                                              serialNumber = 20002L
|                                              signatureAlgorithmID = AlgorithmIdentifier:
|                                                  algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                              issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                              validity = 170112154420Z..99991231235959Z
|                                              subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                              subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                  algorithm = AlgorithmIdentifier:
|                                                      algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                      parameters = ECParameters:
|                                                          namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                  subjectPublicKey = long768:845742207014139347592156358314435843332134248584214422378837411542199258125876533676624576528531099872847995188553754475845062625206454408144399876181206532166146099708745109318714940880918555527718415219943370675826881619523962223
|                                                  x = 21464445307648569715360912025171537489853518167630749432022264316889523384554201791971467556308818886767550256010062
|                                                  y = 18875774350365112817641731703971280215829595879005944265218213442248673524500916700590479094273714292451436160779631
|                                              _extensions = CertificateExtensions
|                                                [0] SubjectDirectoryAttributes_CertExt:
|                                                      extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                      attributes:
|                                                        [0] = DeviceFunctionAttribute:
|                                                          id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                          deviceFunctions:
|                                                            [0] = 1.2.826.0.1145.0.10.3
|                                                [1] AuthorityKeyIdentifier_CertExt:
|                                                      extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                      keyIdentifier = Octets(0xbf435cd148e600b0)
|                                                [2] CertificatePolicies_CertExt:
|                                                      extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                      critical = True
|                                                      policies:
|                                                        [0] = PolicyInformation:
|                                                          id = OID(1.2.826.0.1145.0.1.0.4)
|                                                [3] SubjectKeyIdentifier_CertExt:
|                                                      extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                      id = Octets(0xc56eb9ca19f2856f)
|                                                [4] CRLDistributionPoints_CertExt:
|                                                      extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                      distributionPoints:
|                                                        [0] = DistributionPoint:
|                                                          cRLIssuer:
|                                                            [0] = GeneralName:
|                                                              directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                [5] KeyUsage_CertExt:
|                                                      extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                      critical = True
|                                                      uses = ['digitalSignature']
|                                          signatureAlgorithm = AlgorithmIdentifier:
|                                              algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                          signature = Signature:
|                                              r = long384:16809699863360389396180135634185897104461440248677359985801943535255642547585323522697908566123300334346403214087247
|                                              s = long384:32047132175179371833803797900753991923060283576590100997708197966195863497640844357651872719113255160705528408037532
|                                          [0.1] = Certificate:
|                                          tbsCertificate = TBSCertificate:
|                                              version == 2
|                                              serialNumber = 89392L
|                                              signatureAlgorithmID = AlgorithmIdentifier:
|                                                  algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                              issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                              validity = 170112154420Z..99991231235959Z
|                                              subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                              subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                  algorithm = AlgorithmIdentifier:
|                                                      algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                      parameters = ECParameters:
|                                                          namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                  subjectPublicKey = long768:625721258275786429806312511140332540552320795651848325354248463415229183019432727156923158594602172844295079813422608384882209469365027756498826507815566985246201144941362249001333391458791450417065558679612865187971687006045864112
|                                              _extensions = CertificateExtensions
|                                                [0] KeyUsage_CertExt:
|                                                      extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                      critical = True
|                                                      uses = ['keyCertSign']
|                                                [1] CertificatePolicies_CertExt:
|                                                      extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                      critical = True
|                                                      policies:
|                                                        [0] = PolicyInformation:
|                                                          id = OID(1.2.826.0.1145.0.1.0.4)
|                                                [2] AuthorityKeyIdentifier_CertExt:
|                                                      extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                      keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                [3] SubjectKeyIdentifier_CertExt:
|                                                      extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                      id = Octets(0xbf435cd148e600b0)
|                                                [4] CRLDistributionPoints_CertExt:
|                                                      extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                      distributionPoints:
|                                                        [0] = DistributionPoint:
|                                                          cRLIssuer:
|                                                            [0] = GeneralName:
|                                                              directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                [5] CertificateConstraints_CertExt:
|                                                      extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                      critical = True
|                                                      constraints = CertificateConstraints:
|                                                          range = EsnRange:
|                                                              startEsn = 'D8EFF0123456'
|                                                              endEsn = 'D8EFF0123456'
|                                                          deviceFunctions = OIDList[1]:
|                                                            0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                          signatureAlgorithm = AlgorithmIdentifier:
|                                              algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                          signature = Signature:
|                                              r = long384:18443141222532996577295998543249558121763667040278058714942999314609177011522603257675895256147817467214039088496967
|                                              s = long384:11474107236925546760317587868194590091886376565886954676965961716226374820739709559662021911156727401714731047966461
|                                      Chain[1] =
|                                          [1.0] = Certificate:
|                                          tbsCertificate = TBSCertificate:
|                                              version == 2
|                                              serialNumber = 87832L
|                                              signatureAlgorithmID = AlgorithmIdentifier:
|                                                  algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                              issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                              validity = 170112154406Z..99991231235959Z
|                                              subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                              subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                  algorithm = AlgorithmIdentifier:
|                                                      algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                      parameters = ECParameters:
|                                                          namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                  subjectPublicKey = long768:838352907116922636432328278697750416879690866292656067814708737803101263269657984173525489441238965357992552623163324600596941242310216129260420410200552586701902681110220589683952092105909066837145909011493103395104794237336755854
|                                              _extensions = CertificateExtensions
|                                                [0] KeyUsage_CertExt:
|                                                      extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                      critical = True
|                                                      uses = ['digitalSignature']
|                                                [1] CertificatePolicies_CertExt:
|                                                      extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                      critical = True
|                                                      policies:
|                                                        [0] = PolicyInformation:
|                                                          id = OID(1.2.826.0.1145.0.1.0.4)
|                                                [2] AuthorityKeyIdentifier_CertExt:
|                                                      extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                      keyIdentifier = Octets(0x9e78f60d4fe2e75b)
|                                                [3] SubjectKeyIdentifier_CertExt:
|                                                      extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                      id = Octets(0x5e5c3199d9a31e8e)
|                                                [4] CRLDistributionPoints_CertExt:
|                                                      extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                      distributionPoints:
|                                                        [0] = DistributionPoint:
|                                                          cRLIssuer:
|                                                            [0] = GeneralName:
|                                                              directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                [5] SubjectDirectoryAttributes_CertExt:
|                                                      extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                      attributes:
|                                                        [0] = DeviceFunctionAttribute:
|                                                          id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                          deviceFunctions:
|                                                            [0] = 1.2.826.0.1145.0.10.4
|                                                            [1] = 1.2.826.0.1145.0.10.3
|                                          signatureAlgorithm = AlgorithmIdentifier:
|                                              algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                          signature = Signature:
|                                              r = long384:38378057820242516778522360838879046258709794692679493119379159120264717061785878798283841658835159026511376210127304
|                                              s = long384:22658588277354828768109642911697086154160723583069059877533778294516900407766544902799618210250822967103706809310993
|                                          [1.1] = Certificate:
|                                          tbsCertificate = TBSCertificate:
|                                              version == 2
|                                              serialNumber = 88084L
|                                              signatureAlgorithmID = AlgorithmIdentifier:
|                                                  algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                              issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                              validity = 170112154406Z..99991231235959Z
|                                              subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                              subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                  algorithm = AlgorithmIdentifier:
|                                                      algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                      parameters = ECParameters:
|                                                          namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                  subjectPublicKey = long768:735965990704017235062942971328966202873993416692927822663059041135722727671560109141512520755064930586633706440426600835596790534783038373380775782969552136656687295501875269316054450496006469267771443498086458910159235078640822107
|                                              _extensions = CertificateExtensions
|                                                [0] KeyUsage_CertExt:
|                                                      extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                      critical = True
|                                                      uses = ['keyCertSign']
|                                                [1] CertificatePolicies_CertExt:
|                                                      extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                      critical = True
|                                                      policies:
|                                                        [0] = PolicyInformation:
|                                                          id = OID(1.2.826.0.1145.0.1.0.4)
|                                                [2] AuthorityKeyIdentifier_CertExt:
|                                                      extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                      keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                [3] SubjectKeyIdentifier_CertExt:
|                                                      extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                      id = Octets(0x9e78f60d4fe2e75b)
|                                                [4] CRLDistributionPoints_CertExt:
|                                                      extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                      distributionPoints:
|                                                        [0] = DistributionPoint:
|                                                          cRLIssuer:
|                                                            [0] = GeneralName:
|                                                              directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                [5] CertificateConstraints_CertExt:
|                                                      extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                      critical = True
|                                                      constraints = CertificateConstraints:
|                                                          range = EsnRange:
|                                                              startEsn = 'D8EFF0000000'
|                                                              endEsn = 'D8EFF9999999'
|                                                          deviceFunctions = OIDList[2]:
|                                                            0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                            1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                          signatureAlgorithm = AlgorithmIdentifier:
|                                              algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                          signature = Signature:
|                                              r = long384:36447429867376798326679780420183016838005856436082614718366416159886219425209591611618908980319742360509086146876802
|                                              s = long384:8529993533289468827898533869856235622223766267964442963183093045333700239856569015349403303909670178058642606857987
|                                  signerInfo = SignerInfo:
|                                      version == 3
|                                      sid = SignerIdentifier:
|                                          subjectKeyIdentifier = Octets(0x5e5c3199d9a31e8e)
|                                      digestAlgorithm = AlgorithmIdentifier:
|                                          algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                      signedAttrs:
|                                        [0] = DestinationAttribute:
|                                          id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                          name = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                        [1] = ContentTypeAttribute:
|                                          id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                          type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                        [2] = SigningTimeAttribute:
|                                          id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                          time = UTCTime(170112154420Z)
|                                        [3] = MessageDigestAttribute:
|                                          id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                          digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                        [4] = ExchangeAttribute:
|                                          id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                          exchange = SKDExchange:
|                                              exchangeID = ExchangeID: certReq
|                                              requestMessage = False
|                                              responseExpected = False
|                                        [5] = MessageIDAttribute:
|                                          id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                          messageID = SKDMessageID:
|                                              stateID = Octets(0xaaaabbbbb4673dab)
|                                              msgCount = 0L
|                                      signatureAlgorithm = AlgorithmIdentifier:
|                                          algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                      signature = OctSignature:
|                                          r = long384:15766690348051618584012507834892703650087584833902055530981209507095482627197860218585370805596691886113004944226264
|                                          s = long384:25343952632752958826932252941961034956118705674246471403641792357136569935556013647072503536358553780665838677486582
15:44:26.599 DEBUG             Convert value '0x4d5b9555fdefd9a4' as OCTET STRING
15:44:26.600 DEBUG             Convert value '0x62b7afe623099afa' as OCTET STRING
15:44:28.106 DEBUG             Convert value '0x4d5b9555fdefd9a4' as OCTET STRING
15:44:28.107 DEBUG             Convert value '0x62b7afe623099afa' as OCTET STRING
15:44:28.170 DEBUG             UUT Control: Applying all recent configuration changes
15:44:28.194 INFO    Test:            70  : [icm-request-infca] An ICM will request an
|                                           Infrastructure CA certificate from an IR.
15:44:28.206 INFO                           #> 1. Trigger the ICM to request an Infrastructure CA certificate request.
15:44:35.118 INFO                           #> 2. Expect a Certificate Signing Request.
15:44:35.288 DEBUG                          Received SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:806101842918949003321921116601998420935826689834793730277273974018958954743577352098488022767704980908681112899080796621700961807685154849863932033166910363065438805721202003217246380733945644549115978506659156103756093833242753554
|                                                           x = 20458395922812482961972815853732034750456269742695241457682231755398829430314250955043418869098657769174191774484788
|                                                           y = 35327348980561867447554154790587384535312964477564755870408218910689677787383888744856373329259785289440336798038546
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['keyCertSign']
|                                                               [1]:
|                                                                   BasicConstraints_CertExt:
|                                                                       extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                       critical = True
|                                                                       constraints = BasicConstraints:
|                                                                           cA = True
|                                                                           pathLenConstraint = 0L
|                                                               [2]:
|                                                                   CertificateConstraints_CertExt:
|                                                                       extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                       constraints = CertificateConstraints:
|                                                                           range = EsnRange:
|                                                                               startEsn = 'D8EFF0000000'
|                                                                               endEsn = 'D8EFF9999999'
|                                                                           deviceFunctions = OIDList[1]:
|                                                                             0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:3355825363776454710221339393747460856824273755363040706251973354362386785743467365306994025828400400799048594690275
|                                                       s = long384:33070719513553398320596310043512124554211106826566304348450512773718994108897055377014757780486568486024466179035180
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0xc56eb9ca19f2856f-->0xbf435cd148e600b0-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154420Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:845742207014139347592156358314435843332134248584214422378837411542199258125876533676624576528531099872847995188553754475845062625206454408144399876181206532166146099708745109318714940880918555527718415219943370675826881619523962223
|                                                               x = 21464445307648569715360912025171537489853518167630749432022264316889523384554201791971467556308818886767550256010062
|                                                               y = 18875774350365112817641731703971280215829595879005944265218213442248673524500916700590479094273714292451436160779631
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xbf435cd148e600b0)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xc56eb9ca19f2856f)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16809699863360389396180135634185897104461440248677359985801943535255642547585323522697908566123300334346403214087247
|                                                           s = long384:32047132175179371833803797900753991923060283576590100997708197966195863497640844357651872719113255160705528408037532
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 89392L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154420Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:625721258275786429806312511140332540552320795651848325354248463415229183019432727156923158594602172844295079813422608384882209469365027756498826507815566985246201144941362249001333391458791450417065558679612865187971687006045864112
|                                                               x = 15880441598759092934431016248746363142708816974977120078337409508953162010865592188599611921792178274508346395234577
|                                                               y = 12113691290850596486628001675919917177731323422037730706726647441444228037782058997367249431548620326455395523887280
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xbf435cd148e600b0)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:18443141222532996577295998543249558121763667040278058714942999314609177011522603257675895256147817467214039088496967
|                                                           s = long384:11474107236925546760317587868194590091886376565886954676965961716226374820739709559662021911156727401714731047966461
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0xc56eb9ca19f2856f)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154428Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x39aea1ee65393328)
|                                                           msgCount = 1L
|                                                     [4] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x3fb6bedb5c9fc3db08cddb085e8453e1e762b922838b95ec88ce678a6885c735b8f43cf189ac2a5ffb21f029880bfb9e)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:15504300683532124185255668195612676894826473006110087494632349730463774056923246576158118448274778977069804656315906
|                                                       s = long384:16814939189457124753733644569877499552891450932986683434076483938468770469191872309845077101291681466937745368103230
15:44:35.292 INFO                           #> 3. Check the request is correctly formed.
15:44:35.302 INFO                           #> 4. Create the certificate response for the ICM.
15:44:35.302 DEBUG                          IR: Handling Certificate Signing Request.
15:44:35.304 DEBUG                          Generating InfCA certificate (serialNumber: 20003L)
15:44:35.339 DEBUG                          Generating certificate signature for serial: 20003
15:44:35.348 DEBUG                          Creating SKD message file /tmp/infca.resp
15:44:35.360 DEBUG                          Generating message signature using cert with serial: 87832
15:44:35.460 DEBUG                          Sending SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = 1L
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = 0
|                                               certificates (2 chains, 3 certificates) = 
|                                                 Chains summary:
|                                                   0xa511e00061083a12-->0xc9020cefbb66368c
|                                                   0x5e5c3199d9a31e8e-->0x9e78f60d4fe2e75b-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20003L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154435Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:806101842918949003321921116601998420935826689834793730277273974018958954743577352098488022767704980908681112899080796621700961807685154849863932033166910363065438805721202003217246380733945644549115978506659156103756093833242753554
|                                                               x = 20458395922812482961972815853732034750456269742695241457682231755398829430314250955043418869098657769174191774484788
|                                                               y = 35327348980561867447554154790587384535312964477564755870408218910689677787383888744856373329259785289440336798038546
|                                                           _extensions = CertificateExtensions
|                                                             [0] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xa511e00061083a12)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:21952768659468517103579968347997749348778436061346889264786807395125722832466277690557339118492464417137009279405049
|                                                           s = long384:6538984674489603421921434311223861854268386224241162839416900576844598136959380352483921656390234652491097671332665
|                                                   Chain[1] =
|                                                       [1.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 87832L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154406Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:838352907116922636432328278697750416879690866292656067814708737803101263269657984173525489441238965357992552623163324600596941242310216129260420410200552586701902681110220589683952092105909066837145909011493103395104794237336755854
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x9e78f60d4fe2e75b)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x5e5c3199d9a31e8e)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.4
|                                                                         [1] = 1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:38378057820242516778522360838879046258709794692679493119379159120264717061785878798283841658835159026511376210127304
|                                                           s = long384:22658588277354828768109642911697086154160723583069059877533778294516900407766544902799618210250822967103706809310993
|                                                       [1.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 88084L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154406Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:735965990704017235062942971328966202873993416692927822663059041135722727671560109141512520755064930586633706440426600835596790534783038373380775782969552136656687295501875269316054450496006469267771443498086458910159235078640822107
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x9e78f60d4fe2e75b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[2]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:36447429867376798326679780420183016838005856436082614718366416159886219425209591611618908980319742360509086146876802
|                                                           s = long384:8529993533289468827898533869856235622223766267964442963183093045333700239856569015349403303909670178058642606857987
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x5e5c3199d9a31e8e)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     [1] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154435Z)
|                                                     [3] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                                     [4] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [5] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x39aea1ee65393328)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:24840162150855155424900402044669492838761967701006960920052675088538277432405561272227137990418030189352589294060637
|                                                       s = long384:8516774215660578571392616998785705188955303985018321200453776946370606373949241998104515981626724590889954535828457
15:44:35.535 INFO                           #> 5. Instruct the ICM to load the Inf CA certificate response.
15:44:48.752 INFO                           #> 6. The ICM must store the InfCA certificate
15:44:49.794 INFO    Test:                  PASS
15:44:49.936 DEBUG                    Tearing down mock HTTP servers
15:44:49.939 DEBUG                    Connect closed for Server
15:44:49.941 DEBUG                    Connect closed for Server
15:45:11.511 INFO    Suite:       Tests for ICM/IR exchanges.
15:45:11.521 INFO    Suite:         ICM Inf IA certificate requesting tests.
15:45:11.537 INFO                     Memory (RSS) before suite setup: 106.72 MByte  (3.15)
15:45:11.544 INFO                     Memory (Virt) before suite setup: 284.37 MByte  (76.84)
15:45:11.550 INFO                     Memory (RSS) after suite setup: 106.72 MByte  (0.00)
15:45:11.557 INFO                     Memory (Virt) after suite setup: 284.37 MByte  (0.00)
15:45:11.709 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:45:11.710 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:45:11.722 DEBUG                    Generating certificate signature for serial: 80955
15:45:11.728 DEBUG                    Added keymat IR-INF-CA: serial=80955 auth=0xc9020cefbb66368c subj=0xf5c415e3483bee0a
15:45:11.740 DEBUG                    Generating certificate signature for serial: 83692
15:45:11.746 DEBUG                    Added keymat IR-INF-IA: serial=83692 auth=0xf5c415e3483bee0a subj=0xc452aedebe10a8b7
15:45:11.759 DEBUG                    Generating certificate signature for serial: 81968
15:45:11.764 DEBUG                    Added keymat IR-INF-CRL-CA: serial=81968 auth=0xc9020cefbb66368c subj=0xf41ae4609a37e45a
15:45:11.777 DEBUG                    Generating certificate signature for serial: 81247
15:45:11.782 DEBUG                    Added keymat IR-INF-CRL-IA: serial=81247 auth=0xf41ae4609a37e45a subj=0x81a1032530042f4d
15:45:11.793 DEBUG                    Generating certificate signature for serial: 5
15:45:11.799 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x151bfd828103ac8a subj=0x151bfd828103ac8a
15:45:11.807 DEBUG                    Generating message signature using cert with serial: 83692
15:45:11.842 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:45:11.892 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x151bfd828103ac8a subj=0x151bfd828103ac8a
15:45:11.898 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:45:11.915 DEBUG                    Generating message signature using cert with serial: 5
15:45:11.973 DEBUG                    IR: Handling Certificate Signing Request.
15:45:11.974 DEBUG                    Creating temporary CA cert to issue IA
15:45:11.986 DEBUG                    Generating certificate signature for serial: 87421
15:45:11.992 DEBUG                    Added keymat IR-INF-CA-TMP: serial=87421 auth=0xc9020cefbb66368c subj=0xa314a6ca1811b448
15:45:11.992 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:45:11.999 DEBUG                    Generating certificate signature for serial: 20000
15:45:12.005 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:45:12.008 DEBUG                    Generating message signature using cert with serial: 83692
15:45:12.125 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:45:12.125 DEBUG                    Received Inf IA response
15:45:12.126 DEBUG                    Added keymat IR-INF-CA: serial=87421 auth=0xc9020cefbb66368c subj=0xa314a6ca1811b448
15:45:12.126 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0xa314a6ca1811b448 subj=0x71be5e8645901ad3
15:45:12.136 DEBUG                    Generating certificate signature for serial: 5
15:45:12.142 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x2a13501fa7d645c0 subj=0x2a13501fa7d645c0
15:45:12.151 DEBUG                    Generating message signature using cert with serial: 20000
15:45:12.188 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:45:12.207 DEBUG                    Generating message signature using cert with serial: 20000
15:45:12.290 DEBUG                    IR: Handling Certificate Signing Request.
15:45:12.291 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:45:12.297 DEBUG                    Generating certificate signature for serial: 20001
15:45:12.304 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:45:12.307 DEBUG                    Generating message signature using cert with serial: 83692
15:45:12.407 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:45:12.408 DEBUG                    Received Inf CA response
15:45:12.408 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x873fc2391837223f
15:45:12.408 INFO                     Listening for ('128.10.1.4', 80)
15:45:12.413 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:45:12.417 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:45:12.418 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:45:12.473 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x2a13501fa7d645c0 subj=0x2a13501fa7d645c0
15:45:12.480 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:45:12.499 DEBUG                    Generating message signature using cert with serial: 5
15:45:12.558 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:45:12.565 DEBUG                    Generating certificate signature for serial: 20000
15:45:12.572 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:45:12.575 DEBUG                    Generating message signature using cert with serial: 20000
15:45:12.697 DEBUG                    Received Inf IA response
15:45:12.697 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x873fc2391837223f
15:45:12.697 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x873fc2391837223f subj=0xc09ee0f23c189b8d
15:45:12.702 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:45:12.706 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:45:12.758 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x2a13501fa7d645c0 subj=0x2a13501fa7d645c0
15:45:12.758 INFO                     Listening for ('128.10.1.6', 80)
15:45:12.759 DEBUG                    MCKM requesting Inf IA from ICM.
15:45:12.765 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:45:12.782 DEBUG                    Generating message signature using cert with serial: 5
15:45:12.802 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:45:12.802 INFO                     SKD: Client ---> Server CMC-request (1341 bytes)
15:45:12.802 INFO                     Sent CSR for Inf IA certificate.
15:45:12.803 DEBUG                    108199760: Connect accepted from Client
15:45:12.852 DEBUG                    Connected to Server
15:45:12.903 DEBUG                    Sending HTTP POST /fullcmc message.
15:45:12.904 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:45:12.948 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:45:12.949 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:45:12.956 DEBUG                    Generating certificate signature for serial: 20001
15:45:12.966 DEBUG                    Generating message signature using cert with serial: 20000
15:45:13.024 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:45:13.026 DEBUG                    HTTP Status: 200 - OK
15:45:13.026 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3137 bytes)
15:45:13.095 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:45:13.096 DEBUG                    Received Inf IA response
15:45:13.096 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x873fc2391837223f
15:45:13.096 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x873fc2391837223f subj=0x40228c6b9e3816d1
15:45:14.812 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:45:14.884 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x2a13501fa7d645c0 subj=0x2a13501fa7d645c0
15:45:14.885 DEBUG                    CKA requesting Inf IA from ICM.
15:45:14.891 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:45:14.909 DEBUG                    Generating message signature using cert with serial: 5
15:45:14.928 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:45:14.928 INFO                     SKD: Client ---> Server CMC-request (1330 bytes)
15:45:14.928 INFO                     Sent CSR for Inf IA certificate.
15:45:14.929 DEBUG                    108199760: Connect accepted from Client
15:45:14.929 DEBUG                    Connect closed for Server
15:45:14.929 DEBUG                    Connect closed for Server
15:45:14.978 DEBUG                    Connected to Server
15:45:15.029 DEBUG                    Sending HTTP POST /fullcmc message.
15:45:15.029 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:45:15.092 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:45:15.093 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:45:15.100 DEBUG                    Generating certificate signature for serial: 20002
15:45:15.110 DEBUG                    Generating message signature using cert with serial: 20000
15:45:15.167 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:45:15.168 DEBUG                    HTTP Status: 200 - OK
15:45:15.168 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3125 bytes)
15:45:15.232 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:45:15.232 DEBUG                    Received Inf IA response
15:45:15.232 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x873fc2391837223f
15:45:15.233 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x873fc2391837223f subj=0xd7ac53190c12a007
15:45:19.135 DEBUG                    ########## Mocks complete ##########
15:45:21.815 DEBUG                    cmd optimus > cmdcomplete on
15:45:21.826 DEBUG                    cmd optimus > log path /tmp/optimus.log
15:45:21.826 DEBUG                    cmd optimus > log set CRTNG debug
15:45:21.827 DEBUG                    cmd optimus > log set CRLXF debug
15:45:21.827 DEBUG                    cmd optimus > log set PTFTP debug
15:45:21.827 INFO                     Setting SNMP v3 security to use authPriv with auth=123456789 priv=987654321
15:45:21.828 DEBUG                    cmd optimus > snmp security 123456789 987654321
15:45:21.828 DEBUG                    Optimus has been restarted
15:45:41.876 WARNING                  SNMP: Timout ('get', 'BONDSTONE-DEVICE-MIB::infCertTableCount.0', '')
15:45:41.877 DEBUG                    UUT Control: Applying all recent configuration changes
15:45:42.349 DEBUG                    change classification to 'S'
15:45:42.350 DEBUG                    cmd optimus > class S
15:45:42.351 INFO                     20-CRYPT: Loading Suite Plugins...
15:45:42.359 INFO                     20-KEYST: Loading Key Parser Plugins...
15:45:42.362 INFO                     20-KEYST:   Key Parser TRUSTANCHOR loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.362 INFO                     20-KEYST:   Key Parser KEK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.363 INFO                     20-KEYST:   Key Parser PSK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.363 INFO                     20-KEYST:   Key Parser PPK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.364 INFO                     20-KEYST:   Key Parser X509 loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.364 INFO                     20-KEYST:   Key Parser CCOI loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.365 INFO                     20-KEYST:   Key Parser CRL loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.365 INFO                     20-KEYST:   Key Parser KEYPACK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.366 INFO                     20-KEYST: Loading Key Store Plugins...
15:45:42.370 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.KEYTA loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.373 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PKITA loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.373 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.KEK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.374 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PSK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.374 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PACKAGES loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.375 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CCOI loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.375 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CACERT loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.376 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.EECERT loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.376 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CRL loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.377 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PPK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:45:42.431 DEBUG                    cmd optimus > skdhttp quick on
15:45:42.904 DEBUG                    Convert value '0x800a0102' as OCTET STRING
15:45:44.621 DEBUG                    Convert value '0x800a0100' as OCTET STRING
15:45:44.837 INFO    Test:            73  : [icm-request-infia] An ICM will request an
|                                           Infrastructure IA certificate from an IR,
|                                           signed by a factory certificate.
15:45:44.856 INFO                           #> 0.1. Configure the UUT with a FactoryIA certificate.
15:45:44.878 DEBUG                          Generating certificate signature for serial: 5
15:45:44.885 DEBUG                          Added keymat FACT-IA: serial=5 auth=0x15fd115cd0ada1e3 subj=0x15fd115cd0ada1e3
15:45:44.911 DEBUG                          Generating message signature using cert with serial: 20000
15:45:44.980 DEBUG                          Sending SKD message:
|                                           KeyPackageFile:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = List:
|                                                   [0]:
|                                                       OneAsymmetricKey:
|                                                           version == 0
|                                                           privateKeyAlgorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           privateKey = ECPrivateKey:
|                                                               version = 1L
|                                                               privateKey = Octets(0x3232363930323639303137343933353531393238333437373631363530373234353931363635333139393132333136333933393035393035303839393436383138353638353039323830393036383837373733353831353633333239303636323432303937393437353034363432373138373035)
|                                                           attributes:
|                                                             [0] = UserCertificateAttr:
|                                                               id == OID(userCertificate:2.5.4.36)
|                                                               userCertificate = Certificate:
|                                                                   tbsCertificate = TBSCertificate:
|                                                                       version == 2
|                                                                       serialNumber = 5L
|                                                                       signatureAlgorithmID = AlgorithmIdentifier:
|                                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                       issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                       validity = 170112154544Z..99991231235959Z
|                                                                       subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                           algorithm = AlgorithmIdentifier:
|                                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                               parameters = ECParameters:
|                                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                           subjectPublicKey = long768:465583079064518489089947980795302195462053694153664037014889691236723707393164618629532872126562139605873599280301408407807076170971512836077930307757729062789668070171993355044516735281714171903174437201174687098004062306619466211
|                                                                       _extensions = CertificateExtensions
|                                                                         [0] AuthorityKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                               keyIdentifier = Octets(0x15fd115cd0ada1e3)
|                                                                         [1] SubjectKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                               id = Octets(0x15fd115cd0ada1e3)
|                                                                         [2] KeyUsage_CertExt:
|                                                                               extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                               critical = True
|                                                                               uses = ['digitalSignature']
|                                                                         [3] CertificatePolicies_CertExt:
|                                                                               extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                               critical = True
|                                                                               policies:
|                                                                                 [0] = PolicyInformation:
|                                                                                   id = OID(1.2.826.0.1145.0.1.0.4)
|                                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                   signature = Signature:
|                                                                       r = long384:36284967752285181331741656617889165398775233680938313173318911908853039476232512202377815625126159270099099143970083
|                                                                       s = long384:27535609542884510867119540799566580602470880159978947318968366964645330767373916248939879849717485194105095437240255
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x71be5e8645901ad3-->0xa314a6ca1811b448-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20000L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154511Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0177000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:337507227272622705398398668970416916127783644017433923341281635373035670167887895879668975382581118810135495385864462686258782525696045575442564067637745710964024394331494149166829106459334860508497241353506590197846427016232966867
|                                                               x = 8565737124915904628846947689592760022252700355289453118643029765739529354000223544056449317188901516766660521319181
|                                                               y = 13184070920506615510266015270647674763270242043679652079037787171372091610170461602229769563208214683594030977129171
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xa314a6ca1811b448)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x71be5e8645901ad3)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:8957439463969126585151412613602213869821293552903256360368897904397087985333094255323736362227387844932111618807057
|                                                           s = long384:16850660955690921641073403903061075292390496666148240578532494824890518178672316399743391657134027240081384895627838
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 87421L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154511Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:117325035901274739390703268941837023917261258929900247467297832789034652512447605933135296663170435466556058149226358414671962907822425905789135934113033146307554717205205276536134737478509849724168953063064430559652969607697904712
|                                                               x = 2977641171784057191837721321490032687431694377823600475072322553185380433536187617723527902581987281807635778387532
|                                                               y = 2503110457605404707459430699613819847803964740150977428132595297950757467290872389391110583558331261012405268886600
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xa314a6ca1811b448)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0177000'
|                                                                           endEsn = 'D8EFF0177000'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:615591711421770530362851375794820884801966418152397190309254925628100255193663946912949839244414323928544723186505
|                                                           s = long384:17447320808960411621814769707932205471102690925759068272887557570858076930419578090369110310527646216943125604571483
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x71be5e8645901ad3)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                                     [1] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x7715849d9ae33140762750f3270a2691ffc0d0ed45541c952d7b6ad9054c3ec591eb0aced2b1fe69599351e6e7f84d62)
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154544Z)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:27988452402190212608939714952125159391820171577935240362536260162765108883679221123525604024674638741755479537845501
|                                                       s = long384:26605149339200394052710650947060019460651440930307306270826680145260280995547612153626784178718198262490930842046811
15:45:45.026 DEBUG                          cmd optimus > keydir
15:45:45.038 DEBUG                          cmd optimus > keydir /tmp/
15:45:45.122 DEBUG                          Factory IA ESN: 
15:45:45.205 DEBUG                          cmd optimus > keydir ../Keys/
15:45:45.209 DEBUG                          UUT Control: Applying all recent configuration changes
15:45:45.254 INFO                           #> 0.2. Trigger the UUT to send a InfIA certificate request to the ICM.
15:45:45.379 DEBUG                          Factory IA ESN: D8EFF0000005
15:45:47.516 INFO                           #> 0.3. Check that a CSR file is created.
15:45:47.614 DEBUG                          Received SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:1217137991547019620141137323811443212783793229321654163784524263536813217810038491075929670384669685488115807634104030741361135549036941997398259228182254057570810525118653850244964393293577300698948434287425606302760906535944209626
|                                                           x = 30890254305335221082651632674447350931297452067969621728237414593844843830988306154462669555433506339582023688776260
|                                                           y = 20669503428888069053052794175827663364089171765476890855722869264665557984789959060315239588782301182562922967221466
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.3
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:36566977037649601551024982402902384185648963588806031800678122179415162679162006408974567069633961392675175668113611
|                                                       s = long384:35920878767190555690750324541667303711870216316792225455865435721271820671460514920837834976532548740510741424570687
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x15fd115cd0ada1e3-->0x15fd115cd0ada1e3
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 5L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154544Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:465583079064518489089947980795302195462053694153664037014889691236723707393164618629532872126562139605873599280301408407807076170971512836077930307757729062789668070171993355044516735281714171903174437201174687098004062306619466211
|                                                               x = 11816227751040812329976510610073175492590055755220995343797322741714565044846140325764088106332746280004215956120637
|                                                               y = 6429662565583327006228178666911408382647964424323773217714662719210264739190163568950156305488178032918683880104419
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x15fd115cd0ada1e3)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x15fd115cd0ada1e3)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:36284967752285181331741656617889165398775233680938313173318911908853039476232512202377815625126159270099099143970083
|                                                           s = long384:27535609542884510867119540799566580602470880159978947318968366964645330767373916248939879849717485194105095437240255
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x15fd115cd0ada1e3)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154545Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xaaaabbbbd544ee34)
|                                                           msgCount = 0L
|                                                     [4] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x5ee9c137e5c623a3b14f57e58d06f47d94e8e6eaab510c78df6484dfef67bfabe9fdfbf3ff96ee611205caefbd529c15)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:19287155375542017052322075551849044105455727631835449330054911700763283981044127608641991940505637538206612844981506
|                                                       s = long384:39111974619587044609610908368506875924075010247182824033287177031158492804620017733050536082761245969440959517896624
15:45:47.616 INFO                           #> 0.4. The InfIA certificate request is correctly formed.
15:45:47.654 INFO                           #> 0.5. For file based transfers: create a Certificate Signing Response file and instruct the UUT to consume it.
15:45:47.655 DEBUG                          IR: Handling Certificate Signing Request.
15:45:47.655 DEBUG                          Creating temporary CA cert to issue IA
15:45:47.689 DEBUG                          Generating certificate signature for serial: 84693
15:45:47.696 DEBUG                          Added keymat IR-INF-CA-TMP: serial=84693 auth=0xc9020cefbb66368c subj=0x8c0e80353740c2e6
15:45:47.697 DEBUG                          Generating InfIA certificate (serialNumber: 20002L)
15:45:47.718 DEBUG                          Generating certificate signature for serial: 20002
15:45:47.733 DEBUG                          Creating SKD message file /tmp/infia.resp
15:45:47.742 DEBUG                          Generating message signature using cert with serial: 83692
15:45:47.854 DEBUG                          Sending SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = 1L
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = 0
|                                               certificates (2 chains, 4 certificates) = 
|                                                 Chains summary:
|                                                   0x2578b15bddf244da-->0x8c0e80353740c2e6-->0xc9020cefbb66368c
|                                                   0xc452aedebe10a8b7-->0xf5c415e3483bee0a-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154547Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1217137991547019620141137323811443212783793229321654163784524263536813217810038491075929670384669685488115807634104030741361135549036941997398259228182254057570810525118653850244964393293577300698948434287425606302760906535944209626
|                                                               x = 30890254305335221082651632674447350931297452067969621728237414593844843830988306154462669555433506339582023688776260
|                                                               y = 20669503428888069053052794175827663364089171765476890855722869264665557984789959060315239588782301182562922967221466
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x8c0e80353740c2e6)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2578b15bddf244da)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:6167738622798910902638590772808641101819612838257378692462034330661331135615368838872412712189267326476178254085670
|                                                           s = long384:12960146193357463998264417231671320606252645106388711417336266664913290742057267009486514430708239582590796215665556
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 84693L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154547Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:538130584090626188217492457055825547614696168020103852383663396717097948541659511304405117951426278086981306986016430246985215366492525022894646932386145835408392469148032214812335725165383508033951106276614995257453124113997546214
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x8c0e80353740c2e6)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:24278422764967294263304924834211581769508682345433664300719306578143360330104769420789422936196671990870243447029280
|                                                           s = long384:27904741804703282083487085578055342487650517992176618821988321716142320418824875909363351424778599326418057553171857
|                                                   Chain[1] =
|                                                       [1.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 83692L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154511Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1161029226686041346269082640523476991525606654066039395679296327872505223569449315869074762480370803419327467469794777101182799899672736207597306927673628408555531467617855621372819932401090759078920952368285705537411171799748618423
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xf5c415e3483bee0a)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xc452aedebe10a8b7)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.4
|                                                                         [1] = 1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:3119508243967715326151457856990816614123385903058216482722592141499276313560120293399365815504834630009819917467220
|                                                           s = long384:19221021992552627777934821159977196964476315115061810188387050285432291516924068579875384297701620608794462010474304
|                                                       [1.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 80955L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154511Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:951066301931398460183117377290070554148724632585830785812546343945533094719578814545022012384811153779470986196019212429342804755875473361447142387948246717300715348053798488447408045900987764134302217332772498314131626154402770442
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xf5c415e3483bee0a)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[2]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:38097438268178531258560917554408797052194366747581066264597967446337830232017414485061302476540145733211992872494937
|                                                           s = long384:15435814627298180283025497945699159573846146054336127679931240830567641569635636469233886253441404693298238202532331
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0xc452aedebe10a8b7)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                     [1] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154547Z)
|                                                     [3] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                                     [4] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [5] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xaaaabbbbd544ee34)
|                                                           msgCount = 0L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:9670942891355939340974169907497863705639329543072036061789182060240426167942116131037113959357213117028652556298188
|                                                       s = long384:2861547670003575677535469653606356298001876727962095996690908652962011974494042123220651651598794482373596457524439
15:45:52.421 INFO                           #> 0.6. The UUT must store the InfIA certificate (and associated CA certificates).
15:45:53.551 DEBUG                          Convert value '0x452cdb6c2fccbb8a' as OCTET STRING
15:45:53.552 DEBUG                          Convert value '0x8e766f38b09e6e75' as OCTET STRING
15:45:54.728 DEBUG                          Convert value '0x452cdb6c2fccbb8a' as OCTET STRING
15:45:54.729 DEBUG                          Convert value '0x8e766f38b09e6e75' as OCTET STRING
15:45:54.771 INFO                           #> 0.7. Try to request an Inf IA certificate again.  The UUT should reject the request.
15:45:54.772 INFO                           Forcing InfIa request (may fail)
15:45:54.828 WARNING                        SNMP: Cannot access ('set', 'BONDSTONE-REGISTRATION-MIB::regInfIaCertEsn', (0,))
|                                                 Status = Wrong value
|                                                 Indication = None
15:45:54.828 INFO                           UUT rejected attempt to set BONDSTONE-REGISTRATION-MIB::regInfIaCertEsn (Inf IA wasprobably already installed)
15:45:54.829 INFO                           #> 0.8. The UUT must delete (or otherwise disable) the FactoryIA certificate
15:45:54.845 INFO    Test:                  PASS
15:45:54.977 DEBUG                    Tearing down mock HTTP servers
15:45:54.981 DEBUG                    Connect closed for Server
15:45:54.981 DEBUG                    Connect closed for Server
15:46:04.242 INFO    Suite:       Tests for ICM HTTP requirements.
15:46:04.253 INFO    Suite:         Test that the ICM conforms to the HTTP requirements.
15:46:04.267 INFO                     Memory (RSS) before suite setup: 108.31 MByte  (1.60)
15:46:04.273 INFO                     Memory (Virt) before suite setup: 285.88 MByte  (1.52)
15:46:04.280 INFO                     Memory (RSS) after suite setup: 108.31 MByte  (0.00)
15:46:04.285 INFO                     Memory (Virt) after suite setup: 285.88 MByte  (0.00)
15:46:04.411 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:46:04.412 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:46:04.424 DEBUG                    Generating certificate signature for serial: 88620
15:46:04.430 DEBUG                    Added keymat IR-INF-CA: serial=88620 auth=0xc9020cefbb66368c subj=0xc99ed3f4af77c679
15:46:04.441 DEBUG                    Generating certificate signature for serial: 81736
15:46:04.447 DEBUG                    Added keymat IR-INF-IA: serial=81736 auth=0xc99ed3f4af77c679 subj=0x89e9ab9a4ea632f7
15:46:04.459 DEBUG                    Generating certificate signature for serial: 82072
15:46:04.465 DEBUG                    Added keymat IR-INF-CRL-CA: serial=82072 auth=0xc9020cefbb66368c subj=0xe078755bc900939e
15:46:04.477 DEBUG                    Generating certificate signature for serial: 84977
15:46:04.482 DEBUG                    Added keymat IR-INF-CRL-IA: serial=84977 auth=0xe078755bc900939e subj=0x059b4080f4282dcb
15:46:04.492 DEBUG                    Generating certificate signature for serial: 5
15:46:04.498 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xc2fb581d317192bc subj=0xc2fb581d317192bc
15:46:04.507 DEBUG                    Generating message signature using cert with serial: 81736
15:46:04.541 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:46:04.590 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xc2fb581d317192bc subj=0xc2fb581d317192bc
15:46:04.596 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:46:04.613 DEBUG                    Generating message signature using cert with serial: 5
15:46:04.670 DEBUG                    IR: Handling Certificate Signing Request.
15:46:04.671 DEBUG                    Creating temporary CA cert to issue IA
15:46:04.683 DEBUG                    Generating certificate signature for serial: 80761
15:46:04.688 DEBUG                    Added keymat IR-INF-CA-TMP: serial=80761 auth=0xc9020cefbb66368c subj=0x655d2fa91b10905f
15:46:04.689 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:46:04.695 DEBUG                    Generating certificate signature for serial: 20000
15:46:04.701 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:46:04.704 DEBUG                    Generating message signature using cert with serial: 81736
15:46:04.819 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:46:04.819 DEBUG                    Received Inf IA response
15:46:04.819 DEBUG                    Added keymat IR-INF-CA: serial=80761 auth=0xc9020cefbb66368c subj=0x655d2fa91b10905f
15:46:04.820 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x655d2fa91b10905f subj=0xa73a9b8382c94d22
15:46:04.830 DEBUG                    Generating certificate signature for serial: 5
15:46:04.836 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x56c17bcad8e9d727 subj=0x56c17bcad8e9d727
15:46:04.844 DEBUG                    Generating message signature using cert with serial: 20000
15:46:04.879 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:46:04.896 DEBUG                    Generating message signature using cert with serial: 20000
15:46:04.979 DEBUG                    IR: Handling Certificate Signing Request.
15:46:04.980 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:46:04.986 DEBUG                    Generating certificate signature for serial: 20001
15:46:04.992 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:46:04.995 DEBUG                    Generating message signature using cert with serial: 81736
15:46:05.091 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:46:05.091 DEBUG                    Received Inf CA response
15:46:05.091 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x8a783758028585b1
15:46:05.091 INFO                     Listening for ('128.10.1.4', 80)
15:46:05.096 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:46:05.100 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:46:05.100 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:46:05.151 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x56c17bcad8e9d727 subj=0x56c17bcad8e9d727
15:46:05.157 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:46:05.173 DEBUG                    Generating message signature using cert with serial: 5
15:46:05.231 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:46:05.237 DEBUG                    Generating certificate signature for serial: 20000
15:46:05.244 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:46:05.247 DEBUG                    Generating message signature using cert with serial: 20000
15:46:05.362 DEBUG                    Received Inf IA response
15:46:05.363 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x8a783758028585b1
15:46:05.363 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x8a783758028585b1 subj=0x10eaf77d421d4883
15:46:05.367 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:46:05.371 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:46:05.421 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x56c17bcad8e9d727 subj=0x56c17bcad8e9d727
15:46:05.421 INFO                     Listening for ('128.10.1.6', 80)
15:46:05.421 DEBUG                    MCKM requesting Inf IA from ICM.
15:46:05.427 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:46:05.443 DEBUG                    Generating message signature using cert with serial: 5
15:46:05.462 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:46:05.462 INFO                     SKD: Client ---> Server CMC-request (1340 bytes)
15:46:05.462 INFO                     Sent CSR for Inf IA certificate.
15:46:05.463 DEBUG                    108229456: Connect accepted from Client
15:46:05.512 DEBUG                    Connected to Server
15:46:05.563 DEBUG                    Sending HTTP POST /fullcmc message.
15:46:05.563 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:46:05.604 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:46:05.605 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:46:05.611 DEBUG                    Generating certificate signature for serial: 20001
15:46:05.620 DEBUG                    Generating message signature using cert with serial: 20000
15:46:05.673 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:46:05.674 DEBUG                    HTTP Status: 200 - OK
15:46:05.674 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3141 bytes)
15:46:05.739 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:46:05.739 DEBUG                    Received Inf IA response
15:46:05.740 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x8a783758028585b1
15:46:05.740 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x8a783758028585b1 subj=0x98f6915ad711395c
15:46:07.469 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:46:07.522 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x56c17bcad8e9d727 subj=0x56c17bcad8e9d727
15:46:07.522 DEBUG                    CKA requesting Inf IA from ICM.
15:46:07.528 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:46:07.546 DEBUG                    Generating message signature using cert with serial: 5
15:46:07.565 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:46:07.565 INFO                     SKD: Client ---> Server CMC-request (1330 bytes)
15:46:07.565 INFO                     Sent CSR for Inf IA certificate.
15:46:07.566 DEBUG                    108229456: Connect accepted from Client
15:46:07.566 DEBUG                    Connect closed for Server
15:46:07.566 DEBUG                    Connect closed for Server
15:46:07.616 DEBUG                    Connected to Server
15:46:07.667 DEBUG                    Sending HTTP POST /fullcmc message.
15:46:07.668 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:46:07.708 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:46:07.708 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:46:07.715 DEBUG                    Generating certificate signature for serial: 20002
15:46:07.724 DEBUG                    Generating message signature using cert with serial: 20000
15:46:07.778 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:46:07.779 DEBUG                    HTTP Status: 200 - OK
15:46:07.780 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3127 bytes)
15:46:07.844 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:46:07.845 DEBUG                    Received Inf IA response
15:46:07.845 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x8a783758028585b1
15:46:07.845 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x8a783758028585b1 subj=0xf128ff9cced33c83
15:46:11.769 DEBUG                    ########## Mocks complete ##########
15:46:11.770 DEBUG                    UUT Control: Applying all recent configuration changes
15:46:11.792 INFO    Test:            82  : [icm-http-unrecognised-uri] Verify that the
|                                           ICM returns a status code of 404 when a
|                                           request is sent to an unrecognised URI.
15:46:12.787 DEBUG                          Convert value '0x452cdb6c2fccbb8a' as OCTET STRING
15:46:12.787 DEBUG                          Convert value '0x8e766f38b09e6e75' as OCTET STRING
15:46:13.905 DEBUG                          Convert value '0x452cdb6c2fccbb8a' as OCTET STRING
15:46:13.905 DEBUG                          Convert value '0x8e766f38b09e6e75' as OCTET STRING
15:46:14.002 INFO                           #> 0.0.1. Trigger the ICM to request an Infrastructure CA certificate request.
15:46:19.104 INFO                           #> 0.0.2. Expect a Certificate Signing Request.
15:46:19.235 DEBUG                          Received SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:1092192514285881378359098569704607891747010781489990826896039999998448797293163772197521701491010085712161548144673178490972542992228402174923893457179436064472444923641582132410490202929063278495125024514731392493762491132767400258
|                                                           x = 27719210764091082473568250952180368107696170383335850523307787891164105790594234270825233827072583795039626357336795
|                                                           y = 31039616561189321694631148909187826590802947431781862784123704400128904396910459599967548755100891483786788071305538
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['keyCertSign']
|                                                               [1]:
|                                                                   BasicConstraints_CertExt:
|                                                                       extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                       critical = True
|                                                                       constraints = BasicConstraints:
|                                                                           cA = True
|                                                                           pathLenConstraint = 0L
|                                                               [2]:
|                                                                   CertificateConstraints_CertExt:
|                                                                       extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                       constraints = CertificateConstraints:
|                                                                           range = EsnRange:
|                                                                               startEsn = 'D8EFF0000000'
|                                                                               endEsn = 'D8EFF9999999'
|                                                                           deviceFunctions = OIDList[5]:
|                                                                             0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                             1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                             2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                             3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                             4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:3824225460975265295628556069451384372650938213050658364961049020886350890884530788043331090451564639346573490846413
|                                                       s = long384:11353817298715596678736987421154715031037526274040496920434747998516539384248822589483253459082210006696645609819742
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x2578b15bddf244da-->0x8c0e80353740c2e6-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154547Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1217137991547019620141137323811443212783793229321654163784524263536813217810038491075929670384669685488115807634104030741361135549036941997398259228182254057570810525118653850244964393293577300698948434287425606302760906535944209626
|                                                               x = 30890254305335221082651632674447350931297452067969621728237414593844843830988306154462669555433506339582023688776260
|                                                               y = 20669503428888069053052794175827663364089171765476890855722869264665557984789959060315239588782301182562922967221466
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x8c0e80353740c2e6)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2578b15bddf244da)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:6167738622798910902638590772808641101819612838257378692462034330661331135615368838872412712189267326476178254085670
|                                                           s = long384:12960146193357463998264417231671320606252645106388711417336266664913290742057267009486514430708239582590796215665556
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 84693L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154547Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:538130584090626188217492457055825547614696168020103852383663396717097948541659511304405117951426278086981306986016430246985215366492525022894646932386145835408392469148032214812335725165383508033951106276614995257453124113997546214
|                                                               x = 13657441233027073034932138741724735558053441287308304108821162563046885030485367988447604585327813355571179064368377
|                                                               y = 26105921429113117590538907492040297180200647097768119589017639905534383535332359376376575239613416701689228519588582
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x8c0e80353740c2e6)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:24278422764967294263304924834211581769508682345433664300719306578143360330104769420789422936196671990870243447029280
|                                                           s = long384:27904741804703282083487085578055342487650517992176618821988321716142320418824875909363351424778599326418057553171857
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x2578b15bddf244da)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154614Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xfce3ba053124d287)
|                                                           msgCount = 1L
|                                                     [4] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x0d8cf279daf0afdff0289884bf9868f2622e054c2cdce6683b25353455e324b204acaee66bc759d81523b3b94a2b1c39)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:17197326536644399366536643640698198811655784683236388839444069306801336178471712553122009821544809166350983183849492
|                                                       s = long384:32810509489880624416357293905122945318564708251284651384218948402090121247508942322067908385369783010107267051233081
15:46:19.236 INFO                           #> 0.0.3. Create the certificate response for the ICM.
15:46:19.237 DEBUG                          IR: Handling Certificate Signing Request.
15:46:19.237 DEBUG                          Generating InfCA certificate (serialNumber: 20002L)
15:46:19.258 DEBUG                          Generating certificate signature for serial: 20002
15:46:19.266 DEBUG                          Creating SKD message file /tmp/infca.resp
15:46:19.275 DEBUG                          Generating message signature using cert with serial: 81736
15:46:19.354 DEBUG                          Sending SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = 1L
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = 0
|                                               certificates (2 chains, 3 certificates) = 
|                                                 Chains summary:
|                                                   0x89e9ab9a4ea632f7-->0xc99ed3f4af77c679-->0xc9020cefbb66368c
|                                                   0x570f7a3804907142-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 81736L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154604Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:806108171978614432148844175260356222883780430450968363652762177841793065971776338110118472613500841053813149996717436597751892810888034631921065491173637846701459865203486225023457057129265756267660433738280141679920547360915469047
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc99ed3f4af77c679)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x89e9ab9a4ea632f7)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.4
|                                                                         [1] = 1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:21987351161736466185322200349010035353551578013472193971345759831101157374493552246775621386686971308187743884398479
|                                                           s = long384:20269985059786997924931975416071937299631683720451591973529382510370708799425362726583629139282569941379784668982400
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 88620L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154604Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:65979853226174723801876001180042043799271491887438343947605879014065310875081676458645849817010091213614485824926227147324171027642026135360511109244881013640488948194304793261413905646131765374359802992603567148793027537977984633
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xc99ed3f4af77c679)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[2]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:3395036733562562597008142328259802955288468692453853367188274306559114583900121938044734377751107783392147129124301
|                                                           s = long384:34531448125820603082609235998043738503064933600176560759426059655534664358589995996797158388539766004755071822048694
|                                                   Chain[1] =
|                                                       [1.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154619Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1092192514285881378359098569704607891747010781489990826896039999998448797293163772197521701491010085712161548144673178490972542992228402174923893457179436064472444923641582132410490202929063278495125024514731392493762491132767400258
|                                                               x = 27719210764091082473568250952180368107696170383335850523307787891164105790594234270825233827072583795039626357336795
|                                                               y = 31039616561189321694631148909187826590802947431781862784123704400128904396910459599967548755100891483786788071305538
|                                                           _extensions = CertificateExtensions
|                                                             [0] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[5]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                         2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                         3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                         4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x570f7a3804907142)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:1149203374241133776181448991841367651915405224223021584537910178443824313331054672540113700035990826626983476905202
|                                                           s = long384:18817124620172696373098973163558665787443721878009024672282407371543127539963523605729842414391974887906970786337183
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x89e9ab9a4ea632f7)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     [1] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154619Z)
|                                                     [3] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                                     [4] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [5] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xfce3ba053124d287)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:32229726447510521886917640566661508996036377782186625623195165292675981798921514578786448817580050804601550175392644
|                                                       s = long384:39313196623044704995954720755183232351304773314713757026442357649693927092717912098714459748757396643496337255228614
15:46:19.405 INFO                           #> 0.0.4. Instruct the ICM to load the Inf CA certificate response.
15:46:22.939 INFO                           #> 1. Send CSR for Inf IA to invalid URI.
15:46:22.984 DEBUG                          Generating message signature using cert with serial: 5
15:46:23.016 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:1254013602537575976174030947630677724348552638193737206850155610131937094294834500927609723738580609901192011827735126047990966909400050116797272407427685021699344358590453198861260878460524864496445893968835526206566723576085950397
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.1
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:38415667726983984664284959802162455976945369882211957688833561400501845487511672033915394093298651458976256061924930
|                                                       s = long384:36110268265488307739086618180758260360898358288321177580925066068809550993070138792653089578722365964428409816565421
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x56c17bcad8e9d727-->0x56c17bcad8e9d727
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 5L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154604Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1049690594393323903752242696626639901241909289052638638795813602472487883654334997743348569126034525797431864361740214144300961641547195039696337891140074205239437373610542773718175234041084370937719409967751993922520559569108326183
|                                                               x = 26640536757475483896232798678413001928244084972137771782357318111565818143457653252869893005239309826811490686754689
|                                                               y = 24419564876185491608104649130038734088286451367325643150892736514330280797759860035493695475929102911821876671665959
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x56c17bcad8e9d727)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x56c17bcad8e9d727)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:22953286120345499047823209727745784046619523265811059628977635665257836144477190805581537054169803726899558438642209
|                                                           s = long384:10431963698495375944777951495796685776101713428296713151443763018385045584781615956294256921753252824814361838002155
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x56c17bcad8e9d727)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154622Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x7a20e0c121cf1ecd8daf5b65bc19d145727fdc0c783cd905b43c3fc101750507d0f67e37a9a15579034fcc3d38c78f24)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x3fc2c4e54f3f31ae)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:7008239613536079506431029545199322642517766851636626605750800478399128766896307940415122456960325863550779542188764
|                                                       s = long928:34557394615156815092069774376701935772267800413385800342536990063823889871496150113690515264980842275244554292995612
15:46:23.035 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:46:23.036 INFO                           SKD: Client ---> Server CMC-request (1331 bytes)
15:46:23.036 INFO                           #> 2. Expect 404 (Not Found) response.
15:46:23.086 DEBUG                          Connected to Server
15:46:23.136 DEBUG                          Sending HTTP POST /does/not/exist message.
15:46:23.138 DEBUG                          Removing HTTP POST /does/not/exist message from Q.
15:46:23.214 DEBUG                          HTTP Status: 404 - NOT FOUND
15:46:23.215 ERROR                          HTTP error status 404 received.
15:46:23.215 DEBUG                          Connect closed for Server
15:46:23.216 DEBUG                          Connect closed for Server
15:46:23.227 INFO    Test:                  PASS
15:46:23.335 DEBUG                    Tearing down mock HTTP servers
15:46:31.132 DEBUG                    UUT Control: Applying all recent configuration changes
15:46:31.260 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:46:31.260 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:46:31.273 DEBUG                    Generating certificate signature for serial: 86284
15:46:31.282 DEBUG                    Added keymat IR-INF-CA: serial=86284 auth=0xc9020cefbb66368c subj=0x9fc1b42d411d5fc6
15:46:31.301 DEBUG                    Generating certificate signature for serial: 80185
15:46:31.307 DEBUG                    Added keymat IR-INF-IA: serial=80185 auth=0x9fc1b42d411d5fc6 subj=0x906454d2d1bef44a
15:46:31.320 DEBUG                    Generating certificate signature for serial: 80421
15:46:31.326 DEBUG                    Added keymat IR-INF-CRL-CA: serial=80421 auth=0xc9020cefbb66368c subj=0x717bd4f723e6e8c8
15:46:31.344 DEBUG                    Generating certificate signature for serial: 85641
15:46:31.349 DEBUG                    Added keymat IR-INF-CRL-IA: serial=85641 auth=0x717bd4f723e6e8c8 subj=0x30d64d2ce5ed3081
15:46:31.362 DEBUG                    Generating certificate signature for serial: 5
15:46:31.368 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x54d6f42abb511910 subj=0x54d6f42abb511910
15:46:31.378 DEBUG                    Generating message signature using cert with serial: 80185
15:46:31.422 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:46:31.480 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x54d6f42abb511910 subj=0x54d6f42abb511910
15:46:31.486 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:46:31.503 DEBUG                    Generating message signature using cert with serial: 5
15:46:31.561 DEBUG                    IR: Handling Certificate Signing Request.
15:46:31.561 DEBUG                    Creating temporary CA cert to issue IA
15:46:31.573 DEBUG                    Generating certificate signature for serial: 88263
15:46:31.579 DEBUG                    Added keymat IR-INF-CA-TMP: serial=88263 auth=0xc9020cefbb66368c subj=0xd2ed8491b30ba2ba
15:46:31.579 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:46:31.585 DEBUG                    Generating certificate signature for serial: 20000
15:46:31.592 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:46:31.595 DEBUG                    Generating message signature using cert with serial: 80185
15:46:31.711 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:46:31.711 DEBUG                    Received Inf IA response
15:46:31.712 DEBUG                    Added keymat IR-INF-CA: serial=88263 auth=0xc9020cefbb66368c subj=0xd2ed8491b30ba2ba
15:46:31.712 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0xd2ed8491b30ba2ba subj=0x7e515d00c7a5c27f
15:46:31.722 DEBUG                    Generating certificate signature for serial: 5
15:46:31.728 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xa8bb3aca1cfc8fae subj=0xa8bb3aca1cfc8fae
15:46:31.736 DEBUG                    Generating message signature using cert with serial: 20000
15:46:31.772 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:46:31.789 DEBUG                    Generating message signature using cert with serial: 20000
15:46:31.873 DEBUG                    IR: Handling Certificate Signing Request.
15:46:31.873 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:46:31.880 DEBUG                    Generating certificate signature for serial: 20001
15:46:31.887 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:46:31.890 DEBUG                    Generating message signature using cert with serial: 80185
15:46:31.986 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:46:31.986 DEBUG                    Received Inf CA response
15:46:31.986 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x13a9b89b3db0495f
15:46:31.987 INFO                     Listening for ('128.10.1.4', 80)
15:46:31.991 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:46:31.995 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:46:31.995 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:46:32.046 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xa8bb3aca1cfc8fae subj=0xa8bb3aca1cfc8fae
15:46:32.052 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:46:32.070 DEBUG                    Generating message signature using cert with serial: 5
15:46:32.127 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:46:32.133 DEBUG                    Generating certificate signature for serial: 20000
15:46:32.140 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:46:32.143 DEBUG                    Generating message signature using cert with serial: 20000
15:46:32.257 DEBUG                    Received Inf IA response
15:46:32.258 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x13a9b89b3db0495f
15:46:32.258 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x13a9b89b3db0495f subj=0x9481eb9b89eb41ee
15:46:32.262 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:46:32.266 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:46:32.319 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xa8bb3aca1cfc8fae subj=0xa8bb3aca1cfc8fae
15:46:32.320 INFO                     Listening for ('128.10.1.6', 80)
15:46:32.320 DEBUG                    MCKM requesting Inf IA from ICM.
15:46:32.326 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:46:32.342 DEBUG                    Generating message signature using cert with serial: 5
15:46:32.360 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:46:32.361 INFO                     SKD: Client ---> Server CMC-request (1340 bytes)
15:46:32.361 INFO                     Sent CSR for Inf IA certificate.
15:46:32.362 DEBUG                    112551952: Connect accepted from Client
15:46:32.412 DEBUG                    Connected to Server
15:46:32.461 DEBUG                    Sending HTTP POST /fullcmc message.
15:46:32.462 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:46:32.506 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:46:32.507 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:46:32.515 DEBUG                    Generating certificate signature for serial: 20001
15:46:32.526 DEBUG                    Generating message signature using cert with serial: 20000
15:46:32.588 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:46:32.590 DEBUG                    HTTP Status: 200 - OK
15:46:32.590 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3138 bytes)
15:46:32.669 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:46:32.669 DEBUG                    Received Inf IA response
15:46:32.670 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x13a9b89b3db0495f
15:46:32.670 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x13a9b89b3db0495f subj=0x30a3533b6b0ae39e
15:46:34.370 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:46:34.421 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xa8bb3aca1cfc8fae subj=0xa8bb3aca1cfc8fae
15:46:34.422 DEBUG                    CKA requesting Inf IA from ICM.
15:46:34.428 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:46:34.445 DEBUG                    Generating message signature using cert with serial: 5
15:46:34.465 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:46:34.465 INFO                     SKD: Client ---> Server CMC-request (1328 bytes)
15:46:34.465 INFO                     Sent CSR for Inf IA certificate.
15:46:34.466 DEBUG                    112551952: Connect accepted from Client
15:46:34.466 DEBUG                    Connect closed for Server
15:46:34.467 DEBUG                    Connect closed for Server
15:46:34.516 DEBUG                    Connected to Server
15:46:34.567 DEBUG                    Sending HTTP POST /fullcmc message.
15:46:34.568 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:46:34.609 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:46:34.609 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:46:34.616 DEBUG                    Generating certificate signature for serial: 20002
15:46:34.626 DEBUG                    Generating message signature using cert with serial: 20000
15:46:34.685 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:46:34.686 DEBUG                    HTTP Status: 200 - OK
15:46:34.687 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3127 bytes)
15:46:34.755 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:46:34.755 DEBUG                    Received Inf IA response
15:46:34.755 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x13a9b89b3db0495f
15:46:34.756 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x13a9b89b3db0495f subj=0xd2c7182c3c06bcdc
15:46:38.673 DEBUG                    ########## Mocks complete ##########
15:46:38.674 DEBUG                    UUT Control: Applying all recent configuration changes
15:46:38.696 INFO    Test:            84  : [icm-http-async-approve] Verify that the ICM
|                                           correctly follows the asynchronous HTTP
|                                           message flow when it is ready to return a
|                                           response.
15:46:38.705 DEBUG                          UUT Control: Applying all recent configuration changes
15:46:38.706 DEBUG                          cmd optimus > skdhttp quick off
15:46:38.728 INFO                           #> 0.1. Setup factory IA certs.
15:46:39.740 DEBUG                          Convert value '0x452cdb6c2fccbb8a' as OCTET STRING
15:46:39.741 DEBUG                          Convert value '0x8e766f38b09e6e75' as OCTET STRING
15:46:40.811 DEBUG                          Convert value '0x452cdb6c2fccbb8a' as OCTET STRING
15:46:40.812 DEBUG                          Convert value '0x8e766f38b09e6e75' as OCTET STRING
15:46:40.865 INFO                           #> 0.1.0.1. Trigger the ICM to request an Infrastructure CA certificate request.
15:46:49.154 INFO                           #> 0.1.0.2. Expect a Certificate Signing Request.
15:46:49.293 DEBUG                          Received SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:381805806479093205902274192060244936745243695840210398884910320747042058449325043498080865607557073844979846349962486578184087773323995132738872020110398778074974004267062961499817014931560647094683651126377033865240038204669854578
|                                                           x = 9690009299933330193384753081966566933518340341100791014336840649117466760363137832800340487263029314846126508312434
|                                                           y = 26052481933658375983360004158431813934115076336546070319587949479195779586693697929011214376393847873958002622104434
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['keyCertSign']
|                                                               [1]:
|                                                                   BasicConstraints_CertExt:
|                                                                       extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                       critical = True
|                                                                       constraints = BasicConstraints:
|                                                                           cA = True
|                                                                           pathLenConstraint = 0L
|                                                               [2]:
|                                                                   CertificateConstraints_CertExt:
|                                                                       extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                       constraints = CertificateConstraints:
|                                                                           range = EsnRange:
|                                                                               startEsn = 'D8EFF0000000'
|                                                                               endEsn = 'D8EFF9999999'
|                                                                           deviceFunctions = OIDList[5]:
|                                                                             0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                             1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                             2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                             3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                             4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:2028103395378766241252094243483857145666935491862551358191192328158758412619298346649206514881749221270012021772810
|                                                       s = long384:715647752225257766247052937917005227065383473342042992512250120354051543560501424185192483538772793321773218816126
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x2578b15bddf244da-->0x8c0e80353740c2e6-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154547Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1217137991547019620141137323811443212783793229321654163784524263536813217810038491075929670384669685488115807634104030741361135549036941997398259228182254057570810525118653850244964393293577300698948434287425606302760906535944209626
|                                                               x = 30890254305335221082651632674447350931297452067969621728237414593844843830988306154462669555433506339582023688776260
|                                                               y = 20669503428888069053052794175827663364089171765476890855722869264665557984789959060315239588782301182562922967221466
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x8c0e80353740c2e6)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2578b15bddf244da)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:6167738622798910902638590772808641101819612838257378692462034330661331135615368838872412712189267326476178254085670
|                                                           s = long384:12960146193357463998264417231671320606252645106388711417336266664913290742057267009486514430708239582590796215665556
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 84693L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154547Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:538130584090626188217492457055825547614696168020103852383663396717097948541659511304405117951426278086981306986016430246985215366492525022894646932386145835408392469148032214812335725165383508033951106276614995257453124113997546214
|                                                               x = 13657441233027073034932138741724735558053441287308304108821162563046885030485367988447604585327813355571179064368377
|                                                               y = 26105921429113117590538907492040297180200647097768119589017639905534383535332359376376575239613416701689228519588582
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x8c0e80353740c2e6)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:24278422764967294263304924834211581769508682345433664300719306578143360330104769420789422936196671990870243447029280
|                                                           s = long384:27904741804703282083487085578055342487650517992176618821988321716142320418824875909363351424778599326418057553171857
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x2578b15bddf244da)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154641Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xfce3ba053124d287)
|                                                           msgCount = 2L
|                                                     [4] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xc3d88c14513625a3d906197a9107b8780150896cd0847cf21dd45c722e9441063b806548df99363e53173a67e2360863)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:35935462539721240952935466972073507887905941111767193186487287781042507471396126491092119260418408169046345433367967
|                                                       s = long384:34152876142975307925825276540760573032394635833462546561119548398873135191839688514481389597649878200827074887434481
15:46:49.294 INFO                           #> 0.1.0.3. Create the certificate response for the ICM.
15:46:49.294 DEBUG                          IR: Handling Certificate Signing Request.
15:46:49.295 DEBUG                          Generating InfCA certificate (serialNumber: 20002L)
15:46:49.317 DEBUG                          Generating certificate signature for serial: 20002
15:46:49.327 DEBUG                          Creating SKD message file /tmp/infca.resp
15:46:49.336 DEBUG                          Generating message signature using cert with serial: 80185
15:46:49.414 DEBUG                          Sending SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = 1L
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = 0
|                                               certificates (2 chains, 3 certificates) = 
|                                                 Chains summary:
|                                                   0x906454d2d1bef44a-->0x9fc1b42d411d5fc6-->0xc9020cefbb66368c
|                                                   0x0025f8af06628372-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 80185L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154631Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:255542059840316027841929539733096131147779791662444899327745557532681889913572988611375725263833829795732890799176534788140221908090760406576867151581830675324885220041764602813066848328310175677158021928803437543087518520581223498
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x9fc1b42d411d5fc6)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x906454d2d1bef44a)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.4
|                                                                         [1] = 1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:21869409334093077209005905191934855015562281185835664726787481298568468965953668525920813481403180691763067611050904
|                                                           s = long384:35882416084651239221267632801765450496435267855686388383391565480612244522126527023165530849472120497248219548742564
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 86284L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154631Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:7334629786724462226688784697654065316709605747747406261374593457154630827067565241960009006386947093423047281480762424196925507165134279765454421185805047458495815369145843543726132199652010298240011137061006173070237737571672006
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x9fc1b42d411d5fc6)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[2]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:10820565229432883174842668397874833971814214417629569096049512782659109251355701508255322233580130532106121737525717
|                                                           s = long384:31404997750975803759738979517795533234905437833488552702205079302786850681026181793642271960865939913349056069600597
|                                                   Chain[1] =
|                                                       [1.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154649Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:381805806479093205902274192060244936745243695840210398884910320747042058449325043498080865607557073844979846349962486578184087773323995132738872020110398778074974004267062961499817014931560647094683651126377033865240038204669854578
|                                                               x = 9690009299933330193384753081966566933518340341100791014336840649117466760363137832800340487263029314846126508312434
|                                                               y = 26052481933658375983360004158431813934115076336546070319587949479195779586693697929011214376393847873958002622104434
|                                                           _extensions = CertificateExtensions
|                                                             [0] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[5]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                         2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                         3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                         4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x0025f8af06628372)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:2189512445617723424195051400435240058279293298286360132174685581885699404121290119046946462751812532244369874661845
|                                                           s = long384:24256833479408385930187179259669702255181773875085004212344568446519636797722119731132134758905965536660502091043309
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x906454d2d1bef44a)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     [1] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154649Z)
|                                                     [3] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                                     [4] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [5] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xfce3ba053124d287)
|                                                           msgCount = 2L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:29151303615683612948525651428577961822352548386573958098119895849922509041792271538699522292935997242894448312375668
|                                                       s = long384:31604712127162434681980424536737421245414296643923089776806258800026008016875026026027689705786746889707510800694461
15:46:49.466 INFO                           #> 0.1.0.4. Instruct the ICM to load the Inf CA certificate response.
15:46:53.493 DEBUG                          cmd optimus > keydir
15:46:53.537 DEBUG                          cmd optimus > keydir /tmp/
15:46:55.915 DEBUG                          cmd optimus > keydir ../Keys/
15:46:56.106 DEBUG                          Received SKD message:
|                                           KeyPackageFile:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = List:
|                                                   [0]:
|                                                       OneAsymmetricKey:
|                                                           version == 0
|                                                           privateKeyAlgorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           privateKey = ECPrivateKey:
|                                                               version = 1L
|                                                               privateKey = Octets(0x7bdc1b97868bd62f89b4baa6fbdd1cbe4ec376c0c3b4c21e8ccba32c5c1e7189b78552df6946c23b2719c7c35ae03f78)
|                                                           attributes:
|                                                             [0] = UserCertificateAttr:
|                                                               id == OID(userCertificate:2.5.4.36)
|                                                               userCertificate = Certificate:
|                                                                   tbsCertificate = TBSCertificate:
|                                                                       version == 2
|                                                                       serialNumber = 1L
|                                                                       signatureAlgorithmID = AlgorithmIdentifier:
|                                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                       issuer = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                                       validity = 170112000000Z..99991231235959Z
|                                                                       subject = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                           algorithm = AlgorithmIdentifier:
|                                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                               parameters = ECParameters:
|                                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                           subjectPublicKey = long768:469648945615836341468047815174018471645672134311062317877941211942162805946308643568437698551027407437337263747291576560894374109440045477017780231567112680444424933924018001646332725368061499234175209139138140636687093857114368318
|                                                                           x = 11919417079296131056518798902447995422642355324375016307408181402305967337771595061993721467460550613999159413109585
|                                                                           y = 2910166685440197568109250130698240875747172780624486128218533898294160333630412314836356871223956356801080333936958
|                                                                       _extensions = CertificateExtensions
|                                                                         [0] AuthorityKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                               keyIdentifier = Octets(0x293ae0219e97a93e)
|                                                                         [1] SubjectKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                               id = Octets(0x293ae0219e97a93e)
|                                                                         [2] KeyUsage_CertExt:
|                                                                               extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                               critical = True
|                                                                               uses = ['digitalSignature']
|                                                                         [3] CertificatePolicies_CertExt:
|                                                                               extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                               critical = True
|                                                                               policies:
|                                                                                 [0] = PolicyInformation:
|                                                                                   id = OID(1.2.826.0.1145.0.1.0.3)
|                                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                   signature = Signature:
|                                                                       r = long384:13070661058050973737698823212392128921838875388876081947998012449858790472360146273292460332102414898539744792947049
|                                                                       s = long384:12208102720912902292572471209558505479035792570025011086885564995447731037135975172262458829194577146928446623941648
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x2578b15bddf244da-->0x8c0e80353740c2e6-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154547Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1217137991547019620141137323811443212783793229321654163784524263536813217810038491075929670384669685488115807634104030741361135549036941997398259228182254057570810525118653850244964393293577300698948434287425606302760906535944209626
|                                                               x = 30890254305335221082651632674447350931297452067969621728237414593844843830988306154462669555433506339582023688776260
|                                                               y = 20669503428888069053052794175827663364089171765476890855722869264665557984789959060315239588782301182562922967221466
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x8c0e80353740c2e6)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2578b15bddf244da)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:6167738622798910902638590772808641101819612838257378692462034330661331135615368838872412712189267326476178254085670
|                                                           s = long384:12960146193357463998264417231671320606252645106388711417336266664913290742057267009486514430708239582590796215665556
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 84693L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154547Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:538130584090626188217492457055825547614696168020103852383663396717097948541659511304405117951426278086981306986016430246985215366492525022894646932386145835408392469148032214812335725165383508033951106276614995257453124113997546214
|                                                               x = 13657441233027073034932138741724735558053441287308304108821162563046885030485367988447604585327813355571179064368377
|                                                               y = 26105921429113117590538907492040297180200647097768119589017639905534383535332359376376575239613416701689228519588582
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x8c0e80353740c2e6)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:24278422764967294263304924834211581769508682345433664300719306578143360330104769420789422936196671990870243447029280
|                                                           s = long384:27904741804703282083487085578055342487650517992176618821988321716142320418824875909363351424778599326418057553171857
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x2578b15bddf244da)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                                     [1] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x8f1244b4d577ded83dfc18406a7534cb46642197795826c003585fcca9a7d598c553678e128038bfea113f6bad2d30be)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:32528062992338390981880462104433053691539795728050254002025435704425438590200557947578260338475530575433623423910148
|                                                       s = long384:23519728047300145083476161378940985127425243508028440610290359528432825074807387020288456417083577320314111793565482
15:46:56.107 DEBUG                          Added keymat FACT-IA: serial=1 auth=0x293ae0219e97a93e subj=0x293ae0219e97a93e
15:46:56.107 INFO                           #> 1. Set Retry-After.
15:46:56.152 INFO                           #> 2. Make a valid request for Inf IA and check the asynchronous HTTP responses.
15:46:56.152 DEBUG                          CKA requesting Inf IA from ICM.
15:46:56.159 INFO                           SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:46:56.198 DEBUG                          Generating message signature using cert with serial: 1
15:46:56.230 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:873976586685185192142217562358291946679919084388658489555193063243532110619497413533506160509916092286689824902000143465310621539856830776010105109983181240623621948287633907165891193143483734197052976016954115790033811982364465745
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.1
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:25957063558503459643243171287913556654636661371842610703818114732168019399459775977444155164907242979657629995219112
|                                                       s = long384:39328164337289917590403700742870390795729103140637260233738015598513258468102353241179495169317604865268902237120282
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x293ae0219e97a93e-->0x293ae0219e97a93e
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 1L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:469648945615836341468047815174018471645672134311062317877941211942162805946308643568437698551027407437337263747291576560894374109440045477017780231567112680444424933924018001646332725368061499234175209139138140636687093857114368318
|                                                               x = 11919417079296131056518798902447995422642355324375016307408181402305967337771595061993721467460550613999159413109585
|                                                               y = 2910166685440197568109250130698240875747172780624486128218533898294160333630412314836356871223956356801080333936958
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x293ae0219e97a93e)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x293ae0219e97a93e)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:13070661058050973737698823212392128921838875388876081947998012449858790472360146273292460332102414898539744792947049
|                                                           s = long384:12208102720912902292572471209558505479035792570025011086885564995447731037135975172262458829194577146928446623941648
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x293ae0219e97a93e)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154656Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x972cf0156f377186a1707125fcb525c98c21157d265b11a0d4fbe9c77138c9e304fb2dfedca02a84efc31e8468412c34)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x435a398ec3e08833)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:12951428147937349576027043379055869882155000169543741662662052886513739570827836280120626020487064826261951093946583
|                                                       s = long384:31898912167504785946496533799037412457165046815201471310639104319838011898391241919992513571933415480598005872801269
15:46:56.250 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:46:56.250 INFO                           SKD: Client ---> Server CMC-request (1330 bytes)
15:46:56.251 INFO                           Sent CSR for Inf IA certificate.
15:46:56.301 DEBUG                          Connected to Server
15:46:56.351 DEBUG                          Sending HTTP POST /fullcmc message.
15:46:56.353 DEBUG                          Removing HTTP POST /fullcmc message from Q.
15:46:56.495 DEBUG                          HTTP Status: 202 - ACCEPTED
15:46:56.496 DEBUG                          Connect closed for Server
15:46:56.496 DEBUG                          Connect closed for Server
15:46:56.502 INFO                           #> 3. Instruct operator to approve CSR for Inf IA.
15:46:57.620 ERROR   Test:                  FAIL
15:46:57.626 ERROR                          Test failed
15:46:57.627 ERROR                          Unhandled exception occurred:
|                                             Exception:hmmm
|                                           ../../test_support/plugins/snmp/icm.py: __setActionForInfIaCsr
|                                              565 :         the value of 'Action' (approve/reject) for the row that matches.
|                                              566 :         """
|                                              567 :         if caCertIndex is None and actionValue == 2:  # approve
|                                           ==>568 :             raise Exception("hmmm")
|                                              569 :
|                                              570 :         # If accepting, look for a row that is pending
|                                              571 :         actionToFind = None
|                                           ../../test_support/plugins/snmp/icm.py: approveInfIaCsr
|                                              219 :         return self.__setActionForInfIaCsr(esn, approve, caCertIndex)
|                                           ../../test_support/function/icm.py: approveInfIaCsr
|                                              75  :                                          transport, validCsr)
|                                           test_icm_http.py: testAsyncMessageReady
|                                              153 :                                         transport="HTTP", validCsr=True)
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/testspec.py: run
|                                              357 :             func(*args, **kwargs)
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/testspec.py: runAndTrace
|                                              76  :         runTracer.run(func, args, kwargs)
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/Manager.py: _invoke
|                                              1181:                 self.spec.runAndTrace(self._func)
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/Manager.py: __call__
|                                              1238:                 if self._runner:
|                                              1239:                     ret = self._runner.callFunc(id(self), "_invoke")
|                                              1240:                 else:
|                                           ==>1241:                     ret = self._invoke()
|                                              1242:             else:
|                                              1243:                 print("Do Nowt!!!!")
|                                              1244:         except testKillers as self.origExc:
15:46:57.745 DEBUG                    Tearing down mock HTTP servers
15:46:58.496 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:46:58.546 DEBUG                    Connected to Server
15:46:58.596 DEBUG                    Sending HTTP GET /status_1 message.
15:46:58.596 DEBUG                    Removing HTTP GET /status_1 message from Q.
15:46:58.643 DEBUG                    HTTP Status: 200 - OK
15:46:58.644 DEBUG                    Connect closed for Server
15:46:58.645 DEBUG                    Connect closed for Server
15:47:00.644 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:00.695 DEBUG                    Connected to Server
15:47:00.745 DEBUG                    Sending HTTP GET /status_1 message.
15:47:00.746 DEBUG                    Removing HTTP GET /status_1 message from Q.
15:47:00.820 DEBUG                    HTTP Status: 200 - OK
15:47:00.821 DEBUG                    Connect closed for Server
15:47:00.821 DEBUG                    Connect closed for Server
15:47:02.821 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:02.872 DEBUG                    Connected to Server
15:47:02.922 DEBUG                    Sending HTTP GET /status_1 message.
15:47:02.922 DEBUG                    Removing HTTP GET /status_1 message from Q.
15:47:03.050 DEBUG                    HTTP Status: 200 - OK
15:47:03.051 DEBUG                    Connect closed for Server
15:47:03.051 DEBUG                    Connect closed for Server
15:47:05.051 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:05.102 DEBUG                    Connected to Server
15:47:05.151 DEBUG                    Sending HTTP GET /status_1 message.
15:47:05.152 DEBUG                    Removing HTTP GET /status_1 message from Q.
15:47:05.154 DEBUG                    UUT Control: Applying all recent configuration changes
15:47:05.155 DEBUG                    cmd optimus > skdhttp quick on
15:47:05.330 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:47:05.330 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:47:05.343 DEBUG                    Generating certificate signature for serial: 84242
15:47:05.348 DEBUG                    Added keymat IR-INF-CA: serial=84242 auth=0xc9020cefbb66368c subj=0xb3198b35c039f54e
15:47:05.361 DEBUG                    Generating certificate signature for serial: 87920
15:47:05.368 DEBUG                    Added keymat IR-INF-IA: serial=87920 auth=0xb3198b35c039f54e subj=0x782c5a7da666587d
15:47:05.386 DEBUG                    Generating certificate signature for serial: 88287
15:47:05.394 DEBUG                    Added keymat IR-INF-CRL-CA: serial=88287 auth=0xc9020cefbb66368c subj=0xaba7eaadd7a39b47
15:47:05.408 DEBUG                    Generating certificate signature for serial: 87968
15:47:05.415 DEBUG                    Added keymat IR-INF-CRL-IA: serial=87968 auth=0xaba7eaadd7a39b47 subj=0x7a2eaa6ccad63a94
15:47:05.426 DEBUG                    Generating certificate signature for serial: 5
15:47:05.432 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xd8890e5e56bce6d4 subj=0xd8890e5e56bce6d4
15:47:05.442 DEBUG                    Generating message signature using cert with serial: 87920
15:47:05.487 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:47:05.543 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xd8890e5e56bce6d4 subj=0xd8890e5e56bce6d4
15:47:05.550 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:47:05.573 DEBUG                    Generating message signature using cert with serial: 5
15:47:05.632 DEBUG                    IR: Handling Certificate Signing Request.
15:47:05.632 DEBUG                    Creating temporary CA cert to issue IA
15:47:05.644 DEBUG                    Generating certificate signature for serial: 88418
15:47:05.650 DEBUG                    Added keymat IR-INF-CA-TMP: serial=88418 auth=0xc9020cefbb66368c subj=0x362eca5655a26f84
15:47:05.650 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:47:05.657 DEBUG                    Generating certificate signature for serial: 20000
15:47:05.664 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:47:05.667 DEBUG                    Generating message signature using cert with serial: 87920
15:47:05.785 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:47:05.785 DEBUG                    Received Inf IA response
15:47:05.785 DEBUG                    Added keymat IR-INF-CA: serial=88418 auth=0xc9020cefbb66368c subj=0x362eca5655a26f84
15:47:05.786 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x362eca5655a26f84 subj=0x9a7b7b394995036e
15:47:05.796 DEBUG                    Generating certificate signature for serial: 5
15:47:05.802 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x2d804a8133376b93 subj=0x2d804a8133376b93
15:47:05.810 DEBUG                    Generating message signature using cert with serial: 20000
15:47:05.846 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:47:05.864 DEBUG                    Generating message signature using cert with serial: 20000
15:47:05.948 DEBUG                    IR: Handling Certificate Signing Request.
15:47:05.949 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:47:05.955 DEBUG                    Generating certificate signature for serial: 20001
15:47:05.962 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:47:05.965 DEBUG                    Generating message signature using cert with serial: 87920
15:47:06.062 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:47:06.062 DEBUG                    Received Inf CA response
15:47:06.062 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xb4677915b7734af0
15:47:06.063 INFO                     Listening for ('128.10.1.4', 80)
15:47:06.067 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:47:06.071 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:47:06.072 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:47:06.122 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x2d804a8133376b93 subj=0x2d804a8133376b93
15:47:06.129 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:47:06.145 DEBUG                    Generating message signature using cert with serial: 5
15:47:06.204 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:47:06.210 DEBUG                    Generating certificate signature for serial: 20000
15:47:06.217 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:47:06.220 DEBUG                    Generating message signature using cert with serial: 20000
15:47:06.335 DEBUG                    Received Inf IA response
15:47:06.336 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xb4677915b7734af0
15:47:06.336 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0xb4677915b7734af0 subj=0xc984e67af9a80d67
15:47:06.340 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:47:06.344 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:47:06.394 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x2d804a8133376b93 subj=0x2d804a8133376b93
15:47:06.394 INFO                     Listening for ('128.10.1.6', 80)
15:47:06.394 DEBUG                    MCKM requesting Inf IA from ICM.
15:47:06.400 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:47:06.416 DEBUG                    Generating message signature using cert with serial: 5
15:47:06.435 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:47:06.435 INFO                     SKD: Client ---> Server CMC-request (1341 bytes)
15:47:06.435 INFO                     Sent CSR for Inf IA certificate.
15:47:06.436 DEBUG                    HTTP Status: 200 - OK
15:47:06.436 DEBUG                    105050576: Connect accepted from Client
15:47:06.437 DEBUG                    Connect closed for Server
15:47:06.437 DEBUG                    Connect closed for Server
15:47:06.485 DEBUG                    Connected to Server
15:47:06.536 DEBUG                    Sending HTTP POST /fullcmc message.
15:47:06.537 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:47:06.577 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:47:06.578 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:47:06.584 DEBUG                    Generating certificate signature for serial: 20001
15:47:06.593 DEBUG                    Generating message signature using cert with serial: 20000
15:47:06.646 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:47:06.647 DEBUG                    HTTP Status: 200 - OK
15:47:06.647 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3139 bytes)
15:47:06.712 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:47:06.712 DEBUG                    Received Inf IA response
15:47:06.713 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xb4677915b7734af0
15:47:06.713 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0xb4677915b7734af0 subj=0xdbaf5177be0b3f0b
15:47:08.440 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:08.447 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:47:08.500 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x2d804a8133376b93 subj=0x2d804a8133376b93
15:47:08.500 DEBUG                    CKA requesting Inf IA from ICM.
15:47:08.506 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:47:08.524 DEBUG                    Generating message signature using cert with serial: 5
15:47:08.544 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:47:08.544 INFO                     SKD: Client ---> Server CMC-request (1329 bytes)
15:47:08.545 INFO                     Sent CSR for Inf IA certificate.
15:47:08.545 DEBUG                    Connected to Server
15:47:08.545 DEBUG                    Sending HTTP GET /status_1 message.
15:47:08.546 DEBUG                    Removing HTTP GET /status_1 message from Q.
15:47:08.546 DEBUG                    105050576: Connect accepted from Client
15:47:08.547 DEBUG                    Connect closed for Server
15:47:08.547 DEBUG                    Connect closed for Server
15:47:08.595 DEBUG                    Connected to Server
15:47:08.614 DEBUG                    HTTP Status: 200 - OK
15:47:08.614 DEBUG                    Connect closed for Server
15:47:08.616 DEBUG                    Connect closed for Server
15:47:08.646 DEBUG                    Sending HTTP POST /fullcmc message.
15:47:08.647 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:47:08.699 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:47:08.700 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:47:08.712 DEBUG                    Generating certificate signature for serial: 20002
15:47:08.727 DEBUG                    Generating message signature using cert with serial: 20000
15:47:08.787 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:47:08.788 DEBUG                    HTTP Status: 200 - OK
15:47:08.788 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3129 bytes)
15:47:08.852 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:47:08.853 DEBUG                    Received Inf IA response
15:47:08.853 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xb4677915b7734af0
15:47:08.853 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0xb4677915b7734af0 subj=0xbe2ef7790b249d9e
15:47:10.616 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:10.667 DEBUG                    Connected to Server
15:47:10.718 DEBUG                    Sending HTTP GET /status_1 message.
15:47:10.718 DEBUG                    Removing HTTP GET /status_1 message from Q.
15:47:10.812 DEBUG                    HTTP Status: 200 - OK
15:47:10.813 DEBUG                    Connect closed for Server
15:47:10.814 DEBUG                    Connect closed for Server
15:47:12.751 DEBUG                    ########## Mocks complete ##########
15:47:12.752 DEBUG                    UUT Control: Applying all recent configuration changes
15:47:12.774 INFO    Test:            85  : [icm-http-async-not-ready] Verify that the
|                                           ICM correctly follows the asynchronous HTTP
|                                           message flow when it is not ready to return
|                                           a response.
15:47:12.783 INFO                           #> 0.1. Setup factory IA certs.
15:47:12.813 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:12.865 DEBUG                          Connected to Server
15:47:12.914 DEBUG                          Sending HTTP GET /status_1 message.
15:47:12.915 DEBUG                          Removing HTTP GET /status_1 message from Q.
15:47:13.053 DEBUG                          HTTP Status: 200 - OK
15:47:13.053 DEBUG                          Connect closed for Server
15:47:13.054 DEBUG                          Connect closed for Server
15:47:13.733 DEBUG                          Convert value '0x452cdb6c2fccbb8a' as OCTET STRING
15:47:13.734 DEBUG                          Convert value '0x8e766f38b09e6e75' as OCTET STRING
15:47:14.749 DEBUG                          Convert value '0x452cdb6c2fccbb8a' as OCTET STRING
15:47:14.750 DEBUG                          Convert value '0x8e766f38b09e6e75' as OCTET STRING
15:47:14.805 INFO                           #> 0.1.0.1. Trigger the ICM to request an Infrastructure CA certificate request.
15:47:15.053 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:15.108 DEBUG                          Connected to Server
15:47:15.155 DEBUG                          Sending HTTP GET /status_1 message.
15:47:15.164 DEBUG                          Removing HTTP GET /status_1 message from Q.
15:47:15.212 DEBUG                          HTTP Status: 200 - OK
15:47:15.213 DEBUG                          Connect closed for Server
15:47:15.214 DEBUG                          Connect closed for Server
15:47:17.213 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:17.264 DEBUG                          Connected to Server
15:47:17.314 DEBUG                          Sending HTTP GET /status_1 message.
15:47:17.315 DEBUG                          Removing HTTP GET /status_1 message from Q.
15:47:17.420 DEBUG                          HTTP Status: 200 - OK
15:47:17.421 DEBUG                          Connect closed for Server
15:47:17.421 DEBUG                          Connect closed for Server
15:47:19.421 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:19.472 DEBUG                          Connected to Server
15:47:19.522 DEBUG                          Sending HTTP GET /status_1 message.
15:47:19.522 DEBUG                          Removing HTTP GET /status_1 message from Q.
15:47:19.621 DEBUG                          HTTP Status: 200 - OK
15:47:19.622 DEBUG                          Connect closed for Server
15:47:19.629 DEBUG                          Connect closed for Server
15:47:21.622 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:21.674 DEBUG                          Connected to Server
15:47:21.723 DEBUG                          Sending HTTP GET /status_1 message.
15:47:21.723 DEBUG                          Removing HTTP GET /status_1 message from Q.
15:47:21.863 DEBUG                          HTTP Status: 200 - OK
15:47:21.864 DEBUG                          Connect closed for Server
15:47:21.865 DEBUG                          Connect closed for Server
15:47:23.864 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:23.915 DEBUG                          Connected to Server
15:47:23.966 DEBUG                          Sending HTTP GET /status_1 message.
15:47:23.966 DEBUG                          Removing HTTP GET /status_1 message from Q.
15:47:24.052 DEBUG                          HTTP Status: 200 - OK
15:47:24.053 DEBUG                          Connect closed for Server
15:47:24.054 DEBUG                          Connect closed for Server
15:47:25.960 INFO                           #> 0.1.0.2. Expect a Certificate Signing Request.
15:47:26.092 DEBUG                          Received SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:1332837124652056572431505999897841936251096943700605974311851489055199148382154723040740661459859029002306059449340780483365493810448244265103233493032370637782019037511484941923365696004685125189439860067864729315391926465507648168
|                                                           x = 33826631009819474464119457975745374705544193180216233837149455115582578384658828204029662766523266922549800209351098
|                                                           y = 21474744777064534080750901251015373818891485264430714123609783563497122578778267212739347478176063177041400221164200
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['keyCertSign']
|                                                               [1]:
|                                                                   BasicConstraints_CertExt:
|                                                                       extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                       critical = True
|                                                                       constraints = BasicConstraints:
|                                                                           cA = True
|                                                                           pathLenConstraint = 0L
|                                                               [2]:
|                                                                   CertificateConstraints_CertExt:
|                                                                       extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                       constraints = CertificateConstraints:
|                                                                           range = EsnRange:
|                                                                               startEsn = 'D8EFF0000000'
|                                                                               endEsn = 'D8EFF9999999'
|                                                                           deviceFunctions = OIDList[5]:
|                                                                             0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                             1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                             2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                             3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                             4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:38039452746077633116438979898951941371604349429858438742862367218621982072524794054826789949516627349377081267744804
|                                                       s = long384:37775040234010763342129696191421819312362378714021833009867812020269981221037320112998443730637925414143093324533025
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x2578b15bddf244da-->0x8c0e80353740c2e6-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154547Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1217137991547019620141137323811443212783793229321654163784524263536813217810038491075929670384669685488115807634104030741361135549036941997398259228182254057570810525118653850244964393293577300698948434287425606302760906535944209626
|                                                               x = 30890254305335221082651632674447350931297452067969621728237414593844843830988306154462669555433506339582023688776260
|                                                               y = 20669503428888069053052794175827663364089171765476890855722869264665557984789959060315239588782301182562922967221466
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x8c0e80353740c2e6)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2578b15bddf244da)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:6167738622798910902638590772808641101819612838257378692462034330661331135615368838872412712189267326476178254085670
|                                                           s = long384:12960146193357463998264417231671320606252645106388711417336266664913290742057267009486514430708239582590796215665556
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 84693L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154547Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:538130584090626188217492457055825547614696168020103852383663396717097948541659511304405117951426278086981306986016430246985215366492525022894646932386145835408392469148032214812335725165383508033951106276614995257453124113997546214
|                                                               x = 13657441233027073034932138741724735558053441287308304108821162563046885030485367988447604585327813355571179064368377
|                                                               y = 26105921429113117590538907492040297180200647097768119589017639905534383535332359376376575239613416701689228519588582
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x8c0e80353740c2e6)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:24278422764967294263304924834211581769508682345433664300719306578143360330104769420789422936196671990870243447029280
|                                                           s = long384:27904741804703282083487085578055342487650517992176618821988321716142320418824875909363351424778599326418057553171857
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x2578b15bddf244da)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154716Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xfce3ba053124d287)
|                                                           msgCount = 3L
|                                                     [4] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xb12e51f59b54e54b6f4db64d4115459ea2e084dda4e460c6590c4fdd5c42f8464b2d4bcb1fb2e5d5bd31d0e2c69c0837)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:31319259486936810323674851682843926715622369718096248230350731564501681226433229700741214926214483228931197242994148
|                                                       s = long384:9077449314378266796348848763354047260370478136828652202876240815017550099039759244795700669787025269565987426147809
15:47:26.093 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:26.094 INFO                           #> 0.1.0.3. Create the certificate response for the ICM.
15:47:26.095 DEBUG                          IR: Handling Certificate Signing Request.
15:47:26.097 DEBUG                          Generating InfCA certificate (serialNumber: 20002L)
15:47:26.118 DEBUG                          Generating certificate signature for serial: 20002
15:47:26.126 DEBUG                          Creating SKD message file /tmp/infca.resp
15:47:26.135 DEBUG                          Generating message signature using cert with serial: 87920
15:47:26.214 DEBUG                          Sending SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = 1L
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = 0
|                                               certificates (2 chains, 3 certificates) = 
|                                                 Chains summary:
|                                                   0x782c5a7da666587d-->0xb3198b35c039f54e-->0xc9020cefbb66368c
|                                                   0xc749dce6405462a8-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 87920L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154705Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1051646256409190123555238030613950539254118694647907087878581225792769474633325706208787079786195861130328921029849690052062469183116515371658318189162284898906390294509427490528565939226953963391101061135813387171899658773905954941
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xb3198b35c039f54e)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x782c5a7da666587d)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.4
|                                                                         [1] = 1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:17184034870493421651513493961328796013752175178586273027145328930322010470304955899669130818735797353688774326501385
|                                                           s = long384:18794503130193933009286835588774127730918608631641012931539196710255958703123651288944622755954748678476377326864524
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 84242L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154705Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:580404499489786742499371564757294225919384211694594222666025649570229718783737550517644352047550002346382478010843414970103215972835241886610597437528277932960476997918821985700152842594362471718704083466750408798117614726233584974
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xb3198b35c039f54e)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[2]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:7684785577809113501788614396424730199511388053909414422665478877650354503070409495757627127785814488358687447883897
|                                                           s = long384:34941706258837859718415344183166235782602931651107446541165004168340292358112360601191019465246797158155855739365542
|                                                   Chain[1] =
|                                                       [1.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154726Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1332837124652056572431505999897841936251096943700605974311851489055199148382154723040740661459859029002306059449340780483365493810448244265103233493032370637782019037511484941923365696004685125189439860067864729315391926465507648168
|                                                               x = 33826631009819474464119457975745374705544193180216233837149455115582578384658828204029662766523266922549800209351098
|                                                               y = 21474744777064534080750901251015373818891485264430714123609783563497122578778267212739347478176063177041400221164200
|                                                           _extensions = CertificateExtensions
|                                                             [0] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[5]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                         2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                         3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                         4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xc749dce6405462a8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:21289465414419852311050665233612492605473514715108786216561947013314155973388576704407641764767679519672085671148832
|                                                           s = long384:5123237157886967126741403898592827867198881002350258111942319975928511397272851333435794524313141570126061402652002
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x782c5a7da666587d)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     [1] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154726Z)
|                                                     [3] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                                     [4] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [5] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xfce3ba053124d287)
|                                                           msgCount = 3L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:11032387796417013074721433195922024722141521658367675770414825218568318158313973295667887504678286451891862895481904
|                                                       s = long384:11989844728863864839589129080902625541832258451562022812580747208650696936995274733875532238341854430615473263420273
15:47:26.265 INFO                           #> 0.1.0.4. Instruct the ICM to load the Inf CA certificate response.
15:47:26.269 DEBUG                          Connected to Server
15:47:26.270 DEBUG                          Sending HTTP GET /status_1 message.
15:47:26.270 DEBUG                          Removing HTTP GET /status_1 message from Q.
15:47:26.352 DEBUG                          HTTP Status: 200 - OK
15:47:26.353 DEBUG                          Connect closed for Server
15:47:26.354 DEBUG                          Connect closed for Server
15:47:28.353 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:28.404 DEBUG                          Connected to Server
15:47:28.453 DEBUG                          Sending HTTP GET /status_1 message.
15:47:28.454 DEBUG                          Removing HTTP GET /status_1 message from Q.
15:47:28.543 DEBUG                          HTTP Status: 200 - OK
15:47:28.544 DEBUG                          Connect closed for Server
15:47:28.545 DEBUG                          Connect closed for Server
15:47:30.383 DEBUG                          cmd optimus > keydir
15:47:30.427 DEBUG                          cmd optimus > keydir /tmp/
15:47:30.544 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:30.595 DEBUG                          Connected to Server
15:47:30.645 DEBUG                          Sending HTTP GET /status_1 message.
15:47:30.646 DEBUG                          Removing HTTP GET /status_1 message from Q.
15:47:30.717 DEBUG                          HTTP Status: 200 - OK
15:47:30.719 DEBUG                          Connect closed for Server
15:47:30.728 DEBUG                          Connect closed for Server
15:47:32.718 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:32.769 DEBUG                          Connected to Server
15:47:32.819 DEBUG                          Sending HTTP GET /status_1 message.
15:47:32.820 DEBUG                          Removing HTTP GET /status_1 message from Q.
15:47:32.914 DEBUG                          HTTP Status: 200 - OK
15:47:32.915 DEBUG                          Connect closed for Server
15:47:32.916 DEBUG                          Connect closed for Server
15:47:33.724 DEBUG                          cmd optimus > keydir ../Keys/
15:47:34.071 DEBUG                          Received SKD message:
|                                           KeyPackageFile:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = List:
|                                                   [0]:
|                                                       OneAsymmetricKey:
|                                                           version == 0
|                                                           privateKeyAlgorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           privateKey = ECPrivateKey:
|                                                               version = 1L
|                                                               privateKey = Octets(0xb4211116408a32061610217b33e39936201d1539731d179a9c23fecf84efe51f640164bafb92a1de2af2b0cf30bb24f3)
|                                                           attributes:
|                                                             [0] = UserCertificateAttr:
|                                                               id == OID(userCertificate:2.5.4.36)
|                                                               userCertificate = Certificate:
|                                                                   tbsCertificate = TBSCertificate:
|                                                                       version == 2
|                                                                       serialNumber = 2L
|                                                                       signatureAlgorithmID = AlgorithmIdentifier:
|                                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                       issuer = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                                       validity = 170112000000Z..99991231235959Z
|                                                                       subject = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                           algorithm = AlgorithmIdentifier:
|                                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                               parameters = ECParameters:
|                                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                           subjectPublicKey = long768:555831777095267870590241601399800466833783251129883340213600672284904160396525568836658906539651853017705934754978946550148579456280235332355228623988465307153201312175555360330559785154022163627294146396591863217833603145872150309
|                                                                           x = 14106687215995865322040181002941381475239795958480057660231444126365435715161666811141141722954380282486549706351420
|                                                                           y = 33046451196921907455947491036282842805052518446763141672931422044095692768455375796282800404036588304220196154871589
|                                                                       _extensions = CertificateExtensions
|                                                                         [0] AuthorityKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                               keyIdentifier = Octets(0x61506d89717f8f25)
|                                                                         [1] SubjectKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                               id = Octets(0x61506d89717f8f25)
|                                                                         [2] KeyUsage_CertExt:
|                                                                               extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                               critical = True
|                                                                               uses = ['digitalSignature']
|                                                                         [3] CertificatePolicies_CertExt:
|                                                                               extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                               critical = True
|                                                                               policies:
|                                                                                 [0] = PolicyInformation:
|                                                                                   id = OID(1.2.826.0.1145.0.1.0.3)
|                                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                   signature = Signature:
|                                                                       r = long384:22674024245814608394018772220558183351897236123074325859958784890852007124814941348013777485209832059930981683257868
|                                                                       s = long384:23842586809224447602544604799883373093403349568719994878378798281251818040068274240332914768042402926920681754665792
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x2578b15bddf244da-->0x8c0e80353740c2e6-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154547Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1217137991547019620141137323811443212783793229321654163784524263536813217810038491075929670384669685488115807634104030741361135549036941997398259228182254057570810525118653850244964393293577300698948434287425606302760906535944209626
|                                                               x = 30890254305335221082651632674447350931297452067969621728237414593844843830988306154462669555433506339582023688776260
|                                                               y = 20669503428888069053052794175827663364089171765476890855722869264665557984789959060315239588782301182562922967221466
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x8c0e80353740c2e6)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2578b15bddf244da)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:6167738622798910902638590772808641101819612838257378692462034330661331135615368838872412712189267326476178254085670
|                                                           s = long384:12960146193357463998264417231671320606252645106388711417336266664913290742057267009486514430708239582590796215665556
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 84693L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154547Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:538130584090626188217492457055825547614696168020103852383663396717097948541659511304405117951426278086981306986016430246985215366492525022894646932386145835408392469148032214812335725165383508033951106276614995257453124113997546214
|                                                               x = 13657441233027073034932138741724735558053441287308304108821162563046885030485367988447604585327813355571179064368377
|                                                               y = 26105921429113117590538907492040297180200647097768119589017639905534383535332359376376575239613416701689228519588582
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x8c0e80353740c2e6)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:24278422764967294263304924834211581769508682345433664300719306578143360330104769420789422936196671990870243447029280
|                                                           s = long384:27904741804703282083487085578055342487650517992176618821988321716142320418824875909363351424778599326418057553171857
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x2578b15bddf244da)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                                     [1] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xb9cba7599d9409226a6f59e5b71239b7ec2e5c019c68ce2fdc6ae9c3be41ab74b6b2e45b7f26b2600620134861b0e762)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:1443031650659702274289637392473790664084559216108270716333799668258973878079606741836980509995930299128471502091819
|                                                       s = long384:14451864793596752620098689156094534491172161675290437460670508248430913830353400705802389838720239930317143641608474
15:47:34.073 DEBUG                          Added keymat FACT-IA: serial=2 auth=0x61506d89717f8f25 subj=0x61506d89717f8f25
15:47:34.073 INFO                           #> 1. Make a valid request for Inf IA without approving the request, and check the HTTP 202 (Accepted) response.
15:47:34.073 DEBUG                          CKA requesting Inf IA from ICM.
15:47:34.089 INFO                           SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:47:34.168 DEBUG                          Generating message signature using cert with serial: 2
15:47:34.217 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:167486293120616327444517525626648959424923101975473179738195320138843147646959667939252811832382626177265572218655667533289476885770594601617785384564777874727303591921014700811044020063517121942200800108821988176608847482783832592
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.1
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:10513178242216625443136586309566597707730420729069528514803431487692819928861347677097444100633619699998774988236222
|                                                       s = long384:18980590565329549417217694467381505129942622212117814550047156499404051652885982388297947909806303052020052773875943
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x61506d89717f8f25-->0x61506d89717f8f25
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 2L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:555831777095267870590241601399800466833783251129883340213600672284904160396525568836658906539651853017705934754978946550148579456280235332355228623988465307153201312175555360330559785154022163627294146396591863217833603145872150309
|                                                               x = 14106687215995865322040181002941381475239795958480057660231444126365435715161666811141141722954380282486549706351420
|                                                               y = 33046451196921907455947491036282842805052518446763141672931422044095692768455375796282800404036588304220196154871589
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x61506d89717f8f25)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x61506d89717f8f25)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:22674024245814608394018772220558183351897236123074325859958784890852007124814941348013777485209832059930981683257868
|                                                           s = long384:23842586809224447602544604799883373093403349568719994878378798281251818040068274240332914768042402926920681754665792
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x61506d89717f8f25)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154734Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xf60e2ede3e712e7cbd23aa7f3ee9ef7fb896bff45cc93be93ad40e97b27d930d2b7cde311a4e0b77dc2c1edd289ac241)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x5e1e2add5d5537fe)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:3489051119313252698688512022223700622428793425612988357367467138639988596176253580251492449639347737946353512679834
|                                                       s = long384:17166358348764311625279471173724443281107070498503629794804937022498354373824845438902420594243894415043225686765177
15:47:34.237 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:34.238 INFO                           SKD: Client ---> Server CMC-request (1329 bytes)
15:47:34.238 INFO                           Sent CSR for Inf IA certificate.
15:47:34.288 DEBUG                          Connected to Server
15:47:34.339 DEBUG                          Sending HTTP POST /fullcmc message.
15:47:34.340 DEBUG                          Removing HTTP POST /fullcmc message from Q.
15:47:34.496 DEBUG                          HTTP Status: 202 - ACCEPTED
15:47:34.497 DEBUG                          Connect closed for Server
15:47:34.498 DEBUG                          Connect closed for Server
15:47:34.915 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:34.968 DEBUG                          Connected to Server
15:47:35.017 DEBUG                          Sending HTTP GET /status_1 message.
15:47:35.017 DEBUG                          Removing HTTP GET /status_1 message from Q.
15:47:35.111 DEBUG                          HTTP Status: 200 - OK
15:47:35.112 DEBUG                          Connect closed for Server
15:47:35.113 DEBUG                          Connect closed for Server
15:47:36.499 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:36.551 DEBUG                          Connected to Server
15:47:36.601 DEBUG                          Sending HTTP GET /status_2 message.
15:47:36.602 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:47:36.620 DEBUG                          HTTP Status: 200 - OK
15:47:36.621 DEBUG                          Connect closed for Server
15:47:36.621 DEBUG                          Connect closed for Server
15:47:37.112 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:37.164 DEBUG                          Connected to Server
15:47:37.213 DEBUG                          Sending HTTP GET /status_1 message.
15:47:37.214 DEBUG                          Removing HTTP GET /status_1 message from Q.
15:47:37.314 DEBUG                          HTTP Status: 200 - OK
15:47:37.316 DEBUG                          Connect closed for Server
15:47:37.316 DEBUG                          Connect closed for Server
15:47:37.513 INFO    Test:                  PASS
15:47:37.636 DEBUG                    Tearing down mock HTTP servers
15:47:38.621 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:38.671 DEBUG                    Connected to Server
15:47:38.721 DEBUG                    Sending HTTP GET /status_2 message.
15:47:38.722 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:47:38.854 DEBUG                    HTTP Status: 200 - OK
15:47:38.855 DEBUG                    Connect closed for Server
15:47:38.855 DEBUG                    Connect closed for Server
15:47:40.855 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:40.907 DEBUG                    Connected to Server
15:47:40.955 DEBUG                    Sending HTTP GET /status_2 message.
15:47:40.956 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:47:41.032 DEBUG                    HTTP Status: 200 - OK
15:47:41.033 DEBUG                    Connect closed for Server
15:47:41.033 DEBUG                    Connect closed for Server
15:47:43.033 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:43.084 DEBUG                    Connected to Server
15:47:43.134 DEBUG                    Sending HTTP GET /status_2 message.
15:47:43.134 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:47:43.235 DEBUG                    HTTP Status: 200 - OK
15:47:43.235 DEBUG                    Connect closed for Server
15:47:43.235 DEBUG                    Connect closed for Server
15:47:45.235 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:45.261 DEBUG                    UUT Control: Applying all recent configuration changes
15:47:45.304 INFO    Suite:       Tests for ICM Inf IA processing.
15:47:45.313 INFO    Suite:         ICM Infrastructure IA validity tests.
15:47:45.328 INFO                     Memory (RSS) before suite setup: 110.16 MByte  (1.85)
15:47:45.333 INFO                     Memory (Virt) before suite setup: 287.78 MByte  (1.90)
15:47:45.339 INFO                     Memory (RSS) after suite setup: 110.16 MByte  (0.00)
15:47:45.344 INFO                     Memory (Virt) after suite setup: 287.78 MByte  (0.00)
15:47:45.473 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:47:45.473 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:47:45.486 DEBUG                    Generating certificate signature for serial: 86050
15:47:45.491 DEBUG                    Added keymat IR-INF-CA: serial=86050 auth=0xc9020cefbb66368c subj=0x8d21a625e8727515
15:47:45.503 DEBUG                    Generating certificate signature for serial: 89199
15:47:45.509 DEBUG                    Added keymat IR-INF-IA: serial=89199 auth=0x8d21a625e8727515 subj=0xb669c73c73ef8f95
15:47:45.521 DEBUG                    Generating certificate signature for serial: 82202
15:47:45.527 DEBUG                    Added keymat IR-INF-CRL-CA: serial=82202 auth=0xc9020cefbb66368c subj=0xb97b85905350a249
15:47:45.540 DEBUG                    Generating certificate signature for serial: 84003
15:47:45.545 DEBUG                    Added keymat IR-INF-CRL-IA: serial=84003 auth=0xb97b85905350a249 subj=0xb2175b5b6b9de534
15:47:45.556 DEBUG                    Generating certificate signature for serial: 5
15:47:45.561 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xd80f1044ce0585fe subj=0xd80f1044ce0585fe
15:47:45.570 DEBUG                    Generating message signature using cert with serial: 89199
15:47:45.604 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:47:45.654 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xd80f1044ce0585fe subj=0xd80f1044ce0585fe
15:47:45.660 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:47:45.677 DEBUG                    Generating message signature using cert with serial: 5
15:47:45.734 DEBUG                    IR: Handling Certificate Signing Request.
15:47:45.735 DEBUG                    Creating temporary CA cert to issue IA
15:47:45.747 DEBUG                    Generating certificate signature for serial: 84208
15:47:45.752 DEBUG                    Added keymat IR-INF-CA-TMP: serial=84208 auth=0xc9020cefbb66368c subj=0xc5c1d3887f127971
15:47:45.753 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:47:45.759 DEBUG                    Generating certificate signature for serial: 20000
15:47:45.766 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:47:45.769 DEBUG                    Generating message signature using cert with serial: 89199
15:47:45.907 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:47:45.907 DEBUG                    Received Inf IA response
15:47:45.907 DEBUG                    Added keymat IR-INF-CA: serial=84208 auth=0xc9020cefbb66368c subj=0xc5c1d3887f127971
15:47:45.908 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0xc5c1d3887f127971 subj=0x1490597a90c70236
15:47:45.918 DEBUG                    Generating certificate signature for serial: 5
15:47:45.924 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x0693cd6def20eb08 subj=0x0693cd6def20eb08
15:47:45.932 DEBUG                    Generating message signature using cert with serial: 20000
15:47:45.968 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:47:45.985 DEBUG                    Generating message signature using cert with serial: 20000
15:47:46.068 DEBUG                    IR: Handling Certificate Signing Request.
15:47:46.069 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:47:46.075 DEBUG                    Generating certificate signature for serial: 20001
15:47:46.081 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:47:46.084 DEBUG                    Generating message signature using cert with serial: 89199
15:47:46.179 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:47:46.179 DEBUG                    Received Inf CA response
15:47:46.180 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x9675f223990565f1
15:47:46.180 INFO                     Listening for ('128.10.1.4', 80)
15:47:46.184 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:47:46.188 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:47:46.188 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:47:46.238 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x0693cd6def20eb08 subj=0x0693cd6def20eb08
15:47:46.244 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:47:46.261 DEBUG                    Generating message signature using cert with serial: 5
15:47:46.318 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:47:46.324 DEBUG                    Generating certificate signature for serial: 20000
15:47:46.331 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:47:46.334 DEBUG                    Generating message signature using cert with serial: 20000
15:47:46.449 DEBUG                    Received Inf IA response
15:47:46.449 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x9675f223990565f1
15:47:46.450 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x9675f223990565f1 subj=0x05a148ebd60e13d4
15:47:46.454 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:47:46.458 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:47:46.508 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x0693cd6def20eb08 subj=0x0693cd6def20eb08
15:47:46.508 INFO                     Listening for ('128.10.1.6', 80)
15:47:46.508 DEBUG                    MCKM requesting Inf IA from ICM.
15:47:46.514 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:47:46.531 DEBUG                    Generating message signature using cert with serial: 5
15:47:46.549 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:47:46.549 INFO                     SKD: Client ---> Server CMC-request (1342 bytes)
15:47:46.549 INFO                     Sent CSR for Inf IA certificate.
15:47:46.550 DEBUG                    Connected to Server
15:47:46.550 DEBUG                    Sending HTTP GET /status_2 message.
15:47:46.551 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:47:46.551 DEBUG                    105034896: Connect accepted from Client
15:47:46.599 DEBUG                    Connected to Server
15:47:46.613 DEBUG                    HTTP Status: 200 - OK
15:47:46.614 DEBUG                    Connect closed for Server
15:47:46.615 DEBUG                    Connect closed for Server
15:47:46.650 DEBUG                    Sending HTTP POST /fullcmc message.
15:47:46.651 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:47:46.691 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:47:46.692 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:47:46.698 DEBUG                    Generating certificate signature for serial: 20001
15:47:46.707 DEBUG                    Generating message signature using cert with serial: 20000
15:47:46.759 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:47:46.760 DEBUG                    HTTP Status: 200 - OK
15:47:46.761 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3138 bytes)
15:47:46.825 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:47:46.825 DEBUG                    Received Inf IA response
15:47:46.825 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x9675f223990565f1
15:47:46.826 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x9675f223990565f1 subj=0xf80d6dfbfd920e8b
15:47:48.556 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:47:48.615 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x0693cd6def20eb08 subj=0x0693cd6def20eb08
15:47:48.616 DEBUG                    CKA requesting Inf IA from ICM.
15:47:48.621 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:47:48.641 DEBUG                    Generating message signature using cert with serial: 5
15:47:48.664 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:47:48.665 INFO                     SKD: Client ---> Server CMC-request (1332 bytes)
15:47:48.665 INFO                     Sent CSR for Inf IA certificate.
15:47:48.665 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:48.666 DEBUG                    105034896: Connect accepted from Client
15:47:48.667 DEBUG                    Connect closed for Server
15:47:48.667 DEBUG                    Connect closed for Server
15:47:48.716 DEBUG                    Connected to Server
15:47:48.717 DEBUG                    Connected to Server
15:47:48.766 DEBUG                    Sending HTTP POST /fullcmc message.
15:47:48.766 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:47:48.767 DEBUG                    Sending HTTP GET /status_2 message.
15:47:48.767 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:47:48.809 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:47:48.811 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:47:48.823 DEBUG                    Generating certificate signature for serial: 20002
15:47:48.834 DEBUG                    Generating message signature using cert with serial: 20000
15:47:48.898 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:47:48.899 DEBUG                    HTTP Status: 200 - OK
15:47:48.899 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3126 bytes)
15:47:48.975 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:47:48.975 DEBUG                    Received Inf IA response
15:47:48.975 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x9675f223990565f1
15:47:48.976 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x9675f223990565f1 subj=0x924b0f698c071e74
15:47:48.976 DEBUG                    HTTP Status: 200 - OK
15:47:48.976 DEBUG                    Connect closed for Server
15:47:48.977 DEBUG                    Connect closed for Server
15:47:50.976 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:51.029 DEBUG                    Connected to Server
15:47:51.077 DEBUG                    Sending HTTP GET /status_2 message.
15:47:51.077 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:47:51.111 DEBUG                    HTTP Status: 200 - OK
15:47:51.112 DEBUG                    Connect closed for Server
15:47:51.112 DEBUG                    Connect closed for Server
15:47:52.875 DEBUG                    ########## Mocks complete ##########
15:47:53.112 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:53.163 DEBUG                    Connected to Server
15:47:53.213 DEBUG                    Sending HTTP GET /status_2 message.
15:47:53.213 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:47:55.282 DEBUG                    cmd optimus > cmdcomplete on
15:47:55.293 DEBUG                    cmd optimus > log path /tmp/optimus.log
15:47:55.293 DEBUG                    cmd optimus > log set CRTNG debug
15:47:55.293 DEBUG                    cmd optimus > log set CRLXF debug
15:47:55.293 DEBUG                    cmd optimus > log set PTFTP debug
15:47:55.294 INFO                     Setting SNMP v3 security to use authPriv with auth=123456789 priv=987654321
15:47:55.294 DEBUG                    cmd optimus > snmp security 123456789 987654321
15:47:55.294 DEBUG                    Optimus has been restarted
15:47:55.294 DEBUG                    UUT Control: Applying all recent configuration changes
15:47:55.766 DEBUG                    change classification to 'S'
15:47:55.767 DEBUG                    cmd optimus > class S
15:47:55.767 INFO                     20-CRYPT: Loading Suite Plugins...
15:47:55.777 INFO                     20-KEYST: Loading Key Parser Plugins...
15:47:55.780 INFO                     20-KEYST:   Key Parser TRUSTANCHOR loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.780 INFO                     20-KEYST:   Key Parser KEK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.781 INFO                     20-KEYST:   Key Parser PSK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.781 INFO                     20-KEYST:   Key Parser PPK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.782 INFO                     20-KEYST:   Key Parser X509 loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.782 INFO                     20-KEYST:   Key Parser CCOI loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.782 INFO                     20-KEYST:   Key Parser CRL loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.783 INFO                     20-KEYST:   Key Parser KEYPACK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.783 INFO                     20-KEYST: Loading Key Store Plugins...
15:47:55.788 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.KEYTA loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.792 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PKITA loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.792 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.KEK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.793 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PSK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.793 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PACKAGES loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.793 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CCOI loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.794 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CACERT loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.795 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.EECERT loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.795 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CRL loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.796 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PPK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:47:55.849 DEBUG                    cmd optimus > skdhttp quick on
15:47:56.203 DEBUG                    HTTP Status: 200 - OK
15:47:56.204 DEBUG                    Connect closed for Server
15:47:56.204 DEBUG                    Connect closed for Server
15:47:56.264 DEBUG                    Convert value '0x800a0102' as OCTET STRING
15:47:57.655 DEBUG                    Convert value '0x800a0100' as OCTET STRING
15:47:57.823 INFO    Test:            86  : [icm-process-infia-esn-range] An ICM will
|                                           discard a message where the ESN of the
|                                           Infrastructure IA certificate is outside the
|                                           range of its CA certificate.
15:47:57.833 DEBUG                          cmd optimus > keydir
15:47:57.876 DEBUG                          cmd optimus > keydir /tmp/
15:47:57.948 DEBUG                          Factory IA ESN: 
15:47:58.014 DEBUG                          cmd optimus > keydir ../Keys/
15:47:58.016 DEBUG                          UUT Control: Applying all recent configuration changes
15:47:58.104 INFO                           #> 0.1. Trigger the ICM to create an InfIA certificate request file.
15:47:58.204 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:47:58.217 DEBUG                          Factory IA ESN: D8EFF0144000
15:47:58.258 DEBUG                          Connected to Server
15:47:58.305 DEBUG                          Sending HTTP GET /status_2 message.
15:47:58.306 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:47:58.395 DEBUG                          HTTP Status: 200 - OK
15:47:58.396 DEBUG                          Connect closed for Server
15:47:58.397 DEBUG                          Connect closed for Server
15:47:59.910 INFO                           #> 0.2. Expect a request and verify it is correct.
15:48:00.023 DEBUG                          Received SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:48011243775308154013545499347278478242845951221065327817954492917425813954029874686854428942851416433864952160944102910820570150281544415900270930229230579760202124404466126417840894192318685401976747887692355895366609151417407368
|                                                           x = 1218497442389151034443124526468549759503195406509328348199652838807040403404814579424299219454047136916743216210108
|                                                           y = 2917633885723601135287160304321727596991702741985234946075192078440849745460984435051171613956408304288803776911240
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.3
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:21366660889465735857179954229428732668541516582438417503038790361668906015763287310890649675438575204972536184757926
|                                                       s = long384:37472735539216108842267817541141370483828557841616247433345263419305621975925611944329886970280222957268355242855924
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x61506d89717f8f25-->0x61506d89717f8f25
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 2L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:555831777095267870590241601399800466833783251129883340213600672284904160396525568836658906539651853017705934754978946550148579456280235332355228623988465307153201312175555360330559785154022163627294146396591863217833603145872150309
|                                                               x = 14106687215995865322040181002941381475239795958480057660231444126365435715161666811141141722954380282486549706351420
|                                                               y = 33046451196921907455947491036282842805052518446763141672931422044095692768455375796282800404036588304220196154871589
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x61506d89717f8f25)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x61506d89717f8f25)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:22674024245814608394018772220558183351897236123074325859958784890852007124814941348013777485209832059930981683257868
|                                                           s = long384:23842586809224447602544604799883373093403349568719994878378798281251818040068274240332914768042402926920681754665792
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x61506d89717f8f25)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154758Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xaaaabbbb84186dd2)
|                                                           msgCount = 0L
|                                                     [4] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xf216baf81dc78ff14df551e8295186c75521eb3dec0ece5c6f79bcde43004ba4c8212c39f0d927e91c403217e1aa8fbc)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:22287846731288032870406662298738872928646329127249026410209148751624468010943832952917271664319171835270855536278838
|                                                       s = long384:4173641956954046716764506853883982130670450853039305796933541689191661272696915834839364037108490483815050717981388
15:48:00.025 INFO                           #> 0.3. Create a Certificate Signing Response file and instruct the ICM to consume it
15:48:00.025 DEBUG                          IR: Handling Certificate Signing Request.
15:48:00.026 DEBUG                          Creating temporary CA cert to issue IA
15:48:00.060 DEBUG                          Generating certificate signature for serial: 87013
15:48:00.067 DEBUG                          Added keymat IR-INF-CA-TMP: serial=87013 auth=0xc9020cefbb66368c subj=0x7f102783dd508a8d
15:48:00.068 DEBUG                          Generating InfIA certificate (serialNumber: 20002L)
15:48:00.089 DEBUG                          Generating certificate signature for serial: 20002
15:48:00.118 DEBUG                          Generating certificate signature for serial: 89199
15:48:00.126 DEBUG                          Creating SKD message file /tmp/infia.resp
15:48:00.139 DEBUG                          Generating message signature using cert with serial: 89199
15:48:00.247 DEBUG                          Sending SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = 1L
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = 0
|                                               certificates (2 chains, 4 certificates) = 
|                                                 Chains summary:
|                                                   0xb669c73c73ef8f95-->0x8d21a625e8727515-->0xc9020cefbb66368c
|                                                   0x09e897266c205788-->0x7f102783dd508a8d-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 89199L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFFAFFF0FF,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154745Z..99991231235959Z
|                                                           subject = Name: SN=D8EFFAFFF0FF,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:922877399734121306192731255972244904956175734132173286180223396602850319979480241832202895759835062999722091655560389243065623961426466511492417129060673542942541190003058515227581323348113553485720173706897006255986525603770634133
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x8d21a625e8727515)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xb669c73c73ef8f95)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.4
|                                                                         [1] = 1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:19708390106174869309156401601187471139869287686357818279981595869637340455367576793002888926297506814900155025573030
|                                                           s = long384:3156306626421736730165075180657330485297782977274558615362128569699579148482732032224527149307642328215589034285310
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 86050L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154745Z..99991231235959Z
|                                                           subject = Name: SN=D8EFFAFFF0FF,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1502610525580735936891271569373613688493084785924333338092849053465252896098362364199404780770405216219714448731187750933363743146987477607307527202116907615028833880199851506331226136753393318208983561966125568014588807947924698389
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x8d21a625e8727515)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[2]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:19149356035057118043938248569195858106806420353645359066261427481771495689486600542310853600302566080483497705963917
|                                                           s = long384:28974532148317500378481312996847608156232582924823855916405533445603945133501189816840016383370545818241164972934277
|                                                   Chain[1] =
|                                                       [1.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154800Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:48011243775308154013545499347278478242845951221065327817954492917425813954029874686854428942851416433864952160944102910820570150281544415900270930229230579760202124404466126417840894192318685401976747887692355895366609151417407368
|                                                               x = 1218497442389151034443124526468549759503195406509328348199652838807040403404814579424299219454047136916743216210108
|                                                               y = 2917633885723601135287160304321727596991702741985234946075192078440849745460984435051171613956408304288803776911240
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x7f102783dd508a8d)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x09e897266c205788)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:10747059990125597203889510596456593695654611448275235467200639174420491625940431695291511947149850528065933941768402
|                                                           s = long384:1857415249891326462106192732745259834630208352060877164688437461909651656952300771652444343084967278609899411687218
|                                                       [1.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 87013L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154800Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1499650393074216247844997865073847792421360475783537653077556469513857640950963252099339942724805802739695911598680450846032502994826730549943289998718362199025505585262761192043091237490565773345713945793334038132501517144454892173
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x7f102783dd508a8d)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:35350785104346186078128038584520857982862621783179799405371730803950991601395054549906693834426783020381161769497042
|                                                           s = long384:18020558057308089583734347026995597355483640961870781838499516050440191244532555059769081969220378572011843250860530
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0xb669c73c73ef8f95)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                     [1] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154800Z)
|                                                     [3] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                                     [4] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [5] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xaaaabbbb84186dd2)
|                                                           msgCount = 0L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:37346417729507795743555169462166488901996344882528317933934578016868121990256285295968896227617451617637602347503231
|                                                       s = long384:38811219025423068868189803739113067591987266140823739108365040598037223665269411970440745685712626657161078075503636
15:48:00.396 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:00.447 DEBUG                          Connected to Server
15:48:00.497 DEBUG                          Sending HTTP GET /status_2 message.
15:48:00.498 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:48:00.618 DEBUG                          HTTP Status: 200 - OK
15:48:00.619 DEBUG                          Connect closed for Server
15:48:00.627 DEBUG                          Connect closed for Server
15:48:02.619 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:02.670 DEBUG                          Connected to Server
15:48:02.721 DEBUG                          Sending HTTP GET /status_2 message.
15:48:02.722 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:48:02.814 DEBUG                          HTTP Status: 200 - OK
15:48:02.815 DEBUG                          Connect closed for Server
15:48:02.816 DEBUG                          Connect closed for Server
15:48:04.131 INFO    Test:                  PASS
15:48:04.257 DEBUG                    Tearing down mock HTTP servers
15:48:04.260 DEBUG                    Connect closed for Server
15:48:04.260 DEBUG                    Connect closed for Server
15:48:04.814 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:04.865 DEBUG                    Connected to Server
15:48:04.915 DEBUG                    Sending HTTP GET /status_2 message.
15:48:04.915 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:05.004 DEBUG                    HTTP Status: 200 - OK
15:48:05.004 DEBUG                    Connect closed for Server
15:48:05.005 DEBUG                    Connect closed for Server
15:48:07.007 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:07.058 DEBUG                    Connected to Server
15:48:07.107 DEBUG                    Sending HTTP GET /status_2 message.
15:48:07.108 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:07.197 DEBUG                    HTTP Status: 200 - OK
15:48:07.198 DEBUG                    Connect closed for Server
15:48:07.198 DEBUG                    Connect closed for Server
15:48:09.198 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:09.250 DEBUG                    Connected to Server
15:48:09.299 DEBUG                    Sending HTTP GET /status_2 message.
15:48:09.299 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:09.414 DEBUG                    HTTP Status: 200 - OK
15:48:09.415 DEBUG                    Connect closed for Server
15:48:09.415 DEBUG                    Connect closed for Server
15:48:11.414 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:11.469 DEBUG                    Connected to Server
15:48:11.515 DEBUG                    Sending HTTP GET /status_2 message.
15:48:11.515 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:11.580 DEBUG                    HTTP Status: 200 - OK
15:48:11.581 DEBUG                    Connect closed for Server
15:48:11.581 DEBUG                    Connect closed for Server
15:48:13.583 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:13.633 DEBUG                    Connected to Server
15:48:13.663 INFO    Suite:       Tests for ICM processing.
15:48:13.681 INFO    Suite:         ICM received message processing.
15:48:13.707 INFO                     Memory (RSS) before suite setup: 110.51 MByte  (0.35)
15:48:13.715 INFO                     Memory (Virt) before suite setup: 288.09 MByte  (0.31)
15:48:13.722 INFO                     Memory (RSS) after suite setup: 110.51 MByte  (0.00)
15:48:13.728 INFO                     Memory (Virt) after suite setup: 288.09 MByte  (0.00)
15:48:13.859 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:48:13.859 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:48:13.871 DEBUG                    Generating certificate signature for serial: 87404
15:48:13.877 DEBUG                    Added keymat IR-INF-CA: serial=87404 auth=0xc9020cefbb66368c subj=0x1f6371e54fbecada
15:48:13.888 DEBUG                    Generating certificate signature for serial: 80130
15:48:13.894 DEBUG                    Added keymat IR-INF-IA: serial=80130 auth=0x1f6371e54fbecada subj=0x8e9edc2224d7602b
15:48:13.906 DEBUG                    Generating certificate signature for serial: 89024
15:48:13.912 DEBUG                    Added keymat IR-INF-CRL-CA: serial=89024 auth=0xc9020cefbb66368c subj=0x484e07b09ada52b1
15:48:13.923 DEBUG                    Generating certificate signature for serial: 89005
15:48:13.929 DEBUG                    Added keymat IR-INF-CRL-IA: serial=89005 auth=0x484e07b09ada52b1 subj=0x8101e3916ff980a9
15:48:13.939 DEBUG                    Generating certificate signature for serial: 5
15:48:13.945 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x48a508ae5646559d subj=0x48a508ae5646559d
15:48:13.953 DEBUG                    Generating message signature using cert with serial: 80130
15:48:13.987 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:48:14.037 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x48a508ae5646559d subj=0x48a508ae5646559d
15:48:14.043 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:48:14.060 DEBUG                    Generating message signature using cert with serial: 5
15:48:14.117 DEBUG                    IR: Handling Certificate Signing Request.
15:48:14.118 DEBUG                    Creating temporary CA cert to issue IA
15:48:14.129 DEBUG                    Generating certificate signature for serial: 85946
15:48:14.135 DEBUG                    Added keymat IR-INF-CA-TMP: serial=85946 auth=0xc9020cefbb66368c subj=0x6e6d3e3c3b6b464d
15:48:14.136 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:48:14.142 DEBUG                    Generating certificate signature for serial: 20000
15:48:14.148 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:48:14.151 DEBUG                    Generating message signature using cert with serial: 80130
15:48:14.273 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:48:14.274 DEBUG                    Received Inf IA response
15:48:14.274 DEBUG                    Added keymat IR-INF-CA: serial=85946 auth=0xc9020cefbb66368c subj=0x6e6d3e3c3b6b464d
15:48:14.274 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x6e6d3e3c3b6b464d subj=0x893b9754d75dcc1f
15:48:14.285 DEBUG                    Generating certificate signature for serial: 5
15:48:14.290 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xb069a03393b61043 subj=0xb069a03393b61043
15:48:14.299 DEBUG                    Generating message signature using cert with serial: 20000
15:48:14.335 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:48:14.352 DEBUG                    Generating message signature using cert with serial: 20000
15:48:14.434 DEBUG                    IR: Handling Certificate Signing Request.
15:48:14.435 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:48:14.441 DEBUG                    Generating certificate signature for serial: 20001
15:48:14.447 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:48:14.450 DEBUG                    Generating message signature using cert with serial: 80130
15:48:14.545 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:48:14.545 DEBUG                    Received Inf CA response
15:48:14.546 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xa68d97b1da65b681
15:48:14.546 INFO                     Listening for ('128.10.1.4', 80)
15:48:14.550 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:48:14.554 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:48:14.554 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:48:14.605 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xb069a03393b61043 subj=0xb069a03393b61043
15:48:14.611 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:48:14.628 DEBUG                    Generating message signature using cert with serial: 5
15:48:14.685 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:48:14.691 DEBUG                    Generating certificate signature for serial: 20000
15:48:14.698 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:48:14.701 DEBUG                    Generating message signature using cert with serial: 20000
15:48:14.818 DEBUG                    Received Inf IA response
15:48:14.819 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xa68d97b1da65b681
15:48:14.819 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0xa68d97b1da65b681 subj=0x720f412a3b4e0fd2
15:48:14.823 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:48:14.828 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:48:14.879 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xb069a03393b61043 subj=0xb069a03393b61043
15:48:14.879 INFO                     Listening for ('128.10.1.6', 80)
15:48:14.879 DEBUG                    MCKM requesting Inf IA from ICM.
15:48:14.885 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:48:14.902 DEBUG                    Generating message signature using cert with serial: 5
15:48:14.922 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:48:14.922 INFO                     SKD: Client ---> Server CMC-request (1343 bytes)
15:48:14.922 INFO                     Sent CSR for Inf IA certificate.
15:48:14.923 DEBUG                    Sending HTTP GET /status_2 message.
15:48:14.923 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:14.924 DEBUG                    107178192: Connect accepted from Client
15:48:14.972 DEBUG                    Connected to Server
15:48:14.976 DEBUG                    HTTP Status: 200 - OK
15:48:14.977 DEBUG                    Connect closed for Server
15:48:14.977 DEBUG                    Connect closed for Server
15:48:15.022 DEBUG                    Sending HTTP POST /fullcmc message.
15:48:15.023 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:48:15.066 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:48:15.066 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:48:15.073 DEBUG                    Generating certificate signature for serial: 20001
15:48:15.083 DEBUG                    Generating message signature using cert with serial: 20000
15:48:15.137 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:48:15.139 DEBUG                    HTTP Status: 200 - OK
15:48:15.139 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3137 bytes)
15:48:15.204 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:48:15.205 DEBUG                    Received Inf IA response
15:48:15.205 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xa68d97b1da65b681
15:48:15.205 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0xa68d97b1da65b681 subj=0x49c479aff07163ee
15:48:16.932 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:48:16.992 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xb069a03393b61043 subj=0xb069a03393b61043
15:48:16.992 DEBUG                    CKA requesting Inf IA from ICM.
15:48:16.998 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:48:17.020 DEBUG                    Generating message signature using cert with serial: 5
15:48:17.041 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:48:17.041 INFO                     SKD: Client ---> Server CMC-request (1332 bytes)
15:48:17.041 INFO                     Sent CSR for Inf IA certificate.
15:48:17.042 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:17.042 DEBUG                    107178192: Connect accepted from Client
15:48:17.043 DEBUG                    Connect closed for Server
15:48:17.043 DEBUG                    Connect closed for Server
15:48:17.091 DEBUG                    Connected to Server
15:48:17.092 DEBUG                    Connected to Server
15:48:17.142 DEBUG                    Sending HTTP POST /fullcmc message.
15:48:17.142 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:48:17.142 DEBUG                    Sending HTTP GET /status_2 message.
15:48:17.143 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:17.188 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:48:17.189 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:48:17.196 DEBUG                    Generating certificate signature for serial: 20002
15:48:17.206 DEBUG                    Generating message signature using cert with serial: 20000
15:48:17.261 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:48:17.262 DEBUG                    HTTP Status: 200 - OK
15:48:17.262 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3127 bytes)
15:48:17.337 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:48:17.338 DEBUG                    Received Inf IA response
15:48:17.338 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xa68d97b1da65b681
15:48:17.338 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0xa68d97b1da65b681 subj=0x293210c7e62a6b19
15:48:17.339 DEBUG                    HTTP Status: 200 - OK
15:48:17.339 DEBUG                    Connect closed for Server
15:48:17.339 DEBUG                    Connect closed for Server
15:48:19.341 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:19.392 DEBUG                    Connected to Server
15:48:19.443 DEBUG                    Sending HTTP GET /status_2 message.
15:48:19.444 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:19.476 DEBUG                    HTTP Status: 200 - OK
15:48:19.476 DEBUG                    Connect closed for Server
15:48:19.477 DEBUG                    Connect closed for Server
15:48:21.249 DEBUG                    ########## Mocks complete ##########
15:48:21.477 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:21.527 DEBUG                    Connected to Server
15:48:21.577 DEBUG                    Sending HTTP GET /status_2 message.
15:48:21.578 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:23.729 DEBUG                    cmd optimus > cmdcomplete on
15:48:23.769 DEBUG                    cmd optimus > log path /tmp/optimus.log
15:48:23.770 DEBUG                    cmd optimus > log set CRTNG debug
15:48:23.770 DEBUG                    cmd optimus > log set CRLXF debug
15:48:23.773 DEBUG                    cmd optimus > log set PTFTP debug
15:48:23.774 INFO                     Setting SNMP v3 security to use authPriv with auth=123456789 priv=987654321
15:48:23.775 DEBUG                    cmd optimus > snmp security 123456789 987654321
15:48:23.775 DEBUG                    Optimus has been restarted
15:48:23.777 DEBUG                    UUT Control: Applying all recent configuration changes
15:48:24.247 DEBUG                    change classification to 'S'
15:48:24.248 DEBUG                    cmd optimus > class S
15:48:24.248 INFO                     20-CRYPT: Loading Suite Plugins...
15:48:24.258 INFO                     20-KEYST: Loading Key Parser Plugins...
15:48:24.261 INFO                     20-KEYST:   Key Parser TRUSTANCHOR loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.262 INFO                     20-KEYST:   Key Parser KEK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.262 INFO                     20-KEYST:   Key Parser PSK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.263 INFO                     20-KEYST:   Key Parser PPK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.263 INFO                     20-KEYST:   Key Parser X509 loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.264 INFO                     20-KEYST:   Key Parser CCOI loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.264 INFO                     20-KEYST:   Key Parser CRL loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.265 INFO                     20-KEYST:   Key Parser KEYPACK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.265 INFO                     20-KEYST: Loading Key Store Plugins...
15:48:24.269 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.KEYTA loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.272 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PKITA loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.273 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.KEK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.273 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PSK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.273 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PACKAGES loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.274 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CCOI loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.274 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CACERT loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.275 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.EECERT loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.275 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CRL loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.276 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PPK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:24.332 DEBUG                    cmd optimus > skdhttp quick on
15:48:24.555 DEBUG                    HTTP Status: 200 - OK
15:48:24.556 DEBUG                    Connect closed for Server
15:48:24.556 DEBUG                    Connect closed for Server
15:48:24.727 DEBUG                    Convert value '0x800a0102' as OCTET STRING
15:48:26.124 DEBUG                    Convert value '0x800a0100' as OCTET STRING
15:48:26.302 INFO    Test:            91  : [icm-receive-invalid-sig] An ICM will reject
|                                           a message if the signature can not be
|                                           verified using the Inf IA certificate.
15:48:26.315 INFO                           #> 0.1. Configure the ICM with the IR FactoryIA certificate.
15:48:26.336 DEBUG                          Generating certificate signature for serial: 5
15:48:26.342 DEBUG                          Added keymat FACT-IA: serial=5 auth=0x66773671af6529a6 subj=0x66773671af6529a6
15:48:26.367 DEBUG                          Generating message signature using cert with serial: 80130
15:48:26.421 DEBUG                          Sending SKD message:
|                                           KeyPackageFile:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = List:
|                                                   [0]:
|                                                       OneAsymmetricKey:
|                                                           version == 0
|                                                           privateKeyAlgorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           privateKey = ECPrivateKey:
|                                                               version = 1L
|                                                               privateKey = Octets(0x3237393334353035363835343933343538323439363739393936313734323938343834353030343331393538303031353439363435343937373638383931333432393933323134313430303934373830313731353638323838373438313238333433373635343531353231393435343134323131)
|                                                           attributes:
|                                                             [0] = UserCertificateAttr:
|                                                               id == OID(userCertificate:2.5.4.36)
|                                                               userCertificate = Certificate:
|                                                                   tbsCertificate = TBSCertificate:
|                                                                       version == 2
|                                                                       serialNumber = 5L
|                                                                       signatureAlgorithmID = AlgorithmIdentifier:
|                                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                       issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                       validity = 170112154826Z..99991231235959Z
|                                                                       subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                           algorithm = AlgorithmIdentifier:
|                                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                               parameters = ECParameters:
|                                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                           subjectPublicKey = long768:402616706306065882094108673556402967558489706110825390496862167120458198218647295342462269623472207689852979834242774695324274730611456627973718556480199832579076112878638490631779946385988337530630049023046060507157058668902820262
|                                                                       _extensions = CertificateExtensions
|                                                                         [0] AuthorityKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                               keyIdentifier = Octets(0x66773671af6529a6)
|                                                                         [1] SubjectKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                               id = Octets(0x66773671af6529a6)
|                                                                         [2] KeyUsage_CertExt:
|                                                                               extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                               critical = True
|                                                                               uses = ['digitalSignature']
|                                                                         [3] CertificatePolicies_CertExt:
|                                                                               extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                               critical = True
|                                                                               policies:
|                                                                                 [0] = PolicyInformation:
|                                                                                   id = OID(1.2.826.0.1145.0.1.0.4)
|                                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                   signature = Signature:
|                                                                       r = long384:4584167701529048803860383319694527583262654276565156516919090247640146776487157104282018412095576099531381161209098
|                                                                       s = long384:37729994027174291964874709063935817692321726797839660149724359414652376353448781888530170296664971706436661984167758
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x8e9edc2224d7602b-->0x1f6371e54fbecada-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 80130L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154813Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1093559398791317368157972969585141677750696689853801492421425843386371952315239944404432361902293515702075593587737396882313700925437022664793985982543615831756805656005764292455872095710448857994435688728627420320237500630155354155
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x1f6371e54fbecada)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x8e9edc2224d7602b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.4
|                                                                         [1] = 1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = 0
|                                                           s = 0
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 87404L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154813Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:679159855982623418123779676353222279843803501185299304824564057050492346503550583090908795014090044275446693121604245316983207568088207752637992266425893347658070473506868034318186912284457284134249196935627905119601365767931480794
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1f6371e54fbecada)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[2]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16039673568485085278533165711688131301475736105435128875208548394646412547208881864295037683976726979496260185797482
|                                                           s = long384:24946034735033302058552418350236290262792079065662574658562990807429260190096695380475960040003502282555946416842507
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x8e9edc2224d7602b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                                     [1] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x4a1d7296e813893b7f362da6d3be7a65c627078251429f492eb4fdeabb822311ff63af308c649fe2df64f794d12a5471)
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154826Z)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:36968820375106394779485063504152399087663419115394074535300161311794813250814653366814968632879158321549764577579760
|                                                       s = long384:36746581946678231499734700100967055506903285325407160322007355412481970681718429384526567134732344087847187856756626
15:48:26.453 DEBUG                          cmd optimus > keydir
15:48:26.465 DEBUG                          cmd optimus > keydir /tmp/
15:48:26.542 DEBUG                          Factory IA ESN: 
15:48:26.556 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:26.607 DEBUG                          Connected to Server
15:48:26.610 DEBUG                          cmd optimus > keydir ../Keys/
15:48:26.612 DEBUG                          UUT Control: Applying all recent configuration changes
15:48:26.661 DEBUG                          Sending HTTP GET /status_2 message.
15:48:26.662 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:48:26.727 DEBUG                          HTTP Status: 200 - OK
15:48:26.728 INFO                           #> 0.2. Trigger the ICM to create an InfIA certificate request file.
15:48:26.732 DEBUG                          Connect closed for Server
15:48:26.733 DEBUG                          Connect closed for Server
15:48:26.841 DEBUG                          Factory IA ESN: D8EFF0000005
15:48:28.728 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:28.779 DEBUG                          Connected to Server
15:48:28.823 INFO                           #> 0.3. Expect a request and verify it is correct.
15:48:28.936 DEBUG                          Received SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:516022416324310114611980562720908319841888603547557467474230292945373169373814428540585895960951883021689702012010602966310782241771988695276397795182216960813773161125763390060136013809313460245802390411939634473054975371536530745
|                                                           x = 13096348793821804749407643086803812934150973579639357220231614455549045563789988151932350367771137767732317853181813
|                                                           y = 3319556336908759339503242923504774704283577006676964174965256793570658136383437822688204551733920015216183835393337
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.3
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:30638409708289778532237717521269349928031112238368559958387496739691403694160494770806286606350872575477778711916829
|                                                       s = long384:32713474885717542820765275101793221125646587119627618549590159650382324846917523569927353475389229195565470037330363
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x66773671af6529a6-->0x66773671af6529a6
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 5L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154826Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:402616706306065882094108673556402967558489706110825390496862167120458198218647295342462269623472207689852979834242774695324274730611456627973718556480199832579076112878638490631779946385988337530630049023046060507157058668902820262
|                                                               x = 10218177833363919796676033338286617906906878379924681313625021566132758160650188103828831575205173250975747421169395
|                                                               y = 31694125001485524143262787844374955313787929411053358770927611075595467105536543565803629768218412429599529343723942
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x66773671af6529a6)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x66773671af6529a6)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:4584167701529048803860383319694527583262654276565156516919090247640146776487157104282018412095576099531381161209098
|                                                           s = long384:37729994027174291964874709063935817692321726797839660149724359414652376353448781888530170296664971706436661984167758
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x66773671af6529a6)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154826Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xaaaabbbbe9e2489c)
|                                                           msgCount = 0L
|                                                     [4] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x3c0e7ab054779af7841aeb0e032d61151682006285848239ebdeae8af7f4e2db580ef6da2566b7759d6e133fca39fb6a)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:8329312806845782313475865003975669045060125683261632266136190149323332398850619231826450671929113812266843995909858
|                                                       s = long384:14741661843427964704332563551393811667084721876073131768082110243867501359423536726094789384655749814022792627242727
15:48:28.937 DEBUG                          Sending HTTP GET /status_2 message.
15:48:28.938 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:48:28.939 INFO                           #> 0.4. Create a Certificate Signing Response file and instruct the ICM to consume it
15:48:28.940 DEBUG                          IR: Handling Certificate Signing Request.
15:48:28.940 DEBUG                          Creating temporary CA cert to issue IA
15:48:28.968 DEBUG                          Generating certificate signature for serial: 81877
15:48:28.975 DEBUG                          Added keymat IR-INF-CA-TMP: serial=81877 auth=0xc9020cefbb66368c subj=0xe4bdf885a6988035
15:48:28.976 DEBUG                          Generating InfIA certificate (serialNumber: 20002L)
15:48:28.996 DEBUG                          Generating certificate signature for serial: 20002
15:48:29.005 DEBUG                          Creating SKD message file /tmp/infia.resp
15:48:29.014 DEBUG                          Generating message signature using cert with serial: 80130
15:48:29.115 DEBUG                          Sending SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = 1L
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = 0
|                                               certificates (2 chains, 4 certificates) = 
|                                                 Chains summary:
|                                                   0x8e9edc2224d7602b-->0x1f6371e54fbecada-->0xc9020cefbb66368c
|                                                   0x656d7fb046d87d39-->0xe4bdf885a6988035-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 80130L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154813Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1093559398791317368157972969585141677750696689853801492421425843386371952315239944404432361902293515702075593587737396882313700925437022664793985982543615831756805656005764292455872095710448857994435688728627420320237500630155354155
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x1f6371e54fbecada)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x8e9edc2224d7602b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.4
|                                                                         [1] = 1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = 0
|                                                           s = 0
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 87404L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154813Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:679159855982623418123779676353222279843803501185299304824564057050492346503550583090908795014090044275446693121604245316983207568088207752637992266425893347658070473506868034318186912284457284134249196935627905119601365767931480794
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1f6371e54fbecada)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[2]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16039673568485085278533165711688131301475736105435128875208548394646412547208881864295037683976726979496260185797482
|                                                           s = long384:24946034735033302058552418350236290262792079065662574658562990807429260190096695380475960040003502282555946416842507
|                                                   Chain[1] =
|                                                       [1.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154828Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:516022416324310114611980562720908319841888603547557467474230292945373169373814428540585895960951883021689702012010602966310782241771988695276397795182216960813773161125763390060136013809313460245802390411939634473054975371536530745
|                                                               x = 13096348793821804749407643086803812934150973579639357220231614455549045563789988151932350367771137767732317853181813
|                                                               y = 3319556336908759339503242923504774704283577006676964174965256793570658136383437822688204551733920015216183835393337
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xe4bdf885a6988035)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x656d7fb046d87d39)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:4155360550367187872833164318266906419255069880323716663690680013115610006417335579591615103178233248227210704042248
|                                                           s = long384:9395740379832661180711849216958976430004110496837759312093173363615467008512152394013098776678065863030586920866320
|                                                       [1.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 81877L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154828Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:970704782712380620660212096589103914950083911717685648986726044867333039029269725816747959725245835638468439502035466995417528968622744012149195254575692896834647933380191163469712187747542026776435503628371366264312676718164344885
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xe4bdf885a6988035)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:30181616810718095572895318111086616775385451932262170963355084394331968051486953476209156388723220091744735243553155
|                                                           s = long384:37126319949154519054591457830583429419669905237823810938767675586942959297907931539895159062374335639519929974634200
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x8e9edc2224d7602b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                     [1] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154829Z)
|                                                     [3] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                                     [4] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [5] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xaaaabbbbe9e2489c)
|                                                           msgCount = 0L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:25941003815354657570805387973115139444174678954950423822426961826128780750679492212202558803953091068104990441724291
|                                                       s = long384:19942986824978877169854860015382760053391099798693591916718022001970232975537770353159581527425355609301794114935836
15:48:29.183 DEBUG                          HTTP Status: 200 - OK
15:48:29.184 DEBUG                          Connect closed for Server
15:48:29.185 DEBUG                          Connect closed for Server
15:48:31.187 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:31.239 DEBUG                          Connected to Server
15:48:31.289 DEBUG                          Sending HTTP GET /status_2 message.
15:48:31.290 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:48:31.463 DEBUG                          HTTP Status: 200 - OK
15:48:31.465 DEBUG                          Connect closed for Server
15:48:31.466 DEBUG                          Connect closed for Server
15:48:33.359 INFO    Test:                  PASS
15:48:33.501 DEBUG                    Tearing down mock HTTP servers
15:48:33.504 DEBUG                    Connect closed for Server
15:48:33.505 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:33.505 DEBUG                    Connect closed for Server
15:48:33.555 DEBUG                    Connected to Server
15:48:33.605 DEBUG                    Sending HTTP GET /status_2 message.
15:48:33.606 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:33.660 DEBUG                    HTTP Status: 200 - OK
15:48:33.660 DEBUG                    Connect closed for Server
15:48:33.661 DEBUG                    Connect closed for Server
15:48:35.660 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:35.711 DEBUG                    Connected to Server
15:48:35.761 DEBUG                    Sending HTTP GET /status_2 message.
15:48:35.762 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:35.840 DEBUG                    HTTP Status: 200 - OK
15:48:35.841 DEBUG                    Connect closed for Server
15:48:35.842 DEBUG                    Connect closed for Server
15:48:37.841 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:37.891 DEBUG                    Connected to Server
15:48:37.941 DEBUG                    Sending HTTP GET /status_2 message.
15:48:37.942 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:38.058 DEBUG                    HTTP Status: 200 - OK
15:48:38.059 DEBUG                    Connect closed for Server
15:48:38.059 DEBUG                    Connect closed for Server
15:48:40.060 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:40.111 DEBUG                    Connected to Server
15:48:40.161 DEBUG                    Sending HTTP GET /status_2 message.
15:48:40.162 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:40.262 DEBUG                    HTTP Status: 200 - OK
15:48:40.263 DEBUG                    Connect closed for Server
15:48:40.263 DEBUG                    Connect closed for Server
15:48:42.263 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:42.314 DEBUG                    Connected to Server
15:48:42.364 DEBUG                    Sending HTTP GET /status_2 message.
15:48:42.365 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:42.426 DEBUG                    HTTP Status: 200 - OK
15:48:42.427 DEBUG                    Connect closed for Server
15:48:42.427 DEBUG                    Connect closed for Server
15:48:43.267 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:48:43.267 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:48:43.279 DEBUG                    Generating certificate signature for serial: 89803
15:48:43.285 DEBUG                    Added keymat IR-INF-CA: serial=89803 auth=0xc9020cefbb66368c subj=0x88095dd7278ff315
15:48:43.297 DEBUG                    Generating certificate signature for serial: 88941
15:48:43.303 DEBUG                    Added keymat IR-INF-IA: serial=88941 auth=0x88095dd7278ff315 subj=0x432b7bd6903667ea
15:48:43.315 DEBUG                    Generating certificate signature for serial: 85265
15:48:43.322 DEBUG                    Added keymat IR-INF-CRL-CA: serial=85265 auth=0xc9020cefbb66368c subj=0x74e1d53b9ae346aa
15:48:43.334 DEBUG                    Generating certificate signature for serial: 86776
15:48:43.340 DEBUG                    Added keymat IR-INF-CRL-IA: serial=86776 auth=0x74e1d53b9ae346aa subj=0x745da26a149eced6
15:48:43.351 DEBUG                    Generating certificate signature for serial: 5
15:48:43.357 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x08285eb7d0cda2ac subj=0x08285eb7d0cda2ac
15:48:43.365 DEBUG                    Generating message signature using cert with serial: 88941
15:48:43.401 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:48:43.451 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x08285eb7d0cda2ac subj=0x08285eb7d0cda2ac
15:48:43.456 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:48:43.473 DEBUG                    Generating message signature using cert with serial: 5
15:48:43.533 DEBUG                    IR: Handling Certificate Signing Request.
15:48:43.533 DEBUG                    Creating temporary CA cert to issue IA
15:48:43.545 DEBUG                    Generating certificate signature for serial: 86453
15:48:43.551 DEBUG                    Added keymat IR-INF-CA-TMP: serial=86453 auth=0xc9020cefbb66368c subj=0x19a21ecc1aa49f91
15:48:43.551 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:48:43.557 DEBUG                    Generating certificate signature for serial: 20000
15:48:43.564 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:48:43.567 DEBUG                    Generating message signature using cert with serial: 88941
15:48:43.717 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:48:43.717 DEBUG                    Received Inf IA response
15:48:43.718 DEBUG                    Added keymat IR-INF-CA: serial=86453 auth=0xc9020cefbb66368c subj=0x19a21ecc1aa49f91
15:48:43.718 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x19a21ecc1aa49f91 subj=0x81a16be48b68bcd2
15:48:43.729 DEBUG                    Generating certificate signature for serial: 5
15:48:43.735 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xcab85861609a203e subj=0xcab85861609a203e
15:48:43.745 DEBUG                    Generating message signature using cert with serial: 20000
15:48:43.783 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:48:43.801 DEBUG                    Generating message signature using cert with serial: 20000
15:48:43.890 DEBUG                    IR: Handling Certificate Signing Request.
15:48:43.891 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:48:43.898 DEBUG                    Generating certificate signature for serial: 20001
15:48:43.904 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:48:43.908 DEBUG                    Generating message signature using cert with serial: 88941
15:48:44.008 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:48:44.008 DEBUG                    Received Inf CA response
15:48:44.009 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xea83a534063d125e
15:48:44.009 INFO                     Listening for ('128.10.1.4', 80)
15:48:44.013 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:48:44.018 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:48:44.018 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:48:44.071 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xcab85861609a203e subj=0xcab85861609a203e
15:48:44.078 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:48:44.096 DEBUG                    Generating message signature using cert with serial: 5
15:48:44.156 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:48:44.163 DEBUG                    Generating certificate signature for serial: 20000
15:48:44.170 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:48:44.173 DEBUG                    Generating message signature using cert with serial: 20000
15:48:44.294 DEBUG                    Received Inf IA response
15:48:44.294 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xea83a534063d125e
15:48:44.295 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0xea83a534063d125e subj=0x161145a64428d71e
15:48:44.299 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:48:44.303 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:48:44.356 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xcab85861609a203e subj=0xcab85861609a203e
15:48:44.356 INFO                     Listening for ('128.10.1.6', 80)
15:48:44.357 DEBUG                    MCKM requesting Inf IA from ICM.
15:48:44.362 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:48:44.380 DEBUG                    Generating message signature using cert with serial: 5
15:48:44.399 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:48:44.400 INFO                     SKD: Client ---> Server CMC-request (1340 bytes)
15:48:44.400 INFO                     Sent CSR for Inf IA certificate.
15:48:44.400 DEBUG                    113915536: Connect accepted from Client
15:48:44.427 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:44.451 DEBUG                    Connected to Server
15:48:44.478 DEBUG                    Connected to Server
15:48:44.500 DEBUG                    Sending HTTP POST /fullcmc message.
15:48:44.500 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:48:44.541 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:48:44.542 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:48:44.548 DEBUG                    Generating certificate signature for serial: 20001
15:48:44.558 DEBUG                    Generating message signature using cert with serial: 20000
15:48:44.609 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:48:44.610 DEBUG                    Sending HTTP GET /status_2 message.
15:48:44.610 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:44.612 DEBUG                    HTTP Status: 200 - OK
15:48:44.612 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3139 bytes)
15:48:44.680 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:48:44.680 DEBUG                    Received Inf IA response
15:48:44.681 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xea83a534063d125e
15:48:44.681 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0xea83a534063d125e subj=0xb198d11ccd1b0342
15:48:44.682 DEBUG                    HTTP Status: 200 - OK
15:48:44.682 DEBUG                    Connect closed for Server
15:48:44.682 DEBUG                    Connect closed for Server
15:48:46.408 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:48:46.459 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xcab85861609a203e subj=0xcab85861609a203e
15:48:46.459 DEBUG                    CKA requesting Inf IA from ICM.
15:48:46.465 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:48:46.481 DEBUG                    Generating message signature using cert with serial: 5
15:48:46.499 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:48:46.500 INFO                     SKD: Client ---> Server CMC-request (1331 bytes)
15:48:46.500 INFO                     Sent CSR for Inf IA certificate.
15:48:46.501 DEBUG                    113915536: Connect accepted from Client
15:48:46.501 DEBUG                    Connect closed for Server
15:48:46.501 DEBUG                    Connect closed for Server
15:48:46.551 DEBUG                    Connected to Server
15:48:46.601 DEBUG                    Sending HTTP POST /fullcmc message.
15:48:46.602 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:48:46.641 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:48:46.642 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:48:46.648 DEBUG                    Generating certificate signature for serial: 20002
15:48:46.657 DEBUG                    Generating message signature using cert with serial: 20000
15:48:46.710 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:48:46.711 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:46.712 DEBUG                    HTTP Status: 200 - OK
15:48:46.713 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3127 bytes)
15:48:46.777 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:48:46.778 DEBUG                    Received Inf IA response
15:48:46.778 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xea83a534063d125e
15:48:46.778 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0xea83a534063d125e subj=0x8997895e0b54ae02
15:48:46.778 DEBUG                    Connected to Server
15:48:46.811 DEBUG                    Sending HTTP GET /status_2 message.
15:48:46.812 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:46.827 DEBUG                    HTTP Status: 200 - OK
15:48:46.828 DEBUG                    Connect closed for Server
15:48:46.828 DEBUG                    Connect closed for Server
15:48:48.828 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:48.879 DEBUG                    Connected to Server
15:48:48.929 DEBUG                    Sending HTTP GET /status_2 message.
15:48:48.929 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:49.027 DEBUG                    HTTP Status: 200 - OK
15:48:49.027 DEBUG                    Connect closed for Server
15:48:49.027 DEBUG                    Connect closed for Server
15:48:50.707 DEBUG                    ########## Mocks complete ##########
15:48:51.027 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:51.078 DEBUG                    Connected to Server
15:48:51.128 DEBUG                    Sending HTTP GET /status_2 message.
15:48:51.128 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:48:53.114 DEBUG                    cmd optimus > cmdcomplete on
15:48:53.166 DEBUG                    cmd optimus > log path /tmp/optimus.log
15:48:53.167 DEBUG                    cmd optimus > log set CRTNG debug
15:48:53.167 DEBUG                    cmd optimus > log set CRLXF debug
15:48:53.170 DEBUG                    cmd optimus > log set PTFTP debug
15:48:53.171 INFO                     Setting SNMP v3 security to use authPriv with auth=123456789 priv=987654321
15:48:53.172 DEBUG                    cmd optimus > snmp security 123456789 987654321
15:48:53.172 DEBUG                    Optimus has been restarted
15:48:53.174 DEBUG                    UUT Control: Applying all recent configuration changes
15:48:53.640 DEBUG                    change classification to 'S'
15:48:53.641 DEBUG                    cmd optimus > class S
15:48:53.641 INFO                     20-CRYPT: Loading Suite Plugins...
15:48:53.652 INFO                     20-KEYST: Loading Key Parser Plugins...
15:48:53.655 INFO                     20-KEYST:   Key Parser TRUSTANCHOR loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.656 INFO                     20-KEYST:   Key Parser KEK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.656 INFO                     20-KEYST:   Key Parser PSK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.656 INFO                     20-KEYST:   Key Parser PPK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.657 INFO                     20-KEYST:   Key Parser X509 loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.657 INFO                     20-KEYST:   Key Parser CCOI loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.658 INFO                     20-KEYST:   Key Parser CRL loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.658 INFO                     20-KEYST:   Key Parser KEYPACK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.658 INFO                     20-KEYST: Loading Key Store Plugins...
15:48:53.663 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.KEYTA loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.666 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PKITA loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.666 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.KEK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.667 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PSK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.667 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PACKAGES loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.668 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CCOI loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.668 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CACERT loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.669 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.EECERT loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.669 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CRL loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.670 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PPK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:48:53.713 DEBUG                    cmd optimus > skdhttp quick on
15:48:54.064 DEBUG                    Convert value '0x800a0102' as OCTET STRING
15:48:54.145 DEBUG                    HTTP Status: 200 - OK
15:48:54.145 DEBUG                    Connect closed for Server
15:48:54.145 DEBUG                    Connect closed for Server
15:48:55.467 DEBUG                    Convert value '0x800a0100' as OCTET STRING
15:48:55.667 INFO    Test:            92  : [icm-receive-invalid-chain] An ICM will
|                                           reject a message if the Inf IA can not be
|                                           chained back to the TA.
15:48:55.685 INFO                           #> 0.1. Configure the ICM with the IR FactoryIA certificate.
15:48:55.710 DEBUG                          Generating certificate signature for serial: 5
15:48:55.718 DEBUG                          Added keymat FACT-IA: serial=5 auth=0x828c125b29eed4e3 subj=0x828c125b29eed4e3
15:48:55.744 DEBUG                          Generating message signature using cert with serial: 88941
15:48:55.803 DEBUG                          Sending SKD message:
|                                           KeyPackageFile:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = List:
|                                                   [0]:
|                                                       OneAsymmetricKey:
|                                                           version == 0
|                                                           privateKeyAlgorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           privateKey = ECPrivateKey:
|                                                               version = 1L
|                                                               privateKey = Octets(0x3334303233373736373138333634323431323438383031343535323635363130363630383438353436303539333231393239373237353734313839343134313037313033313239353933383830343134383330343637353536383735383138383330393735323531343436393637323634323933)
|                                                           attributes:
|                                                             [0] = UserCertificateAttr:
|                                                               id == OID(userCertificate:2.5.4.36)
|                                                               userCertificate = Certificate:
|                                                                   tbsCertificate = TBSCertificate:
|                                                                       version == 2
|                                                                       serialNumber = 5L
|                                                                       signatureAlgorithmID = AlgorithmIdentifier:
|                                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                       issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                       validity = 170112154855Z..99991231235959Z
|                                                                       subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                           algorithm = AlgorithmIdentifier:
|                                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                               parameters = ECParameters:
|                                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                           subjectPublicKey = long768:196052485786874245172810048058196475617954086612126983585354380884307853841719190006156357831486504350691251510509714535190635552221109769077084459397992814832116312073008299069841056284314987422777696951818092230462259085787976931
|                                                                       _extensions = CertificateExtensions
|                                                                         [0] AuthorityKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                               keyIdentifier = Octets(0x828c125b29eed4e3)
|                                                                         [1] SubjectKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                               id = Octets(0x828c125b29eed4e3)
|                                                                         [2] KeyUsage_CertExt:
|                                                                               extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                               critical = True
|                                                                               uses = ['digitalSignature']
|                                                                         [3] CertificatePolicies_CertExt:
|                                                                               extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                               critical = True
|                                                                               policies:
|                                                                                 [0] = PolicyInformation:
|                                                                                   id = OID(1.2.826.0.1145.0.1.0.4)
|                                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                   signature = Signature:
|                                                                       r = long384:4076025383843544564067136628670580033275881284255652819311398695184563235301596655033073865043563861263756252522678
|                                                                       s = long384:21697540234567802877879144317558330405059332495981341143956685401610560291236969447997275026455047583655929643474291
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x432b7bd6903667ea-->0x88095dd7278ff315-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 88941L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154843Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:631202723041430011606391798268147795335114247245904350265367661009045493794796382334086468740447333657803685283604456987520985158031779178579055238711468584291997337067337033103698037495290502764618569629840744037947722835537848298
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x88095dd7278ff315)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x432b7bd6903667ea)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.4
|                                                                         [1] = 1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:20743525298304856995976549480458480555798354249356470118107624632561381487816654537921092421597558960347855051200950
|                                                           s = long384:38469243521179165418496773599132322034515389433053585548114748190482631817403791347850410813547699963134262989439958
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 89803L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154843Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:348438190957499272901009291072019559795666862427525770100970609429720084222061942410829608189678558421378622782886643646931907570144169384976827466672219186523745049834338973514536779785414168663084318729339989190680781173814037
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x88095dd7278ff315)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[2]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16532063573147427393141095413063955568151879784332678742334874265562955304503746580738624571349776209917694890309473
|                                                           s = long384:13913363449992862615213950148244924498740340632667530180994022149211817158587558035315839411834886056526419293397940
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x432b7bd6903667ea)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                                     [1] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xdaa9429a79ada9acdaaba90dc5f6a935d7ba9ca8dd56339044a6c98c1f75f78bf75dc60cf39d3d854885cbfd62f6b5bb)
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154855Z)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:33465925901621328502174979849059787648360839352660899297893499629094932229519093693678588183727040112716704373412109
|                                                       s = long384:9335767289900806002370362187115970309387408023999089516525707658999989764625967268075539068970362097956607578627133
15:48:55.839 DEBUG                          cmd optimus > keydir
15:48:55.851 DEBUG                          cmd optimus > keydir /tmp/
15:48:55.927 DEBUG                          Factory IA ESN: 
15:48:55.991 DEBUG                          cmd optimus > keydir ../Keys/
15:48:55.993 DEBUG                          UUT Control: Applying all recent configuration changes
15:48:56.082 INFO                           #> 0.2. Trigger the ICM to create an InfIA certificate request file.
15:48:56.145 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:56.179 DEBUG                          Factory IA ESN: D8EFF0000005
15:48:56.196 DEBUG                          Connected to Server
15:48:56.246 DEBUG                          Sending HTTP GET /status_2 message.
15:48:56.247 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:48:56.313 DEBUG                          HTTP Status: 200 - OK
15:48:56.314 DEBUG                          Connect closed for Server
15:48:56.317 DEBUG                          Connect closed for Server
15:48:57.966 INFO                           #> 0.3. Expect a request and verify it is correct.
15:48:58.072 DEBUG                          Received SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:463243867887081518638880149361313576756583875539756586845040094463824904826163222805391814026287327855421024826625650545574154761943739425098800448003682133938444826591189086948429880260329493949163753897115545165409159278026505038
|                                                           x = 11756859931905475450681213541278896009356394920032282301368011193555192800386389048563105898243747261140539044236082
|                                                           y = 29984234680374861613153314778677782189661210271981547994650790771945093716932314776251247775054600161622746508770126
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.3
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:28180543922530619537917264487770628247471974001569587637849738960503398368619988015942056365262381803912662652181781
|                                                       s = long384:21747380355213760646404906327371200766320115865302398711903427802587819722973805310843273147393529230257609576227676
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x828c125b29eed4e3-->0x828c125b29eed4e3
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 5L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154855Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:196052485786874245172810048058196475617954086612126983585354380884307853841719190006156357831486504350691251510509714535190635552221109769077084459397992814832116312073008299069841056284314987422777696951818092230462259085787976931
|                                                               x = 4975698059882398271414385102456086054163763112535850155841749537688116230344647548644846907525015320556245579802958
|                                                               y = 23183388509547594363145160674368383142715845898803258793494890617190120610712426938683405295285192712607678543615203
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x828c125b29eed4e3)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x828c125b29eed4e3)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:4076025383843544564067136628670580033275881284255652819311398695184563235301596655033073865043563861263756252522678
|                                                           s = long384:21697540234567802877879144317558330405059332495981341143956685401610560291236969447997275026455047583655929643474291
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x828c125b29eed4e3)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154856Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xaaaabbbbfc000ad7)
|                                                           msgCount = 0L
|                                                     [4] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x17ebd53f9ed77cfc44cce4da373e020f33886586aa2fab285f9cab2a14829ae4d9deb638e2a9f9383808aa04c118b091)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:6480083097426461292283457186963132705423329086304644814412209877775854979790172095519928200184486556102300464347760
|                                                       s = long384:9324692567090559953731755710144587102355275111110942030592408547236721805432702359211286646604745285161890962075074
15:48:58.074 INFO                           #> 0.4. Create a Certificate Signing Response file and instruct the ICM to consume it
15:48:58.074 DEBUG                          IR: Handling Certificate Signing Request.
15:48:58.075 DEBUG                          Creating temporary CA cert to issue IA
15:48:58.102 DEBUG                          Generating certificate signature for serial: 84909
15:48:58.110 DEBUG                          Added keymat IR-INF-CA-TMP: serial=84909 auth=0xc9020cefbb66368c subj=0x81961fba5ed93920
15:48:58.112 DEBUG                          Generating InfIA certificate (serialNumber: 20002L)
15:48:58.135 DEBUG                          Generating certificate signature for serial: 20002
15:48:58.144 DEBUG                          Creating SKD message file /tmp/infia.resp
15:48:58.153 DEBUG                          Generating message signature using cert with serial: 88941
15:48:58.246 DEBUG                          Sending SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = 1L
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = 0
|                                               certificates (2 chains, 3 certificates) = 
|                                                 Chains summary:
|                                                   0x78473c9860673b4e-->0x81961fba5ed93920-->0xc9020cefbb66368c
|                                                   0x432b7bd6903667ea-->0x88095dd7278ff315
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154858Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:463243867887081518638880149361313576756583875539756586845040094463824904826163222805391814026287327855421024826625650545574154761943739425098800448003682133938444826591189086948429880260329493949163753897115545165409159278026505038
|                                                               x = 11756859931905475450681213541278896009356394920032282301368011193555192800386389048563105898243747261140539044236082
|                                                               y = 29984234680374861613153314778677782189661210271981547994650790771945093716932314776251247775054600161622746508770126
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x81961fba5ed93920)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x78473c9860673b4e)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:28970273181109267495419155369379136938337770565252935594117972032878522147233715584780330351302461199231721564642074
|                                                           s = long384:5951814520887008609345347204336203175703594165492920098607614518046651027211664594838293878616688367843096162411252
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 84909L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154858Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1278512591983029540876472519918293600149214497009776698123095688450577335509244259540735487169483039401854062328369207676293535092963701883623519725557698102007178725779353799592903886490419503568601393289149230350856219591672674592
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x81961fba5ed93920)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:7072851874309847589504186022459316541592325563560660221271381530923036571844625861949972811262930424882797272823171
|                                                           s = long384:2092967378413905091765584051855727962381647757208198431009467257693212668648876091250023783937031389275250073495782
|                                                   Chain[1] =
|                                                       [1.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 88941L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154843Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:631202723041430011606391798268147795335114247245904350265367661009045493794796382334086468740447333657803685283604456987520985158031779178579055238711468584291997337067337033103698037495290502764618569629840744037947722835537848298
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x88095dd7278ff315)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x432b7bd6903667ea)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.4
|                                                                         [1] = 1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:20743525298304856995976549480458480555798354249356470118107624632561381487816654537921092421597558960347855051200950
|                                                           s = long384:38469243521179165418496773599132322034515389433053585548114748190482631817403791347850410813547699963134262989439958
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x432b7bd6903667ea)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                     [1] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154858Z)
|                                                     [3] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                                     [4] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [5] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xaaaabbbbfc000ad7)
|                                                           msgCount = 0L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:29847402426106376931830848823297000115569165987845513783271475527954377857466605678511103707312946688198865855338587
|                                                       s = long384:9406593677760280708399387283271962601622560262137520920246019564871421862859029733763600564371403240943622653943753
15:48:58.314 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:48:58.365 DEBUG                          Connected to Server
15:48:58.415 DEBUG                          Sending HTTP GET /status_2 message.
15:48:58.416 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:48:58.518 DEBUG                          HTTP Status: 200 - OK
15:48:58.520 DEBUG                          Connect closed for Server
15:48:58.521 DEBUG                          Connect closed for Server
15:49:00.519 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:00.572 DEBUG                          Connected to Server
15:49:00.620 DEBUG                          Sending HTTP GET /status_2 message.
15:49:00.621 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:49:00.771 DEBUG                          HTTP Status: 200 - OK
15:49:00.772 DEBUG                          Connect closed for Server
15:49:00.777 DEBUG                          Connect closed for Server
15:49:01.207 INFO    Test:                  PASS
15:49:01.339 DEBUG                    Tearing down mock HTTP servers
15:49:01.342 DEBUG                    Connect closed for Server
15:49:01.343 DEBUG                    Connect closed for Server
15:49:02.772 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:02.823 DEBUG                    Connected to Server
15:49:02.872 DEBUG                    Sending HTTP GET /status_2 message.
15:49:02.873 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:02.924 DEBUG                    HTTP Status: 200 - OK
15:49:02.924 DEBUG                    Connect closed for Server
15:49:02.925 DEBUG                    Connect closed for Server
15:49:04.924 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:04.975 DEBUG                    Connected to Server
15:49:05.025 DEBUG                    Sending HTTP GET /status_2 message.
15:49:05.025 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:05.143 DEBUG                    HTTP Status: 200 - OK
15:49:05.144 DEBUG                    Connect closed for Server
15:49:05.144 DEBUG                    Connect closed for Server
15:49:07.144 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:07.194 DEBUG                    Connected to Server
15:49:07.244 DEBUG                    Sending HTTP GET /status_2 message.
15:49:07.245 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:07.347 DEBUG                    HTTP Status: 200 - OK
15:49:07.348 DEBUG                    Connect closed for Server
15:49:07.348 DEBUG                    Connect closed for Server
15:49:08.309 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:49:08.309 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:49:08.321 DEBUG                    Generating certificate signature for serial: 83259
15:49:08.327 DEBUG                    Added keymat IR-INF-CA: serial=83259 auth=0xc9020cefbb66368c subj=0xdd62b2fcd6fd9bf5
15:49:08.339 DEBUG                    Generating certificate signature for serial: 87915
15:49:08.345 DEBUG                    Added keymat IR-INF-IA: serial=87915 auth=0xdd62b2fcd6fd9bf5 subj=0xa6e7e82ecd2e247e
15:49:08.357 DEBUG                    Generating certificate signature for serial: 85213
15:49:08.363 DEBUG                    Added keymat IR-INF-CRL-CA: serial=85213 auth=0xc9020cefbb66368c subj=0x9c35429f90b21ede
15:49:08.375 DEBUG                    Generating certificate signature for serial: 84298
15:49:08.380 DEBUG                    Added keymat IR-INF-CRL-IA: serial=84298 auth=0x9c35429f90b21ede subj=0x1dc689fcf72173f4
15:49:08.391 DEBUG                    Generating certificate signature for serial: 5
15:49:08.396 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x1ebe3912596aa6db subj=0x1ebe3912596aa6db
15:49:08.405 DEBUG                    Generating message signature using cert with serial: 87915
15:49:08.439 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:49:08.490 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x1ebe3912596aa6db subj=0x1ebe3912596aa6db
15:49:08.496 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:49:08.513 DEBUG                    Generating message signature using cert with serial: 5
15:49:08.571 DEBUG                    IR: Handling Certificate Signing Request.
15:49:08.571 DEBUG                    Creating temporary CA cert to issue IA
15:49:08.583 DEBUG                    Generating certificate signature for serial: 87873
15:49:08.589 DEBUG                    Added keymat IR-INF-CA-TMP: serial=87873 auth=0xc9020cefbb66368c subj=0x4a1dc08647ef40b1
15:49:08.589 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:49:08.595 DEBUG                    Generating certificate signature for serial: 20000
15:49:08.602 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:49:08.605 DEBUG                    Generating message signature using cert with serial: 87915
15:49:08.721 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:49:08.721 DEBUG                    Received Inf IA response
15:49:08.722 DEBUG                    Added keymat IR-INF-CA: serial=87873 auth=0xc9020cefbb66368c subj=0x4a1dc08647ef40b1
15:49:08.722 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x4a1dc08647ef40b1 subj=0xfcd95499f4626a3e
15:49:08.732 DEBUG                    Generating certificate signature for serial: 5
15:49:08.738 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x990e61314a2f8af0 subj=0x990e61314a2f8af0
15:49:08.746 DEBUG                    Generating message signature using cert with serial: 20000
15:49:08.781 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:49:08.798 DEBUG                    Generating message signature using cert with serial: 20000
15:49:08.880 DEBUG                    IR: Handling Certificate Signing Request.
15:49:08.880 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:49:08.887 DEBUG                    Generating certificate signature for serial: 20001
15:49:08.893 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:49:08.896 DEBUG                    Generating message signature using cert with serial: 87915
15:49:08.990 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:49:08.991 DEBUG                    Received Inf CA response
15:49:08.991 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x87904a4d4ee4d757
15:49:08.991 INFO                     Listening for ('128.10.1.4', 80)
15:49:08.996 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:49:09.000 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:49:09.000 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:49:09.051 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x990e61314a2f8af0 subj=0x990e61314a2f8af0
15:49:09.057 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:49:09.073 DEBUG                    Generating message signature using cert with serial: 5
15:49:09.130 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:49:09.136 DEBUG                    Generating certificate signature for serial: 20000
15:49:09.143 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:49:09.146 DEBUG                    Generating message signature using cert with serial: 20000
15:49:09.262 DEBUG                    Received Inf IA response
15:49:09.263 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x87904a4d4ee4d757
15:49:09.263 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x87904a4d4ee4d757 subj=0x6b07f02bc0cb8eec
15:49:09.267 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:49:09.271 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:49:09.322 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x990e61314a2f8af0 subj=0x990e61314a2f8af0
15:49:09.322 INFO                     Listening for ('128.10.1.6', 80)
15:49:09.322 DEBUG                    MCKM requesting Inf IA from ICM.
15:49:09.328 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:49:09.345 DEBUG                    Generating message signature using cert with serial: 5
15:49:09.363 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:49:09.363 INFO                     SKD: Client ---> Server CMC-request (1342 bytes)
15:49:09.363 INFO                     Sent CSR for Inf IA certificate.
15:49:09.364 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:09.364 DEBUG                    106200912: Connect accepted from Client
15:49:09.415 DEBUG                    Connected to Server
15:49:09.416 DEBUG                    Connected to Server
15:49:09.467 DEBUG                    Sending HTTP POST /fullcmc message.
15:49:09.467 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:49:09.467 DEBUG                    Sending HTTP GET /status_2 message.
15:49:09.468 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:09.533 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:49:09.533 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:49:09.540 DEBUG                    Generating certificate signature for serial: 20001
15:49:09.549 DEBUG                    Generating message signature using cert with serial: 20000
15:49:09.601 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:49:09.602 DEBUG                    HTTP Status: 200 - OK
15:49:09.602 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3139 bytes)
15:49:09.666 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:49:09.666 DEBUG                    Received Inf IA response
15:49:09.666 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x87904a4d4ee4d757
15:49:09.667 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x87904a4d4ee4d757 subj=0xc615d181592cbb79
15:49:09.667 DEBUG                    HTTP Status: 200 - OK
15:49:09.667 DEBUG                    Connect closed for Server
15:49:09.668 DEBUG                    Connect closed for Server
15:49:11.372 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:49:11.422 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x990e61314a2f8af0 subj=0x990e61314a2f8af0
15:49:11.423 DEBUG                    CKA requesting Inf IA from ICM.
15:49:11.428 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:49:11.450 DEBUG                    Generating message signature using cert with serial: 5
15:49:11.474 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:49:11.475 INFO                     SKD: Client ---> Server CMC-request (1331 bytes)
15:49:11.475 INFO                     Sent CSR for Inf IA certificate.
15:49:11.476 DEBUG                    106200912: Connect accepted from Client
15:49:11.477 DEBUG                    Connect closed for Server
15:49:11.477 DEBUG                    Connect closed for Server
15:49:11.525 DEBUG                    Connected to Server
15:49:11.576 DEBUG                    Sending HTTP POST /fullcmc message.
15:49:11.577 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:49:11.635 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:49:11.636 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:49:11.643 DEBUG                    Generating certificate signature for serial: 20002
15:49:11.653 DEBUG                    Generating message signature using cert with serial: 20000
15:49:11.712 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:49:11.713 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:11.714 DEBUG                    HTTP Status: 200 - OK
15:49:11.714 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3127 bytes)
15:49:11.782 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:49:11.782 DEBUG                    Received Inf IA response
15:49:11.783 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x87904a4d4ee4d757
15:49:11.783 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x87904a4d4ee4d757 subj=0x4dcd7119dc676903
15:49:11.783 DEBUG                    Connected to Server
15:49:11.813 DEBUG                    Sending HTTP GET /status_2 message.
15:49:11.814 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:11.819 DEBUG                    HTTP Status: 200 - OK
15:49:11.826 DEBUG                    Connect closed for Server
15:49:11.827 DEBUG                    Connect closed for Server
15:49:13.820 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:13.873 DEBUG                    Connected to Server
15:49:13.922 DEBUG                    Sending HTTP GET /status_2 message.
15:49:13.923 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:14.014 DEBUG                    HTTP Status: 200 - OK
15:49:14.015 DEBUG                    Connect closed for Server
15:49:14.015 DEBUG                    Connect closed for Server
15:49:15.681 DEBUG                    ########## Mocks complete ##########
15:49:16.014 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:16.065 DEBUG                    Connected to Server
15:49:16.115 DEBUG                    Sending HTTP GET /status_2 message.
15:49:16.115 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:18.092 DEBUG                    cmd optimus > cmdcomplete on
15:49:18.102 DEBUG                    cmd optimus > log path /tmp/optimus.log
15:49:18.103 DEBUG                    cmd optimus > log set CRTNG debug
15:49:18.103 DEBUG                    cmd optimus > log set CRLXF debug
15:49:18.103 DEBUG                    cmd optimus > log set PTFTP debug
15:49:18.103 INFO                     Setting SNMP v3 security to use authPriv with auth=123456789 priv=987654321
15:49:18.103 DEBUG                    cmd optimus > snmp security 123456789 987654321
15:49:18.104 DEBUG                    Optimus has been restarted
15:49:18.105 DEBUG                    UUT Control: Applying all recent configuration changes
15:49:19.089 DEBUG                    HTTP Status: 200 - OK
15:49:19.090 DEBUG                    Connect closed for Server
15:49:19.091 DEBUG                    Connect closed for Server
15:49:21.090 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:21.141 DEBUG                    Connected to Server
15:49:21.191 DEBUG                    Sending HTTP GET /status_2 message.
15:49:21.192 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:21.290 DEBUG                    HTTP Status: 200 - OK
15:49:21.291 DEBUG                    Connect closed for Server
15:49:21.291 DEBUG                    Connect closed for Server
15:49:23.291 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:23.342 DEBUG                    Connected to Server
15:49:23.391 DEBUG                    Sending HTTP GET /status_2 message.
15:49:23.392 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:23.488 DEBUG                    HTTP Status: 200 - OK
15:49:23.489 DEBUG                    Connect closed for Server
15:49:23.489 DEBUG                    Connect closed for Server
15:49:25.489 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:25.540 DEBUG                    Connected to Server
15:49:25.589 DEBUG                    Sending HTTP GET /status_2 message.
15:49:25.590 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:25.689 DEBUG                    HTTP Status: 200 - OK
15:49:25.690 DEBUG                    Connect closed for Server
15:49:25.691 DEBUG                    Connect closed for Server
15:49:27.691 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:27.741 DEBUG                    Connected to Server
15:49:27.791 DEBUG                    Sending HTTP GET /status_2 message.
15:49:27.792 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:27.891 DEBUG                    HTTP Status: 200 - OK
15:49:27.891 DEBUG                    Connect closed for Server
15:49:27.891 DEBUG                    Connect closed for Server
15:49:29.891 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:29.942 DEBUG                    Connected to Server
15:49:29.991 DEBUG                    Sending HTTP GET /status_2 message.
15:49:29.992 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:30.089 DEBUG                    HTTP Status: 200 - OK
15:49:30.090 DEBUG                    Connect closed for Server
15:49:30.091 DEBUG                    Connect closed for Server
15:49:32.090 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:32.141 DEBUG                    Connected to Server
15:49:32.191 DEBUG                    Sending HTTP GET /status_2 message.
15:49:32.191 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:32.290 DEBUG                    HTTP Status: 200 - OK
15:49:32.291 DEBUG                    Connect closed for Server
15:49:32.292 DEBUG                    Connect closed for Server
15:49:34.295 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:34.346 DEBUG                    Connected to Server
15:49:34.395 DEBUG                    Sending HTTP GET /status_2 message.
15:49:34.396 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:34.488 DEBUG                    HTTP Status: 200 - OK
15:49:34.489 DEBUG                    Connect closed for Server
15:49:34.489 DEBUG                    Connect closed for Server
15:49:36.489 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:36.539 DEBUG                    Connected to Server
15:49:36.589 DEBUG                    Sending HTTP GET /status_2 message.
15:49:36.590 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:36.691 DEBUG                    HTTP Status: 200 - OK
15:49:36.691 DEBUG                    Connect closed for Server
15:49:36.692 DEBUG                    Connect closed for Server
15:49:38.148 WARNING                  SNMP: Timout ('get', 'PRIME-IPSEC-MIB::childSadTableCount.0', '')
15:49:38.517 DEBUG                    change classification to 'S'
15:49:38.517 DEBUG                    cmd optimus > class S
15:49:38.518 INFO                     20-CRYPT: Loading Suite Plugins...
15:49:38.530 INFO                     20-KEYST: Loading Key Parser Plugins...
15:49:38.533 INFO                     20-KEYST:   Key Parser TRUSTANCHOR loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.534 INFO                     20-KEYST:   Key Parser KEK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.535 INFO                     20-KEYST:   Key Parser PSK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.535 INFO                     20-KEYST:   Key Parser PPK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.536 INFO                     20-KEYST:   Key Parser X509 loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.536 INFO                     20-KEYST:   Key Parser CCOI loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.536 INFO                     20-KEYST:   Key Parser CRL loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.537 INFO                     20-KEYST:   Key Parser KEYPACK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.537 INFO                     20-KEYST: Loading Key Store Plugins...
15:49:38.542 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.KEYTA loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.545 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PKITA loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.545 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.KEK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.546 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PSK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.546 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PACKAGES loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.547 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CCOI loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.547 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CACERT loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.548 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.EECERT loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.548 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.CRL loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.549 INFO                     20-KEYST:   Key Store TEST_SUPPORT.PRIME.CRYPTLIB.KEYTYPES.TABLES.PPK loaded successfully from /local_home/fractal/builds/5cff31c7/0/fractal/fractal/Time_Code/suite/test_support/prime/CryptLib
15:49:38.603 DEBUG                    cmd optimus > skdhttp quick on
15:49:38.691 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:38.742 DEBUG                    Connected to Server
15:49:38.792 DEBUG                    Sending HTTP GET /status_2 message.
15:49:38.792 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:38.905 DEBUG                    HTTP Status: 200 - OK
15:49:38.905 DEBUG                    Connect closed for Server
15:49:38.906 DEBUG                    Connect closed for Server
15:49:38.953 DEBUG                    Convert value '0x800a0102' as OCTET STRING
15:49:40.262 DEBUG                    Convert value '0x800a0100' as OCTET STRING
15:49:40.422 INFO    Test:            94  : [icm-receive-invalid-keyid] An ICM will
|                                           reject a message unless the Subject Key
|                                           Identifier in the SignerInfos matches that
|                                           in the certificate.
15:49:40.431 INFO                           #> 0.1. Configure the ICM with the IR FactoryIA certificate.
15:49:40.453 DEBUG                          Generating certificate signature for serial: 5
15:49:40.460 DEBUG                          Added keymat FACT-IA: serial=5 auth=0xb00155a4d64d863d subj=0xb00155a4d64d863d
15:49:40.485 DEBUG                          Generating message signature using cert with serial: 87915
15:49:40.544 DEBUG                          Sending SKD message:
|                                           KeyPackageFile:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = List:
|                                                   [0]:
|                                                       OneAsymmetricKey:
|                                                           version == 0
|                                                           privateKeyAlgorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           privateKey = ECPrivateKey:
|                                                               version = 1L
|                                                               privateKey = Octets(0x3339323333323638313932373036353638383637313830383433303234393137363231363131363039323833393032323132393334343732383834343235373334343331353839353034363739383133393830373935373235373437393631393432393134313233333933353737373030343632)
|                                                           attributes:
|                                                             [0] = UserCertificateAttr:
|                                                               id == OID(userCertificate:2.5.4.36)
|                                                               userCertificate = Certificate:
|                                                                   tbsCertificate = TBSCertificate:
|                                                                       version == 2
|                                                                       serialNumber = 5L
|                                                                       signatureAlgorithmID = AlgorithmIdentifier:
|                                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                       issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                       validity = 170112154940Z..99991231235959Z
|                                                                       subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                           algorithm = AlgorithmIdentifier:
|                                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                               parameters = ECParameters:
|                                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                           subjectPublicKey = long768:705322846733252638944776884703037340563629438579780439339350259243068224821513734890375742620607327254968203308423717838930991722347689723513892487806385370163192433390124109755549213817120939343851981632114732910998372206957659709
|                                                                       _extensions = CertificateExtensions
|                                                                         [0] AuthorityKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                               keyIdentifier = Octets(0xb00155a4d64d863d)
|                                                                         [1] SubjectKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                               id = Octets(0xb00155a4d64d863d)
|                                                                         [2] KeyUsage_CertExt:
|                                                                               extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                               critical = True
|                                                                               uses = ['digitalSignature']
|                                                                         [3] CertificatePolicies_CertExt:
|                                                                               extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                               critical = True
|                                                                               policies:
|                                                                                 [0] = PolicyInformation:
|                                                                                   id = OID(1.2.826.0.1145.0.1.0.4)
|                                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                   signature = Signature:
|                                                                       r = long384:34678799626729585434849322165736761604888175272776141370994330019084553022925155886818281775619121630329195416918606
|                                                                       s = long384:23750923569197518236042311083724167641674959001174179077011138810918668878873592730075426926175796723620889856726571
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0xa6e7e82ecd2e247e-->0xdd62b2fcd6fd9bf5-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 87915L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154908Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1112061442167385815598944928823279086095300054498129902304790202754926274692982488924463097390721068463615773216460063963817200530403258607442890279457951923352431422851035054776820499159727713741929060973861977262499555916546712702
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xdd62b2fcd6fd9bf5)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xa6e7e82ecd2e247e)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.4
|                                                                         [1] = 1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:34258586314862649062498323055468985620125195901808238420537866714762660700579990917926109632431880705952714065050966
|                                                           s = long384:3106721073705045622380851283190980360072958808887365583599847841233413328831669738064230006585338681068519602337656
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 83259L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154908Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:184371682245429153676514220690946335033179560085836408932997833438476944727336743221889576970353045173337463705342990359849145062093101822718617124671973006597245139746180982841990788729511516242439797540341547767037511349089180661
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xdd62b2fcd6fd9bf5)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[2]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:23994249144128967194653030086530982008800936540394097060290365419384950914915254789402576307510978365499769316601105
|                                                           s = long384:30461246611177336447822700005188575285117511172286696074394261629441256841666571405662948908404450232919262498074770
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0xa6e7e82ecd2e247e)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                                     [1] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xd18cb1e8f45971487f5f2fa0cfc8e204c527c715469432ecd7226d6e260e17a1a20bbdd64d347dbacebcc8f957c91cd3)
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154940Z)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:26135603382062726993422263115127438623181798270903380979977363932532669843753881530144825797138111890063639939136869
|                                                       s = long384:34664979247935387240863339533719275230913437754391478991591060089153062216391767122414093441885449007180885347230702
15:49:40.583 DEBUG                          cmd optimus > keydir
15:49:40.596 DEBUG                          cmd optimus > keydir /tmp/
15:49:40.669 DEBUG                          Factory IA ESN: 
15:49:40.732 DEBUG                          cmd optimus > keydir ../Keys/
15:49:40.734 DEBUG                          UUT Control: Applying all recent configuration changes
15:49:40.821 INFO                           #> 0.2. Trigger the ICM to create an InfIA certificate request file.
15:49:40.906 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:40.908 DEBUG                          Factory IA ESN: D8EFF0000005
15:49:40.957 DEBUG                          Connected to Server
15:49:41.007 DEBUG                          Sending HTTP GET /status_2 message.
15:49:41.007 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:49:41.093 DEBUG                          HTTP Status: 200 - OK
15:49:41.094 DEBUG                          Connect closed for Server
15:49:41.097 DEBUG                          Connect closed for Server
15:49:42.572 INFO                           #> 0.3. Expect a request and verify it is correct.
15:49:42.666 DEBUG                          Received SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:1047564467985706221743773805682654064739016263792640988572542195773653633347889361605781226423965294937384066347546249808471281438058826273102872719208637048386740884028508304696360299313504066880156518992594650204143792441267200485
|                                                           x = 26586576905862338488038775677500468054920533081697435171294681056738138983759848010998326837186243692929093983785981
|                                                           y = 23948113177596388107586093365344556422746279147267621532640270386362349458874249438102569592813009192448503797653989
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.3
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:6157381243665773498469400857776223747793307480138784962014740664560162876375850856746415687601735290239581994164068
|                                                       s = long384:22284340996284090457140977652721942329644974612365153162587861384715229875666531704804827295879422740114232115682384
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0xb00155a4d64d863d-->0xb00155a4d64d863d
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 5L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154940Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:705322846733252638944776884703037340563629438579780439339350259243068224821513734890375742620607327254968203308423717838930991722347689723513892487806385370163192433390124109755549213817120939343851981632114732910998372206957659709
|                                                               x = 17900683615388952601973798518571962480255121449877751399820389927420841222602864823405383471829770451929705498033136
|                                                               y = 3059876019520272066184075014645430418177522261946938107089827211352966370633302684290141686630114276405045783004733
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xb00155a4d64d863d)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xb00155a4d64d863d)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:34678799626729585434849322165736761604888175272776141370994330019084553022925155886818281775619121630329195416918606
|                                                           s = long384:23750923569197518236042311083724167641674959001174179077011138810918668878873592730075426926175796723620889856726571
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0xb00155a4d64d863d)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154940Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xaaaabbbb3df6d81f)
|                                                           msgCount = 0L
|                                                     [4] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x6b0c525ccc124ee12d6143cfa4dbec4f1ecb246ddc512a72d33e2629b9ef1b2445801ea348cf4cb72bdde1fdff022c4b)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:23728487394160909536994948715922216892919481925272461555870403186746206508635402964806404204478072259421400255916433
|                                                       s = long384:34264179381879202775417078600115151994793883059129711152868963437605988026518021864381002532304888952545719027431735
15:49:42.667 INFO                           #> 0.4. Create a Certificate Signing Response file and instruct the ICM to consume it
15:49:42.667 DEBUG                          IR: Handling Certificate Signing Request.
15:49:42.668 DEBUG                          Creating temporary CA cert to issue IA
15:49:42.694 DEBUG                          Generating certificate signature for serial: 87639
15:49:42.700 DEBUG                          Added keymat IR-INF-CA-TMP: serial=87639 auth=0xc9020cefbb66368c subj=0x678d9ce1da9cab36
15:49:42.701 DEBUG                          Generating InfIA certificate (serialNumber: 20002L)
15:49:42.720 DEBUG                          Generating certificate signature for serial: 20002
15:49:42.729 DEBUG                          Creating SKD message file /tmp/infia.resp
15:49:42.737 DEBUG                          Generating message signature using cert with serial: 87915
15:49:42.833 DEBUG                          Sending SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = 1L
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = 0
|                                               certificates (2 chains, 4 certificates) = 
|                                                 Chains summary:
|                                                   0xa6e7e82ecd2e247e-->0xdd62b2fcd6fd9bf5-->0xc9020cefbb66368c
|                                                   0x62e58b7f5f0e21e5-->0x678d9ce1da9cab36-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 87915L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154908Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1112061442167385815598944928823279086095300054498129902304790202754926274692982488924463097390721068463615773216460063963817200530403258607442890279457951923352431422851035054776820499159727713741929060973861977262499555916546712702
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xdd62b2fcd6fd9bf5)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xa6e7e82ecd2e247e)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.4
|                                                                         [1] = 1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:34258586314862649062498323055468985620125195901808238420537866714762660700579990917926109632431880705952714065050966
|                                                           s = long384:3106721073705045622380851283190980360072958808887365583599847841233413328831669738064230006585338681068519602337656
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 83259L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154908Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:184371682245429153676514220690946335033179560085836408932997833438476944727336743221889576970353045173337463705342990359849145062093101822718617124671973006597245139746180982841990788729511516242439797540341547767037511349089180661
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xdd62b2fcd6fd9bf5)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[2]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:23994249144128967194653030086530982008800936540394097060290365419384950914915254789402576307510978365499769316601105
|                                                           s = long384:30461246611177336447822700005188575285117511172286696074394261629441256841666571405662948908404450232919262498074770
|                                                   Chain[1] =
|                                                       [1.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112154942Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1047564467985706221743773805682654064739016263792640988572542195773653633347889361605781226423965294937384066347546249808471281438058826273102872719208637048386740884028508304696360299313504066880156518992594650204143792441267200485
|                                                               x = 26586576905862338488038775677500468054920533081697435171294681056738138983759848010998326837186243692929093983785981
|                                                               y = 23948113177596388107586093365344556422746279147267621532640270386362349458874249438102569592813009192448503797653989
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x678d9ce1da9cab36)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x62e58b7f5f0e21e5)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16102037212280226861074764465226499288708362017667811249175253590051547711822220986118002376772272428738946259362137
|                                                           s = long384:19553632646971720883814213239989093460427271248061850878801950276359309301922241864021274854209592847838505373271321
|                                                       [1.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 87639L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112154942Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1413872306843669867327163212829204442326336675217526853712680058274958855946292084442859921009711511119618962698632107024684892992700315901912867342699207751748372210345148574665679028770640436259627079804740295217413343184332565302
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x678d9ce1da9cab36)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:26009903262201318934140986870745520935548250021542702943593695371475083384522771377421629309416530157702042529476914
|                                                           s = long384:22877595316447476966487839070766501492017731403721302216940254164478762295623371270157807583373457978832058793377850
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1234567812345678)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                     [1] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112154942Z)
|                                                     [3] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                                     [4] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [5] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xaaaabbbb3df6d81f)
|                                                           msgCount = 0L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:16187846030518273019639494212523358783854753267419388757315421207335550849969882826954482949239535005372584403881601
|                                                       s = long384:12679205653660689029306717326225145236134130855950383504603674378929977174948654307579011744347958658687609605786416
15:49:43.095 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:43.153 DEBUG                          Connected to Server
15:49:43.200 DEBUG                          Sending HTTP GET /status_2 message.
15:49:43.201 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:49:43.325 DEBUG                          HTTP Status: 200 - OK
15:49:43.326 DEBUG                          Connect closed for Server
15:49:43.327 DEBUG                          Connect closed for Server
15:49:45.326 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:45.381 DEBUG                          Connected to Server
15:49:45.427 DEBUG                          Sending HTTP GET /status_2 message.
15:49:45.428 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:49:45.531 DEBUG                          HTTP Status: 200 - OK
15:49:45.533 DEBUG                          Connect closed for Server
15:49:45.535 DEBUG                          Connect closed for Server
15:49:46.435 INFO    Test:                  PASS
15:49:46.567 DEBUG                    Tearing down mock HTTP servers
15:49:46.571 DEBUG                    Connect closed for Server
15:49:46.572 DEBUG                    Connect closed for Server
15:49:47.532 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:47.583 DEBUG                    Connected to Server
15:49:47.632 DEBUG                    Sending HTTP GET /status_2 message.
15:49:47.633 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:47.725 DEBUG                    HTTP Status: 200 - OK
15:49:47.726 DEBUG                    Connect closed for Server
15:49:47.726 DEBUG                    Connect closed for Server
15:49:49.726 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:49.777 DEBUG                    Connected to Server
15:49:49.827 DEBUG                    Sending HTTP GET /status_2 message.
15:49:49.827 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:49.903 DEBUG                    HTTP Status: 200 - OK
15:49:49.904 DEBUG                    Connect closed for Server
15:49:49.904 DEBUG                    Connect closed for Server
15:49:51.904 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:51.955 DEBUG                    Connected to Server
15:49:52.004 DEBUG                    Sending HTTP GET /status_2 message.
15:49:52.005 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:52.095 DEBUG                    HTTP Status: 200 - OK
15:49:52.096 DEBUG                    Connect closed for Server
15:49:52.096 DEBUG                    Connect closed for Server
15:49:54.096 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:54.146 DEBUG                    Connected to Server
15:49:54.196 DEBUG                    Sending HTTP GET /status_2 message.
15:49:54.197 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:54.325 DEBUG                    HTTP Status: 200 - OK
15:49:54.326 DEBUG                    Connect closed for Server
15:49:54.326 DEBUG                    Connect closed for Server
15:49:55.185 INFO    Suite:       Tests for ICM SNMP.
15:49:55.194 INFO    Suite:         ICM SNMP tests
15:49:55.208 INFO                     Memory (RSS) before suite setup: 112.55 MByte  (2.04)
15:49:55.214 INFO                     Memory (Virt) before suite setup: 290.04 MByte  (1.95)
15:49:55.220 INFO                     Memory (RSS) after suite setup: 112.55 MByte  (0.00)
15:49:55.226 INFO                     Memory (Virt) after suite setup: 290.04 MByte  (0.00)
15:49:55.364 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:49:55.365 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:49:55.377 DEBUG                    Generating certificate signature for serial: 80491
15:49:55.383 DEBUG                    Added keymat IR-INF-CA: serial=80491 auth=0xc9020cefbb66368c subj=0xdc650387f3ff7bcc
15:49:55.394 DEBUG                    Generating certificate signature for serial: 85354
15:49:55.400 DEBUG                    Added keymat IR-INF-IA: serial=85354 auth=0xdc650387f3ff7bcc subj=0xa1c1b94eb79b84ab
15:49:55.412 DEBUG                    Generating certificate signature for serial: 85340
15:49:55.418 DEBUG                    Added keymat IR-INF-CRL-CA: serial=85340 auth=0xc9020cefbb66368c subj=0x147d5ff2aa688093
15:49:55.430 DEBUG                    Generating certificate signature for serial: 80788
15:49:55.436 DEBUG                    Added keymat IR-INF-CRL-IA: serial=80788 auth=0x147d5ff2aa688093 subj=0x58afc89c3430e7cb
15:49:55.446 DEBUG                    Generating certificate signature for serial: 5
15:49:55.451 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x48d311539b875147 subj=0x48d311539b875147
15:49:55.459 DEBUG                    Generating message signature using cert with serial: 85354
15:49:55.493 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:49:55.543 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x48d311539b875147 subj=0x48d311539b875147
15:49:55.549 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:49:55.565 DEBUG                    Generating message signature using cert with serial: 5
15:49:55.624 DEBUG                    IR: Handling Certificate Signing Request.
15:49:55.625 DEBUG                    Creating temporary CA cert to issue IA
15:49:55.636 DEBUG                    Generating certificate signature for serial: 85572
15:49:55.642 DEBUG                    Added keymat IR-INF-CA-TMP: serial=85572 auth=0xc9020cefbb66368c subj=0xd0dc463b09bc6e01
15:49:55.642 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:49:55.648 DEBUG                    Generating certificate signature for serial: 20000
15:49:55.655 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:49:55.657 DEBUG                    Generating message signature using cert with serial: 85354
15:49:55.772 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:49:55.772 DEBUG                    Received Inf IA response
15:49:55.773 DEBUG                    Added keymat IR-INF-CA: serial=85572 auth=0xc9020cefbb66368c subj=0xd0dc463b09bc6e01
15:49:55.773 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0xd0dc463b09bc6e01 subj=0x862c0a5b7b0af962
15:49:55.783 DEBUG                    Generating certificate signature for serial: 5
15:49:55.788 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xa966971a20e2bb53 subj=0xa966971a20e2bb53
15:49:55.797 DEBUG                    Generating message signature using cert with serial: 20000
15:49:55.832 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:49:55.849 DEBUG                    Generating message signature using cert with serial: 20000
15:49:55.930 DEBUG                    IR: Handling Certificate Signing Request.
15:49:55.931 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:49:55.937 DEBUG                    Generating certificate signature for serial: 20001
15:49:55.944 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:49:55.947 DEBUG                    Generating message signature using cert with serial: 85354
15:49:56.042 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:49:56.042 DEBUG                    Received Inf CA response
15:49:56.042 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x5b93455f27ffe100
15:49:56.042 INFO                     Listening for ('128.10.1.4', 80)
15:49:56.047 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:49:56.051 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:49:56.051 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:49:56.101 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xa966971a20e2bb53 subj=0xa966971a20e2bb53
15:49:56.107 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:49:56.123 DEBUG                    Generating message signature using cert with serial: 5
15:49:56.180 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:49:56.186 DEBUG                    Generating certificate signature for serial: 20000
15:49:56.192 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:49:56.195 DEBUG                    Generating message signature using cert with serial: 20000
15:49:56.311 DEBUG                    Received Inf IA response
15:49:56.312 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x5b93455f27ffe100
15:49:56.312 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x5b93455f27ffe100 subj=0x613e45cfe00a183d
15:49:56.316 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:49:56.321 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:49:56.372 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xa966971a20e2bb53 subj=0xa966971a20e2bb53
15:49:56.372 INFO                     Listening for ('128.10.1.6', 80)
15:49:56.373 DEBUG                    MCKM requesting Inf IA from ICM.
15:49:56.379 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:49:56.396 DEBUG                    Generating message signature using cert with serial: 5
15:49:56.414 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:49:56.415 INFO                     SKD: Client ---> Server CMC-request (1341 bytes)
15:49:56.415 INFO                     Sent CSR for Inf IA certificate.
15:49:56.416 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:56.416 DEBUG                    106062544: Connect accepted from Client
15:49:56.465 DEBUG                    Connected to Server
15:49:56.466 DEBUG                    Connected to Server
15:49:56.515 DEBUG                    Sending HTTP POST /fullcmc message.
15:49:56.516 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:49:56.516 DEBUG                    Sending HTTP GET /status_2 message.
15:49:56.516 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:56.559 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:49:56.559 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:49:56.566 DEBUG                    Generating certificate signature for serial: 20001
15:49:56.576 DEBUG                    Generating message signature using cert with serial: 20000
15:49:56.630 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:49:56.632 DEBUG                    HTTP Status: 200 - OK
15:49:56.632 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3140 bytes)
15:49:56.697 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:49:56.697 DEBUG                    Received Inf IA response
15:49:56.698 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x5b93455f27ffe100
15:49:56.698 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x5b93455f27ffe100 subj=0x4eca515ff199dcea
15:49:56.698 DEBUG                    HTTP Status: 200 - OK
15:49:56.699 DEBUG                    Connect closed for Server
15:49:56.699 DEBUG                    Connect closed for Server
15:49:58.422 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:49:58.475 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xa966971a20e2bb53 subj=0xa966971a20e2bb53
15:49:58.475 DEBUG                    CKA requesting Inf IA from ICM.
15:49:58.481 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:49:58.499 DEBUG                    Generating message signature using cert with serial: 5
15:49:58.518 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:49:58.518 INFO                     SKD: Client ---> Server CMC-request (1329 bytes)
15:49:58.518 INFO                     Sent CSR for Inf IA certificate.
15:49:58.519 DEBUG                    106062544: Connect accepted from Client
15:49:58.519 DEBUG                    Connect closed for Server
15:49:58.520 DEBUG                    Connect closed for Server
15:49:58.570 DEBUG                    Connected to Server
15:49:58.619 DEBUG                    Sending HTTP POST /fullcmc message.
15:49:58.619 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:49:58.662 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:49:58.663 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:49:58.670 DEBUG                    Generating certificate signature for serial: 20002
15:49:58.680 DEBUG                    Generating message signature using cert with serial: 20000
15:49:58.737 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:49:58.737 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:49:58.739 DEBUG                    HTTP Status: 200 - OK
15:49:58.739 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3128 bytes)
15:49:58.808 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:49:58.809 DEBUG                    Received Inf IA response
15:49:58.809 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x5b93455f27ffe100
15:49:58.810 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x5b93455f27ffe100 subj=0xf0cb5dbedc6cdcf6
15:49:58.810 DEBUG                    Connected to Server
15:49:58.838 DEBUG                    Sending HTTP GET /status_2 message.
15:49:58.839 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:49:58.888 DEBUG                    HTTP Status: 200 - OK
15:49:58.889 DEBUG                    Connect closed for Server
15:49:58.890 DEBUG                    Connect closed for Server
15:50:00.891 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:00.942 DEBUG                    Connected to Server
15:50:00.993 DEBUG                    Sending HTTP GET /status_2 message.
15:50:00.994 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:50:01.092 DEBUG                    HTTP Status: 200 - OK
15:50:01.093 DEBUG                    Connect closed for Server
15:50:01.093 DEBUG                    Connect closed for Server
15:50:02.722 DEBUG                    ########## Mocks complete ##########
15:50:02.723 DEBUG                    UUT Control: Applying all recent configuration changes
15:50:02.747 INFO    Test:            102 : [icm-snmp-e2e-auth-priv] Confirm that the
|                                           UUT supports the use of end-to-end
|                                           authentication as specified in RFC 3414.
15:50:02.760 INFO                           #> 0.1. Set the SNMP authentication to the correct values.
15:50:02.760 INFO                           #> 0.2. Check that password is configured
15:50:02.762 DEBUG                          New credentials: UsmUserData(userName='fred', authKey=<AUTHKEY>, privKey=<PRIVKEY>, authProtocol=(1, 3, 6, 1, 6, 3, 10, 1, 1, 3), privProtocol=(1, 3, 6, 1, 6, 3, 10, 1, 2, 4), securityEngineId='<DEFAULT>', securityName='fred')
15:50:02.766 INFO                           #> 0.3. Do a read on the BONDSTONE-DEVICE-MIB (supported by all SKD devices) and check for success.
15:50:03.094 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:03.145 DEBUG                          Connected to Server
15:50:03.195 DEBUG                          Sending HTTP GET /status_2 message.
15:50:03.196 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:03.290 DEBUG                          HTTP Status: 200 - OK
15:50:03.291 DEBUG                          Connect closed for Server
15:50:03.296 DEBUG                          Connect closed for Server
15:50:03.465 INFO                           #> 0.4. Use the wrong priv protocol and check for failure.
15:50:03.466 DEBUG                          New credentials: UsmUserData(userName='fred', authKey=<AUTHKEY>, privKey=<PRIVKEY>, authProtocol=(1, 3, 6, 1, 6, 3, 10, 1, 1, 3), privProtocol=(1, 3, 6, 1, 6, 3, 10, 1, 2, 2), securityEngineId='<DEFAULT>', securityName='fred')
15:50:05.291 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:05.343 DEBUG                          Connected to Server
15:50:05.392 DEBUG                          Sending HTTP GET /status_2 message.
15:50:05.393 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:05.489 DEBUG                          HTTP Status: 200 - OK
15:50:05.490 DEBUG                          Connect closed for Server
15:50:05.491 DEBUG                          Connect closed for Server
15:50:07.490 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:07.541 DEBUG                          Connected to Server
15:50:07.591 DEBUG                          Sending HTTP GET /status_2 message.
15:50:07.591 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:07.690 DEBUG                          HTTP Status: 200 - OK
15:50:07.691 DEBUG                          Connect closed for Server
15:50:07.691 DEBUG                          Connect closed for Server
15:50:09.691 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:09.742 DEBUG                          Connected to Server
15:50:09.792 DEBUG                          Sending HTTP GET /status_2 message.
15:50:09.792 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:09.891 DEBUG                          HTTP Status: 200 - OK
15:50:09.891 DEBUG                          Connect closed for Server
15:50:09.892 DEBUG                          Connect closed for Server
15:50:11.891 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:11.942 DEBUG                          Connected to Server
15:50:11.992 DEBUG                          Sending HTTP GET /status_2 message.
15:50:11.993 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:12.091 DEBUG                          HTTP Status: 200 - OK
15:50:12.092 DEBUG                          Connect closed for Server
15:50:12.093 DEBUG                          Connect closed for Server
15:50:14.092 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:14.143 DEBUG                          Connected to Server
15:50:14.193 DEBUG                          Sending HTTP GET /status_2 message.
15:50:14.194 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:14.292 DEBUG                          HTTP Status: 200 - OK
15:50:14.293 DEBUG                          Connect closed for Server
15:50:14.294 DEBUG                          Connect closed for Server
15:50:16.295 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:16.346 DEBUG                          Connected to Server
15:50:16.396 DEBUG                          Sending HTTP GET /status_2 message.
15:50:16.396 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:16.488 DEBUG                          HTTP Status: 200 - OK
15:50:16.489 DEBUG                          Connect closed for Server
15:50:16.490 DEBUG                          Connect closed for Server
15:50:18.489 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:18.540 DEBUG                          Connected to Server
15:50:18.590 DEBUG                          Sending HTTP GET /status_2 message.
15:50:18.591 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:18.693 DEBUG                          HTTP Status: 200 - OK
15:50:18.695 DEBUG                          Connect closed for Server
15:50:18.697 DEBUG                          Connect closed for Server
15:50:20.694 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:20.746 DEBUG                          Connected to Server
15:50:20.795 DEBUG                          Sending HTTP GET /status_2 message.
15:50:20.796 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:20.889 DEBUG                          HTTP Status: 200 - OK
15:50:20.890 DEBUG                          Connect closed for Server
15:50:20.892 DEBUG                          Connect closed for Server
15:50:22.890 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:22.941 DEBUG                          Connected to Server
15:50:22.991 DEBUG                          Sending HTTP GET /status_2 message.
15:50:22.992 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:23.091 DEBUG                          HTTP Status: 200 - OK
15:50:23.092 DEBUG                          Connect closed for Server
15:50:23.092 DEBUG                          Connect closed for Server
15:50:24.082 WARNING                        SNMP: Timout ('get', 'BONDSTONE-DEVICE-MIB::bsElectronicSerialNumber.0', '')
15:50:24.083 INFO                           #> 0.5. Use the wrong auth protocol and check for failure.
15:50:24.085 DEBUG                          New credentials: UsmUserData(userName='fred', authKey=<AUTHKEY>, privKey=<PRIVKEY>, authProtocol=(1, 3, 6, 1, 6, 3, 10, 1, 1, 2), privProtocol=(1, 3, 6, 1, 6, 3, 10, 1, 2, 4), securityEngineId='<DEFAULT>', securityName='fred')
15:50:25.093 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:25.144 DEBUG                          Connected to Server
15:50:25.194 DEBUG                          Sending HTTP GET /status_2 message.
15:50:25.196 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:25.294 DEBUG                          HTTP Status: 200 - OK
15:50:25.296 DEBUG                          Connect closed for Server
15:50:25.297 DEBUG                          Connect closed for Server
15:50:27.295 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:27.346 DEBUG                          Connected to Server
15:50:27.396 DEBUG                          Sending HTTP GET /status_2 message.
15:50:27.397 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:27.490 DEBUG                          HTTP Status: 200 - OK
15:50:27.492 DEBUG                          Connect closed for Server
15:50:27.493 DEBUG                          Connect closed for Server
15:50:29.492 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:29.543 DEBUG                          Connected to Server
15:50:29.593 DEBUG                          Sending HTTP GET /status_2 message.
15:50:29.594 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:29.690 DEBUG                          HTTP Status: 200 - OK
15:50:29.692 DEBUG                          Connect closed for Server
15:50:29.692 DEBUG                          Connect closed for Server
15:50:31.691 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:31.742 DEBUG                          Connected to Server
15:50:31.792 DEBUG                          Sending HTTP GET /status_2 message.
15:50:31.793 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:31.889 DEBUG                          HTTP Status: 200 - OK
15:50:31.890 DEBUG                          Connect closed for Server
15:50:31.890 DEBUG                          Connect closed for Server
15:50:33.890 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:33.941 DEBUG                          Connected to Server
15:50:33.991 DEBUG                          Sending HTTP GET /status_2 message.
15:50:33.992 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:34.091 DEBUG                          HTTP Status: 200 - OK
15:50:34.092 DEBUG                          Connect closed for Server
15:50:34.093 DEBUG                          Connect closed for Server
15:50:36.092 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:36.143 DEBUG                          Connected to Server
15:50:36.192 DEBUG                          Sending HTTP GET /status_2 message.
15:50:36.193 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:36.290 DEBUG                          HTTP Status: 200 - OK
15:50:36.291 DEBUG                          Connect closed for Server
15:50:36.293 DEBUG                          Connect closed for Server
15:50:38.291 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:38.342 DEBUG                          Connected to Server
15:50:38.392 DEBUG                          Sending HTTP GET /status_2 message.
15:50:38.393 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:38.488 DEBUG                          HTTP Status: 200 - OK
15:50:38.489 DEBUG                          Connect closed for Server
15:50:38.490 DEBUG                          Connect closed for Server
15:50:40.489 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:40.540 DEBUG                          Connected to Server
15:50:40.590 DEBUG                          Sending HTTP GET /status_2 message.
15:50:40.590 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:40.689 DEBUG                          HTTP Status: 200 - OK
15:50:40.690 DEBUG                          Connect closed for Server
15:50:40.691 DEBUG                          Connect closed for Server
15:50:42.690 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:42.741 DEBUG                          Connected to Server
15:50:42.791 DEBUG                          Sending HTTP GET /status_2 message.
15:50:42.792 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:42.894 DEBUG                          HTTP Status: 200 - OK
15:50:42.895 DEBUG                          Connect closed for Server
15:50:42.897 DEBUG                          Connect closed for Server
15:50:44.788 WARNING                        SNMP: Timout ('get', 'BONDSTONE-DEVICE-MIB::bsElectronicSerialNumber.0', '')
15:50:44.789 INFO                           #> 0.6. Use the wrong priv key and check for failure.
15:50:44.790 DEBUG                          New credentials: UsmUserData(userName='fred', authKey=<AUTHKEY>, privKey=<PRIVKEY>, authProtocol=(1, 3, 6, 1, 6, 3, 10, 1, 1, 3), privProtocol=(1, 3, 6, 1, 6, 3, 10, 1, 2, 4), securityEngineId='<DEFAULT>', securityName='fred')
15:50:44.895 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:44.954 DEBUG                          Connected to Server
15:50:45.004 DEBUG                          Sending HTTP GET /status_2 message.
15:50:45.005 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:45.090 DEBUG                          HTTP Status: 200 - OK
15:50:45.091 DEBUG                          Connect closed for Server
15:50:45.104 DEBUG                          Connect closed for Server
15:50:47.091 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:47.142 DEBUG                          Connected to Server
15:50:47.192 DEBUG                          Sending HTTP GET /status_2 message.
15:50:47.193 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:47.290 DEBUG                          HTTP Status: 200 - OK
15:50:47.291 DEBUG                          Connect closed for Server
15:50:47.292 DEBUG                          Connect closed for Server
15:50:49.291 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:49.342 DEBUG                          Connected to Server
15:50:49.392 DEBUG                          Sending HTTP GET /status_2 message.
15:50:49.392 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:49.489 DEBUG                          HTTP Status: 200 - OK
15:50:49.489 DEBUG                          Connect closed for Server
15:50:49.490 DEBUG                          Connect closed for Server
15:50:51.489 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:51.540 DEBUG                          Connected to Server
15:50:51.590 DEBUG                          Sending HTTP GET /status_2 message.
15:50:51.591 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:51.688 DEBUG                          HTTP Status: 200 - OK
15:50:51.689 DEBUG                          Connect closed for Server
15:50:51.690 DEBUG                          Connect closed for Server
15:50:53.689 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:53.740 DEBUG                          Connected to Server
15:50:53.790 DEBUG                          Sending HTTP GET /status_2 message.
15:50:53.791 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:53.892 DEBUG                          HTTP Status: 200 - OK
15:50:53.893 DEBUG                          Connect closed for Server
15:50:53.894 DEBUG                          Connect closed for Server
15:50:55.893 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:55.944 DEBUG                          Connected to Server
15:50:55.994 DEBUG                          Sending HTTP GET /status_2 message.
15:50:55.995 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:56.090 DEBUG                          HTTP Status: 200 - OK
15:50:56.091 DEBUG                          Connect closed for Server
15:50:56.092 DEBUG                          Connect closed for Server
15:50:58.091 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:50:58.142 DEBUG                          Connected to Server
15:50:58.192 DEBUG                          Sending HTTP GET /status_2 message.
15:50:58.194 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:50:58.289 DEBUG                          HTTP Status: 200 - OK
15:50:58.290 DEBUG                          Connect closed for Server
15:50:58.291 DEBUG                          Connect closed for Server
15:51:00.290 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:00.341 DEBUG                          Connected to Server
15:51:00.390 DEBUG                          Sending HTTP GET /status_2 message.
15:51:00.391 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:51:00.488 DEBUG                          HTTP Status: 200 - OK
15:51:00.489 DEBUG                          Connect closed for Server
15:51:00.490 DEBUG                          Connect closed for Server
15:51:02.489 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:02.540 DEBUG                          Connected to Server
15:51:02.590 DEBUG                          Sending HTTP GET /status_2 message.
15:51:02.591 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:51:02.693 DEBUG                          HTTP Status: 200 - OK
15:51:02.694 DEBUG                          Connect closed for Server
15:51:02.695 DEBUG                          Connect closed for Server
15:51:04.694 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:04.745 DEBUG                          Connected to Server
15:51:04.795 DEBUG                          Sending HTTP GET /status_2 message.
15:51:04.796 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:51:04.891 DEBUG                          HTTP Status: 200 - OK
15:51:04.893 DEBUG                          Connect closed for Server
15:51:04.893 DEBUG                          Connect closed for Server
15:51:05.508 WARNING                        SNMP: Timout ('get', 'BONDSTONE-DEVICE-MIB::bsElectronicSerialNumber.0', '')
15:51:05.509 INFO                           #> 0.7. Use the wrong auth key and check for failure.
15:51:05.510 DEBUG                          New credentials: UsmUserData(userName='fred', authKey=<AUTHKEY>, privKey=<PRIVKEY>, authProtocol=(1, 3, 6, 1, 6, 3, 10, 1, 1, 3), privProtocol=(1, 3, 6, 1, 6, 3, 10, 1, 2, 4), securityEngineId='<DEFAULT>', securityName='fred')
15:51:06.279 INFO    Test:                  PASS
15:51:06.425 DEBUG                    Tearing down mock HTTP servers
15:51:06.428 DEBUG                    Connect closed for Server
15:51:06.428 DEBUG                    Connect closed for Server
15:51:06.610 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:51:06.610 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:51:06.623 DEBUG                    Generating certificate signature for serial: 80730
15:51:06.629 DEBUG                    Added keymat IR-INF-CA: serial=80730 auth=0xc9020cefbb66368c subj=0x1fda3f33ef3c2b1c
15:51:06.640 DEBUG                    Generating certificate signature for serial: 80389
15:51:06.646 DEBUG                    Added keymat IR-INF-IA: serial=80389 auth=0x1fda3f33ef3c2b1c subj=0x6184a03142519f25
15:51:06.658 DEBUG                    Generating certificate signature for serial: 88788
15:51:06.664 DEBUG                    Added keymat IR-INF-CRL-CA: serial=88788 auth=0xc9020cefbb66368c subj=0xbda727783eb0616f
15:51:06.676 DEBUG                    Generating certificate signature for serial: 82385
15:51:06.682 DEBUG                    Added keymat IR-INF-CRL-IA: serial=82385 auth=0xbda727783eb0616f subj=0xb6110b9c27a50f47
15:51:06.692 DEBUG                    Generating certificate signature for serial: 5
15:51:06.698 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xa89839625337a84d subj=0xa89839625337a84d
15:51:06.706 DEBUG                    Generating message signature using cert with serial: 80389
15:51:06.740 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:51:06.791 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xa89839625337a84d subj=0xa89839625337a84d
15:51:06.797 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:51:06.814 DEBUG                    Generating message signature using cert with serial: 5
15:51:06.871 DEBUG                    IR: Handling Certificate Signing Request.
15:51:06.871 DEBUG                    Creating temporary CA cert to issue IA
15:51:06.883 DEBUG                    Generating certificate signature for serial: 86710
15:51:06.888 DEBUG                    Added keymat IR-INF-CA-TMP: serial=86710 auth=0xc9020cefbb66368c subj=0x0605d0a8d5d5cbe6
15:51:06.889 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:51:06.895 DEBUG                    Generating certificate signature for serial: 20000
15:51:06.902 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:51:06.905 DEBUG                    Generating message signature using cert with serial: 80389
15:51:07.024 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:51:07.025 DEBUG                    Received Inf IA response
15:51:07.025 DEBUG                    Added keymat IR-INF-CA: serial=86710 auth=0xc9020cefbb66368c subj=0x0605d0a8d5d5cbe6
15:51:07.025 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x0605d0a8d5d5cbe6 subj=0x65e2d47fe5f7a163
15:51:07.036 DEBUG                    Generating certificate signature for serial: 5
15:51:07.041 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xf6091fd936c52527 subj=0xf6091fd936c52527
15:51:07.050 DEBUG                    Generating message signature using cert with serial: 20000
15:51:07.085 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:51:07.103 DEBUG                    Generating message signature using cert with serial: 20000
15:51:07.186 DEBUG                    IR: Handling Certificate Signing Request.
15:51:07.187 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:51:07.193 DEBUG                    Generating certificate signature for serial: 20001
15:51:07.200 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:51:07.202 DEBUG                    Generating message signature using cert with serial: 80389
15:51:07.297 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:51:07.298 DEBUG                    Received Inf CA response
15:51:07.298 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x066578e9d46b69ec
15:51:07.298 INFO                     Listening for ('128.10.1.4', 80)
15:51:07.303 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:51:07.307 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:51:07.307 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:51:07.357 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xf6091fd936c52527 subj=0xf6091fd936c52527
15:51:07.363 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:51:07.380 DEBUG                    Generating message signature using cert with serial: 5
15:51:07.438 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:51:07.444 DEBUG                    Generating certificate signature for serial: 20000
15:51:07.451 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:51:07.453 DEBUG                    Generating message signature using cert with serial: 20000
15:51:07.572 DEBUG                    Received Inf IA response
15:51:07.572 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x066578e9d46b69ec
15:51:07.573 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x066578e9d46b69ec subj=0x281b1d9979f2d335
15:51:07.577 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:51:07.581 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:51:07.630 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xf6091fd936c52527 subj=0xf6091fd936c52527
15:51:07.631 INFO                     Listening for ('128.10.1.6', 80)
15:51:07.631 DEBUG                    MCKM requesting Inf IA from ICM.
15:51:07.637 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:51:07.654 DEBUG                    Generating message signature using cert with serial: 5
15:51:07.672 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:51:07.672 INFO                     SKD: Client ---> Server CMC-request (1342 bytes)
15:51:07.672 INFO                     Sent CSR for Inf IA certificate.
15:51:07.673 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:07.674 DEBUG                    108064080: Connect accepted from Client
15:51:07.722 DEBUG                    Connected to Server
15:51:07.723 DEBUG                    Connected to Server
15:51:07.773 DEBUG                    Sending HTTP POST /fullcmc message.
15:51:07.773 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:51:07.774 DEBUG                    Sending HTTP GET /status_2 message.
15:51:07.774 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:07.818 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:51:07.819 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:51:07.825 DEBUG                    Generating certificate signature for serial: 20001
15:51:07.836 DEBUG                    Generating message signature using cert with serial: 20000
15:51:07.890 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:51:07.891 DEBUG                    HTTP Status: 200 - OK
15:51:07.892 DEBUG                    HTTP Status: 200 - OK
15:51:07.892 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3138 bytes)
15:51:07.958 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:51:07.958 DEBUG                    Received Inf IA response
15:51:07.958 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x066578e9d46b69ec
15:51:07.959 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x066578e9d46b69ec subj=0x94580da42db4d0a6
15:51:07.959 DEBUG                    Connect closed for Server
15:51:07.959 DEBUG                    Connect closed for Server
15:51:09.678 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:51:09.729 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xf6091fd936c52527 subj=0xf6091fd936c52527
15:51:09.729 DEBUG                    CKA requesting Inf IA from ICM.
15:51:09.735 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:51:09.752 DEBUG                    Generating message signature using cert with serial: 5
15:51:09.771 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:51:09.771 INFO                     SKD: Client ---> Server CMC-request (1328 bytes)
15:51:09.771 INFO                     Sent CSR for Inf IA certificate.
15:51:09.772 DEBUG                    108064080: Connect accepted from Client
15:51:09.772 DEBUG                    Connect closed for Server
15:51:09.773 DEBUG                    Connect closed for Server
15:51:09.823 DEBUG                    Connected to Server
15:51:09.875 DEBUG                    Sending HTTP POST /fullcmc message.
15:51:09.876 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:51:09.916 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:51:09.916 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:51:09.923 DEBUG                    Generating certificate signature for serial: 20002
15:51:09.932 DEBUG                    Generating message signature using cert with serial: 20000
15:51:09.986 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:51:09.987 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:09.988 DEBUG                    HTTP Status: 200 - OK
15:51:09.989 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3128 bytes)
15:51:10.055 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:51:10.055 DEBUG                    Received Inf IA response
15:51:10.055 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x066578e9d46b69ec
15:51:10.056 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x066578e9d46b69ec subj=0xe9d69450c6e36899
15:51:10.056 DEBUG                    Connected to Server
15:51:10.087 DEBUG                    Sending HTTP GET /status_2 message.
15:51:10.088 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:10.190 DEBUG                    HTTP Status: 200 - OK
15:51:10.190 DEBUG                    Connect closed for Server
15:51:10.191 DEBUG                    Connect closed for Server
15:51:12.190 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:12.241 DEBUG                    Connected to Server
15:51:12.291 DEBUG                    Sending HTTP GET /status_2 message.
15:51:12.292 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:12.389 DEBUG                    HTTP Status: 200 - OK
15:51:12.389 DEBUG                    Connect closed for Server
15:51:12.390 DEBUG                    Connect closed for Server
15:51:13.981 DEBUG                    ########## Mocks complete ##########
15:51:13.982 DEBUG                    UUT Control: Applying all recent configuration changes
15:51:14.005 INFO    Test:            104 : [icm-snmp-check-last-changed-and-table-
|                                           count] Check that Table Count and Last
|                                           Changed are updated.
15:51:14.015 INFO                           #> 0.1. Do a read on the BONDSTONE-DEVICE-MIB::FileImportTable (supported by all SKD devices) and check for success.
15:51:14.390 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:14.441 DEBUG                          Connected to Server
15:51:14.491 DEBUG                          Sending HTTP GET /status_2 message.
15:51:14.492 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:51:14.550 INFO                           #> 0.2. Wait a few seconds then make a second change to the tables.  Check that the last changed value has incremented by the correct number of seconds as measured by the UUT clock.
15:51:14.588 DEBUG                          HTTP Status: 200 - OK
15:51:14.589 DEBUG                          Connect closed for Server
15:51:14.590 DEBUG                          Connect closed for Server
15:51:16.589 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:16.641 DEBUG                          Connected to Server
15:51:16.691 DEBUG                          Sending HTTP GET /status_2 message.
15:51:16.692 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:51:16.791 DEBUG                          HTTP Status: 200 - OK
15:51:16.793 DEBUG                          Connect closed for Server
15:51:16.793 DEBUG                          Connect closed for Server
15:51:18.794 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:18.845 DEBUG                          Connected to Server
15:51:18.896 DEBUG                          Sending HTTP GET /status_2 message.
15:51:18.897 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:51:18.990 DEBUG                          HTTP Status: 200 - OK
15:51:18.991 DEBUG                          Connect closed for Server
15:51:18.992 DEBUG                          Connect closed for Server
15:51:20.085 INFO    Test:                  PASS
15:51:20.208 DEBUG                    Tearing down mock HTTP servers
15:51:20.211 DEBUG                    Connect closed for Server
15:51:20.212 DEBUG                    Connect closed for Server
15:51:20.758 INFO    Suite:       Tests for ICM issuing InfIA certificate to a CKA
15:51:20.775 INFO    Suite:         ICM Infrastructure IA certificate issuing to CKA
|                                   tests.
15:51:20.795 INFO                     Memory (RSS) before suite setup: 113.64 MByte  (1.09)
15:51:20.802 INFO                     Memory (Virt) before suite setup: 659.78 MByte  (369.74)
15:51:20.810 INFO                     Memory (RSS) after suite setup: 113.64 MByte  (0.00)
15:51:20.818 INFO                     Memory (Virt) after suite setup: 659.78 MByte  (0.00)
15:51:20.962 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:51:20.963 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:51:20.975 DEBUG                    Generating certificate signature for serial: 80264
15:51:20.981 DEBUG                    Added keymat IR-INF-CA: serial=80264 auth=0xc9020cefbb66368c subj=0x17789dadd9c80de1
15:51:20.994 DEBUG                    Generating certificate signature for serial: 81258
15:51:21.000 DEBUG                    Added keymat IR-INF-IA: serial=81258 auth=0x17789dadd9c80de1 subj=0x7689d4158c03a9d1
15:51:21.013 DEBUG                    Generating certificate signature for serial: 85888
15:51:21.019 DEBUG                    Added keymat IR-INF-CRL-CA: serial=85888 auth=0xc9020cefbb66368c subj=0x25a6cd4d458e2677
15:51:21.032 DEBUG                    Generating certificate signature for serial: 89749
15:51:21.038 DEBUG                    Added keymat IR-INF-CRL-IA: serial=89749 auth=0x25a6cd4d458e2677 subj=0x5b0fd90f11283d27
15:51:21.049 DEBUG                    Generating certificate signature for serial: 5
15:51:21.055 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x9e52f90e08f649c9 subj=0x9e52f90e08f649c9
15:51:21.064 DEBUG                    Generating message signature using cert with serial: 81258
15:51:21.100 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:51:21.154 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x9e52f90e08f649c9 subj=0x9e52f90e08f649c9
15:51:21.160 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:51:21.178 DEBUG                    Generating message signature using cert with serial: 5
15:51:21.238 DEBUG                    IR: Handling Certificate Signing Request.
15:51:21.239 DEBUG                    Creating temporary CA cert to issue IA
15:51:21.251 DEBUG                    Generating certificate signature for serial: 83658
15:51:21.257 DEBUG                    Added keymat IR-INF-CA-TMP: serial=83658 auth=0xc9020cefbb66368c subj=0x977c036880de851a
15:51:21.257 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:51:21.263 DEBUG                    Generating certificate signature for serial: 20000
15:51:21.270 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:51:21.273 DEBUG                    Generating message signature using cert with serial: 81258
15:51:21.389 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:51:21.390 DEBUG                    Received Inf IA response
15:51:21.390 DEBUG                    Added keymat IR-INF-CA: serial=83658 auth=0xc9020cefbb66368c subj=0x977c036880de851a
15:51:21.390 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x977c036880de851a subj=0x99b6b72536322b98
15:51:21.400 DEBUG                    Generating certificate signature for serial: 5
15:51:21.406 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xeec0f3393e51b8ba subj=0xeec0f3393e51b8ba
15:51:21.414 DEBUG                    Generating message signature using cert with serial: 20000
15:51:21.450 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:51:21.467 DEBUG                    Generating message signature using cert with serial: 20000
15:51:21.549 DEBUG                    IR: Handling Certificate Signing Request.
15:51:21.550 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:51:21.556 DEBUG                    Generating certificate signature for serial: 20001
15:51:21.563 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:51:21.566 DEBUG                    Generating message signature using cert with serial: 81258
15:51:21.661 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:51:21.661 DEBUG                    Received Inf CA response
15:51:21.662 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x2e04c550dc0325a8
15:51:21.662 INFO                     Listening for ('128.10.1.4', 80)
15:51:21.666 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:51:21.670 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:51:21.670 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:51:21.721 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xeec0f3393e51b8ba subj=0xeec0f3393e51b8ba
15:51:21.727 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:51:21.744 DEBUG                    Generating message signature using cert with serial: 5
15:51:21.800 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:51:21.807 DEBUG                    Generating certificate signature for serial: 20000
15:51:21.813 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:51:21.816 DEBUG                    Generating message signature using cert with serial: 20000
15:51:21.930 DEBUG                    Received Inf IA response
15:51:21.930 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x2e04c550dc0325a8
15:51:21.931 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x2e04c550dc0325a8 subj=0x07ed8528ee270f73
15:51:21.935 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:51:21.939 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:51:21.989 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xeec0f3393e51b8ba subj=0xeec0f3393e51b8ba
15:51:21.989 INFO                     Listening for ('128.10.1.6', 80)
15:51:21.989 DEBUG                    MCKM requesting Inf IA from ICM.
15:51:21.995 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:51:22.012 DEBUG                    Generating message signature using cert with serial: 5
15:51:22.029 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:51:22.030 INFO                     SKD: Client ---> Server CMC-request (1340 bytes)
15:51:22.030 INFO                     Sent CSR for Inf IA certificate.
15:51:22.031 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:22.031 DEBUG                    113850320: Connect accepted from Client
15:51:22.080 DEBUG                    Connected to Server
15:51:22.081 DEBUG                    Connected to Server
15:51:22.130 DEBUG                    Sending HTTP POST /fullcmc message.
15:51:22.130 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:51:22.131 DEBUG                    Sending HTTP GET /status_2 message.
15:51:22.131 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:22.175 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:51:22.176 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:51:22.182 DEBUG                    Generating certificate signature for serial: 20001
15:51:22.194 DEBUG                    Generating message signature using cert with serial: 20000
15:51:22.247 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:51:22.248 DEBUG                    HTTP Status: 200 - OK
15:51:22.249 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3135 bytes)
15:51:22.312 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:51:22.313 DEBUG                    Received Inf IA response
15:51:22.313 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x2e04c550dc0325a8
15:51:22.313 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x2e04c550dc0325a8 subj=0x416bc8a456e5029a
15:51:22.314 DEBUG                    HTTP Status: 200 - OK
15:51:22.314 DEBUG                    Connect closed for Server
15:51:22.314 DEBUG                    Connect closed for Server
15:51:24.038 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:51:24.091 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xeec0f3393e51b8ba subj=0xeec0f3393e51b8ba
15:51:24.092 DEBUG                    CKA requesting Inf IA from ICM.
15:51:24.098 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:51:24.115 DEBUG                    Generating message signature using cert with serial: 5
15:51:24.133 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:51:24.134 INFO                     SKD: Client ---> Server CMC-request (1332 bytes)
15:51:24.134 INFO                     Sent CSR for Inf IA certificate.
15:51:24.135 DEBUG                    113850320: Connect accepted from Client
15:51:24.135 DEBUG                    Connect closed for Server
15:51:24.135 DEBUG                    Connect closed for Server
15:51:24.185 DEBUG                    Connected to Server
15:51:24.239 DEBUG                    Sending HTTP POST /fullcmc message.
15:51:24.239 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:51:24.279 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:51:24.280 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:51:24.286 DEBUG                    Generating certificate signature for serial: 20002
15:51:24.296 DEBUG                    Generating message signature using cert with serial: 20000
15:51:24.350 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:51:24.351 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:24.353 DEBUG                    HTTP Status: 200 - OK
15:51:24.353 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3124 bytes)
15:51:24.419 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:51:24.419 DEBUG                    Received Inf IA response
15:51:24.419 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x2e04c550dc0325a8
15:51:24.419 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x2e04c550dc0325a8 subj=0xb0be59da451509cf
15:51:24.420 DEBUG                    Connected to Server
15:51:24.451 DEBUG                    Sending HTTP GET /status_2 message.
15:51:24.452 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:24.487 DEBUG                    HTTP Status: 200 - OK
15:51:24.488 DEBUG                    Connect closed for Server
15:51:24.489 DEBUG                    Connect closed for Server
15:51:26.489 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:26.540 DEBUG                    Connected to Server
15:51:26.591 DEBUG                    Sending HTTP GET /status_2 message.
15:51:26.592 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:26.690 DEBUG                    HTTP Status: 200 - OK
15:51:26.691 DEBUG                    Connect closed for Server
15:51:26.691 DEBUG                    Connect closed for Server
15:51:28.341 DEBUG                    ########## Mocks complete ##########
15:51:28.479 DEBUG                    UUT Control: Applying all recent configuration changes
15:51:28.511 DEBUG                    Generating certificate signature for serial: 5
15:51:28.518 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xf8894f8704235fb5 subj=0xf8894f8704235fb5
15:51:28.527 DEBUG                    Generating message signature using cert with serial: 81258
15:51:28.552 DEBUG                    Sending SKD message:
|                                     KeyPackageFile:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = List:
|                                             [0]:
|                                                 OneAsymmetricKey:
|                                                     version == 0
|                                                     privateKeyAlgorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     privateKey = ECPrivateKey:
|                                                         version = 1L
|                                                         privateKey = Octets(0x3239353330313531383239363735383737313836353930363130353436353234373931343430383335333138343534353534343733303531303338333530363539373839343933313439383230313031353739323932353638333930313530343432333238363436323334363533323037333434)
|                                                     attributes:
|                                                       [0] = UserCertificateAttr:
|                                                         id == OID(userCertificate:2.5.4.36)
|                                                         userCertificate = Certificate:
|                                                             tbsCertificate = TBSCertificate:
|                                                                 version == 2
|                                                                 serialNumber = 5L
|                                                                 signatureAlgorithmID = AlgorithmIdentifier:
|                                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                 issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 validity = 170112155128Z..99991231235959Z
|                                                                 subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                     algorithm = AlgorithmIdentifier:
|                                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                         parameters = ECParameters:
|                                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                     subjectPublicKey = long768:296977075699475587671071512449168519118041554995438500137773250590179141234405823485189514933310608694250764996323700921818435130186830393230622828919369051024192875727949899471289476024763155936772975823951888018733803788243787701
|                                                                 _extensions = CertificateExtensions
|                                                                   [0] AuthorityKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                         keyIdentifier = Octets(0xf8894f8704235fb5)
|                                                                   [1] SubjectKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                         id = Octets(0xf8894f8704235fb5)
|                                                                   [2] KeyUsage_CertExt:
|                                                                         extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                         critical = True
|                                                                         uses = ['digitalSignature']
|                                                                   [3] CertificatePolicies_CertExt:
|                                                                         extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                         critical = True
|                                                                         policies:
|                                                                           [0] = PolicyInformation:
|                                                                             id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                             signature = Signature:
|                                                                 r = long384:38921623188933176360092768746417576770531439558969657249601469687460484329132471220755447051454430832578352646312770
|                                                                 s = long384:6132353333638842087369589489096948167897335295901255714650417227343880541343394313468040318605223649329068402499196
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x7689d4158c03a9d1-->0x17789dadd9c80de1-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 81258L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155120Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:661224415953107383755992040422944820715244473101914014258053380741599845726528625050849832477050353043950724200333797468703815289998521139178965361044204101239043921039184016395361878159965261719502536372959815184642564302934616529
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x17789dadd9c80de1)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x7689d4158c03a9d1)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:17876196692337748875272884335007649270547621132713179326742374617346247725295131044959290097383340721775494478191010
|                                                     s = long384:28363644328767937374867876022431716450309449878467430866457092241467673507442523176750758283943248461372411274251352
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 80264L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155120Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:430388254198979228810880620598305661320078215889012005897321787098238386084629468043014979394751611489089418330362583192454146224466033696329271502315115165834112677684952586745371448014019804308807678938735331398353772203959913953
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x17789dadd9c80de1)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:15240003387190757633328697184690791004877715917011724305422481754590586777464977434152769591556503648885842476641521
|                                                     s = long384:23284135347858197090637994500168629753812642123651522117402273905689637564971644453479818383817811481502821201315362
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x7689d4158c03a9d1)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                               [1] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x6763901209548cf0182b6a6e08b4976f22ace70342e15cc8fb8c03b22d5300beab87add41754626efc0847ffa1292e84)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155128Z)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:25219054849414032368300739817836300509895032683837647691658029157790022672822468109134971520881078724576829917762626
|                                                 s = long384:20054394907759993561132021872449704046935563748363342558217548453306047684877739121916039127395647128271661779903653
15:51:28.564 DEBUG                    cmd optimus > keydir
15:51:28.575 DEBUG                    cmd optimus > keydir /tmp/
15:51:28.636 DEBUG                    Factory IA ESN: D8EFF0000005
15:51:28.636 DEBUG                    cmd optimus > keydir ../Keys/
15:51:28.691 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:28.730 DEBUG                    Factory IA ESN: D8EFF0000005
15:51:28.742 DEBUG                    Connected to Server
15:51:28.791 DEBUG                    Sending HTTP GET /status_2 message.
15:51:28.792 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:28.904 DEBUG                    HTTP Status: 200 - OK
15:51:28.905 DEBUG                    Connect closed for Server
15:51:28.906 DEBUG                    Connect closed for Server
15:51:30.907 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:30.959 DEBUG                    Connected to Server
15:51:31.008 DEBUG                    Sending HTTP GET /status_2 message.
15:51:31.009 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:31.108 DEBUG                    HTTP Status: 200 - OK
15:51:31.108 DEBUG                    Connect closed for Server
15:51:31.108 DEBUG                    Connect closed for Server
15:51:31.732 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                     x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                     y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['digitalSignature']
|                                                         [1]:
|                                                             SubjectDirectoryAttributes_CertExt:
|                                                                 extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                 attributes:
|                                                                   [0] = DeviceFunctionAttribute:
|                                                                     id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                     deviceFunctions:
|                                                                       [0] = 1.2.826.0.1145.0.10.3
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:23340065640424952383358116773761790171512933608945426235520986654680206292043972207139036049275990230397201766808826
|                                                 s = long384:33099873345061579327749406969829827787329740033406433270641548650820255062575002052402569026139387970227823790243556
|                                         certificates (1 chains, 1 certificates) = 
|                                           Chains summary:
|                                             0xb00155a4d64d863d-->0xb00155a4d64d863d
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 5L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112154940Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:705322846733252638944776884703037340563629438579780439339350259243068224821513734890375742620607327254968203308423717838930991722347689723513892487806385370163192433390124109755549213817120939343851981632114732910998372206957659709
|                                                         x = 17900683615388952601973798518571962480255121449877751399820389927420841222602864823405383471829770451929705498033136
|                                                         y = 3059876019520272066184075014645430418177522261946938107089827211352966370633302684290141686630114276405045783004733
|                                                     _extensions = CertificateExtensions
|                                                       [0] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xb00155a4d64d863d)
|                                                       [1] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xb00155a4d64d863d)
|                                                       [2] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [3] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:34678799626729585434849322165736761604888175272776141370994330019084553022925155886818281775619121630329195416918606
|                                                     s = long384:23750923569197518236042311083724167641674959001174179077011138810918668878873592730075426926175796723620889856726571
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0xb00155a4d64d863d)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155128Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xaaaabbbb3df6d81f)
|                                                     msgCount = 1L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x26313ba6a935ecd0abcb3726f6b508e4083bd18a08e0d3f85fadf4a06a6dca630ca89565e3d18b46c229ee7db3c57a4a)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:27649862938586351570623920693990744930237466281058684195330775771591522032314059653452794328475834744992702084513995
|                                                 s = long384:2358396449153255032558511439776940495729526700647175896070162919901317140872620925099806081285156024532950253845802
15:51:31.734 DEBUG                    IR: Handling Certificate Signing Request.
15:51:31.734 DEBUG                    Creating temporary CA cert to issue IA
15:51:31.755 DEBUG                    Generating certificate signature for serial: 82825
15:51:31.761 DEBUG                    Added keymat IR-INF-CA-TMP: serial=82825 auth=0xc9020cefbb66368c subj=0x2eb4fc66f0202ec8
15:51:31.761 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:51:31.768 DEBUG                    Generating certificate signature for serial: 20002
15:51:31.775 DEBUG                    Creating SKD message file /tmp/infia.resp
15:51:31.778 DEBUG                    Generating message signature using cert with serial: 81258
15:51:31.818 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 4 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                             0x7689d4158c03a9d1-->0x17789dadd9c80de1-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 81258L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155120Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:661224415953107383755992040422944820715244473101914014258053380741599845726528625050849832477050353043950724200333797468703815289998521139178965361044204101239043921039184016395361878159965261719502536372959815184642564302934616529
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x17789dadd9c80de1)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x7689d4158c03a9d1)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:17876196692337748875272884335007649270547621132713179326742374617346247725295131044959290097383340721775494478191010
|                                                     s = long384:28363644328767937374867876022431716450309449878467430866457092241467673507442523176750758283943248461372411274251352
|                                                 [1.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 80264L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155120Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:430388254198979228810880620598305661320078215889012005897321787098238386084629468043014979394751611489089418330362583192454146224466033696329271502315115165834112677684952586745371448014019804308807678938735331398353772203959913953
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x17789dadd9c80de1)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:15240003387190757633328697184690791004877715917011724305422481754590586777464977434152769591556503648885842476641521
|                                                     s = long384:23284135347858197090637994500168629753812642123651522117402273905689637564971644453479818383817811481502821201315362
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x7689d4158c03a9d1)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155131Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xaaaabbbb3df6d81f)
|                                                     msgCount = 1L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:12122187546560533220857702963915226199123796383422897105141452945287852396121720649650898052393352400269566902649420
|                                                 s = long384:31272002755039081448317784549286766395179485022375539064055162241419595380213189826158942070955593547021084047319094
15:51:33.108 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:33.159 DEBUG                    Connected to Server
15:51:33.209 DEBUG                    Sending HTTP GET /status_2 message.
15:51:33.209 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:33.287 DEBUG                    HTTP Status: 200 - OK
15:51:33.292 DEBUG                    Connect closed for Server
15:51:33.292 DEBUG                    Connect closed for Server
15:51:35.292 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:35.343 DEBUG                    Connected to Server
15:51:35.392 DEBUG                    Sending HTTP GET /status_2 message.
15:51:35.393 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:35.502 DEBUG                    HTTP Status: 200 - OK
15:51:35.502 DEBUG                    Connect closed for Server
15:51:35.502 DEBUG                    Connect closed for Server
15:51:36.353 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:51:36.354 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:51:37.296 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:51:37.296 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:51:37.502 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:37.553 DEBUG                    Connected to Server
15:51:37.603 DEBUG                    Sending HTTP GET /status_2 message.
15:51:37.603 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:37.702 DEBUG                    HTTP Status: 200 - OK
15:51:37.702 DEBUG                    Connect closed for Server
15:51:37.704 DEBUG                    Connect closed for Server
15:51:39.703 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:39.753 DEBUG                    Connected to Server
15:51:39.803 DEBUG                    Sending HTTP GET /status_2 message.
15:51:39.804 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:39.901 DEBUG                    HTTP Status: 200 - OK
15:51:39.902 DEBUG                    Connect closed for Server
15:51:39.902 DEBUG                    Connect closed for Server
15:51:41.902 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:41.952 DEBUG                    Connected to Server
15:51:42.002 DEBUG                    Sending HTTP GET /status_2 message.
15:51:42.002 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:42.096 DEBUG                    HTTP Status: 200 - OK
15:51:42.096 DEBUG                    Connect closed for Server
15:51:42.096 DEBUG                    Connect closed for Server
15:51:43.960 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:1115919663498078477295451725671463944353599069385689232225448297858421681074890738639566432086714111154278097234434998851856410919976625386304455140992012276986773707802717167995107976194525992033014709436762383065939763098055813866
|                                                     x = 28321392010749743116567608678794183134421228420054063791991034230709067706300099072292106062944469704933527634519727
|                                                     y = 10375785630161572798469337852183046141011856198097477707364998321386595369929865899658370599175804672543026521254634
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:5133750358002538437618214809754926273652619530194229923510867510548605208969458999614641936810516014102414043824662
|                                                 s = long384:36148010110200445629175699335270551317545954584967831122646298395747512684623754005121367981993282596771843718979376
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155137Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 1L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0xddbf62f7ffe345678115ff48f7b561f77bfc47ff9f814d675ae8a9b19e9594843cefb43377895d65cdcf5be4ba14da5e)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:14704681892716270861860888446084250114004055847753076954359166933089975080893396084461346770211311982998715874171993
|                                                 s = long384:11173565247583161773408218017180368793128074502863036723311192325060317683513103862000750120465535451321335040011037
15:51:43.961 DEBUG                    IR: Handling Certificate Signing Request.
15:51:43.962 DEBUG                    Generating InfCA certificate (serialNumber: 20003L)
15:51:43.972 DEBUG                    Generating certificate signature for serial: 20003
15:51:43.979 DEBUG                    Creating SKD message file /tmp/infca.resp
15:51:43.983 DEBUG                    Generating message signature using cert with serial: 81258
15:51:44.021 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0x7689d4158c03a9d1-->0x17789dadd9c80de1-->0xc9020cefbb66368c
|                                             0x4cf2e0a02c672aea-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 81258L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155120Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:661224415953107383755992040422944820715244473101914014258053380741599845726528625050849832477050353043950724200333797468703815289998521139178965361044204101239043921039184016395361878159965261719502536372959815184642564302934616529
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x17789dadd9c80de1)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x7689d4158c03a9d1)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:17876196692337748875272884335007649270547621132713179326742374617346247725295131044959290097383340721775494478191010
|                                                     s = long384:28363644328767937374867876022431716450309449878467430866457092241467673507442523176750758283943248461372411274251352
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 80264L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155120Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:430388254198979228810880620598305661320078215889012005897321787098238386084629468043014979394751611489089418330362583192454146224466033696329271502315115165834112677684952586745371448014019804308807678938735331398353772203959913953
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x17789dadd9c80de1)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:15240003387190757633328697184690791004877715917011724305422481754590586777464977434152769591556503648885842476641521
|                                                     s = long384:23284135347858197090637994500168629753812642123651522117402273905689637564971644453479818383817811481502821201315362
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20003L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155143Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1115919663498078477295451725671463944353599069385689232225448297858421681074890738639566432086714111154278097234434998851856410919976625386304455140992012276986773707802717167995107976194525992033014709436762383065939763098055813866
|                                                         x = 28321392010749743116567608678794183134421228420054063791991034230709067706300099072292106062944469704933527634519727
|                                                         y = 10375785630161572798469337852183046141011856198097477707364998321386595369929865899658370599175804672543026521254634
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x4cf2e0a02c672aea)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:19862652152821856746549082386003075330243118220176784250670039635768437510241781736631598324520622509308280480750665
|                                                     s = long384:33006235907305762556269590408168405319646531869133538642493900620303351682842047519268675304426243527620989695617209
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x7689d4158c03a9d1)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155143Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 1L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:14856204561089122316318578111343150428595199599296169071695061529606511625752567774596157623794106102056502676471617
|                                                 s = long384:10361794016036883534202834565592870785530317928374786124462019969705306142084688503706089841901504253051988286707133
15:51:44.096 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:44.147 DEBUG                    Connected to Server
15:51:44.197 DEBUG                    Sending HTTP GET /status_2 message.
15:51:44.197 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:44.400 DEBUG                    HTTP Status: 200 - OK
15:51:44.401 DEBUG                    Connect closed for Server
15:51:44.402 DEBUG                    Connect closed for Server
15:51:46.403 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:46.454 DEBUG                    Connected to Server
15:51:46.504 DEBUG                    Sending HTTP GET /status_2 message.
15:51:46.504 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:46.604 DEBUG                    HTTP Status: 200 - OK
15:51:46.605 DEBUG                    Connect closed for Server
15:51:46.605 DEBUG                    Connect closed for Server
15:51:48.604 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:48.655 DEBUG                    Connected to Server
15:51:48.705 DEBUG                    Sending HTTP GET /status_2 message.
15:51:48.705 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:48.796 DEBUG                    HTTP Status: 200 - OK
15:51:48.797 DEBUG                    Connect closed for Server
15:51:48.798 DEBUG                    Connect closed for Server
15:51:50.797 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:50.847 DEBUG                    Connected to Server
15:51:50.897 DEBUG                    Sending HTTP GET /status_2 message.
15:51:50.898 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:50.995 DEBUG                    HTTP Status: 200 - OK
15:51:50.996 DEBUG                    Connect closed for Server
15:51:51.004 DEBUG                    Connect closed for Server
15:51:52.996 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:53.047 DEBUG                    Connected to Server
15:51:53.096 DEBUG                    Sending HTTP GET /status_2 message.
15:51:53.097 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:53.222 DEBUG                    HTTP Status: 200 - OK
15:51:53.222 DEBUG                    Connect closed for Server
15:51:53.223 DEBUG                    Connect closed for Server
15:51:53.838 DEBUG                    cmd optimus > keydir
15:51:53.883 DEBUG                    cmd optimus > keydir /tmp/
15:51:55.222 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:55.273 DEBUG                    Connected to Server
15:51:55.324 DEBUG                    Sending HTTP GET /status_2 message.
15:51:55.325 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:51:55.389 DEBUG                    HTTP Status: 200 - OK
15:51:55.390 DEBUG                    Connect closed for Server
15:51:55.390 DEBUG                    Connect closed for Server
15:51:56.234 DEBUG                    cmd optimus > keydir ../Keys/
15:51:56.340 DEBUG                    Received SKD message:
|                                     KeyPackageFile:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = List:
|                                             [0]:
|                                                 OneAsymmetricKey:
|                                                     version == 0
|                                                     privateKeyAlgorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     privateKey = ECPrivateKey:
|                                                         version = 1L
|                                                         privateKey = Octets(0x0821b93202fdfd406a739ed616ec41639967c26c1b49ff81a1eab05135f50b8b6f24da74fc7ffffe9a410b5d54693a79)
|                                                     attributes:
|                                                       [0] = UserCertificateAttr:
|                                                         id == OID(userCertificate:2.5.4.36)
|                                                         userCertificate = Certificate:
|                                                             tbsCertificate = TBSCertificate:
|                                                                 version == 2
|                                                                 serialNumber = 1L
|                                                                 signatureAlgorithmID = AlgorithmIdentifier:
|                                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                 issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 validity = 170112000000Z..99991231235959Z
|                                                                 subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                     algorithm = AlgorithmIdentifier:
|                                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                         parameters = ECParameters:
|                                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                     subjectPublicKey = long768:1351851991518071121893267100209002368384603119679179127722740246179832517970065284433866719475166544443382853184460615632532641585966014646775096286504372343976163001078300771047909249687555640592358431735867938109388454454276094227
|                                                                     x = 34309217271321928728985716038448217653189498687688599962306213622636790813029968131113937067461540231798637653757133
|                                                                     y = 2251198571446790464675093365497618967630486235513187689875413917760927762523492088812773345081701305504126457575699
|                                                                 _extensions = CertificateExtensions
|                                                                   [0] AuthorityKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                         keyIdentifier = Octets(0x439068c8b55f7913)
|                                                                   [1] SubjectKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                         id = Octets(0x439068c8b55f7913)
|                                                                   [2] KeyUsage_CertExt:
|                                                                         extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                         critical = True
|                                                                         uses = ['digitalSignature']
|                                                                   [3] CertificatePolicies_CertExt:
|                                                                         extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                         critical = True
|                                                                         policies:
|                                                                           [0] = PolicyInformation:
|                                                                             id = OID(1.2.826.0.1145.0.1.0.3)
|                                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                             signature = Signature:
|                                                                 r = long384:5930118054113796861672365826928934437276747119211806815601492152245154138493551788636350387682290650912362852504325
|                                                                 s = long384:27005006673676834786990748418095939554662394140154173371040126468230107771995178462109561553503659883934337222122761
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                               [1] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x83167af09212e94dba1ba6b4519723989bd5c7682b681868c98c085abaaef8ef8c4004181ab40fe2f0aa464e4956dae0)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:28915955183560919751045341700274198819222796559244862135935769342624687217041321879822583225239294794853260936511935
|                                                 s = long384:24124492979964903797662574012477498268359469677263407604112723499193386101410594636542122599668674750988198409852117
15:51:56.341 DEBUG                    Added keymat FACT-IA: serial=1 auth=0x439068c8b55f7913 subj=0x439068c8b55f7913
15:51:56.341 DEBUG                    UUT Control: Applying all recent configuration changes
15:51:56.364 INFO    Test:            105 : [icm-issue-infia-cka-cert-success] The CKA
|                                           sends a valid CSR for an InfIA certificate
|                                           from the ICM using HTTP and receives a valid
|                                           response.
15:51:56.376 INFO                           #> 1. CKA requests a Inf IA from the ICM via HTTP and waits for a 202 ACCEPTED response.
15:51:56.376 DEBUG                          CKA requesting Inf IA from ICM.
15:51:56.383 INFO                           SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:51:56.422 DEBUG                          Generating message signature using cert with serial: 1
15:51:56.454 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:153381736237800754065313292037499727854358686899073619133245139863439532353531942958458323012819863703243812284857606846148468007776325877185972817628173519660729032801514721989061569515350230787927392732144249469925145862669131851
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.1
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:6608815910761130913461836876104795162248608497703561593726868164036496894484686371187806124428056283261251990829295
|                                                       s = long384:18242775676561981203365124033191403859691880947819630367471728319189181591538158978129477479881103617445255942453775
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x439068c8b55f7913-->0x439068c8b55f7913
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 1L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1351851991518071121893267100209002368384603119679179127722740246179832517970065284433866719475166544443382853184460615632532641585966014646775096286504372343976163001078300771047909249687555640592358431735867938109388454454276094227
|                                                               x = 34309217271321928728985716038448217653189498687688599962306213622636790813029968131113937067461540231798637653757133
|                                                               y = 2251198571446790464675093365497618967630486235513187689875413917760927762523492088812773345081701305504126457575699
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x439068c8b55f7913)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x439068c8b55f7913)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:5930118054113796861672365826928934437276747119211806815601492152245154138493551788636350387682290650912362852504325
|                                                           s = long384:27005006673676834786990748418095939554662394140154173371040126468230107771995178462109561553503659883934337222122761
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x439068c8b55f7913)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112155156Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x46f5b760776fecb03c5d3c7774d65bd44af60e3605403af7509828151f09d8b6353bb321112baa428968ddf90d94cc6b)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xaf392399c533f20c)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:36150816090176571800116429398119167351882333197915129021898931441980729512824774502347424185760772497644348894080103
|                                                       s = long384:34989817360064274812905413103761345652138129474675609477138866361181180942902233924040805308437413512365457433391019
15:51:56.473 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:56.474 INFO                           SKD: Client ---> Server CMC-request (1330 bytes)
15:51:56.475 INFO                           Sent CSR for Inf IA certificate.
15:51:56.524 DEBUG                          Connected to Server
15:51:56.575 DEBUG                          Sending HTTP POST /fullcmc message.
15:51:56.576 DEBUG                          Removing HTTP POST /fullcmc message from Q.
15:51:56.676 DEBUG                          HTTP Status: 202 - ACCEPTED
15:51:56.687 DEBUG                          Connect closed for Server
15:51:56.687 DEBUG                          Connect closed for Server
15:51:57.260 INFO                           #> 2. The ICM operator approves the CSR.
15:51:57.390 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:57.441 DEBUG                          Connected to Server
15:51:57.491 DEBUG                          Sending HTTP GET /status_2 message.
15:51:57.492 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:51:57.612 DEBUG                          HTTP Status: 200 - OK
15:51:57.613 DEBUG                          Connect closed for Server
15:51:57.614 DEBUG                          Connect closed for Server
15:51:58.676 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:58.728 DEBUG                          Connected to Server
15:51:58.777 DEBUG                          Sending HTTP GET /status_1 message.
15:51:58.778 DEBUG                          Removing HTTP GET /status_1 message from Q.
15:51:58.899 DEBUG                          HTTP Status: 200 - OK
15:51:58.900 DEBUG                          Connect closed for Server
15:51:58.901 DEBUG                          Connect closed for Server
15:51:59.371 INFO                           #> 3. A CertificateSigningResponse response containing the new Inf IA certificate is expected from the ICM.
15:51:59.613 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:51:59.664 DEBUG                          Connected to Server
15:51:59.714 DEBUG                          Sending HTTP GET /status_2 message.
15:51:59.714 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:51:59.790 DEBUG                          HTTP Status: 200 - OK
15:51:59.791 DEBUG                          Connect closed for Server
15:51:59.793 DEBUG                          Connect closed for Server
15:52:00.900 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:00.951 DEBUG                          Connected to Server
15:52:01.001 DEBUG                          Sending HTTP GET /status_1 message.
15:52:01.002 DEBUG                          Removing HTTP GET /status_1 message from Q.
15:52:01.088 DEBUG                          HTTP Status: 200 - OK
15:52:01.089 DEBUG                          Connect closed for Server
15:52:01.090 DEBUG                          Connect closed for Server
15:52:01.791 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:01.842 DEBUG                          Connected to Server
15:52:01.892 DEBUG                          Sending HTTP GET /status_2 message.
15:52:01.893 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:52:01.993 DEBUG                          HTTP Status: 200 - OK
15:52:01.993 DEBUG                          Connect closed for Server
15:52:01.995 DEBUG                          Connect closed for Server
15:52:03.089 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:03.140 DEBUG                          Connected to Server
15:52:03.190 DEBUG                          Sending HTTP GET /status_1 message.
15:52:03.191 DEBUG                          Removing HTTP GET /status_1 message from Q.
15:52:03.291 DEBUG                          HTTP Status: 303 - SEE OTHER
15:52:03.292 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 2.0 second(s)
15:52:03.293 DEBUG                          Connect closed for Server
15:52:03.293 DEBUG                          Connect closed for Server
15:52:03.293 DEBUG                          Connect closed for Server
15:52:03.294 DEBUG                          Connect closed for Server
15:52:03.294 DEBUG                          Connect closed for Server
15:52:03.295 DEBUG                          Connect closed for Server
15:52:03.295 DEBUG                          Connect closed for Server
15:52:03.296 DEBUG                          Connect closed for Server
15:52:03.296 DEBUG                          Connect closed for Server
15:52:03.297 DEBUG                          Connect closed for Server
15:52:03.297 DEBUG                          Connect closed for Server
15:52:03.297 DEBUG                          Connect closed for Server
15:52:03.298 DEBUG                          Connect closed for Server
15:52:03.298 DEBUG                          Connect closed for Server
15:52:03.299 DEBUG                          Connect closed for Server
15:52:03.299 DEBUG                          Connect closed for Server
15:52:03.299 DEBUG                          Connect closed for Server
15:52:03.300 DEBUG                          Connect closed for Server
15:52:03.300 DEBUG                          Connect closed for Server
15:52:03.301 DEBUG                          Connect closed for Server
15:52:03.301 DEBUG                          Connect closed for Server
15:52:03.302 DEBUG                          Connect closed for Server
15:52:03.302 DEBUG                          Connect closed for Server
15:52:03.302 DEBUG                          Connect closed for Server
15:52:03.303 DEBUG                          Connect closed for Server
15:52:03.303 DEBUG                          Connect closed for Server
15:52:03.304 DEBUG                          Connect closed for Server
15:52:03.304 DEBUG                          Connect closed for Server
15:52:03.305 DEBUG                          Connect closed for Server
15:52:03.305 DEBUG                          Connect closed for Server
15:52:03.305 DEBUG                          Connect closed for Server
15:52:03.306 DEBUG                          Connect closed for Server
15:52:03.306 DEBUG                          Connect closed for Server
15:52:03.307 DEBUG                          Connect closed for Server
15:52:03.307 DEBUG                          Connect closed for Server
15:52:03.307 DEBUG                          Connect closed for Server
15:52:03.308 DEBUG                          Connect closed for Server
15:52:03.308 DEBUG                          Connect closed for Server
15:52:03.309 DEBUG                          Connect closed for Server
15:52:03.309 DEBUG                          Connect closed for Server
15:52:03.309 DEBUG                          Connect closed for Server
15:52:03.310 DEBUG                          Connect closed for Server
15:52:03.310 DEBUG                          Connect closed for Server
15:52:03.311 DEBUG                          Connect closed for Server
15:52:03.311 DEBUG                          Connect closed for Server
15:52:03.312 DEBUG                          Connect closed for Server
15:52:03.312 DEBUG                          Connect closed for Server
15:52:03.313 DEBUG                          Connect closed for Server
15:52:03.313 DEBUG                          Connect closed for Server
15:52:03.313 DEBUG                          Connect closed for Server
15:52:03.314 DEBUG                          Connect closed for Server
15:52:03.314 DEBUG                          Connect closed for Server
15:52:03.315 DEBUG                          Connect closed for Server
15:52:03.315 DEBUG                          Connect closed for Server
15:52:03.316 DEBUG                          Connect closed for Server
15:52:03.316 DEBUG                          Connect closed for Server
15:52:03.316 DEBUG                          Connect closed for Server
15:52:03.317 DEBUG                          Connect closed for Server
15:52:03.317 DEBUG                          Connect closed for Server
15:52:03.318 DEBUG                          Connect closed for Server
15:52:03.318 DEBUG                          Connect closed for Server
15:52:03.318 DEBUG                          Connect closed for Server
15:52:03.319 DEBUG                          Connect closed for Server
15:52:03.319 DEBUG                          Connect closed for Server
15:52:03.320 DEBUG                          Connect closed for Server
15:52:03.320 DEBUG                          Connect closed for Server
15:52:03.320 DEBUG                          Connect closed for Server
15:52:03.321 DEBUG                          Connect closed for Server
15:52:03.321 DEBUG                          Connect closed for Server
15:52:03.322 DEBUG                          Connect closed for Server
15:52:03.322 DEBUG                          Connect closed for Server
15:52:03.322 DEBUG                          Connect closed for Server
15:52:03.323 DEBUG                          Connect closed for Server
15:52:03.323 DEBUG                          Connect closed for Server
15:52:03.324 DEBUG                          Connect closed for Server
15:52:03.324 DEBUG                          Connect closed for Server
15:52:03.325 DEBUG                          Connect closed for Server
15:52:03.325 DEBUG                          Connect closed for Server
15:52:03.325 DEBUG                          Connect closed for Server
15:52:03.326 DEBUG                          Connect closed for Server
15:52:03.326 DEBUG                          Connect closed for Server
15:52:03.327 DEBUG                          Connect closed for Server
15:52:03.327 DEBUG                          Connect closed for Server
15:52:03.327 DEBUG                          Connect closed for Server
15:52:03.328 DEBUG                          Connect closed for Server
15:52:03.328 DEBUG                          Connect closed for Server
15:52:03.329 DEBUG                          Connect closed for Server
15:52:03.329 DEBUG                          Connect closed for Server
15:52:03.329 DEBUG                          Connect closed for Server
15:52:03.330 DEBUG                          Connect closed for Server
15:52:03.330 DEBUG                          Connect closed for Server
15:52:03.331 DEBUG                          Connect closed for Server
15:52:03.331 DEBUG                          Connect closed for Server
15:52:03.332 DEBUG                          Connect closed for Server
15:52:03.332 DEBUG                          Connect closed for Server
15:52:03.332 DEBUG                          Connect closed for Server
15:52:03.333 DEBUG                          Connect closed for Server
15:52:03.333 DEBUG                          Connect closed for Server
15:52:03.333 DEBUG                          Connect closed for Server
15:52:03.334 DEBUG                          Connect closed for Server
15:52:03.335 DEBUG                          Connect closed for Server
15:52:03.336 DEBUG                          Connect closed for Server
15:52:03.336 DEBUG                          Connect closed for Server
15:52:03.336 DEBUG                          Connect closed for Server
15:52:03.337 DEBUG                          Connect closed for Server
15:52:03.337 DEBUG                          Connect closed for Server
15:52:03.338 DEBUG                          Connect closed for Server
15:52:03.338 DEBUG                          Connect closed for Server
15:52:03.338 DEBUG                          Connect closed for Server
15:52:03.339 DEBUG                          Connect closed for Server
15:52:03.339 DEBUG                          Connect closed for Server
15:52:03.340 DEBUG                          Connect closed for Server
15:52:03.340 DEBUG                          Connect closed for Server
15:52:03.340 DEBUG                          Connect closed for Server
15:52:03.341 DEBUG                          Connect closed for Server
15:52:03.341 DEBUG                          Connect closed for Server
15:52:03.342 DEBUG                          Connect closed for Server
15:52:03.342 DEBUG                          Connect closed for Server
15:52:03.344 DEBUG                          Connect closed for Server
15:52:03.345 DEBUG                          Connect closed for Server
15:52:03.346 DEBUG                          Connect closed for Server
15:52:03.347 DEBUG                          Connect closed for Server
15:52:03.347 DEBUG                          Connect closed for Server
15:52:03.348 DEBUG                          Connect closed for Server
15:52:03.348 DEBUG                          Connect closed for Server
15:52:03.348 DEBUG                          Connect closed for Server
15:52:03.349 DEBUG                          Connect closed for Server
15:52:03.349 DEBUG                          Connect closed for Server
15:52:03.350 DEBUG                          Connect closed for Server
15:52:03.350 DEBUG                          Connect closed for Server
15:52:03.350 DEBUG                          Connect closed for Server
15:52:03.351 DEBUG                          Connect closed for Server
15:52:03.351 DEBUG                          Connect closed for Server
15:52:03.352 DEBUG                          Connect closed for Server
15:52:03.352 DEBUG                          Connect closed for Server
15:52:03.353 DEBUG                          Connect closed for Server
15:52:03.353 DEBUG                          Connect closed for Server
15:52:03.354 DEBUG                          Connect closed for Server
15:52:03.354 DEBUG                          Connect closed for Server
15:52:03.354 DEBUG                          Connect closed for Server
15:52:03.355 DEBUG                          Connect closed for Server
15:52:03.355 DEBUG                          Connect closed for Server
15:52:03.356 DEBUG                          Connect closed for Server
15:52:03.356 DEBUG                          Connect closed for Server
15:52:03.356 DEBUG                          Connect closed for Server
15:52:03.357 DEBUG                          Connect closed for Server
15:52:03.357 DEBUG                          Connect closed for Server
15:52:03.358 DEBUG                          Connect closed for Server
15:52:03.358 DEBUG                          Connect closed for Server
15:52:03.358 DEBUG                          Connect closed for Server
15:52:03.359 DEBUG                          Connect closed for Server
15:52:03.359 DEBUG                          Connect closed for Server
15:52:03.360 DEBUG                          Connect closed for Server
15:52:03.360 DEBUG                          Connect closed for Server
15:52:03.360 DEBUG                          Connect closed for Server
15:52:03.361 DEBUG                          Connect closed for Server
15:52:03.361 DEBUG                          Connect closed for Server
15:52:03.362 DEBUG                          Connect closed for Server
15:52:03.362 DEBUG                          Connect closed for Server
15:52:03.363 DEBUG                          Connect closed for Server
15:52:03.363 DEBUG                          Connect closed for Server
15:52:03.363 DEBUG                          Connect closed for Server
15:52:03.364 DEBUG                          Connect closed for Server
15:52:03.364 DEBUG                          Connect closed for Server
15:52:03.365 DEBUG                          Connect closed for Server
15:52:03.365 DEBUG                          Connect closed for Server
15:52:03.365 DEBUG                          Connect closed for Server
15:52:03.366 DEBUG                          Connect closed for Server
15:52:03.366 DEBUG                          Connect closed for Server
15:52:03.367 DEBUG                          Connect closed for Server
15:52:03.367 DEBUG                          Connect closed for Server
15:52:03.367 DEBUG                          Connect closed for Server
15:52:03.368 DEBUG                          Connect closed for Server
15:52:03.368 DEBUG                          Connect closed for Server
15:52:03.369 DEBUG                          Connect closed for Server
15:52:03.369 DEBUG                          Connect closed for Server
15:52:03.369 DEBUG                          Connect closed for Server
15:52:03.370 DEBUG                          Connect closed for Server
15:52:03.370 DEBUG                          Connect closed for Server
15:52:03.371 DEBUG                          Connect closed for Server
15:52:03.371 DEBUG                          Connect closed for Server
15:52:03.372 DEBUG                          Connect closed for Server
15:52:03.372 DEBUG                          Connect closed for Server
15:52:03.373 DEBUG                          Connect closed for Server
15:52:03.373 DEBUG                          Connect closed for Server
15:52:03.373 DEBUG                          Connect closed for Server
15:52:03.374 DEBUG                          Connect closed for Server
15:52:03.374 DEBUG                          Connect closed for Server
15:52:03.375 DEBUG                          Connect closed for Server
15:52:03.375 DEBUG                          Connect closed for Server
15:52:03.376 DEBUG                          Connect closed for Server
15:52:03.376 DEBUG                          Connect closed for Server
15:52:03.376 DEBUG                          Connect closed for Server
15:52:03.377 DEBUG                          Connect closed for Server
15:52:03.377 DEBUG                          Connect closed for Server
15:52:03.378 DEBUG                          Connect closed for Server
15:52:03.378 DEBUG                          Connect closed for Server
15:52:03.378 DEBUG                          Connect closed for Server
15:52:03.379 DEBUG                          Connect closed for Server
15:52:03.379 DEBUG                          Connect closed for Server
15:52:03.380 DEBUG                          Connect closed for Server
15:52:03.380 DEBUG                          Connect closed for Server
15:52:03.380 DEBUG                          Connect closed for Server
15:52:03.381 DEBUG                          Connect closed for Server
15:52:03.381 DEBUG                          Connect closed for Server
15:52:03.382 DEBUG                          Connect closed for Server
15:52:03.382 DEBUG                          Connect closed for Server
15:52:03.383 DEBUG                          Connect closed for Server
15:52:03.383 DEBUG                          Connect closed for Server
15:52:03.383 DEBUG                          Connect closed for Server
15:52:03.384 DEBUG                          Connect closed for Server
15:52:03.384 DEBUG                          Connect closed for Server
15:52:03.385 DEBUG                          Connect closed for Server
15:52:03.385 DEBUG                          Connect closed for Server
15:52:03.386 DEBUG                          Connect closed for Server
15:52:03.386 DEBUG                          Connect closed for Server
15:52:03.386 DEBUG                          Connect closed for Server
15:52:03.387 DEBUG                          Connect closed for Server
15:52:03.387 DEBUG                          Connect closed for Server
15:52:03.388 DEBUG                          Connect closed for Server
15:52:03.388 DEBUG                          Connect closed for Server
15:52:03.388 DEBUG                          Connect closed for Server
15:52:03.389 DEBUG                          Connect closed for Server
15:52:03.389 DEBUG                          Connect closed for Server
15:52:03.390 DEBUG                          Connect closed for Server
15:52:03.390 DEBUG                          Connect closed for Server
15:52:03.390 DEBUG                          Connect closed for Server
15:52:03.391 DEBUG                          Connect closed for Server
15:52:03.391 DEBUG                          Connect closed for Server
15:52:03.392 DEBUG                          Connect closed for Server
15:52:03.392 DEBUG                          Connect closed for Server
15:52:03.393 DEBUG                          Connected to Server
15:52:03.394 DEBUG                          Sending HTTP GET /fetch_1 message.
15:52:03.395 DEBUG                          Removing HTTP GET /fetch_1 message from Q.
15:52:03.492 DEBUG                          HTTP Status: 200 - OK
15:52:03.493 INFO                           SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3093 bytes)
15:52:03.666 DEBUG                          Received SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = Integer(1)
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = Integer(0)
|                                               certificates (2 chains, 4 certificates) = 
|                                                 Chains summary:
|                                                   0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                                   0x3a7abcc3d1a4e04b-->0x4cf2e0a02c672aea-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                               x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                               y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1de6a414dda88f8b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                           s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 82825L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                               x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                               y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2eb4fc66f0202ec8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                           s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                                   Chain[1] =
|                                                       [1.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 2L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112145158Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:153381736237800754065313292037499727854358686899073619133245139863439532353531942958458323012819863703243812284857606846148468007776325877185972817628173519660729032801514721989061569515350230787927392732144249469925145862669131851
|                                                               x = 3892739254780283405203895477687807011252197727198569395619233808521789656893476841889750361653837203500940379084169
|                                                               y = 35823372628499059369569102477359033862183933167534963725324884854381615226751614431428031740008446919341223270735947
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x4cf2e0a02c672aea)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x3a7abcc3d1a4e04b)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.1
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:8522628318394797376308318078153589861049079196246895576009188966986634130574036765274099232407546685748291288345762
|                                                           s = long384:6257769706041214922827444416768596993536571137899916911535979551030775389388254451334908820936747077584709979358849
|                                                       [1.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20003L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155143Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1115919663498078477295451725671463944353599069385689232225448297858421681074890738639566432086714111154278097234434998851856410919976625386304455140992012276986773707802717167995107976194525992033014709436762383065939763098055813866
|                                                               x = 28321392010749743116567608678794183134421228420054063791991034230709067706300099072292106062944469704933527634519727
|                                                               y = 10375785630161572798469337852183046141011856198097477707364998321386595369929865899658370599175804672543026521254634
|                                                           _extensions = CertificateExtensions
|                                                             [0] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[5]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                         2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                         3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                         4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x4cf2e0a02c672aea)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:19862652152821856746549082386003075330243118220176784250670039635768437510241781736631598324520622509308280480750665
|                                                           s = long384:33006235907305762556269590408168405319646531869133538642493900620303351682842047519268675304426243527620989695617209
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112155158Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xaf392399c533f20c)
|                                                           msgCount = 1L
|                                                     [4] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=,CN=
|                                                     [5] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:1663790529975254112917896068277744101586416429329446195104128430255389205734576503094633430987541630665761486187493
|                                                       s = long384:19064896945095380403997957969693635139410541783368505633806643858766097546298503660413996665349312364907017612682271
15:52:03.667 DEBUG                          CKA: Handling, ('CertificateSigningResponse',)
15:52:03.667 DEBUG                          Received Inf IA response
15:52:03.668 DEBUG                          Added keymat ICM-INF-CA: serial=20003 auth=0xc9020cefbb66368c subj=0x4cf2e0a02c672aea
15:52:03.668 DEBUG                          Added keymat CKA-INF-IA: serial=2 auth=0x4cf2e0a02c672aea subj=0x3a7abcc3d1a4e04b
15:52:03.755 INFO                           #> 3.1. Check the format of the certificates
15:52:03.759 DEBUG                          Connect closed for Server
15:52:03.760 DEBUG                          Connect closed for Server
15:52:03.993 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:04.044 DEBUG                          Connected to Server
15:52:04.094 DEBUG                          Sending HTTP GET /status_2 message.
15:52:04.095 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:52:04.234 DEBUG                          HTTP Status: 200 - OK
15:52:04.236 DEBUG                          Connect closed for Server
15:52:04.237 DEBUG                          Connect closed for Server
15:52:04.890 INFO    Test:                  PASS
15:52:05.025 DEBUG                    Tearing down mock HTTP servers
15:52:06.235 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:06.286 DEBUG                    Connected to Server
15:52:06.335 DEBUG                    Sending HTTP GET /status_2 message.
15:52:06.336 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:06.413 DEBUG                    HTTP Status: 200 - OK
15:52:06.413 DEBUG                    Connect closed for Server
15:52:06.423 DEBUG                    Connect closed for Server
15:52:08.413 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:08.464 DEBUG                    Connected to Server
15:52:08.514 DEBUG                    Sending HTTP GET /status_2 message.
15:52:08.514 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:08.600 DEBUG                    HTTP Status: 200 - OK
15:52:08.600 DEBUG                    Connect closed for Server
15:52:08.601 DEBUG                    Connect closed for Server
15:52:10.600 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:10.651 DEBUG                    Connected to Server
15:52:10.701 DEBUG                    Sending HTTP GET /status_2 message.
15:52:10.701 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:10.807 DEBUG                    HTTP Status: 200 - OK
15:52:10.807 DEBUG                    Connect closed for Server
15:52:10.808 DEBUG                    Connect closed for Server
15:52:12.807 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:12.858 DEBUG                    Connected to Server
15:52:12.908 DEBUG                    Sending HTTP GET /status_2 message.
15:52:12.908 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:13.027 DEBUG                    HTTP Status: 200 - OK
15:52:13.034 DEBUG                    Connect closed for Server
15:52:13.034 DEBUG                    Connect closed for Server
15:52:15.033 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:15.084 DEBUG                    Connected to Server
15:52:15.134 DEBUG                    Sending HTTP GET /status_2 message.
15:52:15.135 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:15.204 DEBUG                    HTTP Status: 200 - OK
15:52:15.205 DEBUG                    Connect closed for Server
15:52:15.205 DEBUG                    Connect closed for Server
15:52:17.205 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:17.255 DEBUG                    Connected to Server
15:52:17.305 DEBUG                    Sending HTTP GET /status_2 message.
15:52:17.306 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:17.400 DEBUG                    HTTP Status: 200 - OK
15:52:17.401 DEBUG                    Connect closed for Server
15:52:17.402 DEBUG                    Connect closed for Server
15:52:19.401 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:19.451 DEBUG                    Connected to Server
15:52:19.501 DEBUG                    Sending HTTP GET /status_2 message.
15:52:19.502 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:19.588 DEBUG                    HTTP Status: 200 - OK
15:52:19.588 DEBUG                    Connect closed for Server
15:52:19.589 DEBUG                    Connect closed for Server
15:52:21.588 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:21.639 DEBUG                    Connected to Server
15:52:21.689 DEBUG                    Sending HTTP GET /status_2 message.
15:52:21.689 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:21.851 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:52:21.852 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:52:21.865 DEBUG                    Generating certificate signature for serial: 80769
15:52:21.870 DEBUG                    Added keymat IR-INF-CA: serial=80769 auth=0xc9020cefbb66368c subj=0x435943586f144251
15:52:21.882 DEBUG                    Generating certificate signature for serial: 80546
15:52:21.888 DEBUG                    Added keymat IR-INF-IA: serial=80546 auth=0x435943586f144251 subj=0x143abe1bfa90a73d
15:52:21.900 DEBUG                    Generating certificate signature for serial: 86049
15:52:21.906 DEBUG                    Added keymat IR-INF-CRL-CA: serial=86049 auth=0xc9020cefbb66368c subj=0xcd8bc7cfa654e5d1
15:52:21.918 DEBUG                    Generating certificate signature for serial: 87614
15:52:21.923 DEBUG                    Added keymat IR-INF-CRL-IA: serial=87614 auth=0xcd8bc7cfa654e5d1 subj=0x3886668c07d57ed6
15:52:21.935 DEBUG                    Generating certificate signature for serial: 5
15:52:21.940 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x20030ad540e7318a subj=0x20030ad540e7318a
15:52:21.949 DEBUG                    Generating message signature using cert with serial: 80546
15:52:21.985 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:52:22.037 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x20030ad540e7318a subj=0x20030ad540e7318a
15:52:22.042 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:52:22.060 DEBUG                    Generating message signature using cert with serial: 5
15:52:22.119 DEBUG                    IR: Handling Certificate Signing Request.
15:52:22.119 DEBUG                    Creating temporary CA cert to issue IA
15:52:22.131 DEBUG                    Generating certificate signature for serial: 85241
15:52:22.137 DEBUG                    Added keymat IR-INF-CA-TMP: serial=85241 auth=0xc9020cefbb66368c subj=0x7e29c8034f9e482a
15:52:22.137 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:52:22.143 DEBUG                    Generating certificate signature for serial: 20000
15:52:22.150 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:52:22.153 DEBUG                    Generating message signature using cert with serial: 80546
15:52:22.272 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:52:22.272 DEBUG                    Received Inf IA response
15:52:22.273 DEBUG                    Added keymat IR-INF-CA: serial=85241 auth=0xc9020cefbb66368c subj=0x7e29c8034f9e482a
15:52:22.273 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x7e29c8034f9e482a subj=0x53b2d0c3c4cad38c
15:52:22.283 DEBUG                    Generating certificate signature for serial: 5
15:52:22.289 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xdb276738c14490a8 subj=0xdb276738c14490a8
15:52:22.298 DEBUG                    Generating message signature using cert with serial: 20000
15:52:22.335 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:52:22.352 DEBUG                    Generating message signature using cert with serial: 20000
15:52:22.436 DEBUG                    IR: Handling Certificate Signing Request.
15:52:22.437 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:52:22.443 DEBUG                    Generating certificate signature for serial: 20001
15:52:22.450 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:52:22.453 DEBUG                    Generating message signature using cert with serial: 80546
15:52:22.552 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:52:22.553 DEBUG                    Received Inf CA response
15:52:22.553 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x2fb868343ebc83da
15:52:22.553 INFO                     Listening for ('128.10.1.4', 80)
15:52:22.558 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:52:22.562 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:52:22.562 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:52:22.614 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xdb276738c14490a8 subj=0xdb276738c14490a8
15:52:22.620 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:52:22.636 DEBUG                    Generating message signature using cert with serial: 5
15:52:22.696 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:52:22.702 DEBUG                    Generating certificate signature for serial: 20000
15:52:22.708 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:52:22.711 DEBUG                    Generating message signature using cert with serial: 20000
15:52:22.830 DEBUG                    Received Inf IA response
15:52:22.830 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x2fb868343ebc83da
15:52:22.830 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x2fb868343ebc83da subj=0xade14c75bb9a4389
15:52:22.835 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:52:22.839 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:52:22.890 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xdb276738c14490a8 subj=0xdb276738c14490a8
15:52:22.890 INFO                     Listening for ('128.10.1.6', 80)
15:52:22.891 DEBUG                    MCKM requesting Inf IA from ICM.
15:52:22.896 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:52:22.913 DEBUG                    Generating message signature using cert with serial: 5
15:52:22.932 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:52:22.932 INFO                     SKD: Client ---> Server CMC-request (1343 bytes)
15:52:22.932 INFO                     Sent CSR for Inf IA certificate.
15:52:22.933 DEBUG                    HTTP Status: 200 - OK
15:52:22.933 DEBUG                    105041040: Connect accepted from Client
15:52:22.934 DEBUG                    Connect closed for Server
15:52:22.934 DEBUG                    Connect closed for Server
15:52:22.982 DEBUG                    Connected to Server
15:52:23.033 DEBUG                    Sending HTTP POST /fullcmc message.
15:52:23.034 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:52:23.077 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:52:23.078 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:52:23.085 DEBUG                    Generating certificate signature for serial: 20001
15:52:23.094 DEBUG                    Generating message signature using cert with serial: 20000
15:52:23.147 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:52:23.148 DEBUG                    HTTP Status: 200 - OK
15:52:23.148 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3140 bytes)
15:52:23.215 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:52:23.215 DEBUG                    Received Inf IA response
15:52:23.215 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x2fb868343ebc83da
15:52:23.215 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x2fb868343ebc83da subj=0x8b115775b2719772
15:52:24.936 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:24.948 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:52:25.002 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xdb276738c14490a8 subj=0xdb276738c14490a8
15:52:25.003 DEBUG                    CKA requesting Inf IA from ICM.
15:52:25.009 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:52:25.026 DEBUG                    Generating message signature using cert with serial: 5
15:52:25.044 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:52:25.044 INFO                     SKD: Client ---> Server CMC-request (1331 bytes)
15:52:25.044 INFO                     Sent CSR for Inf IA certificate.
15:52:25.045 DEBUG                    Connected to Server
15:52:25.045 DEBUG                    Sending HTTP GET /status_2 message.
15:52:25.045 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:25.047 DEBUG                    105041040: Connect accepted from Client
15:52:25.047 DEBUG                    Connect closed for Server
15:52:25.048 DEBUG                    Connect closed for Server
15:52:25.088 DEBUG                    HTTP Status: 200 - OK
15:52:25.089 DEBUG                    Connect closed for Server
15:52:25.089 DEBUG                    Connect closed for Server
15:52:25.094 DEBUG                    Connected to Server
15:52:25.144 DEBUG                    Sending HTTP POST /fullcmc message.
15:52:25.145 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:52:25.185 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:52:25.186 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:52:25.192 DEBUG                    Generating certificate signature for serial: 20002
15:52:25.201 DEBUG                    Generating message signature using cert with serial: 20000
15:52:25.254 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:52:25.255 DEBUG                    HTTP Status: 200 - OK
15:52:25.255 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3129 bytes)
15:52:25.319 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:52:25.319 DEBUG                    Received Inf IA response
15:52:25.319 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x2fb868343ebc83da
15:52:25.320 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x2fb868343ebc83da subj=0x16f087ed8b2454b8
15:52:27.089 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:27.140 DEBUG                    Connected to Server
15:52:27.191 DEBUG                    Sending HTTP GET /status_2 message.
15:52:27.192 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:27.291 DEBUG                    HTTP Status: 200 - OK
15:52:27.292 DEBUG                    Connect closed for Server
15:52:27.293 DEBUG                    Connect closed for Server
15:52:29.249 DEBUG                    ########## Mocks complete ##########
15:52:29.292 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:29.347 DEBUG                    Connected to Server
15:52:29.393 DEBUG                    Sending HTTP GET /status_2 message.
15:52:29.393 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:29.523 DEBUG                    HTTP Status: 200 - OK
15:52:29.524 DEBUG                    Connect closed for Server
15:52:29.524 DEBUG                    Connect closed for Server
15:52:30.175 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:52:30.175 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:52:31.143 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:52:31.143 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:52:31.524 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:31.575 DEBUG                    Connected to Server
15:52:31.626 DEBUG                    Sending HTTP GET /status_2 message.
15:52:31.627 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:31.705 DEBUG                    HTTP Status: 200 - OK
15:52:31.705 DEBUG                    Connect closed for Server
15:52:31.706 DEBUG                    Connect closed for Server
15:52:33.705 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:33.756 DEBUG                    Connected to Server
15:52:33.808 DEBUG                    Sending HTTP GET /status_2 message.
15:52:33.809 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:33.891 DEBUG                    HTTP Status: 200 - OK
15:52:33.892 DEBUG                    Connect closed for Server
15:52:33.892 DEBUG                    Connect closed for Server
15:52:35.896 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:35.946 DEBUG                    Connected to Server
15:52:35.996 DEBUG                    Sending HTTP GET /status_2 message.
15:52:35.997 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:36.105 DEBUG                    HTTP Status: 200 - OK
15:52:36.105 DEBUG                    Connect closed for Server
15:52:36.106 DEBUG                    Connect closed for Server
15:52:38.105 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:38.156 DEBUG                    Connected to Server
15:52:38.206 DEBUG                    Sending HTTP GET /status_2 message.
15:52:38.206 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:38.317 DEBUG                    HTTP Status: 200 - OK
15:52:38.317 DEBUG                    Connect closed for Server
15:52:38.318 DEBUG                    Connect closed for Server
15:52:40.317 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:40.367 DEBUG                    Connected to Server
15:52:40.418 DEBUG                    Sending HTTP GET /status_2 message.
15:52:40.418 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:40.512 DEBUG                    HTTP Status: 200 - OK
15:52:40.513 DEBUG                    Connect closed for Server
15:52:40.514 DEBUG                    Connect closed for Server
15:52:40.582 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:173204667024391129104885635840314282915289697038722612268818236879019885094479566937320839011207359033848446340290532469769913491772184888439719701901497165593933081740920419508183797556042049171805684204257783271154783784315608894
|                                                     x = 4395833708595284646206427301986660780719797447298824921999529872485040082703588844511979029413903326508211395977490
|                                                     y = 36349185310719135179991495881837404519131960560020686304517285140743389138091362492304650795354469194552170986037054
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:8933301460363316003488040246266806317903390525639050281728739917642922890663218800455524435380568625050445257121542
|                                                 s = long384:4526739477018965871526438616479767251586041545619949452002532899179486678173235392272976308289150909704785732643585
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155231Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 2L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0xc9512aa89427b51f6b6aae2617d2aa56ec43fb026c1ae94c2c35c4d12ece4cbd56b7b79d447f334d713b9a5b212db184)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:30867819050491671719113707658788719205055456330008021427656098265053385800360107937941001794066186806764147195815393
|                                                 s = long384:12329601755672227239794350890203983706666009353554729401701838113403414697450162915587467090455276943904199218243089
15:52:40.583 DEBUG                    IR: Handling Certificate Signing Request.
15:52:40.583 DEBUG                    Generating InfCA certificate (serialNumber: 20002L)
15:52:40.590 DEBUG                    Generating certificate signature for serial: 20002
15:52:40.596 DEBUG                    Creating SKD message file /tmp/infca.resp
15:52:40.599 DEBUG                    Generating message signature using cert with serial: 80546
15:52:40.630 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0xf6236506c05b5f3e-->0xc9020cefbb66368c
|                                             0x143abe1bfa90a73d-->0x435943586f144251-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155240Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:173204667024391129104885635840314282915289697038722612268818236879019885094479566937320839011207359033848446340290532469769913491772184888439719701901497165593933081740920419508183797556042049171805684204257783271154783784315608894
|                                                         x = 4395833708595284646206427301986660780719797447298824921999529872485040082703588844511979029413903326508211395977490
|                                                         y = 36349185310719135179991495881837404519131960560020686304517285140743389138091362492304650795354469194552170986037054
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xf6236506c05b5f3e)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:38224042445409081565832250690876855691075512409901453945160152126106199856010730006448646727529394709740396054964542
|                                                     s = long384:34936964034128412943272133182479416074704881795946710225592948138223251904748345189009697346248968451860420897780721
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 80546L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155221Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:531732872239231879045990001906983587388281234876443095077423120773592228778386570574209822879508737326516754779427618626749267577832521317653698499514523323996131681265517997406368649737864868290594849197825276857294932449132848957
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x435943586f144251)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x143abe1bfa90a73d)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:30077265833552324777998335273521485582450357387607266116480017289686183590058656950264565931019707096590308041037353
|                                                     s = long384:36606426655734511642892420931725043134789985563300465891665638680207983285022297509959314577684527165621824626347252
|                                                 [1.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 80769L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155221Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1511860331726526125812311433121779489113998339002670136391758399573802876511258015656850327331260311479753451224503097689109644657019211801527451632344179548982749963024767864038265913878568322290813626276281661189658365141609366097
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x435943586f144251)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:4865679868422863360405577645664545056895792532650875602333018400133136856052221207977565741208884689789615669189211
|                                                     s = long384:34861784132965534205371226651483960266313625111244482142242162912132146858827332627057239107120425002558192407330551
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x143abe1bfa90a73d)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155240Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 2L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:23649762261714161273679081676946243014131884193815774878906059887900570009295120422687280040375145837488368620148364
|                                                 s = long384:15859075402978973486683457622376115082626524757362558497026138825405115991228124853502366316512180709390272958550264
15:52:42.513 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:42.564 DEBUG                    Connected to Server
15:52:42.614 DEBUG                    Sending HTTP GET /status_2 message.
15:52:42.614 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:42.701 DEBUG                    HTTP Status: 200 - OK
15:52:42.702 DEBUG                    Connect closed for Server
15:52:42.703 DEBUG                    Connect closed for Server
15:52:44.702 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:44.753 DEBUG                    Connected to Server
15:52:44.803 DEBUG                    Sending HTTP GET /status_2 message.
15:52:44.803 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:44.835 DEBUG                    cmd optimus > keydir
15:52:44.878 DEBUG                    cmd optimus > keydir /tmp/
15:52:44.920 DEBUG                    HTTP Status: 200 - OK
15:52:44.921 DEBUG                    Connect closed for Server
15:52:44.921 DEBUG                    Connect closed for Server
15:52:46.921 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:46.971 DEBUG                    Connected to Server
15:52:47.021 DEBUG                    Sending HTTP GET /status_2 message.
15:52:47.022 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:47.089 DEBUG                    HTTP Status: 200 - OK
15:52:47.090 DEBUG                    Connect closed for Server
15:52:47.090 DEBUG                    Connect closed for Server
15:52:47.874 DEBUG                    cmd optimus > keydir ../Keys/
15:52:47.985 DEBUG                    Received SKD message:
|                                     KeyPackageFile:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = List:
|                                             [0]:
|                                                 OneAsymmetricKey:
|                                                     version == 0
|                                                     privateKeyAlgorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     privateKey = ECPrivateKey:
|                                                         version = 1L
|                                                         privateKey = Octets(0x501d0a1ef2aa37255b5129e9a363e3f60d314ae83b85d8a47b51dd1236ef179397be0b45f34e0abb652b4908d338a152)
|                                                     attributes:
|                                                       [0] = UserCertificateAttr:
|                                                         id == OID(userCertificate:2.5.4.36)
|                                                         userCertificate = Certificate:
|                                                             tbsCertificate = TBSCertificate:
|                                                                 version == 2
|                                                                 serialNumber = 3L
|                                                                 signatureAlgorithmID = AlgorithmIdentifier:
|                                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                 issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 validity = 170112000000Z..99991231235959Z
|                                                                 subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                     algorithm = AlgorithmIdentifier:
|                                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                         parameters = ECParameters:
|                                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                     subjectPublicKey = long768:1023684608294993874079634358707615931672493993358114198725435537402928731402277346055286531294667811673435599457111584852173915129465961338643659559598431152594797288531964110525172083519291487054612761829400491840224534119652070964
|                                                                     x = 25980519956079474421713027998683197994439871463641832681618658763120132541814283461629778220404047082489859902264885
|                                                                     y = 21920498137903341220457097402267832619386617021643400490206112852390734859770438455047729894334532095043215199114804
|                                                                 _extensions = CertificateExtensions
|                                                                   [0] AuthorityKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                         keyIdentifier = Octets(0x62387d3deed11634)
|                                                                   [1] SubjectKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                         id = Octets(0x62387d3deed11634)
|                                                                   [2] KeyUsage_CertExt:
|                                                                         extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                         critical = True
|                                                                         uses = ['digitalSignature']
|                                                                   [3] CertificatePolicies_CertExt:
|                                                                         extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                         critical = True
|                                                                         policies:
|                                                                           [0] = PolicyInformation:
|                                                                             id = OID(1.2.826.0.1145.0.1.0.3)
|                                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                             signature = Signature:
|                                                                 r = long384:32133885813190744637369196418156172240336258797009464888636888636744584287521486155139487795116508945779147044173121
|                                                                 s = long384:27158687117336138294049677356234317338648085625160593890177664950277806199896919287961171500098956414665263986854817
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                               [1] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x76bdc144b7ed1d9579bd94aa3db94e83872e0d39c587ae39e6d0a622cafdb5cfcca4cbcb14d1c4687d0be1d78a251843)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:35062040523409679381066139054882214997504502711807395178634809800626799091149439314691233102862648140668767868158310
|                                                 s = long384:16671367629804168843825903728140161192781565579238205422642192000798331664732411596680761973865030470470008452451139
15:52:47.986 DEBUG                    Added keymat FACT-IA: serial=3 auth=0x62387d3deed11634 subj=0x62387d3deed11634
15:52:47.986 DEBUG                    UUT Control: Applying all recent configuration changes
15:52:48.009 INFO    Test:            107 : [icm-issue-infia-cka-inv-ext-req] The CKA
|                                           sends a CSR for an InfIA certificate with an
|                                           invalid ExtensionReq attribute and receives
|                                           a error response.
15:52:48.020 DEBUG                          CKA requesting Inf IA from ICM.
15:52:48.027 INFO                           SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:52:48.065 DEBUG                          Generating message signature using cert with serial: 3
15:52:48.097 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:21286743161522623331105415961367221811047361579450337680072955148314141752709949290780910627070188933915704476011813384343041244022196850711761016160523095730376334297989352131824308951871998797242882393227247227768453864583364615
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['nonRepudiation']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.1
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:5545445182858587856861408626583415218093149988140480624280457787106757957670468687722910435392011946558584570074088
|                                                       s = long384:19743987565120226885089106344682335612764356863065272805031176842399898287584791614961684553741511032588457235658626
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x62387d3deed11634-->0x62387d3deed11634
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 3L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1023684608294993874079634358707615931672493993358114198725435537402928731402277346055286531294667811673435599457111584852173915129465961338643659559598431152594797288531964110525172083519291487054612761829400491840224534119652070964
|                                                               x = 25980519956079474421713027998683197994439871463641832681618658763120132541814283461629778220404047082489859902264885
|                                                               y = 21920498137903341220457097402267832619386617021643400490206112852390734859770438455047729894334532095043215199114804
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x62387d3deed11634)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x62387d3deed11634)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:32133885813190744637369196418156172240336258797009464888636888636744584287521486155139487795116508945779147044173121
|                                                           s = long384:27158687117336138294049677356234317338648085625160593890177664950277806199896919287961171500098956414665263986854817
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x62387d3deed11634)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112155248Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x72a96c3fdb2766ae5e105c7b774d8a1624a25f8db2ee65e96ee4b0641f5421a78768cd13a694fa7099b52810b1d6fb8d)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x185efec4835844ba)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:12712223634940593510398998215861160502290249299306808544206300526107343315779206976198576806749093662589420209585718
|                                                       s = long384:26485115023010487847194478148402520435946220274655873972683241661202365214043258012908416286681535096297360080872689
15:52:48.116 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:48.117 INFO                           SKD: Client ---> Server CMC-request (1331 bytes)
15:52:48.117 INFO                           Sent CSR for Inf IA certificate.
15:52:48.167 DEBUG                          Connected to Server
15:52:48.217 DEBUG                          Sending HTTP POST /fullcmc message.
15:52:48.218 DEBUG                          Removing HTTP POST /fullcmc message from Q.
15:52:48.400 DEBUG                          HTTP Status: 200 - OK
15:52:48.401 INFO                           SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (1764 bytes)
15:52:48.513 DEBUG                          Received SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = Integer(1)
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = Integer(2)
|                                                           otherInfo = OtherStatusInfo:
|                                                               failInfo = Integer(2)
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                               x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                               y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1de6a414dda88f8b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                           s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 82825L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                               x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                               y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2eb4fc66f0202ec8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                           s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112155248Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x185efec4835844ba)
|                                                           msgCount = 1L
|                                                     [4] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=,CN=
|                                                     [5] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xa398ffd4f2bd9a659ddc4da37aa54c2932303954638e852702d71cd1596bc4938e47fc0a9368ac931413a36a58a68d9b)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:2648435194791988233614387669230768312971953701316592704372536854697976040319117934486766632099642272005608453162029
|                                                       s = long384:10956762494621674671795254029145764755391058583561116947112116681732332610034025349386835323079830940800567503417926
15:52:48.513 DEBUG                          CKA: Handling, ('CertificateSigningResponse',)
15:52:48.515 DEBUG                          Connect closed for Server
15:52:48.519 INFO                           #> 0.1. Check request is displayed with correct status
15:52:48.522 DEBUG                          Connect closed for Server
15:52:49.090 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:49.141 DEBUG                          Connected to Server
15:52:49.191 DEBUG                          Sending HTTP GET /status_2 message.
15:52:49.191 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:52:49.328 DEBUG                          HTTP Status: 200 - OK
15:52:49.329 DEBUG                          Connect closed for Server
15:52:49.330 DEBUG                          Connect closed for Server
15:52:49.422 INFO                           #> 1. Check an error was received.
15:52:49.432 INFO    Test:                  PASS
15:52:49.564 DEBUG                    Tearing down mock HTTP servers
15:52:51.329 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:51.379 DEBUG                    Connected to Server
15:52:51.429 DEBUG                    Sending HTTP GET /status_2 message.
15:52:51.430 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:51.499 DEBUG                    HTTP Status: 200 - OK
15:52:51.500 DEBUG                    Connect closed for Server
15:52:51.501 DEBUG                    Connect closed for Server
15:52:53.500 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:53.551 DEBUG                    Connected to Server
15:52:53.601 DEBUG                    Sending HTTP GET /status_2 message.
15:52:53.601 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:53.719 DEBUG                    HTTP Status: 200 - OK
15:52:53.721 DEBUG                    Connect closed for Server
15:52:53.721 DEBUG                    Connect closed for Server
15:52:55.720 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:55.771 DEBUG                    Connected to Server
15:52:55.821 DEBUG                    Sending HTTP GET /status_2 message.
15:52:55.821 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:55.909 DEBUG                    HTTP Status: 200 - OK
15:52:55.909 DEBUG                    Connect closed for Server
15:52:55.910 DEBUG                    Connect closed for Server
15:52:57.169 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:52:57.169 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:52:57.182 DEBUG                    Generating certificate signature for serial: 86468
15:52:57.188 DEBUG                    Added keymat IR-INF-CA: serial=86468 auth=0xc9020cefbb66368c subj=0x91af031d1bea7fdc
15:52:57.199 DEBUG                    Generating certificate signature for serial: 85437
15:52:57.205 DEBUG                    Added keymat IR-INF-IA: serial=85437 auth=0x91af031d1bea7fdc subj=0x88c22980660719d6
15:52:57.217 DEBUG                    Generating certificate signature for serial: 81031
15:52:57.223 DEBUG                    Added keymat IR-INF-CRL-CA: serial=81031 auth=0xc9020cefbb66368c subj=0xe942a7c4ce88420c
15:52:57.235 DEBUG                    Generating certificate signature for serial: 86179
15:52:57.241 DEBUG                    Added keymat IR-INF-CRL-IA: serial=86179 auth=0xe942a7c4ce88420c subj=0x25189311ae7e7be1
15:52:57.251 DEBUG                    Generating certificate signature for serial: 5
15:52:57.257 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x72e5908ccc19378d subj=0x72e5908ccc19378d
15:52:57.265 DEBUG                    Generating message signature using cert with serial: 85437
15:52:57.299 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:52:57.350 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x72e5908ccc19378d subj=0x72e5908ccc19378d
15:52:57.356 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:52:57.372 DEBUG                    Generating message signature using cert with serial: 5
15:52:57.430 DEBUG                    IR: Handling Certificate Signing Request.
15:52:57.431 DEBUG                    Creating temporary CA cert to issue IA
15:52:57.443 DEBUG                    Generating certificate signature for serial: 82404
15:52:57.448 DEBUG                    Added keymat IR-INF-CA-TMP: serial=82404 auth=0xc9020cefbb66368c subj=0x9777033bb5629961
15:52:57.449 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:52:57.455 DEBUG                    Generating certificate signature for serial: 20000
15:52:57.461 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:52:57.464 DEBUG                    Generating message signature using cert with serial: 85437
15:52:57.583 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:52:57.583 DEBUG                    Received Inf IA response
15:52:57.584 DEBUG                    Added keymat IR-INF-CA: serial=82404 auth=0xc9020cefbb66368c subj=0x9777033bb5629961
15:52:57.584 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x9777033bb5629961 subj=0xa12542fe2ab622e4
15:52:57.594 DEBUG                    Generating certificate signature for serial: 5
15:52:57.600 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x2d41cbc3d016d650 subj=0x2d41cbc3d016d650
15:52:57.609 DEBUG                    Generating message signature using cert with serial: 20000
15:52:57.644 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:52:57.661 DEBUG                    Generating message signature using cert with serial: 20000
15:52:57.743 DEBUG                    IR: Handling Certificate Signing Request.
15:52:57.744 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:52:57.750 DEBUG                    Generating certificate signature for serial: 20001
15:52:57.756 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:52:57.759 DEBUG                    Generating message signature using cert with serial: 85437
15:52:57.854 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:52:57.855 DEBUG                    Received Inf CA response
15:52:57.855 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xbbfeff5e67972578
15:52:57.855 INFO                     Listening for ('128.10.1.4', 80)
15:52:57.860 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:52:57.864 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:52:57.864 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:52:57.914 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x2d41cbc3d016d650 subj=0x2d41cbc3d016d650
15:52:57.920 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:52:57.937 DEBUG                    Generating message signature using cert with serial: 5
15:52:57.994 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:52:58.001 DEBUG                    Generating certificate signature for serial: 20000
15:52:58.007 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:52:58.010 DEBUG                    Generating message signature using cert with serial: 20000
15:52:58.126 DEBUG                    Received Inf IA response
15:52:58.126 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xbbfeff5e67972578
15:52:58.127 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0xbbfeff5e67972578 subj=0x240fdc69f86e7661
15:52:58.131 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:52:58.135 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:52:58.184 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x2d41cbc3d016d650 subj=0x2d41cbc3d016d650
15:52:58.184 INFO                     Listening for ('128.10.1.6', 80)
15:52:58.185 DEBUG                    MCKM requesting Inf IA from ICM.
15:52:58.190 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:52:58.207 DEBUG                    Generating message signature using cert with serial: 5
15:52:58.225 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:52:58.225 INFO                     SKD: Client ---> Server CMC-request (1344 bytes)
15:52:58.225 INFO                     Sent CSR for Inf IA certificate.
15:52:58.226 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:52:58.227 DEBUG                    105984592: Connect accepted from Client
15:52:58.276 DEBUG                    Connected to Server
15:52:58.276 DEBUG                    Connected to Server
15:52:58.326 DEBUG                    Sending HTTP POST /fullcmc message.
15:52:58.326 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:52:58.326 DEBUG                    Sending HTTP GET /status_2 message.
15:52:58.327 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:52:58.376 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:52:58.377 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:52:58.383 DEBUG                    Generating certificate signature for serial: 20001
15:52:58.396 DEBUG                    Generating message signature using cert with serial: 20000
15:52:58.449 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:52:58.451 DEBUG                    HTTP Status: 200 - OK
15:52:58.451 DEBUG                    HTTP Status: 200 - OK
15:52:58.451 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3138 bytes)
15:52:58.515 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:52:58.516 DEBUG                    Received Inf IA response
15:52:58.516 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xbbfeff5e67972578
15:52:58.516 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0xbbfeff5e67972578 subj=0xfd7f18e1af43e61e
15:52:58.516 DEBUG                    Connect closed for Server
15:52:58.517 DEBUG                    Connect closed for Server
15:53:00.231 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:53:00.281 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x2d41cbc3d016d650 subj=0x2d41cbc3d016d650
15:53:00.282 DEBUG                    CKA requesting Inf IA from ICM.
15:53:00.287 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:53:00.305 DEBUG                    Generating message signature using cert with serial: 5
15:53:00.324 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:53:00.325 INFO                     SKD: Client ---> Server CMC-request (1331 bytes)
15:53:00.325 INFO                     Sent CSR for Inf IA certificate.
15:53:00.326 DEBUG                    105984592: Connect accepted from Client
15:53:00.326 DEBUG                    Connect closed for Server
15:53:00.326 DEBUG                    Connect closed for Server
15:53:00.375 DEBUG                    Connected to Server
15:53:00.426 DEBUG                    Sending HTTP POST /fullcmc message.
15:53:00.426 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:53:00.466 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:53:00.466 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:53:00.473 DEBUG                    Generating certificate signature for serial: 20002
15:53:00.482 DEBUG                    Generating message signature using cert with serial: 20000
15:53:00.534 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:53:00.535 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:00.537 DEBUG                    HTTP Status: 200 - OK
15:53:00.537 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3127 bytes)
15:53:00.602 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:53:00.603 DEBUG                    Received Inf IA response
15:53:00.603 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xbbfeff5e67972578
15:53:00.603 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0xbbfeff5e67972578 subj=0x0014234137a3599d
15:53:00.604 DEBUG                    Connected to Server
15:53:00.636 DEBUG                    Sending HTTP GET /status_2 message.
15:53:00.636 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:00.687 DEBUG                    HTTP Status: 200 - OK
15:53:00.688 DEBUG                    Connect closed for Server
15:53:00.688 DEBUG                    Connect closed for Server
15:53:02.688 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:02.739 DEBUG                    Connected to Server
15:53:02.791 DEBUG                    Sending HTTP GET /status_2 message.
15:53:02.791 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:02.891 DEBUG                    HTTP Status: 200 - OK
15:53:02.891 DEBUG                    Connect closed for Server
15:53:02.892 DEBUG                    Connect closed for Server
15:53:04.529 DEBUG                    ########## Mocks complete ##########
15:53:04.891 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:04.942 DEBUG                    Connected to Server
15:53:04.992 DEBUG                    Sending HTTP GET /status_2 message.
15:53:04.992 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:05.113 DEBUG                    HTTP Status: 200 - OK
15:53:05.114 DEBUG                    Connect closed for Server
15:53:05.114 DEBUG                    Connect closed for Server
15:53:05.565 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:53:05.566 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:53:06.505 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:53:06.506 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:53:07.114 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:07.165 DEBUG                    Connected to Server
15:53:07.214 DEBUG                    Sending HTTP GET /status_2 message.
15:53:07.215 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:07.288 DEBUG                    HTTP Status: 200 - OK
15:53:07.294 DEBUG                    Connect closed for Server
15:53:07.294 DEBUG                    Connect closed for Server
15:53:09.293 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:09.344 DEBUG                    Connected to Server
15:53:09.394 DEBUG                    Sending HTTP GET /status_2 message.
15:53:09.394 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:09.929 DEBUG                    HTTP Status: 200 - OK
15:53:09.930 DEBUG                    Connect closed for Server
15:53:09.930 DEBUG                    Connect closed for Server
15:53:11.933 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:11.984 DEBUG                    Connected to Server
15:53:12.034 DEBUG                    Sending HTTP GET /status_2 message.
15:53:12.034 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:12.104 DEBUG                    HTTP Status: 200 - OK
15:53:12.104 DEBUG                    Connect closed for Server
15:53:12.105 DEBUG                    Connect closed for Server
15:53:14.104 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:14.158 DEBUG                    Connected to Server
15:53:14.205 DEBUG                    Sending HTTP GET /status_2 message.
15:53:14.205 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:14.323 DEBUG                    HTTP Status: 200 - OK
15:53:14.324 DEBUG                    Connect closed for Server
15:53:14.325 DEBUG                    Connect closed for Server
15:53:16.323 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:16.374 DEBUG                    Connected to Server
15:53:16.424 DEBUG                    Sending HTTP GET /status_2 message.
15:53:16.424 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:16.504 DEBUG                    HTTP Status: 200 - OK
15:53:16.505 DEBUG                    Connect closed for Server
15:53:16.505 DEBUG                    Connect closed for Server
15:53:18.505 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:18.555 DEBUG                    Connected to Server
15:53:18.605 DEBUG                    Sending HTTP GET /status_2 message.
15:53:18.606 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:18.720 DEBUG                    HTTP Status: 200 - OK
15:53:18.720 DEBUG                    Connect closed for Server
15:53:18.721 DEBUG                    Connect closed for Server
15:53:18.848 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:1288744234208214928468245674585222842736017101001153601285917050090550114217104497780071372144281821962570431156421988519560737255261033377793525874117539163841311441953579383969397076312496857127095750110081465047314303367210300621
|                                                     x = 32707579095963463525742236522702070822493930103362902061915167646445685114147357998425621232037315614885728466533645
|                                                     y = 20394079900138109213306833141241024334446054318554758972385978507446798890342954806434805762157996918304455673476301
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:5702377911140400458607544797887355222091780065113081697997647341982276367301683819536084700357531378399483318592706
|                                                 s = long384:3608425912601425648558831785693932384108335072826080020445389424847145552178425224023829632328778782795492542297546
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155307Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 3L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x29e2dee3d9399ada1da9505de3b4e5e99b09f7c4d3b5e1d617088908a7a4c435c87fb555e9e1b8d886e482897ab9202e)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:9409037710697684903931045551287927593069895900092465825482217892265997037961506032530620219299608096933565999627272
|                                                 s = long384:18404019825275464728299748501722277944538187065197692246509221342297779832942603105338315917766930627007983029210026
15:53:18.849 DEBUG                    IR: Handling Certificate Signing Request.
15:53:18.850 DEBUG                    Generating InfCA certificate (serialNumber: 20002L)
15:53:18.857 DEBUG                    Generating certificate signature for serial: 20002
15:53:18.863 DEBUG                    Creating SKD message file /tmp/infca.resp
15:53:18.867 DEBUG                    Generating message signature using cert with serial: 85437
15:53:18.898 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0x88c22980660719d6-->0x91af031d1bea7fdc-->0xc9020cefbb66368c
|                                             0x45bdca6d874374cd-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 85437L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155257Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:978803182182822953846614309484947692915024936042952970670719140890342438515966523810370123055167394603769242350440532819176610656043970350200028458758692026379336691146869542311331476956513598637037561128244756649039576018645883350
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x91af031d1bea7fdc)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x88c22980660719d6)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:30385535284108726403547592111020678969877047083066366330969420305755175397424640027836040792117434913318132066420213
|                                                     s = long384:30323664425531136854073901262376509833050330828334456604099947774590720718482748816633898554696571848150833471612941
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 86468L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155257Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:419492200981106522072264064562422299552866912657334702288501454935276181178857710722459249307313803158543005730984665634651550982386182388624882386417173454197709824194337280083240573871522852120784482076189180977637461285927550940
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x91af031d1bea7fdc)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:31322074513597564403650721014815389354214150068114282631629928147061959128417946922876478038135134566694741157222408
|                                                     s = long384:12715677992368721988833368874548391970384276623660212493324658055991246136207564761698951807367773848267290697540271
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155318Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1288744234208214928468245674585222842736017101001153601285917050090550114217104497780071372144281821962570431156421988519560737255261033377793525874117539163841311441953579383969397076312496857127095750110081465047314303367210300621
|                                                         x = 32707579095963463525742236522702070822493930103362902061915167646445685114147357998425621232037315614885728466533645
|                                                         y = 20394079900138109213306833141241024334446054318554758972385978507446798890342954806434805762157996918304455673476301
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x45bdca6d874374cd)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:3263799773721001786094675697484738183341886389182582025576112682888173281395736716791592601117201913299887796089371
|                                                     s = long384:35165353202150853149272035766605804993035643945193975207382004537250703204006501548819402212862848956533458541726185
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x88c22980660719d6)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155318Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 3L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:26674318914120846693105123591023133253057793558450910694681375293430913836130002986007021473149758061208865924779499
|                                                 s = long384:10603007147186450104923294715496073717724749314051836154316523403331415345127387950494094163028469647278942069811812
15:53:20.720 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:20.771 DEBUG                    Connected to Server
15:53:20.821 DEBUG                    Sending HTTP GET /status_2 message.
15:53:20.821 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:20.929 DEBUG                    HTTP Status: 200 - OK
15:53:20.930 DEBUG                    Connect closed for Server
15:53:20.930 DEBUG                    Connect closed for Server
15:53:22.929 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:22.980 DEBUG                    Connected to Server
15:53:23.030 DEBUG                    Sending HTTP GET /status_2 message.
15:53:23.030 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:23.087 DEBUG                    HTTP Status: 200 - OK
15:53:23.092 DEBUG                    Connect closed for Server
15:53:23.093 DEBUG                    Connect closed for Server
15:53:23.410 DEBUG                    cmd optimus > keydir
15:53:23.452 DEBUG                    cmd optimus > keydir /tmp/
15:53:25.092 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:25.142 DEBUG                    Connected to Server
15:53:25.192 DEBUG                    Sending HTTP GET /status_2 message.
15:53:25.193 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:25.295 DEBUG                    HTTP Status: 200 - OK
15:53:25.296 DEBUG                    Connect closed for Server
15:53:25.296 DEBUG                    Connect closed for Server
15:53:27.296 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:27.321 DEBUG                    cmd optimus > keydir ../Keys/
15:53:27.427 DEBUG                    Received SKD message:
|                                     KeyPackageFile:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = List:
|                                             [0]:
|                                                 OneAsymmetricKey:
|                                                     version == 0
|                                                     privateKeyAlgorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     privateKey = ECPrivateKey:
|                                                         version = 1L
|                                                         privateKey = Octets(0x8398075f5e1ec72f98142cb82b61d493f149802094c9b29a2c3ea2ed385ad5db8149235b146205b41faebd40b1ae4bd6)
|                                                     attributes:
|                                                       [0] = UserCertificateAttr:
|                                                         id == OID(userCertificate:2.5.4.36)
|                                                         userCertificate = Certificate:
|                                                             tbsCertificate = TBSCertificate:
|                                                                 version == 2
|                                                                 serialNumber = 4L
|                                                                 signatureAlgorithmID = AlgorithmIdentifier:
|                                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                 issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 validity = 170112000000Z..99991231235959Z
|                                                                 subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                     algorithm = AlgorithmIdentifier:
|                                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                         parameters = ECParameters:
|                                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                     subjectPublicKey = long768:1503905650065389395776572674195857429140229842240081327256337696110107012612475989969974105122389422298949177952341815304953587424594867460127408599980599666740587220128237450650585772601604122240141858283719310096737577217783434175
|                                                                     x = 38168250686763401835580720340521647304879896924204896091873084104911863635230889245618896542069791229800054726293293
|                                                                     y = 35282706923891761838860616055921261680874865438432421172853432386352761989734735185060831511795571924903244310449087
|                                                                 _extensions = CertificateExtensions
|                                                                   [0] AuthorityKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                         keyIdentifier = Octets(0xdda919e4dea70bbf)
|                                                                   [1] SubjectKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                         id = Octets(0xdda919e4dea70bbf)
|                                                                   [2] KeyUsage_CertExt:
|                                                                         extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                         critical = True
|                                                                         uses = ['digitalSignature']
|                                                                   [3] CertificatePolicies_CertExt:
|                                                                         extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                         critical = True
|                                                                         policies:
|                                                                           [0] = PolicyInformation:
|                                                                             id = OID(1.2.826.0.1145.0.1.0.3)
|                                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                             signature = Signature:
|                                                                 r = long384:2386545091880777558863152461726175775906206457014230210465302834179294534496601649683846434568695755110861040542195
|                                                                 s = long384:15061756778885203205318324871222072701188934329851334872177699090223416345965182391713460367433581686032930161233641
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                               [1] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0xd5d5dfb0d40e7bf47204ffcc064feab372fb1599a0457d1467cb7df464881445f1edf019616a5d397a8ab836155098fa)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:27138737535834051580044602843195192402209031481942214460083557909850634379227296802169630975508572330294683495140718
|                                                 s = long384:28940939688782378896196183133902848626552326427367531937240897239107561124276093578996993473793971894636680615365938
15:53:27.428 DEBUG                    Added keymat FACT-IA: serial=4 auth=0xdda919e4dea70bbf subj=0xdda919e4dea70bbf
15:53:27.428 DEBUG                    UUT Control: Applying all recent configuration changes
15:53:27.429 DEBUG                    Connected to Server
15:53:27.430 DEBUG                    Sending HTTP GET /status_2 message.
15:53:27.430 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:27.451 INFO    Test:            109 : [icm-issue-infia-cka-invalid-esn] The CKA
|                                           sends a CSR for an InfIA certificate with an
|                                           out of range serial number to the ICM and
|                                           receives a error response.
15:53:27.462 DEBUG                          CKA requesting Inf IA from ICM.
15:53:27.469 INFO                           SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:53:27.509 DEBUG                          Generating message signature using cert with serial: 4
15:53:27.542 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF99999AA,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:1489946503762829124163920886683281263523352495249316471973457104716880641153259558490226023634306034111626328797402889387173653187609570837674117567317561742066156470349637585623142873587264181506066553162272225484735825833081007669
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.1
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:32246011067283968542119009203162684051268334377427336149339159355133914719886356513959376559181361288322077548356859
|                                                       s = long384:34662558775053571009784923985994038612808140495653482724978183464780847762161295803357615889177909236080554512458282
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0xdda919e4dea70bbf-->0xdda919e4dea70bbf
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 4L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1503905650065389395776572674195857429140229842240081327256337696110107012612475989969974105122389422298949177952341815304953587424594867460127408599980599666740587220128237450650585772601604122240141858283719310096737577217783434175
|                                                               x = 38168250686763401835580720340521647304879896924204896091873084104911863635230889245618896542069791229800054726293293
|                                                               y = 35282706923891761838860616055921261680874865438432421172853432386352761989734735185060831511795571924903244310449087
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xdda919e4dea70bbf)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xdda919e4dea70bbf)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:2386545091880777558863152461726175775906206457014230210465302834179294534496601649683846434568695755110861040542195
|                                                           s = long384:15061756778885203205318324871222072701188934329851334872177699090223416345965182391713460367433581686032930161233641
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0xdda919e4dea70bbf)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112155327Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x78764f1fb2b9f010ad46199909e177a15125d94809ea12c61a03ee4a30c0af3a8ae204f2faaa46eb52643ae9270468ff)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x092fd4ffae67bbce)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:16495900379941909579774711350655571481368763266412982308925542158916439670902898758102504653284605922777021036674570
|                                                       s = long384:27327265854556198807722946693902590044979911710078607822098801180975313836240648467842066555117652129146254849613380
15:53:27.561 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:27.562 INFO                           SKD: Client ---> Server CMC-request (1330 bytes)
15:53:27.562 INFO                           Sent CSR for Inf IA certificate.
15:53:27.564 DEBUG                          HTTP Status: 200 - OK
15:53:27.566 DEBUG                          Connect closed for Server
15:53:27.568 DEBUG                          Connect closed for Server
15:53:27.612 DEBUG                          Connected to Server
15:53:27.662 DEBUG                          Sending HTTP POST /fullcmc message.
15:53:27.663 DEBUG                          Removing HTTP POST /fullcmc message from Q.
15:53:27.795 DEBUG                          HTTP Status: 200 - OK
15:53:27.796 INFO                           SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (1765 bytes)
15:53:27.929 DEBUG                          Received SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = Integer(1)
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = Integer(2)
|                                                           otherInfo = OtherStatusInfo:
|                                                               failInfo = Integer(2)
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                               x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                               y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1de6a414dda88f8b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                           s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 82825L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                               x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                               y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2eb4fc66f0202ec8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                           s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112155327Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x092fd4ffae67bbce)
|                                                           msgCount = 1L
|                                                     [4] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=,CN=
|                                                     [5] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xa398ffd4f2bd9a659ddc4da37aa54c2932303954638e852702d71cd1596bc4938e47fc0a9368ac931413a36a58a68d9b)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:34832523645513658737485783057711422596291880460729480007284204921776892684331210319209380498210584501599610128654224
|                                                       s = long384:19670448399571979084895171363247769745400777222699050795762627996438335493069761492598722506536861298186695570052945
15:53:27.929 DEBUG                          CKA: Handling, ('CertificateSigningResponse',)
15:53:27.931 INFO                           #> 0.1. Check request is displayed with correct status
15:53:27.935 DEBUG                          Connect closed for Server
15:53:27.936 DEBUG                          Connect closed for Server
15:53:29.384 INFO    Test:                  PASS
15:53:29.520 DEBUG                    Tearing down mock HTTP servers
15:53:29.564 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:29.617 DEBUG                    Connected to Server
15:53:29.665 DEBUG                    Sending HTTP GET /status_2 message.
15:53:29.665 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:29.822 DEBUG                    HTTP Status: 200 - OK
15:53:29.829 DEBUG                    Connect closed for Server
15:53:29.830 DEBUG                    Connect closed for Server
15:53:31.828 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:31.879 DEBUG                    Connected to Server
15:53:31.928 DEBUG                    Sending HTTP GET /status_2 message.
15:53:31.929 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:32.019 DEBUG                    HTTP Status: 200 - OK
15:53:32.019 DEBUG                    Connect closed for Server
15:53:32.020 DEBUG                    Connect closed for Server
15:53:34.019 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:34.070 DEBUG                    Connected to Server
15:53:34.120 DEBUG                    Sending HTTP GET /status_2 message.
15:53:34.120 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:34.206 DEBUG                    HTTP Status: 200 - OK
15:53:34.207 DEBUG                    Connect closed for Server
15:53:34.207 DEBUG                    Connect closed for Server
15:53:36.207 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:36.257 DEBUG                    Connected to Server
15:53:36.307 DEBUG                    Sending HTTP GET /status_2 message.
15:53:36.308 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:36.417 DEBUG                    HTTP Status: 200 - OK
15:53:36.418 DEBUG                    Connect closed for Server
15:53:36.419 DEBUG                    Connect closed for Server
15:53:36.684 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:53:36.684 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:53:36.696 DEBUG                    Generating certificate signature for serial: 86226
15:53:36.702 DEBUG                    Added keymat IR-INF-CA: serial=86226 auth=0xc9020cefbb66368c subj=0x3b808e50e3541802
15:53:36.714 DEBUG                    Generating certificate signature for serial: 84357
15:53:36.720 DEBUG                    Added keymat IR-INF-IA: serial=84357 auth=0x3b808e50e3541802 subj=0x028a145c2db3851a
15:53:36.732 DEBUG                    Generating certificate signature for serial: 88025
15:53:36.738 DEBUG                    Added keymat IR-INF-CRL-CA: serial=88025 auth=0xc9020cefbb66368c subj=0xa8809611dc8683b8
15:53:36.750 DEBUG                    Generating certificate signature for serial: 84453
15:53:36.755 DEBUG                    Added keymat IR-INF-CRL-IA: serial=84453 auth=0xa8809611dc8683b8 subj=0x01c235070ebbce99
15:53:36.766 DEBUG                    Generating certificate signature for serial: 5
15:53:36.772 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x54468ec03288a6e8 subj=0x54468ec03288a6e8
15:53:36.780 DEBUG                    Generating message signature using cert with serial: 84357
15:53:36.816 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:53:36.870 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x54468ec03288a6e8 subj=0x54468ec03288a6e8
15:53:36.876 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:53:36.892 DEBUG                    Generating message signature using cert with serial: 5
15:53:36.949 DEBUG                    IR: Handling Certificate Signing Request.
15:53:36.950 DEBUG                    Creating temporary CA cert to issue IA
15:53:36.962 DEBUG                    Generating certificate signature for serial: 89208
15:53:36.968 DEBUG                    Added keymat IR-INF-CA-TMP: serial=89208 auth=0xc9020cefbb66368c subj=0xb48f6cb31fd0e8ba
15:53:36.968 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:53:36.974 DEBUG                    Generating certificate signature for serial: 20000
15:53:36.981 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:53:36.983 DEBUG                    Generating message signature using cert with serial: 84357
15:53:37.104 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:53:37.104 DEBUG                    Received Inf IA response
15:53:37.105 DEBUG                    Added keymat IR-INF-CA: serial=89208 auth=0xc9020cefbb66368c subj=0xb48f6cb31fd0e8ba
15:53:37.105 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0xb48f6cb31fd0e8ba subj=0x294cb943d95b0571
15:53:37.115 DEBUG                    Generating certificate signature for serial: 5
15:53:37.122 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x47ecbda80a33a56e subj=0x47ecbda80a33a56e
15:53:37.131 DEBUG                    Generating message signature using cert with serial: 20000
15:53:37.168 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:53:37.186 DEBUG                    Generating message signature using cert with serial: 20000
15:53:37.272 DEBUG                    IR: Handling Certificate Signing Request.
15:53:37.272 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:53:37.279 DEBUG                    Generating certificate signature for serial: 20001
15:53:37.286 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:53:37.289 DEBUG                    Generating message signature using cert with serial: 84357
15:53:37.389 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:53:37.390 DEBUG                    Received Inf CA response
15:53:37.390 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xc457441f618d0077
15:53:37.390 INFO                     Listening for ('128.10.1.4', 80)
15:53:37.395 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:53:37.399 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:53:37.399 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:53:37.451 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x47ecbda80a33a56e subj=0x47ecbda80a33a56e
15:53:37.457 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:53:37.473 DEBUG                    Generating message signature using cert with serial: 5
15:53:37.532 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:53:37.539 DEBUG                    Generating certificate signature for serial: 20000
15:53:37.545 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:53:37.548 DEBUG                    Generating message signature using cert with serial: 20000
15:53:37.666 DEBUG                    Received Inf IA response
15:53:37.667 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xc457441f618d0077
15:53:37.667 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0xc457441f618d0077 subj=0x64dbe46bdebb8823
15:53:37.671 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:53:37.675 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:53:37.725 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x47ecbda80a33a56e subj=0x47ecbda80a33a56e
15:53:37.726 INFO                     Listening for ('128.10.1.6', 80)
15:53:37.726 DEBUG                    MCKM requesting Inf IA from ICM.
15:53:37.731 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:53:37.748 DEBUG                    Generating message signature using cert with serial: 5
15:53:37.766 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:53:37.767 INFO                     SKD: Client ---> Server CMC-request (1344 bytes)
15:53:37.767 INFO                     Sent CSR for Inf IA certificate.
15:53:37.768 DEBUG                    105787600: Connect accepted from Client
15:53:37.817 DEBUG                    Connected to Server
15:53:37.868 DEBUG                    Sending HTTP POST /fullcmc message.
15:53:37.869 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:53:37.910 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:53:37.911 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:53:37.917 DEBUG                    Generating certificate signature for serial: 20001
15:53:37.926 DEBUG                    Generating message signature using cert with serial: 20000
15:53:37.978 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:53:37.980 DEBUG                    HTTP Status: 200 - OK
15:53:37.980 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3141 bytes)
15:53:38.044 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:53:38.045 DEBUG                    Received Inf IA response
15:53:38.045 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xc457441f618d0077
15:53:38.045 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0xc457441f618d0077 subj=0x30b05dfc6416e7e8
15:53:38.419 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:38.470 DEBUG                    Connected to Server
15:53:38.520 DEBUG                    Sending HTTP GET /status_2 message.
15:53:38.520 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:38.590 DEBUG                    HTTP Status: 200 - OK
15:53:38.590 DEBUG                    Connect closed for Server
15:53:38.590 DEBUG                    Connect closed for Server
15:53:39.773 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:53:39.822 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x47ecbda80a33a56e subj=0x47ecbda80a33a56e
15:53:39.823 DEBUG                    CKA requesting Inf IA from ICM.
15:53:39.829 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:53:39.845 DEBUG                    Generating message signature using cert with serial: 5
15:53:39.863 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:53:39.863 INFO                     SKD: Client ---> Server CMC-request (1333 bytes)
15:53:39.863 INFO                     Sent CSR for Inf IA certificate.
15:53:39.864 DEBUG                    105787600: Connect accepted from Client
15:53:39.864 DEBUG                    Connect closed for Server
15:53:39.865 DEBUG                    Connect closed for Server
15:53:39.914 DEBUG                    Connected to Server
15:53:39.964 DEBUG                    Sending HTTP POST /fullcmc message.
15:53:39.964 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:53:40.003 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:53:40.003 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:53:40.009 DEBUG                    Generating certificate signature for serial: 20002
15:53:40.019 DEBUG                    Generating message signature using cert with serial: 20000
15:53:40.071 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:53:40.073 DEBUG                    HTTP Status: 200 - OK
15:53:40.073 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3127 bytes)
15:53:40.136 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:53:40.136 DEBUG                    Received Inf IA response
15:53:40.137 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xc457441f618d0077
15:53:40.137 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0xc457441f618d0077 subj=0x71584f40845f450a
15:53:40.590 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:40.641 DEBUG                    Connected to Server
15:53:40.692 DEBUG                    Sending HTTP GET /status_2 message.
15:53:40.692 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:40.789 DEBUG                    HTTP Status: 200 - OK
15:53:40.789 DEBUG                    Connect closed for Server
15:53:40.790 DEBUG                    Connect closed for Server
15:53:42.790 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:42.841 DEBUG                    Connected to Server
15:53:42.892 DEBUG                    Sending HTTP GET /status_2 message.
15:53:42.893 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:42.990 DEBUG                    HTTP Status: 200 - OK
15:53:42.991 DEBUG                    Connect closed for Server
15:53:42.991 DEBUG                    Connect closed for Server
15:53:44.067 DEBUG                    ########## Mocks complete ##########
15:53:44.990 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:53:44.990 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:53:44.991 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:45.041 DEBUG                    Connected to Server
15:53:45.091 DEBUG                    Sending HTTP GET /status_2 message.
15:53:45.092 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:45.215 DEBUG                    HTTP Status: 200 - OK
15:53:45.216 DEBUG                    Connect closed for Server
15:53:45.217 DEBUG                    Connect closed for Server
15:53:45.995 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:53:45.996 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:53:47.216 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:47.267 DEBUG                    Connected to Server
15:53:47.317 DEBUG                    Sending HTTP GET /status_2 message.
15:53:47.317 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:47.430 DEBUG                    HTTP Status: 200 - OK
15:53:47.431 DEBUG                    Connect closed for Server
15:53:47.431 DEBUG                    Connect closed for Server
15:53:49.431 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:49.481 DEBUG                    Connected to Server
15:53:49.531 DEBUG                    Sending HTTP GET /status_2 message.
15:53:49.532 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:50.014 DEBUG                    HTTP Status: 200 - OK
15:53:50.015 DEBUG                    Connect closed for Server
15:53:50.015 DEBUG                    Connect closed for Server
15:53:52.015 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:52.065 DEBUG                    Connected to Server
15:53:52.115 DEBUG                    Sending HTTP GET /status_2 message.
15:53:52.116 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:52.190 DEBUG                    HTTP Status: 200 - OK
15:53:52.190 DEBUG                    Connect closed for Server
15:53:52.191 DEBUG                    Connect closed for Server
15:53:54.191 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:54.242 DEBUG                    Connected to Server
15:53:54.296 DEBUG                    Sending HTTP GET /status_2 message.
15:53:54.296 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:54.389 DEBUG                    HTTP Status: 200 - OK
15:53:54.389 DEBUG                    Connect closed for Server
15:53:54.396 DEBUG                    Connect closed for Server
15:53:56.389 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:56.440 DEBUG                    Connected to Server
15:53:56.490 DEBUG                    Sending HTTP GET /status_2 message.
15:53:56.490 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:56.619 DEBUG                    HTTP Status: 200 - OK
15:53:56.624 DEBUG                    Connect closed for Server
15:53:56.624 DEBUG                    Connect closed for Server
15:53:58.624 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:53:58.675 DEBUG                    Connected to Server
15:53:58.724 DEBUG                    Sending HTTP GET /status_2 message.
15:53:58.725 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:53:58.828 DEBUG                    HTTP Status: 200 - OK
15:53:58.828 DEBUG                    Connect closed for Server
15:53:58.829 DEBUG                    Connect closed for Server
15:54:00.829 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:00.879 DEBUG                    Connected to Server
15:54:00.991 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:425518088780563608588058367247611374818115210137932342606124283110749372075897783304862551087399700854442863613114878050596604193262876805437282635998897904972158210213268842876818338169494120257634855339214600893570501952348579152
|                                                     x = 10799401600507871488879581546644759353542937429251966615803857367941020664349960652374434465858653359476377273121724
|                                                     y = 4506775019909591766998770152052228431116157022706391392726404488404815684923177007239773287168089249077067473708368
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:13532182182983156691488271882971975904332156305465980687962217033908872960566143330041083561287214273247631107141118
|                                                 s = long384:36677889767678557815074549417518452507959213613535590289206171903421668094744369784044410070910962241338887290974364
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155347Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 4L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x1d09ae1ae7ac62639dd2c0eba3bf6c818c7ae642c2bd31531bc5b05b239340f980433f6269d4cd79d4b47156b89c5ce8)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:17993175979438053304743716841864716147720225853731514804822570045981595056141718473133054932039660419550435766287000
|                                                 s = long384:32738593360588371944402374790155080314540136911429563411955635456035722051108954141215517418167824387301448374645349
15:54:00.992 DEBUG                    Sending HTTP GET /status_2 message.
15:54:00.992 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:00.993 DEBUG                    IR: Handling Certificate Signing Request.
15:54:00.994 DEBUG                    Generating InfCA certificate (serialNumber: 20002L)
15:54:01.001 DEBUG                    Generating certificate signature for serial: 20002
15:54:01.008 DEBUG                    Creating SKD message file /tmp/infca.resp
15:54:01.011 DEBUG                    Generating message signature using cert with serial: 84357
15:54:01.043 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0x99b16f6d023b6550-->0xc9020cefbb66368c
|                                             0x028a145c2db3851a-->0x3b808e50e3541802-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155400Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:425518088780563608588058367247611374818115210137932342606124283110749372075897783304862551087399700854442863613114878050596604193262876805437282635998897904972158210213268842876818338169494120257634855339214600893570501952348579152
|                                                         x = 10799401600507871488879581546644759353542937429251966615803857367941020664349960652374434465858653359476377273121724
|                                                         y = 4506775019909591766998770152052228431116157022706391392726404488404815684923177007239773287168089249077067473708368
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x99b16f6d023b6550)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:34945925746485336857833734598197403733816498995345886654007302856360705492192445595245669488713394501506685988772541
|                                                     s = long384:23356065039010401337675067164385096409485931440703314231925605031905920010676829596155321317930057171047145391287590
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 84357L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155336Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1251185624483950530385317445711574193427088850841833073882587592263305402130846642558252074543291022028848429471666562687796325189838447497915926820158719178783470325051274598979467865477770426803755477031347927813259162243059385626
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x3b808e50e3541802)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x028a145c2db3851a)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:35255672826748724617527085178963774742084240567366364267241870494273524848220250211563955239546998006419925267967117
|                                                     s = long384:21724803782261203506097542170378104365167512862283671325631819988870807789380402926534011280895468429178785088832572
|                                                 [1.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 86226L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155336Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:54585264327604655505934015011869624297163334855874408645050868243793171361925147150909035225928342422451012384271071250286168836652554445447754912838759994368262088432170592555375232572351599504487455151121937180672683583225468930
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x3b808e50e3541802)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:8071793818118584836378440016635347239204889323341038501968962285685721219944568883499324935358304055255214667645687
|                                                     s = long384:28339913023845018854820655779631833801104734507122579034394627910229005137420084801404749791225309423956490550616474
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x028a145c2db3851a)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155401Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 4L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:16822273564578686473597071061858772883487516085715115051808353339179479708187185539968167371236713740517043884183393
|                                                 s = long384:5044716137682469090802217477825240514834909255597492721346576444289787517285000545768201467602666387967248527426627
15:54:01.104 DEBUG                    HTTP Status: 200 - OK
15:54:01.104 DEBUG                    Connect closed for Server
15:54:01.105 DEBUG                    Connect closed for Server
15:54:03.104 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:03.155 DEBUG                    Connected to Server
15:54:03.205 DEBUG                    Sending HTTP GET /status_2 message.
15:54:03.205 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:03.307 DEBUG                    HTTP Status: 200 - OK
15:54:03.308 DEBUG                    Connect closed for Server
15:54:03.308 DEBUG                    Connect closed for Server
15:54:05.307 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:05.358 DEBUG                    Connected to Server
15:54:05.409 DEBUG                    Sending HTTP GET /status_2 message.
15:54:05.409 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:05.523 DEBUG                    HTTP Status: 200 - OK
15:54:05.523 DEBUG                    Connect closed for Server
15:54:05.523 DEBUG                    Connect closed for Server
15:54:05.946 DEBUG                    cmd optimus > keydir
15:54:05.990 DEBUG                    cmd optimus > keydir /tmp/
15:54:07.523 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:07.574 DEBUG                    Connected to Server
15:54:07.623 DEBUG                    Sending HTTP GET /status_2 message.
15:54:07.624 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:07.704 DEBUG                    HTTP Status: 200 - OK
15:54:07.705 DEBUG                    Connect closed for Server
15:54:07.705 DEBUG                    Connect closed for Server
15:54:09.704 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:09.756 DEBUG                    Connected to Server
15:54:09.805 DEBUG                    Sending HTTP GET /status_2 message.
15:54:09.805 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:09.890 DEBUG                    HTTP Status: 200 - OK
15:54:09.891 DEBUG                    Connect closed for Server
15:54:09.891 DEBUG                    Connect closed for Server
15:54:10.704 DEBUG                    cmd optimus > keydir ../Keys/
15:54:10.817 DEBUG                    Received SKD message:
|                                     KeyPackageFile:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = List:
|                                             [0]:
|                                                 OneAsymmetricKey:
|                                                     version == 0
|                                                     privateKeyAlgorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     privateKey = ECPrivateKey:
|                                                         version = 1L
|                                                         privateKey = Octets(0x48af1a002be982c199b3feec949b50d26d1cb981850ad74c1da7b8a067788f3aafa6c98aea47037ff1bf2db8ab5d734f)
|                                                     attributes:
|                                                       [0] = UserCertificateAttr:
|                                                         id == OID(userCertificate:2.5.4.36)
|                                                         userCertificate = Certificate:
|                                                             tbsCertificate = TBSCertificate:
|                                                                 version == 2
|                                                                 serialNumber = 5L
|                                                                 signatureAlgorithmID = AlgorithmIdentifier:
|                                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                 issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 validity = 170112000000Z..99991231235959Z
|                                                                 subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                     algorithm = AlgorithmIdentifier:
|                                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                         parameters = ECParameters:
|                                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                     subjectPublicKey = long768:1478708281032420327098949512655427112556443215593293064044847047201719749390465164713514905563391964492154778528520321514189703512987749024877022788227677475214004249580255197435504336947047967397657379892001474000209092757900551282
|                                                                     x = 37528756116172862218704003008900142329993865096521221962615695113870991204599311206733107263660553248470375600632356
|                                                                     y = 15820573905014032154977543991280072425522052516308311066052069807996210542257850996635594705808786562283229843612786
|                                                                 _extensions = CertificateExtensions
|                                                                   [0] AuthorityKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                         keyIdentifier = Octets(0xbced3e0c5d04e472)
|                                                                   [1] SubjectKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                         id = Octets(0xbced3e0c5d04e472)
|                                                                   [2] KeyUsage_CertExt:
|                                                                         extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                         critical = True
|                                                                         uses = ['digitalSignature']
|                                                                   [3] CertificatePolicies_CertExt:
|                                                                         extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                         critical = True
|                                                                         policies:
|                                                                           [0] = PolicyInformation:
|                                                                             id = OID(1.2.826.0.1145.0.1.0.3)
|                                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                             signature = Signature:
|                                                                 r = long384:36170687850892476976874810303759976594024970365524951740618810192610929669965414789841068206854102400613741227252671
|                                                                 s = long384:30807544519758807891930492636156849400396731412005857959559435687521269108831720536406434181809945679462578801691814
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                               [1] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x103e32e40341463973f7e4ce00f37d92c5dc40edf8ac5e7c3632b29520fe692f8b0fc19d5fc566267f6726e408eb3da3)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:8579154717672806001429692366315232165336283418506914114175316182739193314756854671300310731130737400077706002712194
|                                                 s = long384:3921714681124170996285531616490120661268177532154988478726164640620821464352565652757144636400066291033860851002299
15:54:10.818 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xbced3e0c5d04e472 subj=0xbced3e0c5d04e472
15:54:10.818 DEBUG                    UUT Control: Applying all recent configuration changes
15:54:10.841 INFO    Test:            110 : [icm-issue-infia-cka-invalid-dev-func] The
|                                           CKA sends a CSR for an InfIA certificate
|                                           with an invalid DeviceFunction attribute and
|                                           receives a error response.
15:54:10.852 DEBUG                          CKA requesting Inf IA from ICM.
15:54:10.859 INFO                           SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:54:10.897 DEBUG                          Generating message signature using cert with serial: 5
15:54:10.929 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:918657295796830414101175676152777217990746604175078826878180720417073658447891652370185583608257909221751119031051313343059679110281664653192627477275440839070907267244788419480574984259087348823343278646082647713631543784162966772
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.8
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:3869467905679364435498947766574985376062968148143246034717064125165292252454072915011068553603287388935323453489117
|                                                       s = long384:3637840815268534398776452234637909754907976819406354219343756808550065122872315645778267391766301212723572758352083
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0xbced3e0c5d04e472-->0xbced3e0c5d04e472
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 5L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1478708281032420327098949512655427112556443215593293064044847047201719749390465164713514905563391964492154778528520321514189703512987749024877022788227677475214004249580255197435504336947047967397657379892001474000209092757900551282
|                                                               x = 37528756116172862218704003008900142329993865096521221962615695113870991204599311206733107263660553248470375600632356
|                                                               y = 15820573905014032154977543991280072425522052516308311066052069807996210542257850996635594705808786562283229843612786
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xbced3e0c5d04e472)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xbced3e0c5d04e472)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:36170687850892476976874810303759976594024970365524951740618810192610929669965414789841068206854102400613741227252671
|                                                           s = long384:30807544519758807891930492636156849400396731412005857959559435687521269108831720536406434181809945679462578801691814
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0xbced3e0c5d04e472)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112155410Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x65717108ed8ded3fbdae8e047d07d00eef2a159bac405278a6e186f90ff293df9175e3de2ffbfa1da9b79182c1f9ea13)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xe6fbe4a0b32dac8a)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:35632558302172461252297946226165018350174490356923546113832247250708230856370695735350020170709743712819310314111277
|                                                       s = long384:14014876840891609664010428058926245453584701951081444731154219442078922685512221548932094945084308117435425707358909
15:54:10.948 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:10.949 INFO                           SKD: Client ---> Server CMC-request (1329 bytes)
15:54:10.949 INFO                           Sent CSR for Inf IA certificate.
15:54:10.999 DEBUG                          Connected to Server
15:54:11.049 DEBUG                          Sending HTTP POST /fullcmc message.
15:54:11.050 DEBUG                          Removing HTTP POST /fullcmc message from Q.
15:54:11.202 DEBUG                          HTTP Status: 200 - OK
15:54:11.202 INFO                           SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (1765 bytes)
15:54:11.319 DEBUG                          Received SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = Integer(1)
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = Integer(2)
|                                                           otherInfo = OtherStatusInfo:
|                                                               failInfo = Integer(2)
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                               x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                               y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1de6a414dda88f8b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                           s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 82825L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                               x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                               y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2eb4fc66f0202ec8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                           s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112155411Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xe6fbe4a0b32dac8a)
|                                                           msgCount = 1L
|                                                     [4] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=,CN=
|                                                     [5] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xa398ffd4f2bd9a659ddc4da37aa54c2932303954638e852702d71cd1596bc4938e47fc0a9368ac931413a36a58a68d9b)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:37521757148952770349754037111768982139525372785192299863746356025211681285237358843852152660340811886942917933776724
|                                                       s = long384:10957365226609682513516514535594346374653357795966233130838326033469339145759733651331668711929233768808635016348305
15:54:11.319 DEBUG                          CKA: Handling, ('CertificateSigningResponse',)
15:54:11.321 DEBUG                          Connect closed for Server
15:54:11.324 INFO                           #> 0.1. Check request is displayed with correct status
15:54:11.328 DEBUG                          Connect closed for Server
15:54:11.891 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:11.942 DEBUG                          Connected to Server
15:54:11.992 DEBUG                          Sending HTTP GET /status_2 message.
15:54:11.992 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:54:12.097 DEBUG                          HTTP Status: 200 - OK
15:54:12.099 DEBUG                          Connect closed for Server
15:54:12.099 DEBUG                          Connect closed for Server
15:54:12.740 INFO                           #> 1. Check an error was received.
15:54:12.757 INFO    Test:                  PASS
15:54:12.889 DEBUG                    Tearing down mock HTTP servers
15:54:14.098 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:14.149 DEBUG                    Connected to Server
15:54:14.199 DEBUG                    Sending HTTP GET /status_2 message.
15:54:14.199 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:14.308 DEBUG                    HTTP Status: 200 - OK
15:54:14.308 DEBUG                    Connect closed for Server
15:54:14.309 DEBUG                    Connect closed for Server
15:54:16.308 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:16.359 DEBUG                    Connected to Server
15:54:16.409 DEBUG                    Sending HTTP GET /status_2 message.
15:54:16.410 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:16.511 DEBUG                    HTTP Status: 200 - OK
15:54:16.511 DEBUG                    Connect closed for Server
15:54:16.511 DEBUG                    Connect closed for Server
15:54:18.511 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:18.562 DEBUG                    Connected to Server
15:54:18.612 DEBUG                    Sending HTTP GET /status_2 message.
15:54:18.612 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:18.758 DEBUG                    HTTP Status: 200 - OK
15:54:18.758 DEBUG                    Connect closed for Server
15:54:18.759 DEBUG                    Connect closed for Server
15:54:20.636 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:54:20.636 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:54:20.648 DEBUG                    Generating certificate signature for serial: 84373
15:54:20.654 DEBUG                    Added keymat IR-INF-CA: serial=84373 auth=0xc9020cefbb66368c subj=0xf55e3eca94055992
15:54:20.666 DEBUG                    Generating certificate signature for serial: 81532
15:54:20.672 DEBUG                    Added keymat IR-INF-IA: serial=81532 auth=0xf55e3eca94055992 subj=0x47962a6aef75273f
15:54:20.685 DEBUG                    Generating certificate signature for serial: 89092
15:54:20.691 DEBUG                    Added keymat IR-INF-CRL-CA: serial=89092 auth=0xc9020cefbb66368c subj=0xd1b5676ce448cfa4
15:54:20.703 DEBUG                    Generating certificate signature for serial: 84533
15:54:20.708 DEBUG                    Added keymat IR-INF-CRL-IA: serial=84533 auth=0xd1b5676ce448cfa4 subj=0xea8a9414cd599da4
15:54:20.719 DEBUG                    Generating certificate signature for serial: 5
15:54:20.725 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xd2c569d4ce396838 subj=0xd2c569d4ce396838
15:54:20.733 DEBUG                    Generating message signature using cert with serial: 81532
15:54:20.767 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:54:20.818 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xd2c569d4ce396838 subj=0xd2c569d4ce396838
15:54:20.824 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:54:20.840 DEBUG                    Generating message signature using cert with serial: 5
15:54:20.897 DEBUG                    IR: Handling Certificate Signing Request.
15:54:20.897 DEBUG                    Creating temporary CA cert to issue IA
15:54:20.909 DEBUG                    Generating certificate signature for serial: 82535
15:54:20.915 DEBUG                    Added keymat IR-INF-CA-TMP: serial=82535 auth=0xc9020cefbb66368c subj=0x44e4b9e48698b8c5
15:54:20.915 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:54:20.921 DEBUG                    Generating certificate signature for serial: 20000
15:54:20.928 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:54:20.931 DEBUG                    Generating message signature using cert with serial: 81532
15:54:21.048 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:54:21.048 DEBUG                    Received Inf IA response
15:54:21.048 DEBUG                    Added keymat IR-INF-CA: serial=82535 auth=0xc9020cefbb66368c subj=0x44e4b9e48698b8c5
15:54:21.048 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x44e4b9e48698b8c5 subj=0x79a9dc3b18afaf68
15:54:21.059 DEBUG                    Generating certificate signature for serial: 5
15:54:21.064 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x318ebd053c9d4736 subj=0x318ebd053c9d4736
15:54:21.073 DEBUG                    Generating message signature using cert with serial: 20000
15:54:21.108 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:54:21.126 DEBUG                    Generating message signature using cert with serial: 20000
15:54:21.208 DEBUG                    IR: Handling Certificate Signing Request.
15:54:21.209 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:54:21.215 DEBUG                    Generating certificate signature for serial: 20001
15:54:21.221 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:54:21.224 DEBUG                    Generating message signature using cert with serial: 81532
15:54:21.319 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:54:21.319 DEBUG                    Received Inf CA response
15:54:21.320 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xe95b5bef726545e4
15:54:21.320 INFO                     Listening for ('128.10.1.4', 80)
15:54:21.324 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:54:21.328 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:54:21.328 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:54:21.380 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x318ebd053c9d4736 subj=0x318ebd053c9d4736
15:54:21.387 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:54:21.403 DEBUG                    Generating message signature using cert with serial: 5
15:54:21.461 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:54:21.467 DEBUG                    Generating certificate signature for serial: 20000
15:54:21.474 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:54:21.476 DEBUG                    Generating message signature using cert with serial: 20000
15:54:21.593 DEBUG                    Received Inf IA response
15:54:21.593 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xe95b5bef726545e4
15:54:21.593 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0xe95b5bef726545e4 subj=0x5b51f514762c622f
15:54:21.598 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:54:21.602 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:54:21.652 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x318ebd053c9d4736 subj=0x318ebd053c9d4736
15:54:21.652 INFO                     Listening for ('128.10.1.6', 80)
15:54:21.652 DEBUG                    MCKM requesting Inf IA from ICM.
15:54:21.658 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:54:21.675 DEBUG                    Generating message signature using cert with serial: 5
15:54:21.693 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:54:21.693 INFO                     SKD: Client ---> Server CMC-request (1342 bytes)
15:54:21.693 INFO                     Sent CSR for Inf IA certificate.
15:54:21.694 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:21.695 DEBUG                    105997520: Connect accepted from Client
15:54:21.744 DEBUG                    Connected to Server
15:54:21.745 DEBUG                    Connected to Server
15:54:21.795 DEBUG                    Sending HTTP POST /fullcmc message.
15:54:21.795 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:54:21.796 DEBUG                    Sending HTTP GET /status_2 message.
15:54:21.796 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:21.839 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:54:21.840 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:54:21.846 DEBUG                    Generating certificate signature for serial: 20001
15:54:21.856 DEBUG                    Generating message signature using cert with serial: 20000
15:54:21.911 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:54:21.912 DEBUG                    HTTP Status: 200 - OK
15:54:21.913 DEBUG                    HTTP Status: 200 - OK
15:54:21.913 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3138 bytes)
15:54:21.979 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:54:21.979 DEBUG                    Received Inf IA response
15:54:21.979 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xe95b5bef726545e4
15:54:21.980 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0xe95b5bef726545e4 subj=0x5a8c982e22e2b165
15:54:21.980 DEBUG                    Connect closed for Server
15:54:21.980 DEBUG                    Connect closed for Server
15:54:23.699 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:54:23.752 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x318ebd053c9d4736 subj=0x318ebd053c9d4736
15:54:23.753 DEBUG                    CKA requesting Inf IA from ICM.
15:54:23.758 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:54:23.775 DEBUG                    Generating message signature using cert with serial: 5
15:54:23.793 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:54:23.794 INFO                     SKD: Client ---> Server CMC-request (1329 bytes)
15:54:23.794 INFO                     Sent CSR for Inf IA certificate.
15:54:23.795 DEBUG                    105997520: Connect accepted from Client
15:54:23.795 DEBUG                    Connect closed for Server
15:54:23.795 DEBUG                    Connect closed for Server
15:54:23.846 DEBUG                    Connected to Server
15:54:23.894 DEBUG                    Sending HTTP POST /fullcmc message.
15:54:23.895 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:54:23.935 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:54:23.935 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:54:23.941 DEBUG                    Generating certificate signature for serial: 20002
15:54:23.951 DEBUG                    Generating message signature using cert with serial: 20000
15:54:24.004 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:54:24.005 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:24.006 DEBUG                    HTTP Status: 200 - OK
15:54:24.007 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3126 bytes)
15:54:24.071 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:54:24.072 DEBUG                    Received Inf IA response
15:54:24.072 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xe95b5bef726545e4
15:54:24.072 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0xe95b5bef726545e4 subj=0x0ab46795da33779c
15:54:24.072 DEBUG                    Connected to Server
15:54:24.105 DEBUG                    Sending HTTP GET /status_2 message.
15:54:24.106 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:24.190 DEBUG                    HTTP Status: 200 - OK
15:54:24.191 DEBUG                    Connect closed for Server
15:54:24.192 DEBUG                    Connect closed for Server
15:54:26.191 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:26.244 DEBUG                    Connected to Server
15:54:26.293 DEBUG                    Sending HTTP GET /status_2 message.
15:54:26.293 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:26.390 DEBUG                    HTTP Status: 200 - OK
15:54:26.390 DEBUG                    Connect closed for Server
15:54:26.391 DEBUG                    Connect closed for Server
15:54:28.001 DEBUG                    ########## Mocks complete ##########
15:54:28.390 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:28.441 DEBUG                    Connected to Server
15:54:28.491 DEBUG                    Sending HTTP GET /status_2 message.
15:54:28.491 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:28.618 DEBUG                    HTTP Status: 200 - OK
15:54:28.619 DEBUG                    Connect closed for Server
15:54:28.619 DEBUG                    Connect closed for Server
15:54:28.908 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:54:28.909 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:54:29.881 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:54:29.881 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:54:30.619 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:30.670 DEBUG                    Connected to Server
15:54:30.720 DEBUG                    Sending HTTP GET /status_2 message.
15:54:30.720 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:30.803 DEBUG                    HTTP Status: 200 - OK
15:54:30.804 DEBUG                    Connect closed for Server
15:54:30.804 DEBUG                    Connect closed for Server
15:54:32.804 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:32.855 DEBUG                    Connected to Server
15:54:32.905 DEBUG                    Sending HTTP GET /status_2 message.
15:54:32.905 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:32.993 DEBUG                    HTTP Status: 200 - OK
15:54:32.994 DEBUG                    Connect closed for Server
15:54:32.995 DEBUG                    Connect closed for Server
15:54:34.994 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:35.045 DEBUG                    Connected to Server
15:54:35.095 DEBUG                    Sending HTTP GET /status_2 message.
15:54:35.095 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:35.189 DEBUG                    HTTP Status: 200 - OK
15:54:35.196 DEBUG                    Connect closed for Server
15:54:35.196 DEBUG                    Connect closed for Server
15:54:37.195 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:37.246 DEBUG                    Connected to Server
15:54:37.296 DEBUG                    Sending HTTP GET /status_2 message.
15:54:37.296 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:37.397 DEBUG                    HTTP Status: 200 - OK
15:54:37.397 DEBUG                    Connect closed for Server
15:54:37.398 DEBUG                    Connect closed for Server
15:54:39.397 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:39.448 DEBUG                    Connected to Server
15:54:39.498 DEBUG                    Sending HTTP GET /status_2 message.
15:54:39.498 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:39.609 DEBUG                    HTTP Status: 200 - OK
15:54:39.609 DEBUG                    Connect closed for Server
15:54:39.610 DEBUG                    Connect closed for Server
15:54:41.609 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:41.659 DEBUG                    Connected to Server
15:54:41.709 DEBUG                    Sending HTTP GET /status_2 message.
15:54:41.710 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:41.804 DEBUG                    HTTP Status: 200 - OK
15:54:41.804 DEBUG                    Connect closed for Server
15:54:41.805 DEBUG                    Connect closed for Server
15:54:43.804 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:43.855 DEBUG                    Connected to Server
15:54:43.904 DEBUG                    Sending HTTP GET /status_2 message.
15:54:43.905 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:44.031 DEBUG                    HTTP Status: 200 - OK
15:54:44.032 DEBUG                    Connect closed for Server
15:54:44.041 DEBUG                    Connect closed for Server
15:54:46.032 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:46.082 DEBUG                    Connected to Server
15:54:46.132 DEBUG                    Sending HTTP GET /status_2 message.
15:54:46.132 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:46.238 DEBUG                    HTTP Status: 200 - OK
15:54:46.238 DEBUG                    Connect closed for Server
15:54:46.239 DEBUG                    Connect closed for Server
15:54:48.011 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:710724219230617974300463463945272145984675890626217447071924565271662776083574511354051727938099948203973318123034055410908468906590034304336252113320085833859839122166794760266114542985301912714214169105523769689676323118756800806
|                                                     x = 18037767307788848561035191435271024652154248161547552931071268773594762636050563226138193439685891224160400877667848
|                                                     y = 38185408032866495927955268121961818080001143753002614215911728282383658225511975197288692316349967506647570698348838
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:32197072745081427941408974279739834404589434005006904841753072700376576591004671542805223043071107768823305026646415
|                                                 s = long384:35337273324409485584327258780771760949710718149608796476339542452501200157369439657399899572937411069279802237927947
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155431Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 5L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x9ee673f0a67a7008f58aef05458c155da7199feee7d074a0ab52782ae6a6445955239ff4f790b1de43413a156a68ae70)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:15997573126069509482237991951082657910699888881308078572820503413548818350989219005511242779100158395260888416503060
|                                                 s = long384:26963427753612743745245412021819550782670476346708011815248720218242140883593532936706274891213355400561010139768957
15:54:48.012 DEBUG                    IR: Handling Certificate Signing Request.
15:54:48.013 DEBUG                    Generating InfCA certificate (serialNumber: 20002L)
15:54:48.020 DEBUG                    Generating certificate signature for serial: 20002
15:54:48.026 DEBUG                    Creating SKD message file /tmp/infca.resp
15:54:48.029 DEBUG                    Generating message signature using cert with serial: 81532
15:54:48.060 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0x47962a6aef75273f-->0xf55e3eca94055992-->0xc9020cefbb66368c
|                                             0x239c6c45a4a62926-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 81532L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155420Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:861527584687823124190308408122834626937648993011829233652044233970216408344080885878176500358309422220854991294782556724048244958347252759857296763565603246422528861452928530944274723690609685008864319177481336361427267066189391679
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xf55e3eca94055992)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x47962a6aef75273f)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:39298123618863049380324908499078884451936378864879274121998160394111586316112538116254941773288759794429753801237921
|                                                     s = long384:12456753341412159377498718436621995228393553401696892860768120566678245863518217737224931130310856120074553142180622
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 84373L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155420Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1506690358522396892396757090020418307543101326875319291876595367702077536914697203987188059734180850638245515499808031391687170721047380790898376505465502566373431903956819751234564374242055042239225691188207590372416093476480178578
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xf55e3eca94055992)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:5240093347584127859874441158912226704087668802456116609014699541647768917461528485106975668602254886260834496276814
|                                                     s = long384:10875542480549294422917757937120854657676368152117117174136925021934711467985037589837609878961065798701203549088949
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155448Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:710724219230617974300463463945272145984675890626217447071924565271662776083574511354051727938099948203973318123034055410908468906590034304336252113320085833859839122166794760266114542985301912714214169105523769689676323118756800806
|                                                         x = 18037767307788848561035191435271024652154248161547552931071268773594762636050563226138193439685891224160400877667848
|                                                         y = 38185408032866495927955268121961818080001143753002614215911728282383658225511975197288692316349967506647570698348838
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x239c6c45a4a62926)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:13220752619912151740603018116499160362461099001721691792477149701291342835648538175363172201171041712727733474187477
|                                                     s = long384:31992435927371316916315077293367637076676072500254421676791816400106407569102169837861910185439457940889180689752230
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x47962a6aef75273f)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155448Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 5L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:30497852655608720946430738866396180488247571101964652382385671571909559472807031668756076808596713487441538673251312
|                                                 s = long384:14427392872990382360982009202926772921079279566037439799300517394937047751565805969138554328622486174889479349836385
15:54:48.238 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:48.289 DEBUG                    Connected to Server
15:54:48.339 DEBUG                    Sending HTTP GET /status_2 message.
15:54:48.339 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:48.411 DEBUG                    HTTP Status: 200 - OK
15:54:48.412 DEBUG                    Connect closed for Server
15:54:48.412 DEBUG                    Connect closed for Server
15:54:50.412 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:50.462 DEBUG                    Connected to Server
15:54:50.512 DEBUG                    Sending HTTP GET /status_2 message.
15:54:50.512 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:50.616 DEBUG                    HTTP Status: 200 - OK
15:54:50.617 DEBUG                    Connect closed for Server
15:54:50.618 DEBUG                    Connect closed for Server
15:54:52.617 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:52.668 DEBUG                    Connected to Server
15:54:52.718 DEBUG                    Sending HTTP GET /status_2 message.
15:54:52.719 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:52.822 DEBUG                    HTTP Status: 200 - OK
15:54:52.828 DEBUG                    Connect closed for Server
15:54:52.828 DEBUG                    Connect closed for Server
15:54:53.115 DEBUG                    cmd optimus > keydir
15:54:53.160 DEBUG                    cmd optimus > keydir /tmp/
15:54:54.827 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:54.878 DEBUG                    Connected to Server
15:54:54.928 DEBUG                    Sending HTTP GET /status_2 message.
15:54:54.928 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:55.013 DEBUG                    HTTP Status: 200 - OK
15:54:55.014 DEBUG                    Connect closed for Server
15:54:55.014 DEBUG                    Connect closed for Server
15:54:57.014 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:57.065 DEBUG                    Connected to Server
15:54:57.115 DEBUG                    Sending HTTP GET /status_2 message.
15:54:57.115 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:54:57.191 DEBUG                    HTTP Status: 200 - OK
15:54:57.191 DEBUG                    Connect closed for Server
15:54:57.191 DEBUG                    Connect closed for Server
15:54:58.363 DEBUG                    cmd optimus > keydir ../Keys/
15:54:58.467 DEBUG                    Received SKD message:
|                                     KeyPackageFile:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = List:
|                                             [0]:
|                                                 OneAsymmetricKey:
|                                                     version == 0
|                                                     privateKeyAlgorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     privateKey = ECPrivateKey:
|                                                         version = 1L
|                                                         privateKey = Octets(0xcf6437e4302e029c0bc1da13f5878b709889010ebf522bc83d560bf014e132e925df18b02454c6cdb7d07524e771b0e3)
|                                                     attributes:
|                                                       [0] = UserCertificateAttr:
|                                                         id == OID(userCertificate:2.5.4.36)
|                                                         userCertificate = Certificate:
|                                                             tbsCertificate = TBSCertificate:
|                                                                 version == 2
|                                                                 serialNumber = 6L
|                                                                 signatureAlgorithmID = AlgorithmIdentifier:
|                                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                 issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 validity = 170112000000Z..99991231235959Z
|                                                                 subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                     algorithm = AlgorithmIdentifier:
|                                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                         parameters = ECParameters:
|                                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                     subjectPublicKey = long768:633425226675749225463553949710287291707626840338432165892395551881716725461532290140085763954895085207289487360617369182195433951614419889211441246970801952178533870325896163015963898987062904460560219288250658595752551094881400854
|                                                                     x = 16075963835915325734266724700284383111689191390907567343077503901455923988639669948526164039628023085045927533923253
|                                                                     y = 361745802588528822431277076891793681903666583523127741062928370237460846688928505727661964403983210867195214608406
|                                                                 _extensions = CertificateExtensions
|                                                                   [0] AuthorityKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                         keyIdentifier = Octets(0x8c1751f90c68b816)
|                                                                   [1] SubjectKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                         id = Octets(0x8c1751f90c68b816)
|                                                                   [2] KeyUsage_CertExt:
|                                                                         extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                         critical = True
|                                                                         uses = ['digitalSignature']
|                                                                   [3] CertificatePolicies_CertExt:
|                                                                         extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                         critical = True
|                                                                         policies:
|                                                                           [0] = PolicyInformation:
|                                                                             id = OID(1.2.826.0.1145.0.1.0.3)
|                                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                             signature = Signature:
|                                                                 r = long384:10019977013876802264172020641893389717564076680432889968303426255941628722320626042059444001826189756094246346652097
|                                                                 s = long384:34847812114048115724062687171322474022502957851985948385921196493395959092319560035236094876067315264871110078153782
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                               [1] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0xa31f1d6564a60ce7e92512ab0ff4b0ad0ac24173694290e9bb4ad2d32d101ab1c7f2c3ee88e093556e56e79700a26706)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:29207387618387878811145455299021968165873600082652834074925676588759823197992322919239321114575933907555480443753301
|                                                 s = long384:12416507665100219729756918244121957090519328406226121082726970505329510203356689506532104797902554408934040245174298
15:54:58.468 DEBUG                    Added keymat FACT-IA: serial=6 auth=0x8c1751f90c68b816 subj=0x8c1751f90c68b816
15:54:58.468 DEBUG                    UUT Control: Applying all recent configuration changes
15:54:58.491 INFO    Test:            111 : [icm-issue-infia-cka-missing-dev-func] The
|                                           CKA sends a CSR for an InfIA certificate
|                                           with no DeviceFunction attribute and
|                                           receives a error response.
15:54:58.502 DEBUG                          CKA requesting Inf IA from ICM.
15:54:58.509 INFO                           SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:54:58.547 DEBUG                          Generating message signature using cert with serial: 6
15:54:58.579 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:879793402759690324709890544084832494238864492183750352816577588115298062160800331598162624708015173250486669629015136343165039691043863526587659313728839729815361708673415885955972987095001698848417688127919682030929572615662805373
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:34210540770429357900550834914053257042985137867348035712360740176358831672307057360165379874111250620628185702897060
|                                                       s = long384:33431588957948982449771674147095280321955552166088279886274279459594659791752351947376315911117969831587340713819858
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x8c1751f90c68b816-->0x8c1751f90c68b816
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 6L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:633425226675749225463553949710287291707626840338432165892395551881716725461532290140085763954895085207289487360617369182195433951614419889211441246970801952178533870325896163015963898987062904460560219288250658595752551094881400854
|                                                               x = 16075963835915325734266724700284383111689191390907567343077503901455923988639669948526164039628023085045927533923253
|                                                               y = 361745802588528822431277076891793681903666583523127741062928370237460846688928505727661964403983210867195214608406
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x8c1751f90c68b816)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x8c1751f90c68b816)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:10019977013876802264172020641893389717564076680432889968303426255941628722320626042059444001826189756094246346652097
|                                                           s = long384:34847812114048115724062687171322474022502957851985948385921196493395959092319560035236094876067315264871110078153782
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x8c1751f90c68b816)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112155458Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x49231eed8b8511f58fd51cb59de347d4e3804d1f694bfc36e03401b8ad92e13202e399540d2bbad20a9c901cb9e86d32)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x3b34d2047a906bee)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:12977009150182648104114074260609360887619980116862895029134193223532214963289425064404534049067778219494178372872653
|                                                       s = long384:29054374103063944437143372173176301989107690599094721280823883774784303936925983094311343600526233561190047629936183
15:54:58.598 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:58.599 INFO                           SKD: Client ---> Server CMC-request (1320 bytes)
15:54:58.599 INFO                           Sent CSR for Inf IA certificate.
15:54:58.649 DEBUG                          Connected to Server
15:54:58.700 DEBUG                          Sending HTTP POST /fullcmc message.
15:54:58.701 DEBUG                          Removing HTTP POST /fullcmc message from Q.
15:54:58.905 DEBUG                          HTTP Status: 200 - OK
15:54:58.905 INFO                           SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (1764 bytes)
15:54:59.018 DEBUG                          Received SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = Integer(1)
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = Integer(2)
|                                                           otherInfo = OtherStatusInfo:
|                                                               failInfo = Integer(2)
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                               x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                               y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1de6a414dda88f8b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                           s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 82825L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                               x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                               y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2eb4fc66f0202ec8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                           s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112155458Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x3b34d2047a906bee)
|                                                           msgCount = 1L
|                                                     [4] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=,CN=
|                                                     [5] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xa398ffd4f2bd9a659ddc4da37aa54c2932303954638e852702d71cd1596bc4938e47fc0a9368ac931413a36a58a68d9b)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:4734547538574830955971477075136349702456583788566863182890835704053354431735187343529886503027262193012512153186325
|                                                       s = long384:6077764948817410499025192886674498500864042943096498189055657258314439436598126562602348700077422060605567107272716
15:54:59.019 DEBUG                          CKA: Handling, ('CertificateSigningResponse',)
15:54:59.021 DEBUG                          Connect closed for Server
15:54:59.024 INFO                           #> 0.1. Check request is displayed with correct status
15:54:59.027 DEBUG                          Connect closed for Server
15:54:59.192 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:54:59.244 DEBUG                          Connected to Server
15:54:59.293 DEBUG                          Sending HTTP GET /status_2 message.
15:54:59.293 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:54:59.398 DEBUG                          HTTP Status: 200 - OK
15:54:59.399 DEBUG                          Connect closed for Server
15:54:59.405 DEBUG                          Connect closed for Server
15:55:00.686 INFO                           #> 1. Check an error was received.
15:55:00.701 INFO    Test:                  PASS
15:55:00.852 DEBUG                    Tearing down mock HTTP servers
15:55:01.403 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:01.454 DEBUG                    Connected to Server
15:55:01.503 DEBUG                    Sending HTTP GET /status_2 message.
15:55:01.504 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:01.597 DEBUG                    HTTP Status: 200 - OK
15:55:01.597 DEBUG                    Connect closed for Server
15:55:01.598 DEBUG                    Connect closed for Server
15:55:03.597 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:03.648 DEBUG                    Connected to Server
15:55:03.698 DEBUG                    Sending HTTP GET /status_2 message.
15:55:03.699 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:03.809 DEBUG                    HTTP Status: 200 - OK
15:55:03.817 DEBUG                    Connect closed for Server
15:55:03.817 DEBUG                    Connect closed for Server
15:55:05.815 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:05.866 DEBUG                    Connected to Server
15:55:05.916 DEBUG                    Sending HTTP GET /status_2 message.
15:55:05.916 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:06.013 DEBUG                    HTTP Status: 200 - OK
15:55:06.014 DEBUG                    Connect closed for Server
15:55:06.014 DEBUG                    Connect closed for Server
15:55:08.156 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:55:08.156 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:55:08.168 DEBUG                    Generating certificate signature for serial: 86101
15:55:08.174 DEBUG                    Added keymat IR-INF-CA: serial=86101 auth=0xc9020cefbb66368c subj=0x8b69d5e1a5989730
15:55:08.186 DEBUG                    Generating certificate signature for serial: 81256
15:55:08.191 DEBUG                    Added keymat IR-INF-IA: serial=81256 auth=0x8b69d5e1a5989730 subj=0x44fb85ae66938d87
15:55:08.203 DEBUG                    Generating certificate signature for serial: 84052
15:55:08.209 DEBUG                    Added keymat IR-INF-CRL-CA: serial=84052 auth=0xc9020cefbb66368c subj=0xca9649ec4cc9cb28
15:55:08.221 DEBUG                    Generating certificate signature for serial: 81416
15:55:08.227 DEBUG                    Added keymat IR-INF-CRL-IA: serial=81416 auth=0xca9649ec4cc9cb28 subj=0xa2ed8357f3b2d646
15:55:08.237 DEBUG                    Generating certificate signature for serial: 5
15:55:08.243 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xcac74b0ad27137c4 subj=0xcac74b0ad27137c4
15:55:08.251 DEBUG                    Generating message signature using cert with serial: 81256
15:55:08.285 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:55:08.336 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xcac74b0ad27137c4 subj=0xcac74b0ad27137c4
15:55:08.342 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:55:08.358 DEBUG                    Generating message signature using cert with serial: 5
15:55:08.416 DEBUG                    IR: Handling Certificate Signing Request.
15:55:08.416 DEBUG                    Creating temporary CA cert to issue IA
15:55:08.428 DEBUG                    Generating certificate signature for serial: 87415
15:55:08.434 DEBUG                    Added keymat IR-INF-CA-TMP: serial=87415 auth=0xc9020cefbb66368c subj=0xa94daac075dbd821
15:55:08.434 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:55:08.440 DEBUG                    Generating certificate signature for serial: 20000
15:55:08.446 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:55:08.449 DEBUG                    Generating message signature using cert with serial: 81256
15:55:08.565 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:55:08.566 DEBUG                    Received Inf IA response
15:55:08.566 DEBUG                    Added keymat IR-INF-CA: serial=87415 auth=0xc9020cefbb66368c subj=0xa94daac075dbd821
15:55:08.566 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0xa94daac075dbd821 subj=0xf2418d2fcfaaf61e
15:55:08.576 DEBUG                    Generating certificate signature for serial: 5
15:55:08.582 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xfd6b4db809e48624 subj=0xfd6b4db809e48624
15:55:08.590 DEBUG                    Generating message signature using cert with serial: 20000
15:55:08.626 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:55:08.643 DEBUG                    Generating message signature using cert with serial: 20000
15:55:08.727 DEBUG                    IR: Handling Certificate Signing Request.
15:55:08.727 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:55:08.734 DEBUG                    Generating certificate signature for serial: 20001
15:55:08.740 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:55:08.743 DEBUG                    Generating message signature using cert with serial: 81256
15:55:08.839 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:55:08.839 DEBUG                    Received Inf CA response
15:55:08.839 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x4e1bcbd3952d17e0
15:55:08.840 INFO                     Listening for ('128.10.1.4', 80)
15:55:08.844 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:55:08.848 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:55:08.848 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:55:08.899 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xfd6b4db809e48624 subj=0xfd6b4db809e48624
15:55:08.905 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:55:08.922 DEBUG                    Generating message signature using cert with serial: 5
15:55:08.981 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:55:08.987 DEBUG                    Generating certificate signature for serial: 20000
15:55:08.994 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:55:08.997 DEBUG                    Generating message signature using cert with serial: 20000
15:55:09.115 DEBUG                    Received Inf IA response
15:55:09.115 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x4e1bcbd3952d17e0
15:55:09.116 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x4e1bcbd3952d17e0 subj=0xe1e2b56cae4f3fd8
15:55:09.120 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:55:09.124 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:55:09.174 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xfd6b4db809e48624 subj=0xfd6b4db809e48624
15:55:09.175 INFO                     Listening for ('128.10.1.6', 80)
15:55:09.175 DEBUG                    MCKM requesting Inf IA from ICM.
15:55:09.181 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:55:09.198 DEBUG                    Generating message signature using cert with serial: 5
15:55:09.217 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:55:09.217 INFO                     SKD: Client ---> Server CMC-request (1339 bytes)
15:55:09.217 INFO                     Sent CSR for Inf IA certificate.
15:55:09.218 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:09.218 DEBUG                    106402256: Connect accepted from Client
15:55:09.267 DEBUG                    Connected to Server
15:55:09.268 DEBUG                    Connected to Server
15:55:09.317 DEBUG                    Sending HTTP POST /fullcmc message.
15:55:09.318 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:55:09.319 DEBUG                    Sending HTTP GET /status_2 message.
15:55:09.319 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:09.385 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:55:09.385 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:55:09.394 DEBUG                    Generating certificate signature for serial: 20001
15:55:09.404 DEBUG                    Generating message signature using cert with serial: 20000
15:55:09.458 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:55:09.460 DEBUG                    HTTP Status: 200 - OK
15:55:09.460 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3140 bytes)
15:55:09.526 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:55:09.526 DEBUG                    Received Inf IA response
15:55:09.526 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x4e1bcbd3952d17e0
15:55:09.527 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x4e1bcbd3952d17e0 subj=0x360085307aab03c9
15:55:09.527 DEBUG                    HTTP Status: 200 - OK
15:55:09.528 DEBUG                    Connect closed for Server
15:55:09.528 DEBUG                    Connect closed for Server
15:55:11.223 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:55:11.274 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xfd6b4db809e48624 subj=0xfd6b4db809e48624
15:55:11.274 DEBUG                    CKA requesting Inf IA from ICM.
15:55:11.280 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:55:11.297 DEBUG                    Generating message signature using cert with serial: 5
15:55:11.315 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:55:11.316 INFO                     SKD: Client ---> Server CMC-request (1331 bytes)
15:55:11.316 INFO                     Sent CSR for Inf IA certificate.
15:55:11.317 DEBUG                    106402256: Connect accepted from Client
15:55:11.317 DEBUG                    Connect closed for Server
15:55:11.317 DEBUG                    Connect closed for Server
15:55:11.368 DEBUG                    Connected to Server
15:55:11.417 DEBUG                    Sending HTTP POST /fullcmc message.
15:55:11.418 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:55:11.465 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:55:11.466 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:55:11.472 DEBUG                    Generating certificate signature for serial: 20002
15:55:11.482 DEBUG                    Generating message signature using cert with serial: 20000
15:55:11.535 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:55:11.536 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:11.538 DEBUG                    HTTP Status: 200 - OK
15:55:11.538 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3129 bytes)
15:55:11.602 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:55:11.603 DEBUG                    Received Inf IA response
15:55:11.603 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x4e1bcbd3952d17e0
15:55:11.603 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x4e1bcbd3952d17e0 subj=0xbb6ab6c2a2c8450e
15:55:11.604 DEBUG                    Connected to Server
15:55:11.636 DEBUG                    Sending HTTP GET /status_2 message.
15:55:11.637 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:11.688 DEBUG                    HTTP Status: 200 - OK
15:55:11.689 DEBUG                    Connect closed for Server
15:55:11.689 DEBUG                    Connect closed for Server
15:55:13.690 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:13.740 DEBUG                    Connected to Server
15:55:13.791 DEBUG                    Sending HTTP GET /status_2 message.
15:55:13.792 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:13.887 DEBUG                    HTTP Status: 200 - OK
15:55:13.888 DEBUG                    Connect closed for Server
15:55:13.888 DEBUG                    Connect closed for Server
15:55:15.522 DEBUG                    ########## Mocks complete ##########
15:55:15.888 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:15.939 DEBUG                    Connected to Server
15:55:15.988 DEBUG                    Sending HTTP GET /status_2 message.
15:55:15.989 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:16.094 DEBUG                    HTTP Status: 200 - OK
15:55:16.095 DEBUG                    Connect closed for Server
15:55:16.096 DEBUG                    Connect closed for Server
15:55:16.415 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:55:16.415 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:55:17.359 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:55:17.360 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:55:18.095 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:18.146 DEBUG                    Connected to Server
15:55:18.196 DEBUG                    Sending HTTP GET /status_2 message.
15:55:18.196 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:18.302 DEBUG                    HTTP Status: 200 - OK
15:55:18.303 DEBUG                    Connect closed for Server
15:55:18.303 DEBUG                    Connect closed for Server
15:55:20.303 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:20.353 DEBUG                    Connected to Server
15:55:20.403 DEBUG                    Sending HTTP GET /status_2 message.
15:55:20.404 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:20.515 DEBUG                    HTTP Status: 200 - OK
15:55:20.516 DEBUG                    Connect closed for Server
15:55:20.516 DEBUG                    Connect closed for Server
15:55:22.516 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:22.567 DEBUG                    Connected to Server
15:55:22.616 DEBUG                    Sending HTTP GET /status_2 message.
15:55:22.617 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:22.913 DEBUG                    HTTP Status: 200 - OK
15:55:22.913 DEBUG                    Connect closed for Server
15:55:22.914 DEBUG                    Connect closed for Server
15:55:24.914 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:24.964 DEBUG                    Connected to Server
15:55:25.014 DEBUG                    Sending HTTP GET /status_2 message.
15:55:25.015 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:25.121 DEBUG                    HTTP Status: 200 - OK
15:55:25.122 DEBUG                    Connect closed for Server
15:55:25.122 DEBUG                    Connect closed for Server
15:55:27.122 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:27.172 DEBUG                    Connected to Server
15:55:27.222 DEBUG                    Sending HTTP GET /status_2 message.
15:55:27.223 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:27.320 DEBUG                    HTTP Status: 200 - OK
15:55:27.320 DEBUG                    Connect closed for Server
15:55:27.321 DEBUG                    Connect closed for Server
15:55:29.320 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:29.371 DEBUG                    Connected to Server
15:55:29.420 DEBUG                    Sending HTTP GET /status_2 message.
15:55:29.421 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:29.499 DEBUG                    HTTP Status: 200 - OK
15:55:29.499 DEBUG                    Connect closed for Server
15:55:29.499 DEBUG                    Connect closed for Server
15:55:31.499 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:31.550 DEBUG                    Connected to Server
15:55:31.599 DEBUG                    Sending HTTP GET /status_2 message.
15:55:31.600 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:31.730 DEBUG                    HTTP Status: 200 - OK
15:55:31.736 DEBUG                    Connect closed for Server
15:55:31.736 DEBUG                    Connect closed for Server
15:55:33.736 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:33.787 DEBUG                    Connected to Server
15:55:33.836 DEBUG                    Sending HTTP GET /status_2 message.
15:55:33.837 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:33.896 DEBUG                    HTTP Status: 200 - OK
15:55:33.897 DEBUG                    Connect closed for Server
15:55:33.897 DEBUG                    Connect closed for Server
15:55:35.897 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:35.947 DEBUG                    Connected to Server
15:55:35.997 DEBUG                    Sending HTTP GET /status_2 message.
15:55:35.998 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:36.121 DEBUG                    HTTP Status: 200 - OK
15:55:36.122 DEBUG                    Connect closed for Server
15:55:36.122 DEBUG                    Connect closed for Server
15:55:38.122 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:38.183 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:281249255001280776010618062476515113358342899379380776387800253947515743129070045112512924297933655873854844811589466213760901288315283245347940719426018877940262277260381764953106767649242528354652635066251330576511156283339693276
|                                                     x = 7137942509816080789087258801190134101920419165841543517295837733228975025688678802831658040744419469480207080626886
|                                                     y = 10977306708637299523014336146870710067135256630818686821656134015872170985222225585510263009318501598946494581038300
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:38606227968552435294236342507928538990653551640955521987842673984843184181106442297120826272223493934145824225803935
|                                                 s = long384:13764000083487395047269197842804744011985756343034223296591670370579358112627651210569324562762513206837402276444046
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155519Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 6L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0xf9973eabb587bb49e002b178089b1fb60e861dd3d9a05a57e14113c85437507bab56125386ebf4a5ea20294b4797f833)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:18612100218997214385872678553635332757358843299309641005232602806863077889670451840599029083380473615111111414371282
|                                                 s = long384:6698783403451868055860933824042322322258056878929375993309676988386108265363102719677226958973610127310756460470063
15:55:38.184 DEBUG                    Connected to Server
15:55:38.184 DEBUG                    IR: Handling Certificate Signing Request.
15:55:38.185 DEBUG                    Generating InfCA certificate (serialNumber: 20002L)
15:55:38.191 DEBUG                    Generating certificate signature for serial: 20002
15:55:38.198 DEBUG                    Creating SKD message file /tmp/infca.resp
15:55:38.200 DEBUG                    Generating message signature using cert with serial: 81256
15:55:38.231 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0x9b13958d7b6bdcdc-->0xc9020cefbb66368c
|                                             0x44fb85ae66938d87-->0x8b69d5e1a5989730-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155538Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:281249255001280776010618062476515113358342899379380776387800253947515743129070045112512924297933655873854844811589466213760901288315283245347940719426018877940262277260381764953106767649242528354652635066251330576511156283339693276
|                                                         x = 7137942509816080789087258801190134101920419165841543517295837733228975025688678802831658040744419469480207080626886
|                                                         y = 10977306708637299523014336146870710067135256630818686821656134015872170985222225585510263009318501598946494581038300
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x9b13958d7b6bdcdc)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:3130532657927586158462868255137467269114624497290843042480251303280223466026675879197892890670237426968721204036743
|                                                     s = long384:7040306779398688424149271933775343508160480963673217418443534972536793447159587755484144257529903466680437923074851
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 81256L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155508Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:395623796935103859559764180812606398672195606598038855053054657113535110103642107008870752391091767382649902088537639445220752767479708810652770485003631240859506470816891544414874352925373851024051099301339149065815971805139275143
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x8b69d5e1a5989730)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x44fb85ae66938d87)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:15557181792760366043631898023706100612317354007654257621394693181488953744575539483331249171614332702337451155240846
|                                                     s = long384:18882528383827673532399915943429714986441563370680024417201042560265467713711232960376301498531578828326624387290072
|                                                 [1.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 86101L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155508Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1248836688821534119516080942780677277851935067785476832151163478664727565777065121877347427459519982371202976994277776287755841683037116649953911494621589501839405628813859185735870425755788247233886270388658781577870006692674574128
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x8b69d5e1a5989730)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:18047140587489927180636527202269219322905086697254151294369145013169209007335786520429983312108420568914950436212503
|                                                     s = long384:28253349427840058639419665874537504132232842591487149587097030025086161555743534379247500834258190461565892461003075
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x44fb85ae66938d87)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155538Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 6L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:1084072545728429014507123989688200093434771465801945533350599914936457801000839350228102160580187745690673786225133
|                                                 s = long384:13116258656930586787535352797997297963577224464933528857949476277879271361897208905630616605133578824812509567348250
15:55:38.249 DEBUG                    Sending HTTP GET /status_2 message.
15:55:38.250 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:38.394 DEBUG                    HTTP Status: 200 - OK
15:55:38.395 DEBUG                    Connect closed for Server
15:55:38.395 DEBUG                    Connect closed for Server
15:55:40.394 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:40.445 DEBUG                    Connected to Server
15:55:40.495 DEBUG                    Sending HTTP GET /status_2 message.
15:55:40.496 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:40.589 DEBUG                    HTTP Status: 200 - OK
15:55:40.590 DEBUG                    Connect closed for Server
15:55:40.590 DEBUG                    Connect closed for Server
15:55:42.591 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:42.642 DEBUG                    Connected to Server
15:55:42.691 DEBUG                    Sending HTTP GET /status_2 message.
15:55:42.692 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:42.813 DEBUG                    HTTP Status: 200 - OK
15:55:42.814 DEBUG                    Connect closed for Server
15:55:42.815 DEBUG                    Connect closed for Server
15:55:44.041 DEBUG                    cmd optimus > keydir
15:55:44.084 DEBUG                    cmd optimus > keydir /tmp/
15:55:44.814 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:44.870 DEBUG                    Connected to Server
15:55:44.915 DEBUG                    Sending HTTP GET /status_2 message.
15:55:44.915 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:44.993 DEBUG                    HTTP Status: 200 - OK
15:55:44.993 DEBUG                    Connect closed for Server
15:55:44.993 DEBUG                    Connect closed for Server
15:55:46.993 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:47.044 DEBUG                    Connected to Server
15:55:47.094 DEBUG                    Sending HTTP GET /status_2 message.
15:55:47.094 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:47.224 DEBUG                    HTTP Status: 200 - OK
15:55:47.225 DEBUG                    Connect closed for Server
15:55:47.225 DEBUG                    Connect closed for Server
15:55:49.224 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:49.281 DEBUG                    Connected to Server
15:55:49.325 DEBUG                    Sending HTTP GET /status_2 message.
15:55:49.325 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:49.421 DEBUG                    HTTP Status: 200 - OK
15:55:49.422 DEBUG                    Connect closed for Server
15:55:49.423 DEBUG                    Connect closed for Server
15:55:50.428 DEBUG                    cmd optimus > keydir ../Keys/
15:55:50.534 DEBUG                    Received SKD message:
|                                     KeyPackageFile:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = List:
|                                             [0]:
|                                                 OneAsymmetricKey:
|                                                     version == 0
|                                                     privateKeyAlgorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     privateKey = ECPrivateKey:
|                                                         version = 1L
|                                                         privateKey = Octets(0x780b797c7b0d042a1ada2d0a808087043a9f4cfd649890e9ea4eb3841429ece83b3ef3c6b9b9f3d3d0604943a868d245)
|                                                     attributes:
|                                                       [0] = UserCertificateAttr:
|                                                         id == OID(userCertificate:2.5.4.36)
|                                                         userCertificate = Certificate:
|                                                             tbsCertificate = TBSCertificate:
|                                                                 version == 2
|                                                                 serialNumber = 7L
|                                                                 signatureAlgorithmID = AlgorithmIdentifier:
|                                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                 issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 validity = 170112000000Z..99991231235959Z
|                                                                 subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                     algorithm = AlgorithmIdentifier:
|                                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                         parameters = ECParameters:
|                                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                     subjectPublicKey = long768:937246235294779390408761185226201565840706307844416022374312347203083526891472626641708898378944881912611429422554901165637313430155633550451564321293861965312019181508070065398326553462418698940573375318994666510233352625121971924
|                                                                     x = 23786764324212076887910523171967234118399903680880089322033884542410100731440243087791037256009513406772342547931170
|                                                                     y = 2024600667054584269758063801421720074807599829244400426119832426518716488351663150182557430767569971985990772117204
|                                                                 _extensions = CertificateExtensions
|                                                                   [0] AuthorityKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                         keyIdentifier = Octets(0xbc354d3f9f44ced4)
|                                                                   [1] SubjectKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                         id = Octets(0xbc354d3f9f44ced4)
|                                                                   [2] KeyUsage_CertExt:
|                                                                         extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                         critical = True
|                                                                         uses = ['digitalSignature']
|                                                                   [3] CertificatePolicies_CertExt:
|                                                                         extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                         critical = True
|                                                                         policies:
|                                                                           [0] = PolicyInformation:
|                                                                             id = OID(1.2.826.0.1145.0.1.0.3)
|                                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                             signature = Signature:
|                                                                 r = long384:13196979117146343559378149229766698312984227202659524736878284828303379319845773693077058720616252613130765994064508
|                                                                 s = long384:29872869196003391986020446642934543559769829435776549330010047224756621370499930124441985557869187011992296468033632
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                               [1] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x66fe30dbd6ac03caf541513081d9c8251482a8eb1ff439a7dfce0de365cde53addf67ad3a93f7e9fd2bb41b49a64778b)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:9771707733679461813589579381375989285481030174318383868843414271276151609216743768527894134675784041206821654209017
|                                                 s = long384:230434129841724184889435411048737835660245233727188246033935419727800501368786593700002280492188558149459762401630
15:55:50.535 DEBUG                    Added keymat FACT-IA: serial=7 auth=0xbc354d3f9f44ced4 subj=0xbc354d3f9f44ced4
15:55:50.535 DEBUG                    UUT Control: Applying all recent configuration changes
15:55:50.558 INFO    Test:            112 : [icm-issue-infia-cka-user-reject] The CKA
|                                           sends a CSR for an InfIA certificate to the
|                                           ICM and the ICM operator rejects the
|                                           request.
15:55:50.569 INFO                           #> 1. CKA requests a Inf IA from the ICM via HTTP and waits for a 202 ACCEPTED response.
15:55:50.569 DEBUG                          CKA requesting Inf IA from ICM.
15:55:50.576 INFO                           SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:55:50.615 DEBUG                          Generating message signature using cert with serial: 7
15:55:50.647 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:260879702877227508551816748946962861205125590786876327925159918905170591199042328958886566587777790246663919960038909159919727718849802740425583025987553927830203024546864780362951489524710460525783508994314756338961325038593599366
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.1
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:26463219795236200635476859363542095441138589541745053665857160035182776313119265500953464439427502000255189951593160
|                                                       s = long384:33934102229927134441693329596990130413947195807809154048832439332195884475352542727610717799790882609706521991424561
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0xbc354d3f9f44ced4-->0xbc354d3f9f44ced4
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 7L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:937246235294779390408761185226201565840706307844416022374312347203083526891472626641708898378944881912611429422554901165637313430155633550451564321293861965312019181508070065398326553462418698940573375318994666510233352625121971924
|                                                               x = 23786764324212076887910523171967234118399903680880089322033884542410100731440243087791037256009513406772342547931170
|                                                               y = 2024600667054584269758063801421720074807599829244400426119832426518716488351663150182557430767569971985990772117204
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xbc354d3f9f44ced4)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xbc354d3f9f44ced4)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:13196979117146343559378149229766698312984227202659524736878284828303379319845773693077058720616252613130765994064508
|                                                           s = long384:29872869196003391986020446642934543559769829435776549330010047224756621370499930124441985557869187011992296468033632
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0xbc354d3f9f44ced4)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112155550Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x0e3802846093b6eee351d54864e2ecf21e3eb94459daf35e2ec96e692a7311f8d584557271e99d690d5157f313dab1a7)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x09012265614c50fc)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:35024268528965660713238190729928782646862099085096462507907957661040210203501516635505373225480584075411212352838537
|                                                       s = long384:36265355951416569170602409698555498959253626791166326307496904525934097476284272504240340804923292083846143082754731
15:55:50.667 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:50.667 INFO                           SKD: Client ---> Server CMC-request (1332 bytes)
15:55:50.668 INFO                           Sent CSR for Inf IA certificate.
15:55:50.718 DEBUG                          Connected to Server
15:55:50.768 DEBUG                          Sending HTTP POST /fullcmc message.
15:55:50.769 DEBUG                          Removing HTTP POST /fullcmc message from Q.
15:55:50.872 DEBUG                          HTTP Status: 202 - ACCEPTED
15:55:50.873 DEBUG                          Connect closed for Server
15:55:50.873 DEBUG                          Connect closed for Server
15:55:50.879 INFO                           #> 2. The ICM operator rejects the CSR request.
15:55:51.424 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:51.475 DEBUG                          Connected to Server
15:55:51.525 DEBUG                          Sending HTTP GET /status_2 message.
15:55:51.526 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:55:51.603 DEBUG                          HTTP Status: 200 - OK
15:55:51.605 DEBUG                          Connect closed for Server
15:55:51.606 DEBUG                          Connect closed for Server
15:55:52.883 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:52.934 DEBUG                          Connected to Server
15:55:52.985 DEBUG                          Sending HTTP GET /status_6 message.
15:55:52.986 DEBUG                          Removing HTTP GET /status_6 message from Q.
15:55:52.991 DEBUG                          HTTP Status: 200 - OK
15:55:52.995 DEBUG                          Connect closed for Server
15:55:52.996 DEBUG                          Connect closed for Server
15:55:53.604 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:53.655 DEBUG                          Connected to Server
15:55:53.705 DEBUG                          Sending HTTP GET /status_2 message.
15:55:53.705 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:55:53.835 DEBUG                          HTTP Status: 200 - OK
15:55:53.837 DEBUG                          Connect closed for Server
15:55:53.837 DEBUG                          Connect closed for Server
15:55:54.992 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:55.043 DEBUG                          Connected to Server
15:55:55.093 DEBUG                          Sending HTTP GET /status_6 message.
15:55:55.093 DEBUG                          Removing HTTP GET /status_6 message from Q.
15:55:55.117 INFO                           #> 3. Wait for CertificateSigningResponse response containing error.
15:55:55.192 DEBUG                          HTTP Status: 200 - OK
15:55:55.193 DEBUG                          Connect closed for Server
15:55:55.194 DEBUG                          Connect closed for Server
15:55:55.836 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:55.887 DEBUG                          Connected to Server
15:55:55.937 DEBUG                          Sending HTTP GET /status_2 message.
15:55:55.938 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:55:55.989 DEBUG                          HTTP Status: 200 - OK
15:55:55.990 DEBUG                          Connect closed for Server
15:55:55.991 DEBUG                          Connect closed for Server
15:55:57.193 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:57.244 DEBUG                          Connected to Server
15:55:57.294 DEBUG                          Sending HTTP GET /status_6 message.
15:55:57.295 DEBUG                          Removing HTTP GET /status_6 message from Q.
15:55:57.391 DEBUG                          HTTP Status: 303 - SEE OTHER
15:55:57.392 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 2.0 second(s)
15:55:57.392 DEBUG                          Connect closed for Server
15:55:57.393 DEBUG                          Connect closed for Server
15:55:57.393 DEBUG                          Connect closed for Server
15:55:57.394 DEBUG                          Connect closed for Server
15:55:57.394 DEBUG                          Connect closed for Server
15:55:57.395 DEBUG                          Connect closed for Server
15:55:57.395 DEBUG                          Connect closed for Server
15:55:57.395 DEBUG                          Connect closed for Server
15:55:57.396 DEBUG                          Connect closed for Server
15:55:57.396 DEBUG                          Connect closed for Server
15:55:57.397 DEBUG                          Connect closed for Server
15:55:57.397 DEBUG                          Connect closed for Server
15:55:57.398 DEBUG                          Connect closed for Server
15:55:57.398 DEBUG                          Connect closed for Server
15:55:57.399 DEBUG                          Connect closed for Server
15:55:57.399 DEBUG                          Connect closed for Server
15:55:57.399 DEBUG                          Connect closed for Server
15:55:57.400 DEBUG                          Connect closed for Server
15:55:57.400 DEBUG                          Connect closed for Server
15:55:57.400 DEBUG                          Connect closed for Server
15:55:57.401 DEBUG                          Connect closed for Server
15:55:57.401 DEBUG                          Connect closed for Server
15:55:57.402 DEBUG                          Connect closed for Server
15:55:57.402 DEBUG                          Connect closed for Server
15:55:57.402 DEBUG                          Connect closed for Server
15:55:57.403 DEBUG                          Connect closed for Server
15:55:57.403 DEBUG                          Connect closed for Server
15:55:57.404 DEBUG                          Connect closed for Server
15:55:57.404 DEBUG                          Connect closed for Server
15:55:57.405 DEBUG                          Connect closed for Server
15:55:57.405 DEBUG                          Connect closed for Server
15:55:57.405 DEBUG                          Connect closed for Server
15:55:57.406 DEBUG                          Connect closed for Server
15:55:57.406 DEBUG                          Connect closed for Server
15:55:57.407 DEBUG                          Connect closed for Server
15:55:57.407 DEBUG                          Connect closed for Server
15:55:57.408 DEBUG                          Connect closed for Server
15:55:57.408 DEBUG                          Connect closed for Server
15:55:57.408 DEBUG                          Connect closed for Server
15:55:57.409 DEBUG                          Connect closed for Server
15:55:57.409 DEBUG                          Connect closed for Server
15:55:57.410 DEBUG                          Connect closed for Server
15:55:57.410 DEBUG                          Connect closed for Server
15:55:57.410 DEBUG                          Connect closed for Server
15:55:57.411 DEBUG                          Connect closed for Server
15:55:57.411 DEBUG                          Connect closed for Server
15:55:57.412 DEBUG                          Connect closed for Server
15:55:57.412 DEBUG                          Connect closed for Server
15:55:57.412 DEBUG                          Connect closed for Server
15:55:57.413 DEBUG                          Connect closed for Server
15:55:57.413 DEBUG                          Connect closed for Server
15:55:57.414 DEBUG                          Connect closed for Server
15:55:57.414 DEBUG                          Connect closed for Server
15:55:57.414 DEBUG                          Connect closed for Server
15:55:57.415 DEBUG                          Connect closed for Server
15:55:57.415 DEBUG                          Connect closed for Server
15:55:57.416 DEBUG                          Connect closed for Server
15:55:57.416 DEBUG                          Connect closed for Server
15:55:57.416 DEBUG                          Connect closed for Server
15:55:57.417 DEBUG                          Connect closed for Server
15:55:57.417 DEBUG                          Connect closed for Server
15:55:57.418 DEBUG                          Connect closed for Server
15:55:57.418 DEBUG                          Connect closed for Server
15:55:57.419 DEBUG                          Connect closed for Server
15:55:57.419 DEBUG                          Connect closed for Server
15:55:57.419 DEBUG                          Connect closed for Server
15:55:57.420 DEBUG                          Connect closed for Server
15:55:57.420 DEBUG                          Connect closed for Server
15:55:57.421 DEBUG                          Connect closed for Server
15:55:57.421 DEBUG                          Connect closed for Server
15:55:57.421 DEBUG                          Connect closed for Server
15:55:57.422 DEBUG                          Connect closed for Server
15:55:57.422 DEBUG                          Connect closed for Server
15:55:57.423 DEBUG                          Connect closed for Server
15:55:57.423 DEBUG                          Connect closed for Server
15:55:57.423 DEBUG                          Connect closed for Server
15:55:57.424 DEBUG                          Connect closed for Server
15:55:57.425 DEBUG                          Connect closed for Server
15:55:57.425 DEBUG                          Connect closed for Server
15:55:57.425 DEBUG                          Connect closed for Server
15:55:57.426 DEBUG                          Connect closed for Server
15:55:57.426 DEBUG                          Connect closed for Server
15:55:57.427 DEBUG                          Connect closed for Server
15:55:57.427 DEBUG                          Connect closed for Server
15:55:57.428 DEBUG                          Connect closed for Server
15:55:57.428 DEBUG                          Connect closed for Server
15:55:57.428 DEBUG                          Connect closed for Server
15:55:57.429 DEBUG                          Connect closed for Server
15:55:57.429 DEBUG                          Connect closed for Server
15:55:57.430 DEBUG                          Connect closed for Server
15:55:57.430 DEBUG                          Connect closed for Server
15:55:57.430 DEBUG                          Connect closed for Server
15:55:57.431 DEBUG                          Connect closed for Server
15:55:57.431 DEBUG                          Connect closed for Server
15:55:57.432 DEBUG                          Connect closed for Server
15:55:57.432 DEBUG                          Connect closed for Server
15:55:57.432 DEBUG                          Connect closed for Server
15:55:57.433 DEBUG                          Connect closed for Server
15:55:57.433 DEBUG                          Connect closed for Server
15:55:57.433 DEBUG                          Connect closed for Server
15:55:57.434 DEBUG                          Connect closed for Server
15:55:57.435 DEBUG                          Connect closed for Server
15:55:57.436 DEBUG                          Connect closed for Server
15:55:57.436 DEBUG                          Connect closed for Server
15:55:57.436 DEBUG                          Connect closed for Server
15:55:57.437 DEBUG                          Connect closed for Server
15:55:57.437 DEBUG                          Connect closed for Server
15:55:57.438 DEBUG                          Connect closed for Server
15:55:57.438 DEBUG                          Connect closed for Server
15:55:57.438 DEBUG                          Connect closed for Server
15:55:57.439 DEBUG                          Connect closed for Server
15:55:57.439 DEBUG                          Connect closed for Server
15:55:57.440 DEBUG                          Connect closed for Server
15:55:57.440 DEBUG                          Connect closed for Server
15:55:57.440 DEBUG                          Connect closed for Server
15:55:57.441 DEBUG                          Connect closed for Server
15:55:57.441 DEBUG                          Connect closed for Server
15:55:57.442 DEBUG                          Connect closed for Server
15:55:57.442 DEBUG                          Connect closed for Server
15:55:57.443 DEBUG                          Connect closed for Server
15:55:57.444 DEBUG                          Connect closed for Server
15:55:57.445 DEBUG                          Connect closed for Server
15:55:57.446 DEBUG                          Connect closed for Server
15:55:57.446 DEBUG                          Connect closed for Server
15:55:57.447 DEBUG                          Connect closed for Server
15:55:57.447 DEBUG                          Connect closed for Server
15:55:57.447 DEBUG                          Connect closed for Server
15:55:57.448 DEBUG                          Connect closed for Server
15:55:57.448 DEBUG                          Connect closed for Server
15:55:57.449 DEBUG                          Connect closed for Server
15:55:57.449 DEBUG                          Connect closed for Server
15:55:57.449 DEBUG                          Connect closed for Server
15:55:57.450 DEBUG                          Connect closed for Server
15:55:57.450 DEBUG                          Connect closed for Server
15:55:57.451 DEBUG                          Connect closed for Server
15:55:57.451 DEBUG                          Connect closed for Server
15:55:57.451 DEBUG                          Connect closed for Server
15:55:57.452 DEBUG                          Connect closed for Server
15:55:57.452 DEBUG                          Connect closed for Server
15:55:57.453 DEBUG                          Connect closed for Server
15:55:57.453 DEBUG                          Connect closed for Server
15:55:57.453 DEBUG                          Connect closed for Server
15:55:57.454 DEBUG                          Connect closed for Server
15:55:57.454 DEBUG                          Connect closed for Server
15:55:57.455 DEBUG                          Connect closed for Server
15:55:57.455 DEBUG                          Connect closed for Server
15:55:57.455 DEBUG                          Connect closed for Server
15:55:57.456 DEBUG                          Connect closed for Server
15:55:57.456 DEBUG                          Connect closed for Server
15:55:57.457 DEBUG                          Connect closed for Server
15:55:57.457 DEBUG                          Connect closed for Server
15:55:57.458 DEBUG                          Connect closed for Server
15:55:57.458 DEBUG                          Connect closed for Server
15:55:57.458 DEBUG                          Connect closed for Server
15:55:57.459 DEBUG                          Connect closed for Server
15:55:57.459 DEBUG                          Connect closed for Server
15:55:57.460 DEBUG                          Connect closed for Server
15:55:57.460 DEBUG                          Connect closed for Server
15:55:57.460 DEBUG                          Connect closed for Server
15:55:57.461 DEBUG                          Connect closed for Server
15:55:57.461 DEBUG                          Connect closed for Server
15:55:57.461 DEBUG                          Connect closed for Server
15:55:57.462 DEBUG                          Connect closed for Server
15:55:57.462 DEBUG                          Connect closed for Server
15:55:57.463 DEBUG                          Connect closed for Server
15:55:57.463 DEBUG                          Connect closed for Server
15:55:57.463 DEBUG                          Connect closed for Server
15:55:57.464 DEBUG                          Connect closed for Server
15:55:57.464 DEBUG                          Connect closed for Server
15:55:57.465 DEBUG                          Connect closed for Server
15:55:57.465 DEBUG                          Connect closed for Server
15:55:57.466 DEBUG                          Connect closed for Server
15:55:57.466 DEBUG                          Connect closed for Server
15:55:57.466 DEBUG                          Connect closed for Server
15:55:57.467 DEBUG                          Connect closed for Server
15:55:57.467 DEBUG                          Connect closed for Server
15:55:57.468 DEBUG                          Connect closed for Server
15:55:57.468 DEBUG                          Connect closed for Server
15:55:57.469 DEBUG                          Connect closed for Server
15:55:57.469 DEBUG                          Connect closed for Server
15:55:57.469 DEBUG                          Connect closed for Server
15:55:57.470 DEBUG                          Connect closed for Server
15:55:57.470 DEBUG                          Connect closed for Server
15:55:57.471 DEBUG                          Connect closed for Server
15:55:57.471 DEBUG                          Connect closed for Server
15:55:57.471 DEBUG                          Connect closed for Server
15:55:57.472 DEBUG                          Connect closed for Server
15:55:57.472 DEBUG                          Connect closed for Server
15:55:57.473 DEBUG                          Connect closed for Server
15:55:57.473 DEBUG                          Connect closed for Server
15:55:57.473 DEBUG                          Connect closed for Server
15:55:57.474 DEBUG                          Connect closed for Server
15:55:57.474 DEBUG                          Connect closed for Server
15:55:57.475 DEBUG                          Connect closed for Server
15:55:57.475 DEBUG                          Connect closed for Server
15:55:57.475 DEBUG                          Connect closed for Server
15:55:57.476 DEBUG                          Connect closed for Server
15:55:57.476 DEBUG                          Connect closed for Server
15:55:57.476 DEBUG                          Connect closed for Server
15:55:57.477 DEBUG                          Connect closed for Server
15:55:57.477 DEBUG                          Connect closed for Server
15:55:57.478 DEBUG                          Connect closed for Server
15:55:57.478 DEBUG                          Connect closed for Server
15:55:57.479 DEBUG                          Connect closed for Server
15:55:57.479 DEBUG                          Connect closed for Server
15:55:57.479 DEBUG                          Connect closed for Server
15:55:57.480 DEBUG                          Connect closed for Server
15:55:57.480 DEBUG                          Connect closed for Server
15:55:57.480 DEBUG                          Connect closed for Server
15:55:57.481 DEBUG                          Connect closed for Server
15:55:57.481 DEBUG                          Connect closed for Server
15:55:57.482 DEBUG                          Connect closed for Server
15:55:57.482 DEBUG                          Connect closed for Server
15:55:57.482 DEBUG                          Connect closed for Server
15:55:57.483 DEBUG                          Connect closed for Server
15:55:57.483 DEBUG                          Connect closed for Server
15:55:57.484 DEBUG                          Connect closed for Server
15:55:57.484 DEBUG                          Connect closed for Server
15:55:57.484 DEBUG                          Connect closed for Server
15:55:57.485 DEBUG                          Connect closed for Server
15:55:57.485 DEBUG                          Connect closed for Server
15:55:57.486 DEBUG                          Connect closed for Server
15:55:57.486 DEBUG                          Connect closed for Server
15:55:57.486 DEBUG                          Connect closed for Server
15:55:57.487 DEBUG                          Connect closed for Server
15:55:57.487 DEBUG                          Connect closed for Server
15:55:57.488 DEBUG                          Connect closed for Server
15:55:57.488 DEBUG                          Connect closed for Server
15:55:57.488 DEBUG                          Connect closed for Server
15:55:57.489 DEBUG                          Connect closed for Server
15:55:57.489 DEBUG                          Connect closed for Server
15:55:57.490 DEBUG                          Connect closed for Server
15:55:57.490 DEBUG                          Connect closed for Server
15:55:57.491 DEBUG                          Connect closed for Server
15:55:57.491 DEBUG                          Connect closed for Server
15:55:57.491 DEBUG                          Connect closed for Server
15:55:57.492 DEBUG                          Connect closed for Server
15:55:57.493 DEBUG                          Connected to Server
15:55:57.494 DEBUG                          Sending HTTP GET /fetch_6 message.
15:55:57.495 DEBUG                          Removing HTTP GET /fetch_6 message from Q.
15:55:57.592 DEBUG                          HTTP Status: 200 - OK
15:55:57.593 INFO                           SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (1765 bytes)
15:55:57.708 DEBUG                          Received SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = Integer(1)
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = Integer(2)
|                                                           otherInfo = OtherStatusInfo:
|                                                               failInfo = Integer(2)
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                               x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                               y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1de6a414dda88f8b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                           s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 82825L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                               x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                               y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2eb4fc66f0202ec8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                           s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112155553Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x09012265614c50fc)
|                                                           msgCount = 1L
|                                                     [4] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=,CN=
|                                                     [5] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xa398ffd4f2bd9a659ddc4da37aa54c2932303954638e852702d71cd1596bc4938e47fc0a9368ac931413a36a58a68d9b)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:36316852578069608076392628636962771052513579951019912007947199191359191680005472061070171055062672056096736026678763
|                                                       s = long384:17050403628858137400934375630198590187247871645398909399134765281784536137249196932251801763159178643764155769944522
15:55:57.709 DEBUG                          CKA: Handling, ('CertificateSigningResponse',)
15:55:57.720 INFO    Test:                  PASS
15:55:57.856 DEBUG                    Tearing down mock HTTP servers
15:55:57.859 DEBUG                    Connect closed for Server
15:55:57.860 DEBUG                    Connect closed for Server
15:55:57.990 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:55:58.040 DEBUG                    Connected to Server
15:55:58.090 DEBUG                    Sending HTTP GET /status_2 message.
15:55:58.091 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:55:58.214 DEBUG                    HTTP Status: 200 - OK
15:55:58.215 DEBUG                    Connect closed for Server
15:55:58.215 DEBUG                    Connect closed for Server
15:56:00.215 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:00.265 DEBUG                    Connected to Server
15:56:00.315 DEBUG                    Sending HTTP GET /status_2 message.
15:56:00.316 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:00.404 DEBUG                    HTTP Status: 200 - OK
15:56:00.404 DEBUG                    Connect closed for Server
15:56:00.405 DEBUG                    Connect closed for Server
15:56:02.404 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:02.455 DEBUG                    Connected to Server
15:56:02.505 DEBUG                    Sending HTTP GET /status_2 message.
15:56:02.505 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:02.591 DEBUG                    HTTP Status: 200 - OK
15:56:02.592 DEBUG                    Connect closed for Server
15:56:02.592 DEBUG                    Connect closed for Server
15:56:04.592 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:04.642 DEBUG                    Connected to Server
15:56:04.692 DEBUG                    Sending HTTP GET /status_2 message.
15:56:04.692 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:04.892 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:56:04.893 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:56:04.905 DEBUG                    Generating certificate signature for serial: 89151
15:56:04.911 DEBUG                    Added keymat IR-INF-CA: serial=89151 auth=0xc9020cefbb66368c subj=0x54cf8550e58168b7
15:56:04.922 DEBUG                    Generating certificate signature for serial: 82665
15:56:04.928 DEBUG                    Added keymat IR-INF-IA: serial=82665 auth=0x54cf8550e58168b7 subj=0x597d31f238b963d6
15:56:04.940 DEBUG                    Generating certificate signature for serial: 86241
15:56:04.946 DEBUG                    Added keymat IR-INF-CRL-CA: serial=86241 auth=0xc9020cefbb66368c subj=0xc575fb37f8a0b39a
15:56:04.958 DEBUG                    Generating certificate signature for serial: 81830
15:56:04.963 DEBUG                    Added keymat IR-INF-CRL-IA: serial=81830 auth=0xc575fb37f8a0b39a subj=0xb57924093e1b8129
15:56:04.974 DEBUG                    Generating certificate signature for serial: 5
15:56:04.980 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xa7a854dbe87acf72 subj=0xa7a854dbe87acf72
15:56:04.988 DEBUG                    Generating message signature using cert with serial: 82665
15:56:05.024 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:56:05.075 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xa7a854dbe87acf72 subj=0xa7a854dbe87acf72
15:56:05.081 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:56:05.098 DEBUG                    Generating message signature using cert with serial: 5
15:56:05.153 DEBUG                    IR: Handling Certificate Signing Request.
15:56:05.154 DEBUG                    Creating temporary CA cert to issue IA
15:56:05.166 DEBUG                    Generating certificate signature for serial: 87700
15:56:05.171 DEBUG                    Added keymat IR-INF-CA-TMP: serial=87700 auth=0xc9020cefbb66368c subj=0xb1d3a7c15c17e66b
15:56:05.172 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:56:05.178 DEBUG                    Generating certificate signature for serial: 20000
15:56:05.184 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:56:05.187 DEBUG                    Generating message signature using cert with serial: 82665
15:56:05.301 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:56:05.301 DEBUG                    Received Inf IA response
15:56:05.301 DEBUG                    Added keymat IR-INF-CA: serial=87700 auth=0xc9020cefbb66368c subj=0xb1d3a7c15c17e66b
15:56:05.302 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0xb1d3a7c15c17e66b subj=0xb5508dfdbd6a90aa
15:56:05.311 DEBUG                    Generating certificate signature for serial: 5
15:56:05.317 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xbde1fc619231dbdf subj=0xbde1fc619231dbdf
15:56:05.325 DEBUG                    Generating message signature using cert with serial: 20000
15:56:05.359 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:56:05.376 DEBUG                    Generating message signature using cert with serial: 20000
15:56:05.457 DEBUG                    IR: Handling Certificate Signing Request.
15:56:05.458 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:56:05.464 DEBUG                    Generating certificate signature for serial: 20001
15:56:05.470 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:56:05.473 DEBUG                    Generating message signature using cert with serial: 82665
15:56:05.567 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:56:05.567 DEBUG                    Received Inf CA response
15:56:05.568 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x573dd7c1feba87fc
15:56:05.568 INFO                     Listening for ('128.10.1.4', 80)
15:56:05.572 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:56:05.576 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:56:05.576 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:56:05.626 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xbde1fc619231dbdf subj=0xbde1fc619231dbdf
15:56:05.632 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:56:05.648 DEBUG                    Generating message signature using cert with serial: 5
15:56:05.707 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:56:05.713 DEBUG                    Generating certificate signature for serial: 20000
15:56:05.719 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:56:05.722 DEBUG                    Generating message signature using cert with serial: 20000
15:56:05.836 DEBUG                    Received Inf IA response
15:56:05.837 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x573dd7c1feba87fc
15:56:05.837 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x573dd7c1feba87fc subj=0x8b1b718790ee2ad8
15:56:05.841 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:56:05.845 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:56:05.895 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xbde1fc619231dbdf subj=0xbde1fc619231dbdf
15:56:05.895 INFO                     Listening for ('128.10.1.6', 80)
15:56:05.895 DEBUG                    MCKM requesting Inf IA from ICM.
15:56:05.901 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:56:05.917 DEBUG                    Generating message signature using cert with serial: 5
15:56:05.935 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:56:05.935 INFO                     SKD: Client ---> Server CMC-request (1340 bytes)
15:56:05.935 INFO                     Sent CSR for Inf IA certificate.
15:56:05.936 DEBUG                    HTTP Status: 200 - OK
15:56:05.937 DEBUG                    105796880: Connect accepted from Client
15:56:05.937 DEBUG                    Connect closed for Server
15:56:05.937 DEBUG                    Connect closed for Server
15:56:05.987 DEBUG                    Connected to Server
15:56:06.037 DEBUG                    Sending HTTP POST /fullcmc message.
15:56:06.038 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:56:06.095 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:56:06.096 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:56:06.103 DEBUG                    Generating certificate signature for serial: 20001
15:56:06.114 DEBUG                    Generating message signature using cert with serial: 20000
15:56:06.167 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:56:06.168 DEBUG                    HTTP Status: 200 - OK
15:56:06.168 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3137 bytes)
15:56:06.231 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:56:06.231 DEBUG                    Received Inf IA response
15:56:06.232 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x573dd7c1feba87fc
15:56:06.232 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x573dd7c1feba87fc subj=0xf592f45c6076186a
15:56:07.936 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:07.945 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:56:08.002 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xbde1fc619231dbdf subj=0xbde1fc619231dbdf
15:56:08.003 DEBUG                    CKA requesting Inf IA from ICM.
15:56:08.009 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:56:08.025 DEBUG                    Generating message signature using cert with serial: 5
15:56:08.043 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:56:08.043 INFO                     SKD: Client ---> Server CMC-request (1330 bytes)
15:56:08.044 INFO                     Sent CSR for Inf IA certificate.
15:56:08.044 DEBUG                    Connected to Server
15:56:08.044 DEBUG                    Sending HTTP GET /status_2 message.
15:56:08.045 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:08.047 DEBUG                    105796880: Connect accepted from Client
15:56:08.047 DEBUG                    Connect closed for Server
15:56:08.047 DEBUG                    Connect closed for Server
15:56:08.088 DEBUG                    HTTP Status: 200 - OK
15:56:08.089 DEBUG                    Connect closed for Server
15:56:08.089 DEBUG                    Connect closed for Server
15:56:08.094 DEBUG                    Connected to Server
15:56:08.144 DEBUG                    Sending HTTP POST /fullcmc message.
15:56:08.144 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:56:08.184 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:56:08.185 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:56:08.191 DEBUG                    Generating certificate signature for serial: 20002
15:56:08.201 DEBUG                    Generating message signature using cert with serial: 20000
15:56:08.252 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:56:08.254 DEBUG                    HTTP Status: 200 - OK
15:56:08.254 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3127 bytes)
15:56:08.318 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:56:08.318 DEBUG                    Received Inf IA response
15:56:08.318 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x573dd7c1feba87fc
15:56:08.319 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x573dd7c1feba87fc subj=0xcefe9b41edde22b3
15:56:10.089 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:10.140 DEBUG                    Connected to Server
15:56:10.189 DEBUG                    Sending HTTP GET /status_2 message.
15:56:10.190 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:10.288 DEBUG                    HTTP Status: 200 - OK
15:56:10.289 DEBUG                    Connect closed for Server
15:56:10.289 DEBUG                    Connect closed for Server
15:56:12.253 DEBUG                    ########## Mocks complete ##########
15:56:12.289 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:12.339 DEBUG                    Connected to Server
15:56:12.389 DEBUG                    Sending HTTP GET /status_2 message.
15:56:12.390 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:12.561 DEBUG                    HTTP Status: 200 - OK
15:56:12.561 DEBUG                    Connect closed for Server
15:56:12.561 DEBUG                    Connect closed for Server
15:56:13.315 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:56:13.315 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:56:14.246 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:56:14.246 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:56:14.561 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:14.616 DEBUG                    Connected to Server
15:56:14.662 DEBUG                    Sending HTTP GET /status_2 message.
15:56:14.662 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:14.708 DEBUG                    HTTP Status: 200 - OK
15:56:14.708 DEBUG                    Connect closed for Server
15:56:14.708 DEBUG                    Connect closed for Server
15:56:16.708 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:16.759 DEBUG                    Connected to Server
15:56:16.808 DEBUG                    Sending HTTP GET /status_2 message.
15:56:16.809 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:16.908 DEBUG                    HTTP Status: 200 - OK
15:56:16.909 DEBUG                    Connect closed for Server
15:56:16.909 DEBUG                    Connect closed for Server
15:56:18.909 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:18.959 DEBUG                    Connected to Server
15:56:19.009 DEBUG                    Sending HTTP GET /status_2 message.
15:56:19.010 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:20.510 DEBUG                    HTTP Status: 200 - OK
15:56:20.516 DEBUG                    Connect closed for Server
15:56:20.517 DEBUG                    Connect closed for Server
15:56:22.516 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:22.566 DEBUG                    Connected to Server
15:56:22.616 DEBUG                    Sending HTTP GET /status_2 message.
15:56:22.616 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:22.710 DEBUG                    HTTP Status: 200 - OK
15:56:22.711 DEBUG                    Connect closed for Server
15:56:22.711 DEBUG                    Connect closed for Server
15:56:24.711 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:24.761 DEBUG                    Connected to Server
15:56:24.811 DEBUG                    Sending HTTP GET /status_2 message.
15:56:24.812 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:24.910 DEBUG                    HTTP Status: 200 - OK
15:56:24.910 DEBUG                    Connect closed for Server
15:56:24.911 DEBUG                    Connect closed for Server
15:56:26.910 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:26.961 DEBUG                    Connected to Server
15:56:27.011 DEBUG                    Sending HTTP GET /status_2 message.
15:56:27.012 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:27.116 DEBUG                    HTTP Status: 200 - OK
15:56:27.116 DEBUG                    Connect closed for Server
15:56:27.116 DEBUG                    Connect closed for Server
15:56:29.116 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:29.167 DEBUG                    Connected to Server
15:56:29.217 DEBUG                    Sending HTTP GET /status_2 message.
15:56:29.217 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:29.329 DEBUG                    HTTP Status: 200 - OK
15:56:29.334 DEBUG                    Connect closed for Server
15:56:29.335 DEBUG                    Connect closed for Server
15:56:31.334 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:31.385 DEBUG                    Connected to Server
15:56:31.435 DEBUG                    Sending HTTP GET /status_2 message.
15:56:31.436 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:31.536 DEBUG                    HTTP Status: 200 - OK
15:56:31.536 DEBUG                    Connect closed for Server
15:56:31.537 DEBUG                    Connect closed for Server
15:56:33.544 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:33.595 DEBUG                    Connected to Server
15:56:33.645 DEBUG                    Sending HTTP GET /status_2 message.
15:56:33.645 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:33.719 DEBUG                    HTTP Status: 200 - OK
15:56:33.719 DEBUG                    Connect closed for Server
15:56:33.719 DEBUG                    Connect closed for Server
15:56:35.719 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:35.770 DEBUG                    Connected to Server
15:56:35.820 DEBUG                    Sending HTTP GET /status_2 message.
15:56:35.820 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:35.918 DEBUG                    HTTP Status: 200 - OK
15:56:35.919 DEBUG                    Connect closed for Server
15:56:35.919 DEBUG                    Connect closed for Server
15:56:37.919 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:37.969 DEBUG                    Connected to Server
15:56:38.019 DEBUG                    Sending HTTP GET /status_2 message.
15:56:38.019 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:38.094 DEBUG                    HTTP Status: 200 - OK
15:56:38.095 DEBUG                    Connect closed for Server
15:56:38.095 DEBUG                    Connect closed for Server
15:56:38.495 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:569705099952055055438264602241006344410596323774743412386829006545018132718727144405058541434090214868000924368903481686774337554922977574992270198011843834693753955380262905253862071168451070907181711520439615690554865885902344226
|                                                     x = 14458784081004141916192428071746814068875161100012200942531663488026718933820389285200235246983843954584041954740941
|                                                     y = 36957774340982135452947247971801822216158855063224231304959282304489416579854352268133750622661675301239961515790370
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:24504218868340254201595954222205914318786828663269322370104213091035470916548887733071499522729109910342978793050691
|                                                 s = long384:36393042577606510726321663050944271876235048696873104739058557000282868899677948495440537480740293098146152106484133
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155616Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 7L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0xe386e75fd2db4e21b096fbeccaa449c42bdce6ceec96c012260acd21545a68962aa45b3ed6e192f76cb1b68d5dbcca9d)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:24291753832599357006948379381723716148553450848261865093303828801467914804975618593956926198876433380685075139054238
|                                                 s = long384:35110960437076125368978015850256572824240707748049333555755392826883796362087973515761895626560782388975851744883854
15:56:38.496 DEBUG                    IR: Handling Certificate Signing Request.
15:56:38.496 DEBUG                    Generating InfCA certificate (serialNumber: 20002L)
15:56:38.504 DEBUG                    Generating certificate signature for serial: 20002
15:56:38.510 DEBUG                    Creating SKD message file /tmp/infca.resp
15:56:38.513 DEBUG                    Generating message signature using cert with serial: 82665
15:56:38.551 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0xa12b19b870191022-->0xc9020cefbb66368c
|                                             0x597d31f238b963d6-->0x54cf8550e58168b7-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155638Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:569705099952055055438264602241006344410596323774743412386829006545018132718727144405058541434090214868000924368903481686774337554922977574992270198011843834693753955380262905253862071168451070907181711520439615690554865885902344226
|                                                         x = 14458784081004141916192428071746814068875161100012200942531663488026718933820389285200235246983843954584041954740941
|                                                         y = 36957774340982135452947247971801822216158855063224231304959282304489416579854352268133750622661675301239961515790370
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xa12b19b870191022)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:7682601686519643559369130697381940864411018136553926603238558553144674172651811211350357740892034534745382597577404
|                                                     s = long384:16812709140576360538740204879380890319124654060307527474359323812647927284955764129224843064615613519148290683336643
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82665L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155604Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:58725517137550869538748924667349626185988933041777115553447003406939995521442402536298717733112528806299815977333243437797678911497852828872430103660643304290799803240744525403358865094683390603015468969981695954030715535602836438
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x54cf8550e58168b7)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x597d31f238b963d6)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:33649387953748958981955795422127439607314042344922321414478577826005469991705090921950292777011961999679751109067069
|                                                     s = long384:6582056917414547150163666955988614071157330525161096982602680711626877825866994799124242116648892344957745952982763
|                                                 [1.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 89151L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155604Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:994061159293320978176760682003558506506827740500669154030506683747314607234578114801818057752272924515709960077031266175512467978044046584132833096107265460986543244210208125742400716242054479586912272206402472805544432818504951991
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x54cf8550e58168b7)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:30393316494163080809937787197506996055652696916564728177910774105052003980764929184902919497477644598553684061775797
|                                                     s = long384:28929386142045161504579794697610018222386825814950260826148788146057073373010844887421018372719357098624443911846471
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x597d31f238b963d6)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155638Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 7L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:15173044625779900324080244295139548529233158336307386633317836757185985673123903610057933205579065005654281995643981
|                                                 s = long384:2102948303864074429609227770259233801767653279142460078481763228850991853155308345056135656967595847340419638763784
15:56:40.095 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:40.146 DEBUG                    Connected to Server
15:56:40.195 DEBUG                    Sending HTTP GET /status_2 message.
15:56:40.196 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:40.314 DEBUG                    HTTP Status: 200 - OK
15:56:40.315 DEBUG                    Connect closed for Server
15:56:40.315 DEBUG                    Connect closed for Server
15:56:42.314 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:42.365 DEBUG                    Connected to Server
15:56:42.415 DEBUG                    Sending HTTP GET /status_2 message.
15:56:42.416 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:42.503 DEBUG                    HTTP Status: 200 - OK
15:56:42.510 DEBUG                    Connect closed for Server
15:56:42.510 DEBUG                    Connect closed for Server
15:56:44.285 DEBUG                    cmd optimus > keydir
15:56:44.330 DEBUG                    cmd optimus > keydir /tmp/
15:56:44.509 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:44.560 DEBUG                    Connected to Server
15:56:44.610 DEBUG                    Sending HTTP GET /status_2 message.
15:56:44.610 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:44.695 DEBUG                    HTTP Status: 200 - OK
15:56:44.696 DEBUG                    Connect closed for Server
15:56:44.696 DEBUG                    Connect closed for Server
15:56:46.696 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:46.746 DEBUG                    Connected to Server
15:56:46.796 DEBUG                    Sending HTTP GET /status_2 message.
15:56:46.797 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:46.922 DEBUG                    HTTP Status: 200 - OK
15:56:46.923 DEBUG                    Connect closed for Server
15:56:46.923 DEBUG                    Connect closed for Server
15:56:48.924 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:48.975 DEBUG                    Connected to Server
15:56:49.024 DEBUG                    Sending HTTP GET /status_2 message.
15:56:49.025 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:49.092 DEBUG                    HTTP Status: 200 - OK
15:56:49.092 DEBUG                    Connect closed for Server
15:56:49.092 DEBUG                    Connect closed for Server
15:56:50.901 DEBUG                    cmd optimus > keydir ../Keys/
15:56:51.024 DEBUG                    Received SKD message:
|                                     KeyPackageFile:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = List:
|                                             [0]:
|                                                 OneAsymmetricKey:
|                                                     version == 0
|                                                     privateKeyAlgorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     privateKey = ECPrivateKey:
|                                                         version = 1L
|                                                         privateKey = Octets(0x9643f3770c356afc536ef74d6704de3215d697d4d93c49451bf82a901c5a522eba2e2d4851a66f002f1dd987def7d758)
|                                                     attributes:
|                                                       [0] = UserCertificateAttr:
|                                                         id == OID(userCertificate:2.5.4.36)
|                                                         userCertificate = Certificate:
|                                                             tbsCertificate = TBSCertificate:
|                                                                 version == 2
|                                                                 serialNumber = 8L
|                                                                 signatureAlgorithmID = AlgorithmIdentifier:
|                                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                 issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 validity = 170112000000Z..99991231235959Z
|                                                                 subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                     algorithm = AlgorithmIdentifier:
|                                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                         parameters = ECParameters:
|                                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                     subjectPublicKey = long768:16633474600482886949971308912011540945068938872169460893793954081148632186999114307263914893246765850141367578900182238583984214078664743235097625764147143138807539459124762287116647254025135869327243886310924068285820260445034546
|                                                                     x = 422147910884927225308641500173162759939652257233280638999978104994483150564295195129274386410253918199573954417163
|                                                                     y = 18698110571130457485316237440827665740558506927898237681157502648630678392113616915857400719077064777525669618751538
|                                                                 _extensions = CertificateExtensions
|                                                                   [0] AuthorityKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                         keyIdentifier = Octets(0xfe84da67db7f9832)
|                                                                   [1] SubjectKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                         id = Octets(0xfe84da67db7f9832)
|                                                                   [2] KeyUsage_CertExt:
|                                                                         extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                         critical = True
|                                                                         uses = ['digitalSignature']
|                                                                   [3] CertificatePolicies_CertExt:
|                                                                         extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                         critical = True
|                                                                         policies:
|                                                                           [0] = PolicyInformation:
|                                                                             id = OID(1.2.826.0.1145.0.1.0.3)
|                                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                             signature = Signature:
|                                                                 r = long384:31474927513750800171656370885249339623927933060288056258744194076890679801469934455328038385286430151473274975498105
|                                                                 s = long384:34222578126639429892038794771447687957291734818842992833730307035033309579287173322957786494754912606477925858299113
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                               [1] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x758c17c446edba983307162a057b4d0613849aba371fd58e40c3f8fe9a559d9203ffb6aedbc269cb8eeefc106b6333ba)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:32935421611549712001054305557511874726574697682714583583840948531522026005335555903895383500173679310759790088313035
|                                                 s = long384:18991271774335297605928901108370863583344676952054573285739455266440483988799356097272363561385876082104821528127374
15:56:51.025 DEBUG                    Added keymat FACT-IA: serial=8 auth=0xfe84da67db7f9832 subj=0xfe84da67db7f9832
15:56:51.025 DEBUG                    UUT Control: Applying all recent configuration changes
15:56:51.049 INFO    Test:            114 : [icm-issue-infia-cka-invalid-factory] The
|                                           CKA sends a CSR for an InfIA certificate to
|                                           the ICM using HTTP but it is signed by an
|                                           invalid Factory certificate so should not
|                                           receive a valid response.
15:56:51.060 INFO                           #> 1. The ICM generates a factory package for the CKA.
15:56:51.081 DEBUG                          Generating certificate signature for serial: 5
15:56:51.088 DEBUG                          Added keymat FACT-IA: serial=5 auth=0x0275bee8e66fdb9c subj=0x0275bee8e66fdb9c
15:56:51.113 DEBUG                          Generating message signature using cert with serial: 20000
15:56:51.169 DEBUG                          Sending SKD message:
|                                           KeyPackageFile:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = List:
|                                                   [0]:
|                                                       OneAsymmetricKey:
|                                                           version == 0
|                                                           privateKeyAlgorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           privateKey = ECPrivateKey:
|                                                               version = 1L
|                                                               privateKey = Octets(0x3236313130363934313436303736343936373933323834393538343438303830313032373631393836323336323939323731383839383436323432353732383630313334333239323032373036323533353331313332373336373935323831363331383633333239343232303034313637353739)
|                                                           attributes:
|                                                             [0] = UserCertificateAttr:
|                                                               id == OID(userCertificate:2.5.4.36)
|                                                               userCertificate = Certificate:
|                                                                   tbsCertificate = TBSCertificate:
|                                                                       version == 2
|                                                                       serialNumber = 5L
|                                                                       signatureAlgorithmID = AlgorithmIdentifier:
|                                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                       issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                       validity = 170112155651Z..99991231235959Z
|                                                                       subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                           algorithm = AlgorithmIdentifier:
|                                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                               parameters = ECParameters:
|                                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                           subjectPublicKey = long768:1055600278659903135087805947002589590417551784599759307171571569649633982740395484877282793860407507642857455769578290589127707994486682188420720492281398305632714846372152414893129861010951520494959972945398896741890438755100122012
|                                                                       _extensions = CertificateExtensions
|                                                                         [0] AuthorityKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                               keyIdentifier = Octets(0x0275bee8e66fdb9c)
|                                                                         [1] SubjectKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                               id = Octets(0x0275bee8e66fdb9c)
|                                                                         [2] KeyUsage_CertExt:
|                                                                               extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                               critical = True
|                                                                               uses = ['digitalSignature']
|                                                                         [3] CertificatePolicies_CertExt:
|                                                                               extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                               critical = True
|                                                                               policies:
|                                                                                 [0] = PolicyInformation:
|                                                                                   id = OID(1.2.826.0.1145.0.1.0.4)
|                                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                   signature = Signature:
|                                                                       r = long384:13984967560530967785554663891060703608814196352133006310946349481385100606912700652416156065047140647224701553343095
|                                                                       s = long768:22331534239952674325927969160491563646081829991822898096494541253707693737834004645328272044987972017141001336740989
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0xb5508dfdbd6a90aa-->0xb1d3a7c15c17e66b-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20000L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155605Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0177000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1305718400547817926591748816881973759732953580960589285629606962417824159408593764552137125182958998905912399651305498166262274312506049603482676439446010440155757186967842975300332520327099607342883590645040388765388046695693717674
|                                                               x = 33138373565031798339033145489840532033215871072894279568524285654315410666654571593674107354523265586822116455689281
|                                                               y = 15447108604315119553900233825959848775239013411906667760125221777296470723396571334362660950113025564766651741278378
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xb1d3a7c15c17e66b)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xb5508dfdbd6a90aa)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:22709164749950538491466957953497332778755297049232249017846013794181819917462700186956312805054916483459711131280018
|                                                           s = long384:16028424718342152951147139563122809621821647818777296129932825969980054084131507016356704278517911381912782621633054
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 87700L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155605Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:117886793888612292091933130401060029160694099028456771178196981105739812957177042133642151140067345661291953157574328435555195822073159082085544897959159142183651029395742067416699528594092334419464577679900468354805615851721975403
|                                                               x = 2991898262769159288977868367319083931623527892828902743003425174700752208386599825159755816937808939878466388000785
|                                                               y = 19410493743053245623054190439574341752078572034970354842638190199519531308156573990799806518515044020749578723124843
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xb1d3a7c15c17e66b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0177000'
|                                                                           endEsn = 'D8EFF0177000'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:32536727758490096763029577158479182916064924008604872243101342997497614360773451847671381318037859852618592493823501
|                                                           s = long384:36363287237512088748224222467564228707021004173535316440608844876493766967788275504132116302012845968181970201068649
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0xb5508dfdbd6a90aa)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                                     [1] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x278c7a694d004d6b1fd88a711ec8877adf17745f54334abdb512a4b2642bb2ba384fc73e193af6166b9107f875d272e0)
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112155651Z)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:18248525456569709854723142591758951705957488404502072414340994181784958924344861677122232660925070985658563586289063
|                                                       s = long384:37194839059963330396950223479975691819627546162005727362215535166414452848950396327537175178401133123793044510429069
15:56:51.331 DEBUG                          Received SKD message:
|                                           KeyPackageFile:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = List:
|                                                   [0]:
|                                                       OneAsymmetricKey:
|                                                           version == 0
|                                                           privateKeyAlgorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           privateKey = ECPrivateKey:
|                                                               version = 1L
|                                                               privateKey = Octets(0x3236313130363934313436303736343936373933323834393538343438303830313032373631393836323336323939323731383839383436323432353732383630313334333239323032373036323533353331313332373336373935323831363331383633333239343232303034313637353739)
|                                                           attributes:
|                                                             [0] = UserCertificateAttr:
|                                                               id == OID(userCertificate:2.5.4.36)
|                                                               userCertificate = Certificate:
|                                                                   tbsCertificate = TBSCertificate:
|                                                                       version == 2
|                                                                       serialNumber = 5L
|                                                                       signatureAlgorithmID = AlgorithmIdentifier:
|                                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                       issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                       validity = 170112155651Z..99991231235959Z
|                                                                       subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                           algorithm = AlgorithmIdentifier:
|                                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                               parameters = ECParameters:
|                                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                           subjectPublicKey = long768:1055600278659903135087805947002589590417551784599759307171571569649633982740395484877282793860407507642857455769578290589127707994486682188420720492281398305632714846372152414893129861010951520494959972945398896741890438755100122012
|                                                                           x = 26790521106930258689536476847753848052092828320930368550003581184106130350703346383113515404522879375106333712251344
|                                                                           y = 9712556503386482676715228654349869616036758086371651478524684719399333931372704792980860979223186565568978431761308
|                                                                       _extensions = CertificateExtensions
|                                                                         [0] AuthorityKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                               keyIdentifier = Octets(0x0275bee8e66fdb9c)
|                                                                         [1] SubjectKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                               id = Octets(0x0275bee8e66fdb9c)
|                                                                         [2] KeyUsage_CertExt:
|                                                                               extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                               critical = True
|                                                                               uses = ['digitalSignature']
|                                                                         [3] CertificatePolicies_CertExt:
|                                                                               extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                               critical = True
|                                                                               policies:
|                                                                                 [0] = PolicyInformation:
|                                                                                   id = OID(1.2.826.0.1145.0.1.0.4)
|                                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                   signature = Signature:
|                                                                       r = long384:13984967560530967785554663891060703608814196352133006310946349481385100606912700652416156065047140647224701553343095
|                                                                       s = long384:22331534239952674325927969160491563646081829991822898096494541253707693737834004645328272044987972017141001336740989
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0xb5508dfdbd6a90aa-->0xb1d3a7c15c17e66b-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20000L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155605Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0177000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1305718400547817926591748816881973759732953580960589285629606962417824159408593764552137125182958998905912399651305498166262274312506049603482676439446010440155757186967842975300332520327099607342883590645040388765388046695693717674
|                                                               x = 33138373565031798339033145489840532033215871072894279568524285654315410666654571593674107354523265586822116455689281
|                                                               y = 15447108604315119553900233825959848775239013411906667760125221777296470723396571334362660950113025564766651741278378
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xb1d3a7c15c17e66b)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xb5508dfdbd6a90aa)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:22709164749950538491466957953497332778755297049232249017846013794181819917462700186956312805054916483459711131280018
|                                                           s = long384:16028424718342152951147139563122809621821647818777296129932825969980054084131507016356704278517911381912782621633054
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 87700L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155605Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:117886793888612292091933130401060029160694099028456771178196981105739812957177042133642151140067345661291953157574328435555195822073159082085544897959159142183651029395742067416699528594092334419464577679900468354805615851721975403
|                                                               x = 2991898262769159288977868367319083931623527892828902743003425174700752208386599825159755816937808939878466388000785
|                                                               y = 19410493743053245623054190439574341752078572034970354842638190199519531308156573990799806518515044020749578723124843
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xb1d3a7c15c17e66b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0177000'
|                                                                           endEsn = 'D8EFF0177000'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:32536727758490096763029577158479182916064924008604872243101342997497614360773451847671381318037859852618592493823501
|                                                           s = long384:36363287237512088748224222467564228707021004173535316440608844876493766967788275504132116302012845968181970201068649
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0xb5508dfdbd6a90aa)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112155651Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x278c7a694d004d6b1fd88a711ec8877adf17745f54334abdb512a4b2642bb2ba384fc73e193af6166b9107f875d272e0)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:18248525456569709854723142591758951705957488404502072414340994181784958924344861677122232660925070985658563586289063
|                                                       s = long384:37194839059963330396950223479975691819627546162005727362215535166414452848950396327537175178401133123793044510429069
15:56:51.332 DEBUG                          Added keymat FACT-IA: serial=5 auth=0x0275bee8e66fdb9c subj=0x0275bee8e66fdb9c
15:56:51.333 INFO                           #> 2. CKA requests a Inf IA from the ICM ith incorrect Factory Certficate signature.
15:56:51.333 DEBUG                          CKA requesting Inf IA from ICM.
15:56:51.340 INFO                           SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:56:51.379 DEBUG                          Generating message signature using cert with serial: 5
15:56:51.411 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0144000,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:964587346310403119287940751552222317684798753374521480254865215092502474230689134763674277404082542120957565717288924683100214178686498912564152001382042310915525800903782384599144028249414268293513326000562176435599680799886994050
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.1
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:13549720250626965369674000535473342804462610609113690187048348043852643964183081812225368685885150916698520785075401
|                                                       s = long384:32293682146622737221382656228019211099584720849007282585996759207988966886073684599928551089337859950937953417304379
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x0275bee8e66fdb9c-->0x0275bee8e66fdb9c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 5L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155651Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1055600278659903135087805947002589590417551784599759307171571569649633982740395484877282793860407507642857455769578290589127707994486682188420720492281398305632714846372152414893129861010951520494959972945398896741890438755100122012
|                                                               x = 26790521106930258689536476847753848052092828320930368550003581184106130350703346383113515404522879375106333712251344
|                                                               y = 9712556503386482676715228654349869616036758086371651478524684719399333931372704792980860979223186565568978431761308
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x0275bee8e66fdb9c)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x0275bee8e66fdb9c)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:13984967560530967785554663891060703608814196352133006310946349481385100606912700652416156065047140647224701553343095
|                                                           s = long384:22331534239952674325927969160491563646081829991822898096494541253707693737834004645328272044987972017141001336740989
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x0275bee8e66fdb9c)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112155651Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x9b92926c4dc5419bcde9c773e8e5e3899aac4b868b8519c77c645e319978e37b92970ee576e1d3516f230310d89c5f98)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x710c5b980fdc8310)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:24866697136206837445396347187883761390421058126669956557055642768684054963379472163241271020337826421689896099265656
|                                                       s = long928:29408796269329853310799811624010963729697233027135044417634024483546439678880917603186784207134867366073102826904314
15:56:51.431 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:51.432 INFO                           SKD: Client ---> Server CMC-request (1331 bytes)
15:56:51.432 INFO                           Sent CSR for Inf IA certificate.
15:56:51.432 INFO                           #> 3. The ICM should respond by rejecting the request.
15:56:51.433 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:51.482 DEBUG                          Connected to Server
15:56:51.484 DEBUG                          Connected to Server
15:56:51.533 DEBUG                          Sending HTTP POST /fullcmc message.
15:56:51.534 DEBUG                          Removing HTTP POST /fullcmc message from Q.
15:56:51.535 DEBUG                          Sending HTTP GET /status_2 message.
15:56:51.536 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:56:51.627 DEBUG                          HTTP Status: 400 - BAD REQUEST
15:56:51.628 ERROR                          HTTP error status 400 received.
15:56:51.629 DEBUG                          Connect closed for Server
15:56:51.631 DEBUG                          HTTP Status: 200 - OK
15:56:51.632 DEBUG                          Connect closed for Server
15:56:51.633 DEBUG                          Connect closed for Server
15:56:51.647 INFO    Test:                  PASS
15:56:51.794 DEBUG                    Tearing down mock HTTP servers
15:56:51.797 DEBUG                    Connect closed for Server
15:56:53.631 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:53.682 DEBUG                    Connected to Server
15:56:53.732 DEBUG                    Sending HTTP GET /status_2 message.
15:56:53.732 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:53.807 DEBUG                    HTTP Status: 200 - OK
15:56:53.809 DEBUG                    Connect closed for Server
15:56:53.809 DEBUG                    Connect closed for Server
15:56:55.808 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:55.859 DEBUG                    Connected to Server
15:56:55.909 DEBUG                    Sending HTTP GET /status_2 message.
15:56:55.909 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:55.998 DEBUG                    HTTP Status: 200 - OK
15:56:55.999 DEBUG                    Connect closed for Server
15:56:56.000 DEBUG                    Connect closed for Server
15:56:57.999 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:56:58.050 DEBUG                    Connected to Server
15:56:58.100 DEBUG                    Sending HTTP GET /status_2 message.
15:56:58.100 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:56:58.221 DEBUG                    HTTP Status: 200 - OK
15:56:58.222 DEBUG                    Connect closed for Server
15:56:58.222 DEBUG                    Connect closed for Server
15:56:58.919 INFO    Suite:       Tests for ICM issuing InfIA certificate to a CKA
15:56:58.930 INFO    Suite:         ICM Factory IA certificate issuing to CKA tests.
15:56:58.948 INFO                     Memory (RSS) before suite setup: 116.21 MByte  (2.58)
15:56:58.958 INFO                     Memory (Virt) before suite setup: 662.49 MByte  (2.71)
15:56:58.968 INFO                     Memory (RSS) after suite setup: 116.21 MByte  (0.00)
15:56:58.976 INFO                     Memory (Virt) after suite setup: 662.49 MByte  (0.00)
15:56:59.126 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:56:59.127 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:56:59.139 DEBUG                    Generating certificate signature for serial: 88206
15:56:59.145 DEBUG                    Added keymat IR-INF-CA: serial=88206 auth=0xc9020cefbb66368c subj=0xc396b374037da04a
15:56:59.158 DEBUG                    Generating certificate signature for serial: 88843
15:56:59.164 DEBUG                    Added keymat IR-INF-IA: serial=88843 auth=0xc396b374037da04a subj=0xe7209147c0a98039
15:56:59.177 DEBUG                    Generating certificate signature for serial: 87956
15:56:59.183 DEBUG                    Added keymat IR-INF-CRL-CA: serial=87956 auth=0xc9020cefbb66368c subj=0xe488203f76406610
15:56:59.196 DEBUG                    Generating certificate signature for serial: 83299
15:56:59.202 DEBUG                    Added keymat IR-INF-CRL-IA: serial=83299 auth=0xe488203f76406610 subj=0xb81e22e08c323d9b
15:56:59.213 DEBUG                    Generating certificate signature for serial: 5
15:56:59.218 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x2caf8331a6350c80 subj=0x2caf8331a6350c80
15:56:59.227 DEBUG                    Generating message signature using cert with serial: 88843
15:56:59.261 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:56:59.313 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x2caf8331a6350c80 subj=0x2caf8331a6350c80
15:56:59.319 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:56:59.336 DEBUG                    Generating message signature using cert with serial: 5
15:56:59.395 DEBUG                    IR: Handling Certificate Signing Request.
15:56:59.395 DEBUG                    Creating temporary CA cert to issue IA
15:56:59.407 DEBUG                    Generating certificate signature for serial: 86211
15:56:59.413 DEBUG                    Added keymat IR-INF-CA-TMP: serial=86211 auth=0xc9020cefbb66368c subj=0x76008dca8a9ee5ac
15:56:59.413 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:56:59.419 DEBUG                    Generating certificate signature for serial: 20000
15:56:59.426 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:56:59.429 DEBUG                    Generating message signature using cert with serial: 88843
15:56:59.546 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:56:59.546 DEBUG                    Received Inf IA response
15:56:59.547 DEBUG                    Added keymat IR-INF-CA: serial=86211 auth=0xc9020cefbb66368c subj=0x76008dca8a9ee5ac
15:56:59.547 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x76008dca8a9ee5ac subj=0x512a227b5cb0d60f
15:56:59.557 DEBUG                    Generating certificate signature for serial: 5
15:56:59.563 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x9b6df1d0a9bf9f68 subj=0x9b6df1d0a9bf9f68
15:56:59.571 DEBUG                    Generating message signature using cert with serial: 20000
15:56:59.607 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:56:59.625 DEBUG                    Generating message signature using cert with serial: 20000
15:56:59.707 DEBUG                    IR: Handling Certificate Signing Request.
15:56:59.708 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:56:59.714 DEBUG                    Generating certificate signature for serial: 20001
15:56:59.720 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:56:59.723 DEBUG                    Generating message signature using cert with serial: 88843
15:56:59.819 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:56:59.819 DEBUG                    Received Inf CA response
15:56:59.820 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x09732caf42ac9e12
15:56:59.820 INFO                     Listening for ('128.10.1.4', 80)
15:56:59.824 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:56:59.828 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:56:59.828 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:56:59.879 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x9b6df1d0a9bf9f68 subj=0x9b6df1d0a9bf9f68
15:56:59.884 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:56:59.901 DEBUG                    Generating message signature using cert with serial: 5
15:56:59.958 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:56:59.964 DEBUG                    Generating certificate signature for serial: 20000
15:56:59.970 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:56:59.973 DEBUG                    Generating message signature using cert with serial: 20000
15:57:00.089 DEBUG                    Received Inf IA response
15:57:00.089 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x09732caf42ac9e12
15:57:00.089 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x09732caf42ac9e12 subj=0x6c499ad6265a0040
15:57:00.093 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:57:00.098 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:57:00.146 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x9b6df1d0a9bf9f68 subj=0x9b6df1d0a9bf9f68
15:57:00.147 INFO                     Listening for ('128.10.1.6', 80)
15:57:00.147 DEBUG                    MCKM requesting Inf IA from ICM.
15:57:00.153 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:57:00.169 DEBUG                    Generating message signature using cert with serial: 5
15:57:00.188 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:57:00.188 INFO                     SKD: Client ---> Server CMC-request (1339 bytes)
15:57:00.188 INFO                     Sent CSR for Inf IA certificate.
15:57:00.189 DEBUG                    107313680: Connect accepted from Client
15:57:00.222 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:00.238 DEBUG                    Connected to Server
15:57:00.272 DEBUG                    Connected to Server
15:57:00.288 DEBUG                    Sending HTTP POST /fullcmc message.
15:57:00.288 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:57:00.328 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:57:00.329 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:57:00.335 DEBUG                    Generating certificate signature for serial: 20001
15:57:00.344 DEBUG                    Generating message signature using cert with serial: 20000
15:57:00.395 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:57:00.396 DEBUG                    Sending HTTP GET /status_2 message.
15:57:00.397 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:00.399 DEBUG                    HTTP Status: 200 - OK
15:57:00.399 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3139 bytes)
15:57:00.463 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:57:00.463 DEBUG                    Received Inf IA response
15:57:00.464 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x09732caf42ac9e12
15:57:00.464 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x09732caf42ac9e12 subj=0x935dd6d2d8fa9dad
15:57:00.488 DEBUG                    HTTP Status: 200 - OK
15:57:00.488 DEBUG                    Connect closed for Server
15:57:00.489 DEBUG                    Connect closed for Server
15:57:02.200 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:57:02.270 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x9b6df1d0a9bf9f68 subj=0x9b6df1d0a9bf9f68
15:57:02.270 DEBUG                    CKA requesting Inf IA from ICM.
15:57:02.277 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:57:02.296 DEBUG                    Generating message signature using cert with serial: 5
15:57:02.316 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:57:02.316 INFO                     SKD: Client ---> Server CMC-request (1330 bytes)
15:57:02.316 INFO                     Sent CSR for Inf IA certificate.
15:57:02.317 DEBUG                    107313680: Connect accepted from Client
15:57:02.317 DEBUG                    Connect closed for Server
15:57:02.317 DEBUG                    Connect closed for Server
15:57:02.367 DEBUG                    Connected to Server
15:57:02.417 DEBUG                    Sending HTTP POST /fullcmc message.
15:57:02.417 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:57:02.488 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:57:02.489 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:57:02.498 DEBUG                    Generating certificate signature for serial: 20002
15:57:02.510 DEBUG                    Generating message signature using cert with serial: 20000
15:57:02.574 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:57:02.575 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:02.577 DEBUG                    HTTP Status: 200 - OK
15:57:02.577 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3127 bytes)
15:57:02.643 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:57:02.643 DEBUG                    Received Inf IA response
15:57:02.643 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x09732caf42ac9e12
15:57:02.644 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x09732caf42ac9e12 subj=0xf9b85c1423524d23
15:57:02.644 DEBUG                    Connected to Server
15:57:02.675 DEBUG                    Sending HTTP GET /status_2 message.
15:57:02.676 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:02.690 DEBUG                    HTTP Status: 200 - OK
15:57:02.691 DEBUG                    Connect closed for Server
15:57:02.691 DEBUG                    Connect closed for Server
15:57:04.691 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:04.742 DEBUG                    Connected to Server
15:57:04.792 DEBUG                    Sending HTTP GET /status_2 message.
15:57:04.793 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:04.893 DEBUG                    HTTP Status: 200 - OK
15:57:04.895 DEBUG                    Connect closed for Server
15:57:04.896 DEBUG                    Connect closed for Server
15:57:06.520 DEBUG                    ########## Mocks complete ##########
15:57:06.901 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:06.951 DEBUG                    Connected to Server
15:57:07.001 DEBUG                    Sending HTTP GET /status_2 message.
15:57:07.002 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:07.120 DEBUG                    HTTP Status: 200 - OK
15:57:07.120 DEBUG                    Connect closed for Server
15:57:07.120 DEBUG                    Connect closed for Server
15:57:07.652 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:57:07.653 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:57:08.604 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:57:08.605 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:57:09.120 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:09.170 DEBUG                    Connected to Server
15:57:09.220 DEBUG                    Sending HTTP GET /status_2 message.
15:57:09.221 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:09.321 DEBUG                    HTTP Status: 200 - OK
15:57:09.321 DEBUG                    Connect closed for Server
15:57:09.322 DEBUG                    Connect closed for Server
15:57:11.321 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:11.372 DEBUG                    Connected to Server
15:57:11.421 DEBUG                    Sending HTTP GET /status_2 message.
15:57:11.422 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:11.520 DEBUG                    HTTP Status: 200 - OK
15:57:11.520 DEBUG                    Connect closed for Server
15:57:11.521 DEBUG                    Connect closed for Server
15:57:13.520 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:13.571 DEBUG                    Connected to Server
15:57:13.621 DEBUG                    Sending HTTP GET /status_2 message.
15:57:13.621 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:15.927 DEBUG                    HTTP Status: 200 - OK
15:57:15.927 DEBUG                    Connect closed for Server
15:57:15.928 DEBUG                    Connect closed for Server
15:57:17.928 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:17.978 DEBUG                    Connected to Server
15:57:18.028 DEBUG                    Sending HTTP GET /status_2 message.
15:57:18.029 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:18.095 DEBUG                    HTTP Status: 200 - OK
15:57:18.096 DEBUG                    Connect closed for Server
15:57:18.096 DEBUG                    Connect closed for Server
15:57:20.095 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:20.146 DEBUG                    Connected to Server
15:57:20.196 DEBUG                    Sending HTTP GET /status_2 message.
15:57:20.196 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:20.333 DEBUG                    HTTP Status: 200 - OK
15:57:20.333 DEBUG                    Connect closed for Server
15:57:20.333 DEBUG                    Connect closed for Server
15:57:22.333 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:22.384 DEBUG                    Connected to Server
15:57:22.434 DEBUG                    Sending HTTP GET /status_2 message.
15:57:22.434 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:22.507 DEBUG                    HTTP Status: 200 - OK
15:57:22.507 DEBUG                    Connect closed for Server
15:57:22.507 DEBUG                    Connect closed for Server
15:57:24.507 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:24.558 DEBUG                    Connected to Server
15:57:24.611 DEBUG                    Sending HTTP GET /status_2 message.
15:57:24.611 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:24.732 DEBUG                    HTTP Status: 200 - OK
15:57:24.733 DEBUG                    Connect closed for Server
15:57:24.733 DEBUG                    Connect closed for Server
15:57:26.733 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:26.783 DEBUG                    Connected to Server
15:57:26.833 DEBUG                    Sending HTTP GET /status_2 message.
15:57:26.834 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:26.933 DEBUG                    HTTP Status: 200 - OK
15:57:26.934 DEBUG                    Connect closed for Server
15:57:26.935 DEBUG                    Connect closed for Server
15:57:28.934 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:28.988 DEBUG                    Connected to Server
15:57:29.035 DEBUG                    Sending HTTP GET /status_2 message.
15:57:29.035 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:29.124 DEBUG                    HTTP Status: 200 - OK
15:57:29.125 DEBUG                    Connect closed for Server
15:57:29.126 DEBUG                    Connect closed for Server
15:57:31.125 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:31.176 DEBUG                    Connected to Server
15:57:31.226 DEBUG                    Sending HTTP GET /status_2 message.
15:57:31.226 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:31.336 DEBUG                    HTTP Status: 200 - OK
15:57:31.337 DEBUG                    Connect closed for Server
15:57:31.338 DEBUG                    Connect closed for Server
15:57:33.337 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:33.388 DEBUG                    Connected to Server
15:57:33.443 DEBUG                    Sending HTTP GET /status_2 message.
15:57:33.443 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:33.495 DEBUG                    HTTP Status: 200 - OK
15:57:33.496 DEBUG                    Connect closed for Server
15:57:33.497 DEBUG                    Connect closed for Server
15:57:35.496 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:35.551 DEBUG                    Connected to Server
15:57:35.598 DEBUG                    Sending HTTP GET /status_2 message.
15:57:35.599 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:35.690 DEBUG                    HTTP Status: 200 - OK
15:57:35.690 DEBUG                    Connect closed for Server
15:57:35.690 DEBUG                    Connect closed for Server
15:57:36.430 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:991253331296772971741725885849194084888991714278707306530333153013814374659018387107583089448328442751751131533464914938852722823328832944739730795533365837566922856859617545254606563068360302279199124928427281074189299389424972848
|                                                     x = 25157433008765899321657606090443775174134899220798520102246324825628468961926388819092139337203160740376409798156553
|                                                     y = 4511482449123037142017218466407720203232011613764766443728858591927374105387564348698087928118262614699039754007600
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:12598582754751789911197423688411483796096912067114588028449501644742063519212246751056689496545374865359991768615407
|                                                 s = long384:30590000001182270559965166883017245395466849999183294581480641123533110980899539611231217023283487809968539225549415
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155711Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 8L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0xce94e845b63c0c8d87acfebc4af097bb7c33014b864225ad1a5bfe78d76058527713c3edeebe008ef8d1ccca4f7381dc)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:11924627678760108635337783920994681757612694380492367407378885392024589966597408209766977446204909251237767212129658
|                                                 s = long384:30490819537570461439625624308437137313000943068742284031188318712507206302713772837258040310425923623821684068625258
15:57:36.431 DEBUG                    IR: Handling Certificate Signing Request.
15:57:36.432 DEBUG                    Generating InfCA certificate (serialNumber: 20002L)
15:57:36.438 DEBUG                    Generating certificate signature for serial: 20002
15:57:36.445 DEBUG                    Creating SKD message file /tmp/infca.resp
15:57:36.448 DEBUG                    Generating message signature using cert with serial: 88843
15:57:36.479 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0xe7209147c0a98039-->0xc396b374037da04a-->0xc9020cefbb66368c
|                                             0xc1db49bbfa67b430-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 88843L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155659Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:917139409558941819946716513766466533028382507580617074639606041846757270455406501392506790304125973568003917620183012751303357852648561099085491242712427989183669802541734608611182573821677389721718849041305165777203924359952564281
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc396b374037da04a)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xe7209147c0a98039)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:37416580915995472583704639615704459513740020357836306562475891163656964720382922386333015243537101864264133667792671
|                                                     s = long384:4964311543872396631951227327143122731762535962192500070427658333190962518357719263251282239992088868349934090724562
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 88206L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155659Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1043625049204873137289915107597708677869150681634436184873169661671627269071821291136832191426765664622472760341962167242327863051554784597120557959532805782136965142570388688156001847619896207961320432836564384500327844658311700554
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xc396b374037da04a)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:38574925273909644923742254480039907003871671467644259457163077970763585061834577958762371017175780637337307282312760
|                                                     s = long384:7141272972005530383774455702780320311135446793089638312006452113720392398909244953043631287794042437375187406878947
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155736Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:991253331296772971741725885849194084888991714278707306530333153013814374659018387107583089448328442751751131533464914938852722823328832944739730795533365837566922856859617545254606563068360302279199124928427281074189299389424972848
|                                                         x = 25157433008765899321657606090443775174134899220798520102246324825628468961926388819092139337203160740376409798156553
|                                                         y = 4511482449123037142017218466407720203232011613764766443728858591927374105387564348698087928118262614699039754007600
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xc1db49bbfa67b430)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:30093211764820163973737042199954289752154505144227163004079733895364369597947270956889595221778882442544318970291232
|                                                     s = long384:7595105225624097195080353362734416249405493964834615095861032531135264051341846978340709244490032183972858177490268
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0xe7209147c0a98039)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155736Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 8L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:13404621024052624206100866245036593892637252499720460267331296018809931927350402547307977539136493058009281853166527
|                                                 s = long384:25164431652543295607297423461274057731871853302399075114240202283495469211394114018485966479836289506522712421024271
15:57:37.690 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:37.741 DEBUG                    Connected to Server
15:57:37.791 DEBUG                    Sending HTTP GET /status_2 message.
15:57:37.791 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:57:37.900 DEBUG                    HTTP Status: 200 - OK
15:57:37.901 DEBUG                    Connect closed for Server
15:57:37.901 DEBUG                    Connect closed for Server
15:57:39.741 DEBUG                    UUT Control: Applying all recent configuration changes
15:57:39.763 INFO    Test:            116 : [icm-issue-factia-creation] The ICM allows
|                                           the user to request creation of Factory IA
|                                           certificates and receives a valid response.
15:57:39.773 INFO                           #> 0.1. Create some factory IA certs and check they are stored/viewable
15:57:39.773 INFO                           #> 0.1.1. Create and check the certificates
15:57:39.773 INFO                           #> 0.1.2. Create a Factory IA Certificate.
15:57:39.901 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:39.952 DEBUG                          Connected to Server
15:57:40.002 DEBUG                          Sending HTTP GET /status_2 message.
15:57:40.002 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:57:40.127 DEBUG                          HTTP Status: 200 - OK
15:57:40.128 DEBUG                          Connect closed for Server
15:57:40.128 DEBUG                          Connect closed for Server
15:57:42.128 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:42.179 DEBUG                          Connected to Server
15:57:42.229 DEBUG                          Sending HTTP GET /status_2 message.
15:57:42.230 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:57:42.295 DEBUG                          HTTP Status: 200 - OK
15:57:42.296 DEBUG                          Connect closed for Server
15:57:42.298 DEBUG                          Connect closed for Server
15:57:42.785 INFO                           #> 0.1.3. Verify Factory IA Certificate is stored.
15:57:44.296 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:44.347 DEBUG                          Connected to Server
15:57:44.396 DEBUG                          Sending HTTP GET /status_2 message.
15:57:44.398 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:57:44.504 DEBUG                          HTTP Status: 200 - OK
15:57:44.505 DEBUG                          Connect closed for Server
15:57:44.506 DEBUG                          Connect closed for Server
15:57:46.065 INFO                           #> 0.1.4. Create and check the certificates
15:57:46.065 INFO                           #> 0.1.5. Create a Factory IA Certificate.
15:57:46.505 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:46.556 DEBUG                          Connected to Server
15:57:46.606 DEBUG                          Sending HTTP GET /status_2 message.
15:57:46.607 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:57:46.702 DEBUG                          HTTP Status: 200 - OK
15:57:46.703 DEBUG                          Connect closed for Server
15:57:46.704 DEBUG                          Connect closed for Server
15:57:48.703 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:48.754 DEBUG                          Connected to Server
15:57:48.803 DEBUG                          Sending HTTP GET /status_2 message.
15:57:48.804 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:57:48.902 DEBUG                          HTTP Status: 200 - OK
15:57:48.903 DEBUG                          Connect closed for Server
15:57:48.909 DEBUG                          Connect closed for Server
15:57:49.305 INFO                           #> 0.1.6. Verify Factory IA Certificate is stored.
15:57:50.903 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:50.953 DEBUG                          Connected to Server
15:57:51.004 DEBUG                          Sending HTTP GET /status_2 message.
15:57:51.005 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:57:51.122 DEBUG                          HTTP Status: 200 - OK
15:57:51.123 DEBUG                          Connect closed for Server
15:57:51.129 DEBUG                          Connect closed for Server
15:57:52.904 INFO                           #> 0.1.7. Create and check the certificates
15:57:52.904 INFO                           #> 0.1.8. Create a Factory IA Certificate.
15:57:53.123 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:53.174 DEBUG                          Connected to Server
15:57:53.224 DEBUG                          Sending HTTP GET /status_2 message.
15:57:53.227 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:57:53.321 DEBUG                          HTTP Status: 200 - OK
15:57:53.322 DEBUG                          Connect closed for Server
15:57:53.322 DEBUG                          Connect closed for Server
15:57:55.322 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:55.374 DEBUG                          Connected to Server
15:57:55.423 DEBUG                          Sending HTTP GET /status_2 message.
15:57:55.424 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:57:55.530 DEBUG                          HTTP Status: 200 - OK
15:57:55.531 DEBUG                          Connect closed for Server
15:57:55.532 DEBUG                          Connect closed for Server
15:57:56.570 INFO                           #> 0.1.9. Verify Factory IA Certificate is stored.
15:57:57.531 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:57.582 DEBUG                          Connected to Server
15:57:57.632 DEBUG                          Sending HTTP GET /status_2 message.
15:57:57.632 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:57:57.711 DEBUG                          HTTP Status: 200 - OK
15:57:57.712 DEBUG                          Connect closed for Server
15:57:57.713 DEBUG                          Connect closed for Server
15:57:59.712 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:57:59.763 DEBUG                          Connected to Server
15:57:59.812 DEBUG                          Sending HTTP GET /status_2 message.
15:57:59.813 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:57:59.895 DEBUG                          HTTP Status: 200 - OK
15:57:59.896 DEBUG                          Connect closed for Server
15:57:59.897 DEBUG                          Connect closed for Server
15:58:00.566 INFO                           #> 0.1.10. Create and check the certificates
15:58:00.566 INFO                           #> 0.1.11. Verify valid created certificates can be listed.
15:58:01.896 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:01.952 DEBUG                          Connected to Server
15:58:01.996 DEBUG                          Sending HTTP GET /status_2 message.
15:58:01.997 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:58:02.109 DEBUG                          HTTP Status: 200 - OK
15:58:02.110 DEBUG                          Connect closed for Server
15:58:02.110 DEBUG                          Connect closed for Server
15:58:04.110 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:04.161 DEBUG                          Connected to Server
15:58:04.210 DEBUG                          Sending HTTP GET /status_2 message.
15:58:04.211 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:58:04.358 DEBUG                          HTTP Status: 200 - OK
15:58:04.359 DEBUG                          Connect closed for Server
15:58:04.362 DEBUG                          Connect closed for Server
15:58:04.660 INFO                           #> 0.2. Remove one of them and check it has gone
15:58:04.660 INFO                           #> 0.2.1. Verify Factory IA Certificates can be marked as invalid.
15:58:06.362 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:06.413 DEBUG                          Connected to Server
15:58:06.462 DEBUG                          Sending HTTP GET /status_2 message.
15:58:06.464 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:58:06.520 DEBUG                          HTTP Status: 200 - OK
15:58:06.521 DEBUG                          Connect closed for Server
15:58:06.522 DEBUG                          Connect closed for Server
15:58:08.521 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:08.572 DEBUG                          Connected to Server
15:58:08.624 DEBUG                          Sending HTTP GET /status_2 message.
15:58:08.624 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:58:08.688 DEBUG                          HTTP Status: 200 - OK
15:58:08.689 DEBUG                          Connect closed for Server
15:58:08.693 DEBUG                          Connect closed for Server
15:58:10.689 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:10.740 DEBUG                          Connected to Server
15:58:10.789 DEBUG                          Sending HTTP GET /status_2 message.
15:58:10.790 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:58:10.895 DEBUG                          HTTP Status: 200 - OK
15:58:10.896 DEBUG                          Connect closed for Server
15:58:10.902 DEBUG                          Connect closed for Server
15:58:12.172 INFO    Test:                  PASS
15:58:12.299 DEBUG                    Tearing down mock HTTP servers
15:58:12.302 DEBUG                    Connect closed for Server
15:58:12.302 DEBUG                    Connect closed for Server
15:58:12.896 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:12.946 DEBUG                    Connected to Server
15:58:12.996 DEBUG                    Sending HTTP GET /status_2 message.
15:58:12.997 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:13.104 DEBUG                    HTTP Status: 200 - OK
15:58:13.105 DEBUG                    Connect closed for Server
15:58:13.105 DEBUG                    Connect closed for Server
15:58:15.104 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:15.155 DEBUG                    Connected to Server
15:58:15.205 DEBUG                    Sending HTTP GET /status_2 message.
15:58:15.205 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:15.324 DEBUG                    HTTP Status: 200 - OK
15:58:15.328 DEBUG                    Connect closed for Server
15:58:15.329 DEBUG                    Connect closed for Server
15:58:17.334 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:17.384 DEBUG                    Connected to Server
15:58:17.434 DEBUG                    Sending HTTP GET /status_2 message.
15:58:17.435 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:17.499 DEBUG                    HTTP Status: 200 - OK
15:58:17.504 DEBUG                    Connect closed for Server
15:58:17.505 DEBUG                    Connect closed for Server
15:58:19.636 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:58:19.636 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:58:19.648 DEBUG                    Generating certificate signature for serial: 86794
15:58:19.653 DEBUG                    Added keymat IR-INF-CA: serial=86794 auth=0xc9020cefbb66368c subj=0xcd3bebef598db313
15:58:19.665 DEBUG                    Generating certificate signature for serial: 86461
15:58:19.670 DEBUG                    Added keymat IR-INF-IA: serial=86461 auth=0xcd3bebef598db313 subj=0x597cf27d088f2b8f
15:58:19.682 DEBUG                    Generating certificate signature for serial: 85118
15:58:19.688 DEBUG                    Added keymat IR-INF-CRL-CA: serial=85118 auth=0xc9020cefbb66368c subj=0x5d6c9c37eb9ed720
15:58:19.699 DEBUG                    Generating certificate signature for serial: 87037
15:58:19.705 DEBUG                    Added keymat IR-INF-CRL-IA: serial=87037 auth=0x5d6c9c37eb9ed720 subj=0xb22a7bd10f550916
15:58:19.715 DEBUG                    Generating certificate signature for serial: 5
15:58:19.720 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x3c22825d60a5ec87 subj=0x3c22825d60a5ec87
15:58:19.729 DEBUG                    Generating message signature using cert with serial: 86461
15:58:19.762 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:58:19.812 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x3c22825d60a5ec87 subj=0x3c22825d60a5ec87
15:58:19.818 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:58:19.834 DEBUG                    Generating message signature using cert with serial: 5
15:58:19.890 DEBUG                    IR: Handling Certificate Signing Request.
15:58:19.890 DEBUG                    Creating temporary CA cert to issue IA
15:58:19.902 DEBUG                    Generating certificate signature for serial: 89798
15:58:19.908 DEBUG                    Added keymat IR-INF-CA-TMP: serial=89798 auth=0xc9020cefbb66368c subj=0x0e997654d6849962
15:58:19.908 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:58:19.914 DEBUG                    Generating certificate signature for serial: 20000
15:58:19.921 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:58:19.923 DEBUG                    Generating message signature using cert with serial: 86461
15:58:20.041 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:58:20.042 DEBUG                    Received Inf IA response
15:58:20.042 DEBUG                    Added keymat IR-INF-CA: serial=89798 auth=0xc9020cefbb66368c subj=0x0e997654d6849962
15:58:20.042 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x0e997654d6849962 subj=0xf66c764fc6cda07e
15:58:20.053 DEBUG                    Generating certificate signature for serial: 5
15:58:20.059 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x6d19d19cbd1dec48 subj=0x6d19d19cbd1dec48
15:58:20.068 DEBUG                    Generating message signature using cert with serial: 20000
15:58:20.107 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:58:20.125 DEBUG                    Generating message signature using cert with serial: 20000
15:58:20.210 DEBUG                    IR: Handling Certificate Signing Request.
15:58:20.211 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:58:20.218 DEBUG                    Generating certificate signature for serial: 20001
15:58:20.225 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:58:20.228 DEBUG                    Generating message signature using cert with serial: 86461
15:58:20.329 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:58:20.329 DEBUG                    Received Inf CA response
15:58:20.330 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xa2ae4fa9ffbd850c
15:58:20.330 INFO                     Listening for ('128.10.1.4', 80)
15:58:20.335 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:58:20.339 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:58:20.339 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:58:20.392 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x6d19d19cbd1dec48 subj=0x6d19d19cbd1dec48
15:58:20.398 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:58:20.415 DEBUG                    Generating message signature using cert with serial: 5
15:58:20.473 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:58:20.480 DEBUG                    Generating certificate signature for serial: 20000
15:58:20.486 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:58:20.489 DEBUG                    Generating message signature using cert with serial: 20000
15:58:20.604 DEBUG                    Received Inf IA response
15:58:20.604 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xa2ae4fa9ffbd850c
15:58:20.604 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0xa2ae4fa9ffbd850c subj=0x6008ac467e0ea94f
15:58:20.608 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:58:20.612 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:58:20.661 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x6d19d19cbd1dec48 subj=0x6d19d19cbd1dec48
15:58:20.662 INFO                     Listening for ('128.10.1.6', 80)
15:58:20.662 DEBUG                    MCKM requesting Inf IA from ICM.
15:58:20.668 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:58:20.684 DEBUG                    Generating message signature using cert with serial: 5
15:58:20.701 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:58:20.702 INFO                     SKD: Client ---> Server CMC-request (1341 bytes)
15:58:20.702 INFO                     Sent CSR for Inf IA certificate.
15:58:20.702 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:20.703 DEBUG                    107291408: Connect accepted from Client
15:58:20.752 DEBUG                    Connected to Server
15:58:20.753 DEBUG                    Connected to Server
15:58:20.804 DEBUG                    Sending HTTP POST /fullcmc message.
15:58:20.805 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:58:20.805 DEBUG                    Sending HTTP GET /status_2 message.
15:58:20.807 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:20.878 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:58:20.879 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:58:20.891 DEBUG                    Generating certificate signature for serial: 20001
15:58:20.903 DEBUG                    Generating message signature using cert with serial: 20000
15:58:20.965 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:58:20.967 DEBUG                    HTTP Status: 200 - OK
15:58:20.967 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3138 bytes)
15:58:21.032 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:58:21.033 DEBUG                    Received Inf IA response
15:58:21.033 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xa2ae4fa9ffbd850c
15:58:21.033 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0xa2ae4fa9ffbd850c subj=0xc61dd41107312128
15:58:21.034 DEBUG                    HTTP Status: 200 - OK
15:58:21.035 DEBUG                    Connect closed for Server
15:58:21.035 DEBUG                    Connect closed for Server
15:58:22.707 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:58:22.762 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x6d19d19cbd1dec48 subj=0x6d19d19cbd1dec48
15:58:22.762 DEBUG                    CKA requesting Inf IA from ICM.
15:58:22.769 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:58:22.787 DEBUG                    Generating message signature using cert with serial: 5
15:58:22.805 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:58:22.805 INFO                     SKD: Client ---> Server CMC-request (1331 bytes)
15:58:22.805 INFO                     Sent CSR for Inf IA certificate.
15:58:22.806 DEBUG                    107291408: Connect accepted from Client
15:58:22.806 DEBUG                    Connect closed for Server
15:58:22.806 DEBUG                    Connect closed for Server
15:58:22.857 DEBUG                    Connected to Server
15:58:22.907 DEBUG                    Sending HTTP POST /fullcmc message.
15:58:22.907 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:58:22.947 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:58:22.947 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:58:22.953 DEBUG                    Generating certificate signature for serial: 20002
15:58:22.963 DEBUG                    Generating message signature using cert with serial: 20000
15:58:23.016 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:58:23.017 DEBUG                    HTTP Status: 200 - OK
15:58:23.017 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3127 bytes)
15:58:23.082 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:58:23.082 DEBUG                    Received Inf IA response
15:58:23.082 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xa2ae4fa9ffbd850c
15:58:23.082 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0xa2ae4fa9ffbd850c subj=0xedd833c216ef09bf
15:58:23.083 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:23.133 DEBUG                    Connected to Server
15:58:23.184 DEBUG                    Sending HTTP GET /status_2 message.
15:58:23.185 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:23.189 DEBUG                    HTTP Status: 200 - OK
15:58:23.190 DEBUG                    Connect closed for Server
15:58:23.191 DEBUG                    Connect closed for Server
15:58:25.193 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:25.244 DEBUG                    Connected to Server
15:58:25.295 DEBUG                    Sending HTTP GET /status_2 message.
15:58:25.295 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:25.388 DEBUG                    HTTP Status: 200 - OK
15:58:25.389 DEBUG                    Connect closed for Server
15:58:25.389 DEBUG                    Connect closed for Server
15:58:27.014 DEBUG                    ########## Mocks complete ##########
15:58:27.389 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:27.439 DEBUG                    Connected to Server
15:58:27.490 DEBUG                    Sending HTTP GET /status_2 message.
15:58:27.490 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:27.615 DEBUG                    HTTP Status: 200 - OK
15:58:27.615 DEBUG                    Connect closed for Server
15:58:27.615 DEBUG                    Connect closed for Server
15:58:27.902 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:58:27.902 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:58:28.859 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:58:28.859 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:58:29.615 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:29.666 DEBUG                    Connected to Server
15:58:29.716 DEBUG                    Sending HTTP GET /status_2 message.
15:58:29.716 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:29.827 DEBUG                    HTTP Status: 200 - OK
15:58:29.827 DEBUG                    Connect closed for Server
15:58:29.828 DEBUG                    Connect closed for Server
15:58:31.827 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:31.878 DEBUG                    Connected to Server
15:58:31.928 DEBUG                    Sending HTTP GET /status_2 message.
15:58:31.928 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:32.024 DEBUG                    HTTP Status: 200 - OK
15:58:32.025 DEBUG                    Connect closed for Server
15:58:32.025 DEBUG                    Connect closed for Server
15:58:34.025 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:34.075 DEBUG                    Connected to Server
15:58:34.125 DEBUG                    Sending HTTP GET /status_2 message.
15:58:34.126 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:37.224 DEBUG                    HTTP Status: 200 - OK
15:58:37.225 DEBUG                    Connect closed for Server
15:58:37.225 DEBUG                    Connect closed for Server
15:58:39.224 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:39.275 DEBUG                    Connected to Server
15:58:39.325 DEBUG                    Sending HTTP GET /status_2 message.
15:58:39.325 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:39.432 DEBUG                    HTTP Status: 200 - OK
15:58:39.432 DEBUG                    Connect closed for Server
15:58:39.433 DEBUG                    Connect closed for Server
15:58:41.432 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:41.483 DEBUG                    Connected to Server
15:58:41.533 DEBUG                    Sending HTTP GET /status_2 message.
15:58:41.533 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:41.597 DEBUG                    HTTP Status: 200 - OK
15:58:41.603 DEBUG                    Connect closed for Server
15:58:41.604 DEBUG                    Connect closed for Server
15:58:43.603 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:43.653 DEBUG                    Connected to Server
15:58:43.703 DEBUG                    Sending HTTP GET /status_2 message.
15:58:43.704 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:43.843 DEBUG                    HTTP Status: 200 - OK
15:58:43.845 DEBUG                    Connect closed for Server
15:58:43.845 DEBUG                    Connect closed for Server
15:58:45.844 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:45.895 DEBUG                    Connected to Server
15:58:45.945 DEBUG                    Sending HTTP GET /status_2 message.
15:58:45.945 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:46.002 DEBUG                    HTTP Status: 200 - OK
15:58:46.002 DEBUG                    Connect closed for Server
15:58:46.002 DEBUG                    Connect closed for Server
15:58:48.002 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:48.053 DEBUG                    Connected to Server
15:58:48.103 DEBUG                    Sending HTTP GET /status_2 message.
15:58:48.103 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:48.215 DEBUG                    HTTP Status: 200 - OK
15:58:48.216 DEBUG                    Connect closed for Server
15:58:48.216 DEBUG                    Connect closed for Server
15:58:50.216 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:50.266 DEBUG                    Connected to Server
15:58:50.316 DEBUG                    Sending HTTP GET /status_2 message.
15:58:50.316 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:50.391 DEBUG                    HTTP Status: 200 - OK
15:58:50.392 DEBUG                    Connect closed for Server
15:58:50.392 DEBUG                    Connect closed for Server
15:58:52.392 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:52.442 DEBUG                    Connected to Server
15:58:52.492 DEBUG                    Sending HTTP GET /status_2 message.
15:58:52.492 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:52.610 DEBUG                    HTTP Status: 200 - OK
15:58:52.611 DEBUG                    Connect closed for Server
15:58:52.611 DEBUG                    Connect closed for Server
15:58:54.610 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:54.661 DEBUG                    Connected to Server
15:58:54.711 DEBUG                    Sending HTTP GET /status_2 message.
15:58:54.711 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:54.829 DEBUG                    HTTP Status: 200 - OK
15:58:54.830 DEBUG                    Connect closed for Server
15:58:54.836 DEBUG                    Connect closed for Server
15:58:56.830 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:56.880 DEBUG                    Connected to Server
15:58:56.930 DEBUG                    Sending HTTP GET /status_2 message.
15:58:56.931 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:56.996 DEBUG                    HTTP Status: 200 - OK
15:58:56.996 DEBUG                    Connect closed for Server
15:58:56.997 DEBUG                    Connect closed for Server
15:58:58.996 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:58:59.047 DEBUG                    Connected to Server
15:58:59.097 DEBUG                    Sending HTTP GET /status_2 message.
15:58:59.097 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:58:59.232 DEBUG                    HTTP Status: 200 - OK
15:58:59.232 DEBUG                    Connect closed for Server
15:58:59.233 DEBUG                    Connect closed for Server
15:59:00.276 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:676230175086339576893789381419039055274298586799168714188823092766832847407954802582186235943425494268522375772721264157718611659450186234898146292646026442445684886446335045028510532504521982341899083290075109577315836315863681301
|                                                     x = 17162328530069078289080872952976479157107423742699390070706756422121361972359885945641067244604782127090006320352714
|                                                     y = 24122279673630002534829170886981273673300902950537973780540824317424040113057402184575914554994151702672265665382677
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:4819317820347894529033477878656531689519531581227440791351228901242741505807180404033878620406899542149850266407511
|                                                 s = long384:14738838343320523910395972491954661586167891708957796944909783545518011916993351066647493565700814945207296734379751
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155832Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 9L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x4ee3c59fd17597be35bdf8777d0c4deddc6e799ba3efa399c381ac702c7661ebd883ee148d9502ae449e3819c736d1ae)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:34116651294816210006188363960526214041565434150311097138904047519887959293413106285090311414361486236511606509459477
|                                                 s = long384:17221817294873800611694808794495077794979931277491430714107350380824040754887583196276715088030333041262447072438548
15:59:00.277 DEBUG                    IR: Handling Certificate Signing Request.
15:59:00.278 DEBUG                    Generating InfCA certificate (serialNumber: 20002L)
15:59:00.284 DEBUG                    Generating certificate signature for serial: 20002
15:59:00.290 DEBUG                    Creating SKD message file /tmp/infca.resp
15:59:00.293 DEBUG                    Generating message signature using cert with serial: 86461
15:59:00.323 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0x597cf27d088f2b8f-->0xcd3bebef598db313-->0xc9020cefbb66368c
|                                             0xb6c4b49e83bd0915-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 86461L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155819Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1368358575715246760566243797799766974601117056005724529756119124641015368213198573293541959773020946129500147166097793131419289952963637512010567021934955743682429074651714207636175663780793994331341694383740988481938227807629814671
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xcd3bebef598db313)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x597cf27d088f2b8f)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14846642345198443515624735359948027191042208093971665936191267656645616721907050827197909973858398025332703378814819
|                                                     s = long384:29042417738203622358033794315930659955608383458790037659806712617049302570438202980133791762942988477772291399291440
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 86794L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155819Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1364484829777915461886131472811386329776808163704282718976343139350816641588842936739884113923878435559452247187524233293275756713425940625448416359042621045653812270516794359226130909303845201105863643065968365998889707551742341907
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xcd3bebef598db313)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:10525018984994030445823776366309853950964885783457418880677517389928858972734763868610488435981461828258850900978644
|                                                     s = long384:2860541056040233423775058281302001470477834970515832739808826406028071683143749645588395527632188913137166617749090
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155900Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:676230175086339576893789381419039055274298586799168714188823092766832847407954802582186235943425494268522375772721264157718611659450186234898146292646026442445684886446335045028510532504521982341899083290075109577315836315863681301
|                                                         x = 17162328530069078289080872952976479157107423742699390070706756422121361972359885945641067244604782127090006320352714
|                                                         y = 24122279673630002534829170886981273673300902950537973780540824317424040113057402184575914554994151702672265665382677
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xb6c4b49e83bd0915)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:28524878729481714509416690316559586356286981981103265314067146827396029041072865182375432170283392372904929222440203
|                                                     s = long384:23928635548270773821794256971373994300383169450484420285686375465867652432576531609008825859877335202332122316175862
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x597cf27d088f2b8f)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112155900Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 9L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:31405395178796051743626384681873862340350881642288370601280897394089424897579122835754615243563756875222834966568069
|                                                 s = long384:19689233456869132214142141536280597721265022972618847150856677432095068576414901683083141185546948132065868893633809
15:59:01.235 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:01.286 DEBUG                    Connected to Server
15:59:01.336 DEBUG                    Sending HTTP GET /status_2 message.
15:59:01.336 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:59:01.423 DEBUG                    HTTP Status: 200 - OK
15:59:01.423 DEBUG                    Connect closed for Server
15:59:01.424 DEBUG                    Connect closed for Server
15:59:03.423 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:03.475 DEBUG                    Connected to Server
15:59:03.525 DEBUG                    Sending HTTP GET /status_2 message.
15:59:03.525 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:59:03.687 DEBUG                    HTTP Status: 200 - OK
15:59:03.687 DEBUG                    Connect closed for Server
15:59:03.688 DEBUG                    Connect closed for Server
15:59:03.697 DEBUG                    UUT Control: Applying all recent configuration changes
15:59:03.721 INFO    Test:            117 : [icm-factia-export] The ICM allows the user
|                                           to request creation of a Factory IA
|                                           certificate and export it.
15:59:03.732 INFO                           #> 0.1. Create a Factory IA Certificate.
15:59:05.688 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:05.739 DEBUG                          Connected to Server
15:59:05.788 DEBUG                          Sending HTTP GET /status_2 message.
15:59:05.789 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:59:05.942 DEBUG                          HTTP Status: 200 - OK
15:59:05.943 DEBUG                          Connect closed for Server
15:59:05.949 DEBUG                          Connect closed for Server
15:59:07.463 INFO                           #> 0.2. Verify the Factory IA Certificate and key can be exported.
15:59:07.463 INFO                           #> 0.2.1. Verify the Factory IA Certificate and key can be exported.
15:59:07.464 DEBUG                          cmd optimus > keydir
15:59:07.510 DEBUG                          cmd optimus > keydir /tmp/
15:59:07.943 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:07.994 DEBUG                          Connected to Server
15:59:08.044 DEBUG                          Sending HTTP GET /status_2 message.
15:59:08.045 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:59:08.099 DEBUG                          HTTP Status: 200 - OK
15:59:08.100 DEBUG                          Connect closed for Server
15:59:08.100 DEBUG                          Connect closed for Server
15:59:10.099 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:10.151 DEBUG                          Connected to Server
15:59:10.200 DEBUG                          Sending HTTP GET /status_2 message.
15:59:10.201 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:59:10.314 DEBUG                          HTTP Status: 200 - OK
15:59:10.316 DEBUG                          Connect closed for Server
15:59:10.317 DEBUG                          Connect closed for Server
15:59:12.315 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:12.366 DEBUG                          Connected to Server
15:59:12.416 DEBUG                          Sending HTTP GET /status_2 message.
15:59:12.416 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:59:12.501 DEBUG                          HTTP Status: 200 - OK
15:59:12.501 DEBUG                          Connect closed for Server
15:59:12.502 DEBUG                          Connect closed for Server
15:59:14.501 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:14.555 DEBUG                          Connected to Server
15:59:14.602 DEBUG                          Sending HTTP GET /status_2 message.
15:59:14.603 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:59:14.716 DEBUG                          HTTP Status: 200 - OK
15:59:14.718 DEBUG                          Connect closed for Server
15:59:14.719 DEBUG                          Connect closed for Server
15:59:16.466 DEBUG                          cmd optimus > keydir ../Keys/
15:59:16.668 DEBUG                          Received SKD message:
|                                           KeyPackageFile:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = List:
|                                                   [0]:
|                                                       OneAsymmetricKey:
|                                                           version == 0
|                                                           privateKeyAlgorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           privateKey = ECPrivateKey:
|                                                               version = 1L
|                                                               privateKey = Octets(0x72180a2be0910438d5407ea16e2f31937a5e681b289629f9fe03cf5eaa801f141bbb70ad57f712e2ae0ddc02f03051ec)
|                                                           attributes:
|                                                             [0] = UserCertificateAttr:
|                                                               id == OID(userCertificate:2.5.4.36)
|                                                               userCertificate = Certificate:
|                                                                   tbsCertificate = TBSCertificate:
|                                                                       version == 2
|                                                                       serialNumber = 12L
|                                                                       signatureAlgorithmID = AlgorithmIdentifier:
|                                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                       issuer = Name: SN=D8EFF0144001,CN=2.16.840.1.101.2.1.17
|                                                                       validity = 170112000000Z..99991231235959Z
|                                                                       subject = Name: SN=D8EFF0144001,CN=2.16.840.1.101.2.1.17
|                                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                           algorithm = AlgorithmIdentifier:
|                                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                               parameters = ECParameters:
|                                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                           subjectPublicKey = long768:1041089967826362098025396010291219930119827864566826977052329515030336810691440790629381978906287277068152192714946969202407510605570751105055736016169861193728476123246936293800778021204596654995552517569876250875717084752343547103
|                                                                           x = 26422257857561275597925180341825894449563206667162959514757131994163199828435462262421906403962898200491323538916936
|                                                                           y = 39145275524333460365416851177546515121628859591436057086815741217672404070784771926094529173030678476299197364911327
|                                                                       _extensions = CertificateExtensions
|                                                                         [0] AuthorityKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                               keyIdentifier = Octets(0x312c5666d0553cdf)
|                                                                         [1] SubjectKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                               id = Octets(0x312c5666d0553cdf)
|                                                                         [2] KeyUsage_CertExt:
|                                                                               extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                               critical = True
|                                                                               uses = ['digitalSignature']
|                                                                         [3] CertificatePolicies_CertExt:
|                                                                               extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                               critical = True
|                                                                               policies:
|                                                                                 [0] = PolicyInformation:
|                                                                                   id = OID(1.2.826.0.1145.0.1.0.3)
|                                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                   signature = Signature:
|                                                                       r = long384:20265534010043600650637296964615552316609178749717477550518531998916213888482883165329370749763188506635689849267930
|                                                                       s = long384:29887598473169695360044561239879671828957868199462375730727998458539863801464406493648725028289950941728057355190847
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                               x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                               y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1de6a414dda88f8b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                           s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 82825L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                               x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                               y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2eb4fc66f0202ec8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                           s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                                     [1] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x277fc89302bd37e0989468d6f2189febd26aef399089a28d90524a123bd6a7aa7a0fb6702665b4c8ae8c1ea12917dd78)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:15639123562022759607473652765321508016631173610589723900520755280286170270552871272695535429712776200333559158481796
|                                                       s = long384:34916022321055087171561149749152535681060893441318704462685994489053338415903768118637884592027068029860115839893492
15:59:16.669 INFO                           #> 0.2.2. Verify signature of the message.
15:59:16.695 INFO                           #> 0.2.3. Verify content of the message and certificate
15:59:16.767 INFO                           #> 0.3. Verify a Factory IA Certificate can be exported multiple times
15:59:16.767 INFO                           #> 0.3.1. Verify the Factory IA Certificate and key can be exported.
15:59:16.768 DEBUG                          cmd optimus > keydir
15:59:16.770 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:16.779 DEBUG                          cmd optimus > keydir /tmp/
15:59:16.826 DEBUG                          Connected to Server
15:59:16.871 DEBUG                          Sending HTTP GET /status_2 message.
15:59:16.871 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:59:16.897 DEBUG                          HTTP Status: 200 - OK
15:59:16.900 DEBUG                          Connect closed for Server
15:59:16.901 DEBUG                          Connect closed for Server
15:59:18.898 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:18.949 DEBUG                          Connected to Server
15:59:19.002 DEBUG                          Sending HTTP GET /status_2 message.
15:59:19.003 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:59:19.118 DEBUG                          HTTP Status: 200 - OK
15:59:19.119 DEBUG                          Connect closed for Server
15:59:19.128 DEBUG                          Connect closed for Server
15:59:21.119 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:21.169 DEBUG                          Connected to Server
15:59:21.220 DEBUG                          Sending HTTP GET /status_2 message.
15:59:21.221 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:59:21.315 DEBUG                          HTTP Status: 200 - OK
15:59:21.316 DEBUG                          Connect closed for Server
15:59:21.324 DEBUG                          Connect closed for Server
15:59:23.316 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:23.368 DEBUG                          Connected to Server
15:59:23.417 DEBUG                          Sending HTTP GET /status_2 message.
15:59:23.418 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:59:23.499 DEBUG                          HTTP Status: 200 - OK
15:59:23.500 DEBUG                          Connect closed for Server
15:59:23.501 DEBUG                          Connect closed for Server
15:59:25.502 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:25.553 DEBUG                          Connected to Server
15:59:25.605 DEBUG                          Sending HTTP GET /status_2 message.
15:59:25.605 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:59:25.690 DEBUG                          HTTP Status: 200 - OK
15:59:25.691 DEBUG                          Connect closed for Server
15:59:25.692 DEBUG                          Connect closed for Server
15:59:25.738 DEBUG                          cmd optimus > keydir ../Keys/
15:59:25.913 DEBUG                          Received SKD message:
|                                           KeyPackageFile:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = List:
|                                                   [0]:
|                                                       OneAsymmetricKey:
|                                                           version == 0
|                                                           privateKeyAlgorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           privateKey = ECPrivateKey:
|                                                               version = 1L
|                                                               privateKey = Octets(0x72180a2be0910438d5407ea16e2f31937a5e681b289629f9fe03cf5eaa801f141bbb70ad57f712e2ae0ddc02f03051ec)
|                                                           attributes:
|                                                             [0] = UserCertificateAttr:
|                                                               id == OID(userCertificate:2.5.4.36)
|                                                               userCertificate = Certificate:
|                                                                   tbsCertificate = TBSCertificate:
|                                                                       version == 2
|                                                                       serialNumber = 12L
|                                                                       signatureAlgorithmID = AlgorithmIdentifier:
|                                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                       issuer = Name: SN=D8EFF0144001,CN=2.16.840.1.101.2.1.17
|                                                                       validity = 170112000000Z..99991231235959Z
|                                                                       subject = Name: SN=D8EFF0144001,CN=2.16.840.1.101.2.1.17
|                                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                           algorithm = AlgorithmIdentifier:
|                                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                               parameters = ECParameters:
|                                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                           subjectPublicKey = long768:1041089967826362098025396010291219930119827864566826977052329515030336810691440790629381978906287277068152192714946969202407510605570751105055736016169861193728476123246936293800778021204596654995552517569876250875717084752343547103
|                                                                           x = 26422257857561275597925180341825894449563206667162959514757131994163199828435462262421906403962898200491323538916936
|                                                                           y = 39145275524333460365416851177546515121628859591436057086815741217672404070784771926094529173030678476299197364911327
|                                                                       _extensions = CertificateExtensions
|                                                                         [0] AuthorityKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                               keyIdentifier = Octets(0x312c5666d0553cdf)
|                                                                         [1] SubjectKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                               id = Octets(0x312c5666d0553cdf)
|                                                                         [2] KeyUsage_CertExt:
|                                                                               extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                               critical = True
|                                                                               uses = ['digitalSignature']
|                                                                         [3] CertificatePolicies_CertExt:
|                                                                               extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                               critical = True
|                                                                               policies:
|                                                                                 [0] = PolicyInformation:
|                                                                                   id = OID(1.2.826.0.1145.0.1.0.3)
|                                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                   signature = Signature:
|                                                                       r = long384:20265534010043600650637296964615552316609178749717477550518531998916213888482883165329370749763188506635689849267930
|                                                                       s = long384:29887598473169695360044561239879671828957868199462375730727998458539863801464406493648725028289950941728057355190847
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                               x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                               y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1de6a414dda88f8b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                           s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 82825L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                               x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                               y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2eb4fc66f0202ec8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                           s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                                     [1] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x277fc89302bd37e0989468d6f2189febd26aef399089a28d90524a123bd6a7aa7a0fb6702665b4c8ae8c1ea12917dd78)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:15639123562022759607473652765321508016631173610589723900520755280286170270552871272695535429712776200333559158481796
|                                                       s = long384:34916022321055087171561149749152535681060893441318704462685994489053338415903768118637884592027068029860115839893492
15:59:25.915 INFO                           #> 0.3.2. Verify signature of the message.
15:59:25.940 INFO                           #> 0.3.3. Verify content of the message and certificate
15:59:26.012 INFO                           #> 0.4. Verify Factory IA Certificates have different private keys
15:59:27.691 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:27.742 DEBUG                          Connected to Server
15:59:27.792 DEBUG                          Sending HTTP GET /status_2 message.
15:59:27.793 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:59:27.919 DEBUG                          HTTP Status: 200 - OK
15:59:27.920 DEBUG                          Connect closed for Server
15:59:27.921 DEBUG                          Connect closed for Server
15:59:29.920 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:29.971 DEBUG                          Connected to Server
15:59:30.021 DEBUG                          Sending HTTP GET /status_2 message.
15:59:30.022 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:59:30.030 INFO                           #> 0.4.1. Verify the Factory IA Certificate and key can be exported.
15:59:30.030 DEBUG                          cmd optimus > keydir
15:59:30.075 DEBUG                          cmd optimus > keydir /tmp/
15:59:30.122 DEBUG                          HTTP Status: 200 - OK
15:59:30.123 DEBUG                          Connect closed for Server
15:59:30.127 DEBUG                          Connect closed for Server
15:59:32.123 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:32.174 DEBUG                          Connected to Server
15:59:32.223 DEBUG                          Sending HTTP GET /status_2 message.
15:59:32.224 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:59:32.298 DEBUG                          HTTP Status: 200 - OK
15:59:32.298 DEBUG                          Connect closed for Server
15:59:32.299 DEBUG                          Connect closed for Server
15:59:34.298 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:34.350 DEBUG                          Connected to Server
15:59:34.399 DEBUG                          Sending HTTP GET /status_2 message.
15:59:34.400 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:59:34.491 DEBUG                          HTTP Status: 200 - OK
15:59:34.492 DEBUG                          Connect closed for Server
15:59:34.493 DEBUG                          Connect closed for Server
15:59:36.492 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:36.544 DEBUG                          Connected to Server
15:59:36.594 DEBUG                          Sending HTTP GET /status_2 message.
15:59:36.594 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:59:36.697 DEBUG                          HTTP Status: 200 - OK
15:59:36.698 DEBUG                          Connect closed for Server
15:59:36.698 DEBUG                          Connect closed for Server
15:59:38.697 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:38.748 DEBUG                          Connected to Server
15:59:38.798 DEBUG                          Sending HTTP GET /status_2 message.
15:59:38.799 DEBUG                          Removing HTTP GET /status_2 message from Q.
15:59:38.896 DEBUG                          HTTP Status: 200 - OK
15:59:38.896 DEBUG                          Connect closed for Server
15:59:38.897 DEBUG                          Connect closed for Server
15:59:39.945 DEBUG                          cmd optimus > keydir ../Keys/
15:59:40.127 DEBUG                          Received SKD message:
|                                           KeyPackageFile:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = List:
|                                                   [0]:
|                                                       OneAsymmetricKey:
|                                                           version == 0
|                                                           privateKeyAlgorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           privateKey = ECPrivateKey:
|                                                               version = 1L
|                                                               privateKey = Octets(0xe1881182739cd740b998af39d0a4137d4c20e688610b46d14c2621c9d7195adff06b127f3e7749f10f3f9054625730f7)
|                                                           attributes:
|                                                             [0] = UserCertificateAttr:
|                                                               id == OID(userCertificate:2.5.4.36)
|                                                               userCertificate = Certificate:
|                                                                   tbsCertificate = TBSCertificate:
|                                                                       version == 2
|                                                                       serialNumber = 13L
|                                                                       signatureAlgorithmID = AlgorithmIdentifier:
|                                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                       issuer = Name: SN=D8EFF0144002,CN=2.16.840.1.101.2.1.17
|                                                                       validity = 170112000000Z..99991231235959Z
|                                                                       subject = Name: SN=D8EFF0144002,CN=2.16.840.1.101.2.1.17
|                                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                           algorithm = AlgorithmIdentifier:
|                                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                               parameters = ECParameters:
|                                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                           subjectPublicKey = long768:810274552089857120878795365199749098595329019311291065042417629882510128905694777276989982736224272592121153176680711517510762444128154030753408704931911283410651966271422682474690426020729347388741954723531324577626256764251885697
|                                                                           x = 20564296854610467034365325141257616513854476408841401633366773814593267374100147759795035502024836800605431001100416
|                                                                           y = 11979125679064059492576832672817382392851994320210745315379029960904404944015443710727607610076355513992486786650241
|                                                                       _extensions = CertificateExtensions
|                                                                         [0] AuthorityKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                               keyIdentifier = Octets(0x61c7161c394f5081)
|                                                                         [1] SubjectKeyIdentifier_CertExt:
|                                                                               extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                               id = Octets(0x61c7161c394f5081)
|                                                                         [2] KeyUsage_CertExt:
|                                                                               extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                               critical = True
|                                                                               uses = ['digitalSignature']
|                                                                         [3] CertificatePolicies_CertExt:
|                                                                               extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                               critical = True
|                                                                               policies:
|                                                                                 [0] = PolicyInformation:
|                                                                                   id = OID(1.2.826.0.1145.0.1.0.3)
|                                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                   signature = Signature:
|                                                                       r = long384:18677194333923176509706934136288404710986541520318842980562244057244209084920549017188236672198975555180057124593436
|                                                                       s = long384:19066452689667573463322915898064402613747278171765706391460029410721883799769208513639548624007455958522208936128254
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                               x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                               y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1de6a414dda88f8b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                           s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 82825L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                               x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                               y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2eb4fc66f0202ec8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                           s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                                     [1] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x15fe90e0c6ab9f9c89df44611bbf602d499a5ddd708fdb52a44f7af4ee22046f26b4c7dbfcecd833cdd3ad8b9052c190)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:19832309908085806959680508287544083068675757140954713041301490086321863318462340915924759042201188407879364125921206
|                                                       s = long384:2911776715896897444576947385938677716237306652829167839099274136359409733761642300643859672026333677226269846470212
15:59:40.129 INFO                           #> 0.4.2. Verify signature of the message.
15:59:40.154 INFO                           #> 0.4.3. Verify content of the message and certificate
15:59:40.236 INFO    Test:                  PASS
15:59:40.373 DEBUG                    Tearing down mock HTTP servers
15:59:40.376 DEBUG                    Connect closed for Server
15:59:40.377 DEBUG                    Connect closed for Server
15:59:40.896 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:40.947 DEBUG                    Connected to Server
15:59:40.997 DEBUG                    Sending HTTP GET /status_2 message.
15:59:40.997 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:59:41.116 DEBUG                    HTTP Status: 200 - OK
15:59:41.116 DEBUG                    Connect closed for Server
15:59:41.117 DEBUG                    Connect closed for Server
15:59:43.116 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:43.167 DEBUG                    Connected to Server
15:59:43.217 DEBUG                    Sending HTTP GET /status_2 message.
15:59:43.217 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:59:43.341 DEBUG                    HTTP Status: 200 - OK
15:59:43.348 DEBUG                    Connect closed for Server
15:59:43.348 DEBUG                    Connect closed for Server
15:59:45.348 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:45.398 DEBUG                    Connected to Server
15:59:45.448 DEBUG                    Sending HTTP GET /status_2 message.
15:59:45.449 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:59:45.497 DEBUG                    HTTP Status: 200 - OK
15:59:45.498 DEBUG                    Connect closed for Server
15:59:45.499 DEBUG                    Connect closed for Server
15:59:47.498 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:47.564 INFO    Suite:       Tests for ICM issuing InfIA certificate to a MCKM
15:59:47.573 INFO    Suite:         ICM Infrastructure IA certificate issuing to MCKM
|                                   tests.
15:59:47.588 INFO                     Memory (RSS) before suite setup: 117.37 MByte  (1.16)
15:59:47.594 INFO                     Memory (Virt) before suite setup: 663.62 MByte  (1.13)
15:59:47.600 INFO                     Memory (RSS) after suite setup: 117.37 MByte  (0.00)
15:59:47.606 INFO                     Memory (Virt) after suite setup: 663.62 MByte  (0.00)
15:59:47.754 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:59:47.754 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:59:47.767 DEBUG                    Generating certificate signature for serial: 81714
15:59:47.773 DEBUG                    Added keymat IR-INF-CA: serial=81714 auth=0xc9020cefbb66368c subj=0x52083fbb22cd1267
15:59:47.784 DEBUG                    Generating certificate signature for serial: 84911
15:59:47.790 DEBUG                    Added keymat IR-INF-IA: serial=84911 auth=0x52083fbb22cd1267 subj=0x377045f7a23b065f
15:59:47.802 DEBUG                    Generating certificate signature for serial: 83363
15:59:47.808 DEBUG                    Added keymat IR-INF-CRL-CA: serial=83363 auth=0xc9020cefbb66368c subj=0x385357fba3a78fe5
15:59:47.820 DEBUG                    Generating certificate signature for serial: 80717
15:59:47.826 DEBUG                    Added keymat IR-INF-CRL-IA: serial=80717 auth=0x385357fba3a78fe5 subj=0xd7b1bed5f52fed95
15:59:47.835 DEBUG                    Generating certificate signature for serial: 5
15:59:47.841 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x4c1ea1d57760284b subj=0x4c1ea1d57760284b
15:59:47.849 DEBUG                    Generating message signature using cert with serial: 84911
15:59:47.883 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:59:47.933 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x4c1ea1d57760284b subj=0x4c1ea1d57760284b
15:59:47.939 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:59:47.956 DEBUG                    Generating message signature using cert with serial: 5
15:59:48.015 DEBUG                    IR: Handling Certificate Signing Request.
15:59:48.015 DEBUG                    Creating temporary CA cert to issue IA
15:59:48.027 DEBUG                    Generating certificate signature for serial: 86453
15:59:48.033 DEBUG                    Added keymat IR-INF-CA-TMP: serial=86453 auth=0xc9020cefbb66368c subj=0x697da59674411cc4
15:59:48.034 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:59:48.040 DEBUG                    Generating certificate signature for serial: 20000
15:59:48.047 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:59:48.049 DEBUG                    Generating message signature using cert with serial: 84911
15:59:48.166 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:59:48.166 DEBUG                    Received Inf IA response
15:59:48.166 DEBUG                    Added keymat IR-INF-CA: serial=86453 auth=0xc9020cefbb66368c subj=0x697da59674411cc4
15:59:48.166 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x697da59674411cc4 subj=0x01015e09c803cbae
15:59:48.176 DEBUG                    Generating certificate signature for serial: 5
15:59:48.182 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x12e674d0065f0d88 subj=0x12e674d0065f0d88
15:59:48.190 DEBUG                    Generating message signature using cert with serial: 20000
15:59:48.225 DEBUG                    Creating SKD message file /tmp/icmCaReq
15:59:48.242 DEBUG                    Generating message signature using cert with serial: 20000
15:59:48.322 DEBUG                    IR: Handling Certificate Signing Request.
15:59:48.323 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
15:59:48.330 DEBUG                    Generating certificate signature for serial: 20001
15:59:48.336 DEBUG                    Creating SKD message file /tmp/icmCaResp
15:59:48.339 DEBUG                    Generating message signature using cert with serial: 84911
15:59:48.433 INFO                     SKD: IR ---> ICM CertificateSigningResponse
15:59:48.433 DEBUG                    Received Inf CA response
15:59:48.434 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xf0cd5aca28d24b51
15:59:48.434 INFO                     Listening for ('128.10.1.4', 80)
15:59:48.438 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:59:48.442 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:59:48.442 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:59:48.492 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x12e674d0065f0d88 subj=0x12e674d0065f0d88
15:59:48.498 DEBUG                    Creating SKD message file /tmp/icmIaReq
15:59:48.515 DEBUG                    Generating message signature using cert with serial: 5
15:59:48.572 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
15:59:48.578 DEBUG                    Generating certificate signature for serial: 20000
15:59:48.585 DEBUG                    Creating SKD message file /tmp/icmIaResp
15:59:48.588 DEBUG                    Generating message signature using cert with serial: 20000
15:59:48.704 DEBUG                    Received Inf IA response
15:59:48.704 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xf0cd5aca28d24b51
15:59:48.704 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0xf0cd5aca28d24b51 subj=0x4389abe056640f10
15:59:48.708 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:59:48.712 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
15:59:48.761 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x12e674d0065f0d88 subj=0x12e674d0065f0d88
15:59:48.762 INFO                     Listening for ('128.10.1.6', 80)
15:59:48.762 DEBUG                    MCKM requesting Inf IA from ICM.
15:59:48.768 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
15:59:48.784 DEBUG                    Generating message signature using cert with serial: 5
15:59:48.802 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:59:48.802 INFO                     SKD: Client ---> Server CMC-request (1343 bytes)
15:59:48.803 INFO                     Sent CSR for Inf IA certificate.
15:59:48.803 DEBUG                    Connected to Server
15:59:48.803 DEBUG                    Sending HTTP GET /status_2 message.
15:59:48.804 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:59:48.805 DEBUG                    105569552: Connect accepted from Client
15:59:48.852 DEBUG                    Connected to Server
15:59:48.890 DEBUG                    HTTP Status: 200 - OK
15:59:48.892 DEBUG                    Connect closed for Server
15:59:48.893 DEBUG                    Connect closed for Server
15:59:48.903 DEBUG                    Sending HTTP POST /fullcmc message.
15:59:48.903 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:59:48.949 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:59:48.950 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
15:59:48.956 DEBUG                    Generating certificate signature for serial: 20001
15:59:48.965 DEBUG                    Generating message signature using cert with serial: 20000
15:59:49.016 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:59:49.017 DEBUG                    HTTP Status: 200 - OK
15:59:49.017 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3135 bytes)
15:59:49.080 INFO                     MCKM: Handling incoming CertificateSigningResponse
15:59:49.080 DEBUG                    Received Inf IA response
15:59:49.081 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xf0cd5aca28d24b51
15:59:49.081 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0xf0cd5aca28d24b51 subj=0x5a2599c7090caa17
15:59:50.813 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
15:59:50.872 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x12e674d0065f0d88 subj=0x12e674d0065f0d88
15:59:50.873 DEBUG                    CKA requesting Inf IA from ICM.
15:59:50.878 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
15:59:50.895 DEBUG                    Generating message signature using cert with serial: 5
15:59:50.913 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
15:59:50.914 INFO                     SKD: Client ---> Server CMC-request (1330 bytes)
15:59:50.914 INFO                     Sent CSR for Inf IA certificate.
15:59:50.914 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:50.915 DEBUG                    105569552: Connect accepted from Client
15:59:50.916 DEBUG                    Connect closed for Server
15:59:50.916 DEBUG                    Connect closed for Server
15:59:50.964 DEBUG                    Connected to Server
15:59:50.964 DEBUG                    Connected to Server
15:59:51.015 DEBUG                    Sending HTTP POST /fullcmc message.
15:59:51.015 DEBUG                    Removing HTTP POST /fullcmc message from Q.
15:59:51.016 DEBUG                    Sending HTTP GET /status_2 message.
15:59:51.016 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:59:51.083 INFO                     SKD: Client ---> ICM CertificateSigningRequest
15:59:51.084 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
15:59:51.095 DEBUG                    Generating certificate signature for serial: 20002
15:59:51.107 DEBUG                    Generating message signature using cert with serial: 20000
15:59:51.165 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
15:59:51.166 DEBUG                    HTTP Status: 200 - OK
15:59:51.166 DEBUG                    HTTP Status: 200 - OK
15:59:51.166 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3126 bytes)
15:59:51.229 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
15:59:51.229 DEBUG                    Received Inf IA response
15:59:51.230 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xf0cd5aca28d24b51
15:59:51.230 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0xf0cd5aca28d24b51 subj=0x6d2d3b66911ca6d7
15:59:51.230 DEBUG                    Connect closed for Server
15:59:51.230 DEBUG                    Connect closed for Server
15:59:53.168 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:53.219 DEBUG                    Connected to Server
15:59:53.269 DEBUG                    Sending HTTP GET /status_2 message.
15:59:53.270 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:59:53.287 DEBUG                    HTTP Status: 200 - OK
15:59:53.288 DEBUG                    Connect closed for Server
15:59:53.288 DEBUG                    Connect closed for Server
15:59:55.122 DEBUG                    ########## Mocks complete ##########
15:59:55.288 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:55.339 DEBUG                    Connected to Server
15:59:55.390 DEBUG                    Sending HTTP GET /status_2 message.
15:59:55.391 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:59:55.512 DEBUG                    HTTP Status: 200 - OK
15:59:55.513 DEBUG                    Connect closed for Server
15:59:55.513 DEBUG                    Connect closed for Server
15:59:56.076 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:59:56.076 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:59:57.029 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
15:59:57.029 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
15:59:57.513 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:57.563 DEBUG                    Connected to Server
15:59:57.613 DEBUG                    Sending HTTP GET /status_2 message.
15:59:57.613 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:59:57.710 DEBUG                    HTTP Status: 200 - OK
15:59:57.710 DEBUG                    Connect closed for Server
15:59:57.711 DEBUG                    Connect closed for Server
15:59:59.710 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
15:59:59.761 DEBUG                    Connected to Server
15:59:59.811 DEBUG                    Sending HTTP GET /status_2 message.
15:59:59.811 DEBUG                    Removing HTTP GET /status_2 message from Q.
15:59:59.914 DEBUG                    HTTP Status: 200 - OK
15:59:59.915 DEBUG                    Connect closed for Server
15:59:59.916 DEBUG                    Connect closed for Server
16:00:01.916 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:01.967 DEBUG                    Connected to Server
16:00:02.016 DEBUG                    Sending HTTP GET /status_2 message.
16:00:02.017 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:02.108 DEBUG                    HTTP Status: 200 - OK
16:00:02.108 DEBUG                    Connect closed for Server
16:00:02.109 DEBUG                    Connect closed for Server
16:00:04.108 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:04.159 DEBUG                    Connected to Server
16:00:04.209 DEBUG                    Sending HTTP GET /status_2 message.
16:00:04.209 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:06.616 DEBUG                    HTTP Status: 200 - OK
16:00:06.617 DEBUG                    Connect closed for Server
16:00:06.617 DEBUG                    Connect closed for Server
16:00:08.617 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:08.668 DEBUG                    Connected to Server
16:00:08.717 DEBUG                    Sending HTTP GET /status_2 message.
16:00:08.718 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:08.795 DEBUG                    HTTP Status: 200 - OK
16:00:08.802 DEBUG                    Connect closed for Server
16:00:08.802 DEBUG                    Connect closed for Server
16:00:10.801 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:10.852 DEBUG                    Connected to Server
16:00:10.902 DEBUG                    Sending HTTP GET /status_2 message.
16:00:10.902 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:11.015 DEBUG                    HTTP Status: 200 - OK
16:00:11.016 DEBUG                    Connect closed for Server
16:00:11.016 DEBUG                    Connect closed for Server
16:00:13.016 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:13.066 DEBUG                    Connected to Server
16:00:13.116 DEBUG                    Sending HTTP GET /status_2 message.
16:00:13.116 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:13.227 DEBUG                    HTTP Status: 200 - OK
16:00:13.228 DEBUG                    Connect closed for Server
16:00:13.228 DEBUG                    Connect closed for Server
16:00:15.228 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:15.279 DEBUG                    Connected to Server
16:00:15.328 DEBUG                    Sending HTTP GET /status_2 message.
16:00:15.329 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:15.405 DEBUG                    HTTP Status: 200 - OK
16:00:15.406 DEBUG                    Connect closed for Server
16:00:15.406 DEBUG                    Connect closed for Server
16:00:17.406 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:17.456 DEBUG                    Connected to Server
16:00:17.506 DEBUG                    Sending HTTP GET /status_2 message.
16:00:17.506 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:17.629 DEBUG                    HTTP Status: 200 - OK
16:00:17.629 DEBUG                    Connect closed for Server
16:00:17.630 DEBUG                    Connect closed for Server
16:00:19.629 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:19.680 DEBUG                    Connected to Server
16:00:19.730 DEBUG                    Sending HTTP GET /status_2 message.
16:00:19.731 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:19.804 DEBUG                    HTTP Status: 200 - OK
16:00:19.804 DEBUG                    Connect closed for Server
16:00:19.805 DEBUG                    Connect closed for Server
16:00:21.804 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:21.855 DEBUG                    Connected to Server
16:00:21.905 DEBUG                    Sending HTTP GET /status_2 message.
16:00:21.905 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:22.036 DEBUG                    HTTP Status: 200 - OK
16:00:22.042 DEBUG                    Connect closed for Server
16:00:22.043 DEBUG                    Connect closed for Server
16:00:24.044 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:24.095 DEBUG                    Connected to Server
16:00:24.149 DEBUG                    Sending HTTP GET /status_2 message.
16:00:24.150 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:24.292 DEBUG                    HTTP Status: 200 - OK
16:00:24.292 DEBUG                    Connect closed for Server
16:00:24.292 DEBUG                    Connect closed for Server
16:00:26.292 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:26.343 DEBUG                    Connected to Server
16:00:26.392 DEBUG                    Sending HTTP GET /status_2 message.
16:00:26.393 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:26.534 DEBUG                    HTTP Status: 200 - OK
16:00:26.534 DEBUG                    Connect closed for Server
16:00:26.535 DEBUG                    Connect closed for Server
16:00:28.535 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:28.585 DEBUG                    Connected to Server
16:00:28.635 DEBUG                    Sending HTTP GET /status_2 message.
16:00:28.636 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:28.703 DEBUG                    HTTP Status: 200 - OK
16:00:28.703 DEBUG                    Connect closed for Server
16:00:28.703 DEBUG                    Connect closed for Server
16:00:30.703 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:30.754 DEBUG                    Connected to Server
16:00:30.803 DEBUG                    Sending HTTP GET /status_2 message.
16:00:30.804 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:30.887 DEBUG                    HTTP Status: 200 - OK
16:00:30.888 DEBUG                    Connect closed for Server
16:00:30.888 DEBUG                    Connect closed for Server
16:00:31.915 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:1216768906720823426710750354060369830746525928609013774388467863976032848127412618982806853164671094932343382422996445248515911399427355326180181658670705014895657332481554634238476887660501336092642016614816085653611635323717431502
|                                                     x = 30880887147116004140493285730064109243409459364430409534097074158466601706090778720708373249365439475654704283175420
|                                                     y = 30402365677205751777789755171530054835096118940156686817144890727717889702875083665021989903335940158033971167768782
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:25626419293560811483175967195136867946533948101108149965588529354195604146054986630064978591035512351366333427109285
|                                                 s = long384:1673251691083224980786635230983024223715874040198647842167346090511224698681007144352952281647150328757052249950806
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112160001Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 10L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x0afcf28f439d2d8b8bc8c11f36b9449c94d70f6a5d687ace11a1b2b33269323667070a3d1c6fd7ca7e3a192e17d189e5)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:19579132927185451079002098246191292013688242115795618599760294185819283151793972975947828649777855359717561424438541
|                                                 s = long384:33980207279192484442859040715045679599491397125799348757517289054024742709408004648491460814908504406251760771047952
16:00:31.916 DEBUG                    IR: Handling Certificate Signing Request.
16:00:31.917 DEBUG                    Generating InfCA certificate (serialNumber: 20002L)
16:00:31.923 DEBUG                    Generating certificate signature for serial: 20002
16:00:31.930 DEBUG                    Creating SKD message file /tmp/infca.resp
16:00:31.933 DEBUG                    Generating message signature using cert with serial: 84911
16:00:31.964 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0x377045f7a23b065f-->0x52083fbb22cd1267-->0xc9020cefbb66368c
|                                             0xfc110d089f7630ce-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 84911L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155947Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:961143838482357597660377909657667041641540700790773938658626003357653823259614639569701787365165848536154842260797984015462333271163572616280809588583683741787450201850290130829047805122365785010553943977924901305522728471185000031
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x52083fbb22cd1267)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x377045f7a23b065f)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:9499788444194834461090549866643994614265843896800175278742161985288863446244539252152403572092388305730278166595629
|                                                     s = long384:39236427987802834788084602972893808497096111426414669652717607152790408552476955117652684430886352957574232815735162
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 81714L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155947Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1462515063922110636664969824803871304583825705755782362888159073507394966834929352811823223091167438526002221082223912037196774423034378545991692733121060823852523405020435372080738312465259704195067215138000637991177188001276826215
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x52083fbb22cd1267)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:5956575690896753419192384175955643586947976473291982856968579903115382870980310584602226062397575150273459715939808
|                                                     s = long384:12096712326697279083054219968474661335662762419139124213227363110538827915667759776031218954284255447584671675413434
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112160031Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1216768906720823426710750354060369830746525928609013774388467863976032848127412618982806853164671094932343382422996445248515911399427355326180181658670705014895657332481554634238476887660501336092642016614816085653611635323717431502
|                                                         x = 30880887147116004140493285730064109243409459364430409534097074158466601706090778720708373249365439475654704283175420
|                                                         y = 30402365677205751777789755171530054835096118940156686817144890727717889702875083665021989903335940158033971167768782
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xfc110d089f7630ce)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:2795137142827156275971808506036470066215960147585121570581111269335825712612308903776510104305546918212707509884009
|                                                     s = long384:20997034851440329670704774547263418690927689225968177578451483724183594756632782875367796862680842768661493037069548
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x377045f7a23b065f)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112160031Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 10L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:37677688018037969448108687822096936710304029570493963713505588515054952665738716691841895046701903368063136744046934
|                                                 s = long384:26646814634487126778511585384504176422716713218195414970400781640174044184897090618997358562374038623093115692129169
16:00:32.887 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:32.939 DEBUG                    Connected to Server
16:00:32.988 DEBUG                    Sending HTTP GET /status_2 message.
16:00:32.988 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:33.111 DEBUG                    HTTP Status: 200 - OK
16:00:33.112 DEBUG                    Connect closed for Server
16:00:33.112 DEBUG                    Connect closed for Server
16:00:35.111 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:35.162 DEBUG                    Connected to Server
16:00:35.212 DEBUG                    Sending HTTP GET /status_2 message.
16:00:35.212 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:35.320 DEBUG                    HTTP Status: 200 - OK
16:00:35.320 DEBUG                    Connect closed for Server
16:00:35.321 DEBUG                    Connect closed for Server
16:00:37.320 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:37.371 DEBUG                    Connected to Server
16:00:37.421 DEBUG                    Sending HTTP GET /status_2 message.
16:00:37.421 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:37.487 DEBUG                    HTTP Status: 200 - OK
16:00:37.488 DEBUG                    Connect closed for Server
16:00:37.488 DEBUG                    Connect closed for Server
16:00:39.488 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:39.539 DEBUG                    Connected to Server
16:00:39.589 DEBUG                    Sending HTTP GET /status_2 message.
16:00:39.589 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:39.627 DEBUG                    cmd optimus > keydir
16:00:39.672 DEBUG                    cmd optimus > keydir /tmp/
16:00:39.721 DEBUG                    HTTP Status: 200 - OK
16:00:39.721 DEBUG                    Connect closed for Server
16:00:39.721 DEBUG                    Connect closed for Server
16:00:41.721 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:41.772 DEBUG                    Connected to Server
16:00:41.822 DEBUG                    Sending HTTP GET /status_2 message.
16:00:41.822 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:42.031 DEBUG                    HTTP Status: 200 - OK
16:00:42.032 DEBUG                    Connect closed for Server
16:00:42.033 DEBUG                    Connect closed for Server
16:00:44.032 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:44.083 DEBUG                    Connected to Server
16:00:44.134 DEBUG                    Sending HTTP GET /status_2 message.
16:00:44.134 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:44.216 DEBUG                    HTTP Status: 200 - OK
16:00:44.217 DEBUG                    Connect closed for Server
16:00:44.218 DEBUG                    Connect closed for Server
16:00:46.217 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:46.267 DEBUG                    Connected to Server
16:00:46.317 DEBUG                    Sending HTTP GET /status_2 message.
16:00:46.318 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:46.404 DEBUG                    HTTP Status: 200 - OK
16:00:46.404 DEBUG                    Connect closed for Server
16:00:46.404 DEBUG                    Connect closed for Server
16:00:48.404 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:48.455 DEBUG                    Connected to Server
16:00:48.504 DEBUG                    Sending HTTP GET /status_2 message.
16:00:48.505 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:00:48.604 DEBUG                    HTTP Status: 200 - OK
16:00:48.605 DEBUG                    Connect closed for Server
16:00:48.605 DEBUG                    Connect closed for Server
16:00:50.291 DEBUG                    cmd optimus > keydir ../Keys/
16:00:50.398 DEBUG                    Received SKD message:
|                                     KeyPackageFile:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = List:
|                                             [0]:
|                                                 OneAsymmetricKey:
|                                                     version == 0
|                                                     privateKeyAlgorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     privateKey = ECPrivateKey:
|                                                         version = 1L
|                                                         privateKey = Octets(0x72609f9b93552bf6670fb59c19128b81b6be1b47cebd7b29c6aab586dcba5fa8488fae404a0bd70b02ad8df99de15ccb)
|                                                     attributes:
|                                                       [0] = UserCertificateAttr:
|                                                         id == OID(userCertificate:2.5.4.36)
|                                                         userCertificate = Certificate:
|                                                             tbsCertificate = TBSCertificate:
|                                                                 version == 2
|                                                                 serialNumber = 14L
|                                                                 signatureAlgorithmID = AlgorithmIdentifier:
|                                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                 issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 validity = 170112000000Z..99991231235959Z
|                                                                 subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                     algorithm = AlgorithmIdentifier:
|                                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                         parameters = ECParameters:
|                                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                     subjectPublicKey = long768:494394860776932735610754099093807679935087239243213717908265577823072500072384653662031790978525763934945140489989260007205351352830290414852165103122293147067409879720730851711564597265501163035256304669915059390895542753412309244
|                                                                     x = 12547454013196232680363009016575196687039012479905966663748414618301899492352696613326453047559179164077108148797155
|                                                                     y = 2545943823876825284750813147337089837458138910434802005312881500599066618382918116016711180346904343473603614400764
|                                                                 _extensions = CertificateExtensions
|                                                                   [0] AuthorityKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                         keyIdentifier = Octets(0x4f0ec90bbe88e0fc)
|                                                                   [1] SubjectKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                         id = Octets(0x4f0ec90bbe88e0fc)
|                                                                   [2] KeyUsage_CertExt:
|                                                                         extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                         critical = True
|                                                                         uses = ['digitalSignature']
|                                                                   [3] CertificatePolicies_CertExt:
|                                                                         extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                         critical = True
|                                                                         policies:
|                                                                           [0] = PolicyInformation:
|                                                                             id = OID(1.2.826.0.1145.0.1.0.3)
|                                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                             signature = Signature:
|                                                                 r = long384:30338694250796462621072800141001680727236255249543308178350700191929742602054724074933008416788830289855026804718229
|                                                                 s = long384:23585749735229104884119890791975823931113097856381198243178073229706194751241488202168151348647210971111724665772550
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                               [1] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0xe1064c9e6931fa6772b4e0539445a5c0e39bb7a883ce58224180561beafaefb655c893acd9080bf5a35abf53aae798cf)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:11672157103931204854449372374052498195676777336892439334464440926940633568398569613617703711298631112552066114413579
|                                                 s = long384:6768991957091945937376913608525387933340700401449916025516501825397957853509969311606684615264940299857571903854326
16:00:50.399 DEBUG                    Added keymat FACT-IA: serial=14 auth=0x4f0ec90bbe88e0fc subj=0x4f0ec90bbe88e0fc
16:00:50.399 DEBUG                    UUT Control: Applying all recent configuration changes
16:00:50.422 INFO    Test:            121 : [icm-issue-infia-mckm-cert-success] The MCKM
|                                           sends a valid CSR for an InfIA certificate
|                                           from the ICM using HTTP and receives a valid
|                                           response.
16:00:50.433 INFO                           #> 0.1. MCKM requests a Inf IA from the ICM via HTTP and waits for a 202 ACCEPTED response.
16:00:50.433 DEBUG                          MCKM requesting Inf IA from ICM.
16:00:50.443 INFO                           SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
16:00:50.529 DEBUG                          Generating message signature using cert with serial: 14
16:00:50.590 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0155000,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:1456942030991419407222873088458491202071034009798321712473913573781589138840790468256265344302881905999977659734242857827214002862145908811105155569201133887357002102763697872312062633514774067436543810586389086526527051445001528564
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.7
|                                                                             [1] = 1.2.826.0.1145.0.10.6
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:35494109901558264124674662867114253479182709917159864908803502074442391482663011588401892244707474079071918279438676
|                                                       s = long384:18680562204881153070383930354879963005221341798189696353732162359953452087124098123461377732937093494462263896043448
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x4f0ec90bbe88e0fc-->0x4f0ec90bbe88e0fc
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 14L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:494394860776932735610754099093807679935087239243213717908265577823072500072384653662031790978525763934945140489989260007205351352830290414852165103122293147067409879720730851711564597265501163035256304669915059390895542753412309244
|                                                               x = 12547454013196232680363009016575196687039012479905966663748414618301899492352696613326453047559179164077108148797155
|                                                               y = 2545943823876825284750813147337089837458138910434802005312881500599066618382918116016711180346904343473603614400764
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x4f0ec90bbe88e0fc)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x4f0ec90bbe88e0fc)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:30338694250796462621072800141001680727236255249543308178350700191929742602054724074933008416788830289855026804718229
|                                                           s = long384:23585749735229104884119890791975823931113097856381198243178073229706194751241488202168151348647210971111724665772550
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x4f0ec90bbe88e0fc)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112160050Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x83dc17c8ba54c342cf7d0dfc7ba7d977b21e1a5df06de4f55da50bc9d27c5526cf588be2de388e7789bab1e432aed314)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x221c57a2b7fe4083)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:31627528432181680604330883728937545371539732170944279640394873476527799267107273489611558063897049462550449908452180
|                                                       s = long384:25022769883855850002008521894316090588737290324665379933603097858555547175283670045203177440492574765809009597738147
16:00:50.629 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:50.630 INFO                           SKD: Client ---> Server CMC-request (1343 bytes)
16:00:50.630 INFO                           Sent CSR for Inf IA certificate.
16:00:50.631 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:50.680 DEBUG                          Connected to Server
16:00:50.682 DEBUG                          Connected to Server
16:00:50.734 DEBUG                          Sending HTTP POST /fullcmc message.
16:00:50.735 DEBUG                          Removing HTTP POST /fullcmc message from Q.
16:00:50.736 DEBUG                          Sending HTTP GET /status_2 message.
16:00:50.737 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:00:50.877 DEBUG                          HTTP Status: 202 - ACCEPTED
16:00:50.879 DEBUG                          HTTP Status: 200 - OK
16:00:50.879 DEBUG                          Connect closed for Server
16:00:50.880 DEBUG                          Connect closed for Server
16:00:50.881 DEBUG                          Connect closed for Server
16:00:50.882 INFO                           #> 0.2. Check that the operator is able to view a list of imported CSRs as well as the data relevant to the new request.
16:00:50.887 DEBUG                          Connect closed for Server
16:00:52.878 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:52.880 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:52.929 DEBUG                          Connected to Server
16:00:52.931 DEBUG                          Connected to Server
16:00:52.979 DEBUG                          Sending HTTP GET /status_8 message.
16:00:52.980 DEBUG                          Removing HTTP GET /status_8 message from Q.
16:00:52.981 DEBUG                          Sending HTTP GET /status_2 message.
16:00:52.982 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:00:53.051 INFO                           #> 0.3. The ICM operator approves the CSR.
16:00:53.094 DEBUG                          HTTP Status: 200 - OK
16:00:53.095 DEBUG                          Connect closed for Server
16:00:53.100 DEBUG                          HTTP Status: 200 - OK
16:00:53.100 DEBUG                          Connect closed for Server
16:00:53.101 DEBUG                          Connect closed for Server
16:00:53.101 DEBUG                          Connect closed for Server
16:00:55.095 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:55.100 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:55.146 DEBUG                          Connected to Server
16:00:55.151 DEBUG                          Connected to Server
16:00:55.198 DEBUG                          Sending HTTP GET /status_8 message.
16:00:55.199 DEBUG                          Removing HTTP GET /status_8 message from Q.
16:00:55.201 DEBUG                          Sending HTTP GET /status_2 message.
16:00:55.203 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:00:55.330 DEBUG                          HTTP Status: 200 - OK
16:00:55.332 DEBUG                          HTTP Status: 200 - OK
16:00:55.333 DEBUG                          Connect closed for Server
16:00:55.334 DEBUG                          Connect closed for Server
16:00:55.334 DEBUG                          Connect closed for Server
16:00:55.334 DEBUG                          Connect closed for Server
16:00:57.331 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:57.333 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:57.383 DEBUG                          Connected to Server
16:00:57.383 DEBUG                          Connected to Server
16:00:57.432 DEBUG                          Sending HTTP GET /status_8 message.
16:00:57.433 DEBUG                          Removing HTTP GET /status_8 message from Q.
16:00:57.433 DEBUG                          Sending HTTP GET /status_2 message.
16:00:57.434 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:00:57.501 DEBUG                          HTTP Status: 200 - OK
16:00:57.502 DEBUG                          Connect closed for Server
16:00:57.506 DEBUG                          HTTP Status: 200 - OK
16:00:57.506 DEBUG                          Connect closed for Server
16:00:57.507 DEBUG                          Connect closed for Server
16:00:57.509 DEBUG                          Connect closed for Server
16:00:59.501 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:59.509 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:00:59.554 DEBUG                          Connected to Server
16:00:59.560 DEBUG                          Connected to Server
16:00:59.602 DEBUG                          Sending HTTP GET /status_8 message.
16:00:59.603 DEBUG                          Removing HTTP GET /status_8 message from Q.
16:00:59.610 DEBUG                          Sending HTTP GET /status_2 message.
16:00:59.610 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:00:59.758 DEBUG                          HTTP Status: 200 - OK
16:00:59.760 DEBUG                          HTTP Status: 200 - OK
16:00:59.761 DEBUG                          Connect closed for Server
16:00:59.764 DEBUG                          Connect closed for Server
16:00:59.765 DEBUG                          Connect closed for Server
16:00:59.766 DEBUG                          Connect closed for Server
16:01:01.759 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:01.761 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:01.810 DEBUG                          Connected to Server
16:01:01.811 DEBUG                          Connected to Server
16:01:01.861 DEBUG                          Sending HTTP GET /status_2 message.
16:01:01.862 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:01:01.863 DEBUG                          Sending HTTP GET /status_8 message.
16:01:01.864 DEBUG                          Removing HTTP GET /status_8 message from Q.
16:01:01.910 DEBUG                          HTTP Status: 200 - OK
16:01:01.911 DEBUG                          Connect closed for Server
16:01:01.912 DEBUG                          HTTP Status: 200 - OK
16:01:01.913 DEBUG                          Connect closed for Server
16:01:01.913 DEBUG                          Connect closed for Server
16:01:01.913 DEBUG                          Connect closed for Server
16:01:02.035 INFO                           #> 0.4. A CertificateSigningResponse response containing the new Inf IA certificate is expected from the ICM.
16:01:03.911 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:03.913 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:03.961 DEBUG                          Connected to Server
16:01:03.964 DEBUG                          Connected to Server
16:01:04.011 DEBUG                          Sending HTTP GET /status_2 message.
16:01:04.012 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:01:04.014 DEBUG                          Sending HTTP GET /status_8 message.
16:01:04.015 DEBUG                          Removing HTTP GET /status_8 message from Q.
16:01:04.091 DEBUG                          HTTP Status: 200 - OK
16:01:04.093 DEBUG                          HTTP Status: 303 - SEE OTHER
16:01:04.093 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 2.0 second(s)
16:01:04.094 DEBUG                          Connect closed for Server
16:01:04.095 DEBUG                          Connect closed for Server
16:01:04.096 DEBUG                          Connect closed for Server
16:01:04.097 DEBUG                          Connect closed for Server
16:01:04.097 DEBUG                          Connect closed for Server
16:01:04.098 DEBUG                          Connect closed for Server
16:01:04.098 DEBUG                          Connect closed for Server
16:01:04.098 DEBUG                          Connect closed for Server
16:01:04.099 DEBUG                          Connect closed for Server
16:01:04.099 DEBUG                          Connect closed for Server
16:01:04.100 DEBUG                          Connect closed for Server
16:01:04.100 DEBUG                          Connect closed for Server
16:01:04.101 DEBUG                          Connect closed for Server
16:01:04.101 DEBUG                          Connect closed for Server
16:01:04.101 DEBUG                          Connect closed for Server
16:01:04.102 DEBUG                          Connect closed for Server
16:01:04.102 DEBUG                          Connect closed for Server
16:01:04.103 DEBUG                          Connect closed for Server
16:01:04.103 DEBUG                          Connect closed for Server
16:01:04.103 DEBUG                          Connect closed for Server
16:01:04.104 DEBUG                          Connect closed for Server
16:01:04.104 DEBUG                          Connect closed for Server
16:01:04.105 DEBUG                          Connect closed for Server
16:01:04.105 DEBUG                          Connect closed for Server
16:01:04.105 DEBUG                          Connect closed for Server
16:01:04.106 DEBUG                          Connect closed for Server
16:01:04.106 DEBUG                          Connect closed for Server
16:01:04.107 DEBUG                          Connect closed for Server
16:01:04.107 DEBUG                          Connect closed for Server
16:01:04.108 DEBUG                          Connect closed for Server
16:01:04.108 DEBUG                          Connect closed for Server
16:01:04.108 DEBUG                          Connect closed for Server
16:01:04.109 DEBUG                          Connect closed for Server
16:01:04.109 DEBUG                          Connect closed for Server
16:01:04.109 DEBUG                          Connect closed for Server
16:01:04.110 DEBUG                          Connect closed for Server
16:01:04.110 DEBUG                          Connect closed for Server
16:01:04.111 DEBUG                          Connect closed for Server
16:01:04.111 DEBUG                          Connect closed for Server
16:01:04.111 DEBUG                          Connect closed for Server
16:01:04.112 DEBUG                          Connect closed for Server
16:01:04.112 DEBUG                          Connect closed for Server
16:01:04.113 DEBUG                          Connect closed for Server
16:01:04.113 DEBUG                          Connect closed for Server
16:01:04.113 DEBUG                          Connect closed for Server
16:01:04.114 DEBUG                          Connect closed for Server
16:01:04.114 DEBUG                          Connect closed for Server
16:01:04.115 DEBUG                          Connect closed for Server
16:01:04.115 DEBUG                          Connect closed for Server
16:01:04.115 DEBUG                          Connect closed for Server
16:01:04.116 DEBUG                          Connect closed for Server
16:01:04.116 DEBUG                          Connect closed for Server
16:01:04.117 DEBUG                          Connect closed for Server
16:01:04.117 DEBUG                          Connect closed for Server
16:01:04.118 DEBUG                          Connect closed for Server
16:01:04.118 DEBUG                          Connect closed for Server
16:01:04.118 DEBUG                          Connect closed for Server
16:01:04.119 DEBUG                          Connect closed for Server
16:01:04.119 DEBUG                          Connect closed for Server
16:01:04.120 DEBUG                          Connect closed for Server
16:01:04.120 DEBUG                          Connect closed for Server
16:01:04.120 DEBUG                          Connect closed for Server
16:01:04.121 DEBUG                          Connect closed for Server
16:01:04.121 DEBUG                          Connect closed for Server
16:01:04.121 DEBUG                          Connect closed for Server
16:01:04.122 DEBUG                          Connect closed for Server
16:01:04.122 DEBUG                          Connect closed for Server
16:01:04.123 DEBUG                          Connect closed for Server
16:01:04.123 DEBUG                          Connect closed for Server
16:01:04.123 DEBUG                          Connect closed for Server
16:01:04.124 DEBUG                          Connect closed for Server
16:01:04.124 DEBUG                          Connect closed for Server
16:01:04.125 DEBUG                          Connect closed for Server
16:01:04.125 DEBUG                          Connect closed for Server
16:01:04.125 DEBUG                          Connect closed for Server
16:01:04.126 DEBUG                          Connect closed for Server
16:01:04.126 DEBUG                          Connect closed for Server
16:01:04.127 DEBUG                          Connect closed for Server
16:01:04.127 DEBUG                          Connect closed for Server
16:01:04.128 DEBUG                          Connect closed for Server
16:01:04.128 DEBUG                          Connect closed for Server
16:01:04.128 DEBUG                          Connect closed for Server
16:01:04.129 DEBUG                          Connect closed for Server
16:01:04.129 DEBUG                          Connect closed for Server
16:01:04.130 DEBUG                          Connect closed for Server
16:01:04.130 DEBUG                          Connect closed for Server
16:01:04.130 DEBUG                          Connect closed for Server
16:01:04.131 DEBUG                          Connect closed for Server
16:01:04.131 DEBUG                          Connect closed for Server
16:01:04.131 DEBUG                          Connect closed for Server
16:01:04.132 DEBUG                          Connect closed for Server
16:01:04.132 DEBUG                          Connect closed for Server
16:01:04.133 DEBUG                          Connect closed for Server
16:01:04.133 DEBUG                          Connect closed for Server
16:01:04.133 DEBUG                          Connect closed for Server
16:01:04.134 DEBUG                          Connect closed for Server
16:01:04.135 DEBUG                          Connect closed for Server
16:01:04.135 DEBUG                          Connect closed for Server
16:01:04.136 DEBUG                          Connect closed for Server
16:01:04.136 DEBUG                          Connect closed for Server
16:01:04.137 DEBUG                          Connect closed for Server
16:01:04.137 DEBUG                          Connect closed for Server
16:01:04.138 DEBUG                          Connect closed for Server
16:01:04.138 DEBUG                          Connect closed for Server
16:01:04.138 DEBUG                          Connect closed for Server
16:01:04.139 DEBUG                          Connect closed for Server
16:01:04.139 DEBUG                          Connect closed for Server
16:01:04.140 DEBUG                          Connect closed for Server
16:01:04.140 DEBUG                          Connect closed for Server
16:01:04.141 DEBUG                          Connect closed for Server
16:01:04.142 DEBUG                          Connect closed for Server
16:01:04.143 DEBUG                          Connect closed for Server
16:01:04.143 DEBUG                          Connect closed for Server
16:01:04.145 DEBUG                          Connect closed for Server
16:01:04.147 DEBUG                          Connect closed for Server
16:01:04.148 DEBUG                          Connect closed for Server
16:01:04.149 DEBUG                          Connect closed for Server
16:01:04.149 DEBUG                          Connect closed for Server
16:01:04.150 DEBUG                          Connect closed for Server
16:01:04.151 DEBUG                          Connect closed for Server
16:01:04.152 DEBUG                          Connect closed for Server
16:01:04.152 DEBUG                          Connect closed for Server
16:01:04.153 DEBUG                          Connect closed for Server
16:01:04.154 DEBUG                          Connect closed for Server
16:01:04.155 DEBUG                          Connect closed for Server
16:01:04.156 DEBUG                          Connect closed for Server
16:01:04.157 DEBUG                          Connect closed for Server
16:01:04.157 DEBUG                          Connect closed for Server
16:01:04.158 DEBUG                          Connect closed for Server
16:01:04.159 DEBUG                          Connect closed for Server
16:01:04.159 DEBUG                          Connect closed for Server
16:01:04.160 DEBUG                          Connect closed for Server
16:01:04.161 DEBUG                          Connect closed for Server
16:01:04.162 DEBUG                          Connect closed for Server
16:01:04.162 DEBUG                          Connect closed for Server
16:01:04.163 DEBUG                          Connect closed for Server
16:01:04.164 DEBUG                          Connect closed for Server
16:01:04.164 DEBUG                          Connect closed for Server
16:01:04.165 DEBUG                          Connect closed for Server
16:01:04.166 DEBUG                          Connect closed for Server
16:01:04.167 DEBUG                          Connect closed for Server
16:01:04.167 DEBUG                          Connect closed for Server
16:01:04.168 DEBUG                          Connect closed for Server
16:01:04.169 DEBUG                          Connect closed for Server
16:01:04.170 DEBUG                          Connect closed for Server
16:01:04.170 DEBUG                          Connect closed for Server
16:01:04.171 DEBUG                          Connect closed for Server
16:01:04.172 DEBUG                          Connect closed for Server
16:01:04.172 DEBUG                          Connect closed for Server
16:01:04.173 DEBUG                          Connect closed for Server
16:01:04.174 DEBUG                          Connect closed for Server
16:01:04.175 DEBUG                          Connect closed for Server
16:01:04.176 DEBUG                          Connect closed for Server
16:01:04.177 DEBUG                          Connect closed for Server
16:01:04.177 DEBUG                          Connect closed for Server
16:01:04.178 DEBUG                          Connect closed for Server
16:01:04.179 DEBUG                          Connect closed for Server
16:01:04.179 DEBUG                          Connect closed for Server
16:01:04.180 DEBUG                          Connect closed for Server
16:01:04.181 DEBUG                          Connect closed for Server
16:01:04.181 DEBUG                          Connect closed for Server
16:01:04.182 DEBUG                          Connect closed for Server
16:01:04.183 DEBUG                          Connect closed for Server
16:01:04.183 DEBUG                          Connect closed for Server
16:01:04.183 DEBUG                          Connect closed for Server
16:01:04.184 DEBUG                          Connect closed for Server
16:01:04.184 DEBUG                          Connect closed for Server
16:01:04.185 DEBUG                          Connect closed for Server
16:01:04.185 DEBUG                          Connect closed for Server
16:01:04.186 DEBUG                          Connect closed for Server
16:01:04.186 DEBUG                          Connect closed for Server
16:01:04.187 DEBUG                          Connect closed for Server
16:01:04.187 DEBUG                          Connect closed for Server
16:01:04.187 DEBUG                          Connect closed for Server
16:01:04.188 DEBUG                          Connect closed for Server
16:01:04.188 DEBUG                          Connect closed for Server
16:01:04.188 DEBUG                          Connect closed for Server
16:01:04.189 DEBUG                          Connect closed for Server
16:01:04.189 DEBUG                          Connect closed for Server
16:01:04.190 DEBUG                          Connect closed for Server
16:01:04.190 DEBUG                          Connect closed for Server
16:01:04.190 DEBUG                          Connect closed for Server
16:01:04.191 DEBUG                          Connect closed for Server
16:01:04.191 DEBUG                          Connect closed for Server
16:01:04.192 DEBUG                          Connect closed for Server
16:01:04.192 DEBUG                          Connect closed for Server
16:01:04.192 DEBUG                          Connect closed for Server
16:01:04.193 DEBUG                          Connect closed for Server
16:01:04.193 DEBUG                          Connect closed for Server
16:01:04.194 DEBUG                          Connect closed for Server
16:01:04.194 DEBUG                          Connected to Server
16:01:04.195 DEBUG                          Sending HTTP GET /fetch_8 message.
16:01:04.196 DEBUG                          Removing HTTP GET /fetch_8 message from Q.
16:01:04.295 DEBUG                          HTTP Status: 200 - OK
16:01:04.296 INFO                           SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3106 bytes)
16:01:04.471 DEBUG                          Received SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = Integer(1)
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = Integer(0)
|                                               certificates (2 chains, 4 certificates) = 
|                                                 Chains summary:
|                                                   0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                                   0x69ea30bf1be424f4-->0xfc110d089f7630ce-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                               x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                               y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1de6a414dda88f8b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                           s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 82825L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                               x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                               y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2eb4fc66f0202ec8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                           s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                                   Chain[1] =
|                                                       [1.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 15L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112150059Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0155000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1456942030991419407222873088458491202071034009798321712473913573781589138840790468256265344302881905999977659734242857827214002862145908811105155569201133887357002102763697872312062633514774067436543810586389086526527051445001528564
|                                                               x = 36976341349967565220423909430105008516506631485838339989250707652124402538876750213264242559923227249081150847998784
|                                                               y = 6813415223021394354299096304185003173908231920936170111619978545275748975943327844956252903476882630012501246616820
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xfc110d089f7630ce)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x69ea30bf1be424f4)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.7
|                                                                         [1] = 1.2.826.0.1145.0.10.6
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:28698521970788673316260531696461240568037709917219504770024790476531893201577987111868835218962141348174916677471122
|                                                           s = long384:3210573079962109561889273956916035566352058351970758745222171988952110633769885958352815004805045666281961022205035
|                                                       [1.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112160031Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1216768906720823426710750354060369830746525928609013774388467863976032848127412618982806853164671094932343382422996445248515911399427355326180181658670705014895657332481554634238476887660501336092642016614816085653611635323717431502
|                                                               x = 30880887147116004140493285730064109243409459364430409534097074158466601706090778720708373249365439475654704283175420
|                                                               y = 30402365677205751777789755171530054835096118940156686817144890727717889702875083665021989903335940158033971167768782
|                                                           _extensions = CertificateExtensions
|                                                             [0] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[5]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                         2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                         3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                         4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xfc110d089f7630ce)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:2795137142827156275971808506036470066215960147585121570581111269335825712612308903776510104305546918212707509884009
|                                                           s = long384:20997034851440329670704774547263418690927689225968177578451483724183594756632782875367796862680842768661493037069548
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112160059Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x221c57a2b7fe4083)
|                                                           msgCount = 1L
|                                                     [4] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=,CN=
|                                                     [5] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:20854954921847471802420452673233587610986516750654047572268659838608473975581722931931910522065861492589334102669016
|                                                       s = long384:31181590581061553690491174777538691885680371078804286051379502018102036063516240642959902108573688901078036379073720
16:01:04.471 INFO                           MCKM: Handling incoming CertificateSigningResponse
16:01:04.472 DEBUG                          Received Inf IA response
16:01:04.473 DEBUG                          Added keymat ICM-INF-CA: serial=20002 auth=0xc9020cefbb66368c subj=0xfc110d089f7630ce
16:01:04.473 DEBUG                          Added keymat MCKM-INF-IA: serial=15 auth=0xfc110d089f7630ce subj=0x69ea30bf1be424f4
16:01:04.561 INFO                           #> 0.4.1. Check the format of the certificates
16:01:04.565 DEBUG                          Connect closed for Server
16:01:04.566 DEBUG                          Connect closed for Server
16:01:06.092 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:06.143 DEBUG                          Connected to Server
16:01:06.193 DEBUG                          Sending HTTP GET /status_2 message.
16:01:06.194 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:01:06.291 DEBUG                          HTTP Status: 200 - OK
16:01:06.292 DEBUG                          Connect closed for Server
16:01:06.296 DEBUG                          Connect closed for Server
16:01:06.316 INFO    Test:                  PASS
16:01:06.451 DEBUG                    Tearing down mock HTTP servers
16:01:06.454 DEBUG                    Connect closed for Server
16:01:06.455 DEBUG                    Connect closed for Server
16:01:08.292 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:08.342 DEBUG                    Connected to Server
16:01:08.392 DEBUG                    Sending HTTP GET /status_2 message.
16:01:08.392 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:08.490 DEBUG                    HTTP Status: 200 - OK
16:01:08.490 DEBUG                    Connect closed for Server
16:01:08.491 DEBUG                    Connect closed for Server
16:01:10.490 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:10.541 DEBUG                    Connected to Server
16:01:10.591 DEBUG                    Sending HTTP GET /status_2 message.
16:01:10.591 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:10.723 DEBUG                    HTTP Status: 200 - OK
16:01:10.723 DEBUG                    Connect closed for Server
16:01:10.724 DEBUG                    Connect closed for Server
16:01:12.724 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:12.775 DEBUG                    Connected to Server
16:01:12.824 DEBUG                    Sending HTTP GET /status_2 message.
16:01:12.825 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:12.912 DEBUG                    HTTP Status: 200 - OK
16:01:12.913 DEBUG                    Connect closed for Server
16:01:12.913 DEBUG                    Connect closed for Server
16:01:13.432 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:01:13.433 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:01:13.445 DEBUG                    Generating certificate signature for serial: 81208
16:01:13.450 DEBUG                    Added keymat IR-INF-CA: serial=81208 auth=0xc9020cefbb66368c subj=0x8b9de492d07d6392
16:01:13.461 DEBUG                    Generating certificate signature for serial: 87600
16:01:13.467 DEBUG                    Added keymat IR-INF-IA: serial=87600 auth=0x8b9de492d07d6392 subj=0x4d9c203c49db7226
16:01:13.479 DEBUG                    Generating certificate signature for serial: 88472
16:01:13.485 DEBUG                    Added keymat IR-INF-CRL-CA: serial=88472 auth=0xc9020cefbb66368c subj=0x0210e8e8161b8d25
16:01:13.497 DEBUG                    Generating certificate signature for serial: 87389
16:01:13.502 DEBUG                    Added keymat IR-INF-CRL-IA: serial=87389 auth=0x0210e8e8161b8d25 subj=0x92bedb4d511ce86e
16:01:13.513 DEBUG                    Generating certificate signature for serial: 5
16:01:13.518 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x976916617678a048 subj=0x976916617678a048
16:01:13.527 DEBUG                    Generating message signature using cert with serial: 87600
16:01:13.561 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:01:13.611 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x976916617678a048 subj=0x976916617678a048
16:01:13.617 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:01:13.634 DEBUG                    Generating message signature using cert with serial: 5
16:01:13.690 DEBUG                    IR: Handling Certificate Signing Request.
16:01:13.691 DEBUG                    Creating temporary CA cert to issue IA
16:01:13.703 DEBUG                    Generating certificate signature for serial: 84537
16:01:13.708 DEBUG                    Added keymat IR-INF-CA-TMP: serial=84537 auth=0xc9020cefbb66368c subj=0x75848bd8ed3d6940
16:01:13.709 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:01:13.715 DEBUG                    Generating certificate signature for serial: 20000
16:01:13.721 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:01:13.724 DEBUG                    Generating message signature using cert with serial: 87600
16:01:13.839 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:01:13.840 DEBUG                    Received Inf IA response
16:01:13.840 DEBUG                    Added keymat IR-INF-CA: serial=84537 auth=0xc9020cefbb66368c subj=0x75848bd8ed3d6940
16:01:13.840 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x75848bd8ed3d6940 subj=0x74169cdca8de00ca
16:01:13.850 DEBUG                    Generating certificate signature for serial: 5
16:01:13.856 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x7cf1fcbd45dc10db subj=0x7cf1fcbd45dc10db
16:01:13.864 DEBUG                    Generating message signature using cert with serial: 20000
16:01:13.900 DEBUG                    Creating SKD message file /tmp/icmCaReq
16:01:13.917 DEBUG                    Generating message signature using cert with serial: 20000
16:01:13.998 DEBUG                    IR: Handling Certificate Signing Request.
16:01:13.999 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
16:01:14.005 DEBUG                    Generating certificate signature for serial: 20001
16:01:14.012 DEBUG                    Creating SKD message file /tmp/icmCaResp
16:01:14.014 DEBUG                    Generating message signature using cert with serial: 87600
16:01:14.110 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:01:14.110 DEBUG                    Received Inf CA response
16:01:14.110 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x281760781d2d0515
16:01:14.110 INFO                     Listening for ('128.10.1.4', 80)
16:01:14.115 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:01:14.119 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:01:14.119 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:01:14.169 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x7cf1fcbd45dc10db subj=0x7cf1fcbd45dc10db
16:01:14.175 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:01:14.191 DEBUG                    Generating message signature using cert with serial: 5
16:01:14.248 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:01:14.254 DEBUG                    Generating certificate signature for serial: 20000
16:01:14.260 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:01:14.263 DEBUG                    Generating message signature using cert with serial: 20000
16:01:14.378 DEBUG                    Received Inf IA response
16:01:14.378 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x281760781d2d0515
16:01:14.378 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x281760781d2d0515 subj=0x98e841fbfdcf534b
16:01:14.382 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:01:14.386 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:01:14.435 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x7cf1fcbd45dc10db subj=0x7cf1fcbd45dc10db
16:01:14.436 INFO                     Listening for ('128.10.1.6', 80)
16:01:14.436 DEBUG                    MCKM requesting Inf IA from ICM.
16:01:14.442 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
16:01:14.458 DEBUG                    Generating message signature using cert with serial: 5
16:01:14.476 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:01:14.476 INFO                     SKD: Client ---> Server CMC-request (1338 bytes)
16:01:14.476 INFO                     Sent CSR for Inf IA certificate.
16:01:14.477 DEBUG                    105994064: Connect accepted from Client
16:01:14.526 DEBUG                    Connected to Server
16:01:14.577 DEBUG                    Sending HTTP POST /fullcmc message.
16:01:14.577 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:01:14.616 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:01:14.617 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
16:01:14.623 DEBUG                    Generating certificate signature for serial: 20001
16:01:14.632 DEBUG                    Generating message signature using cert with serial: 20000
16:01:14.683 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:01:14.684 DEBUG                    HTTP Status: 200 - OK
16:01:14.684 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3139 bytes)
16:01:14.748 INFO                     MCKM: Handling incoming CertificateSigningResponse
16:01:14.748 DEBUG                    Received Inf IA response
16:01:14.749 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x281760781d2d0515
16:01:14.749 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x281760781d2d0515 subj=0x434de0ee902a5351
16:01:14.914 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:14.965 DEBUG                    Connected to Server
16:01:15.015 DEBUG                    Sending HTTP GET /status_2 message.
16:01:15.016 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:15.088 DEBUG                    HTTP Status: 200 - OK
16:01:15.089 DEBUG                    Connect closed for Server
16:01:15.089 DEBUG                    Connect closed for Server
16:01:16.484 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:01:16.534 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x7cf1fcbd45dc10db subj=0x7cf1fcbd45dc10db
16:01:16.535 DEBUG                    CKA requesting Inf IA from ICM.
16:01:16.540 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
16:01:16.557 DEBUG                    Generating message signature using cert with serial: 5
16:01:16.576 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:01:16.576 INFO                     SKD: Client ---> Server CMC-request (1329 bytes)
16:01:16.576 INFO                     Sent CSR for Inf IA certificate.
16:01:16.577 DEBUG                    105994064: Connect accepted from Client
16:01:16.577 DEBUG                    Connect closed for Server
16:01:16.578 DEBUG                    Connect closed for Server
16:01:16.626 DEBUG                    Connected to Server
16:01:16.676 DEBUG                    Sending HTTP POST /fullcmc message.
16:01:16.677 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:01:16.718 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:01:16.719 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
16:01:16.725 DEBUG                    Generating certificate signature for serial: 20002
16:01:16.734 DEBUG                    Generating message signature using cert with serial: 20000
16:01:16.787 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:01:16.788 DEBUG                    HTTP Status: 200 - OK
16:01:16.788 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3129 bytes)
16:01:16.851 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
16:01:16.851 DEBUG                    Received Inf IA response
16:01:16.852 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x281760781d2d0515
16:01:16.852 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x281760781d2d0515 subj=0x6939f2e60c9a5303
16:01:17.089 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:17.140 DEBUG                    Connected to Server
16:01:17.190 DEBUG                    Sending HTTP GET /status_2 message.
16:01:17.191 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:17.288 DEBUG                    HTTP Status: 200 - OK
16:01:17.289 DEBUG                    Connect closed for Server
16:01:17.289 DEBUG                    Connect closed for Server
16:01:19.289 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:19.340 DEBUG                    Connected to Server
16:01:19.390 DEBUG                    Sending HTTP GET /status_2 message.
16:01:19.390 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:19.487 DEBUG                    HTTP Status: 200 - OK
16:01:19.488 DEBUG                    Connect closed for Server
16:01:19.488 DEBUG                    Connect closed for Server
16:01:20.783 DEBUG                    ########## Mocks complete ##########
16:01:21.491 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:21.542 DEBUG                    Connected to Server
16:01:21.592 DEBUG                    Sending HTTP GET /status_2 message.
16:01:21.592 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:21.694 DEBUG                    HTTP Status: 200 - OK
16:01:21.695 DEBUG                    Connect closed for Server
16:01:21.695 DEBUG                    Connect closed for Server
16:01:21.702 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:01:21.702 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:01:22.682 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:01:22.683 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:01:23.695 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:23.745 DEBUG                    Connected to Server
16:01:23.795 DEBUG                    Sending HTTP GET /status_2 message.
16:01:23.795 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:23.888 DEBUG                    HTTP Status: 200 - OK
16:01:23.889 DEBUG                    Connect closed for Server
16:01:23.889 DEBUG                    Connect closed for Server
16:01:25.890 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:25.943 DEBUG                    Connected to Server
16:01:25.991 DEBUG                    Sending HTTP GET /status_2 message.
16:01:25.991 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:26.122 DEBUG                    HTTP Status: 200 - OK
16:01:26.123 DEBUG                    Connect closed for Server
16:01:26.123 DEBUG                    Connect closed for Server
16:01:28.123 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:28.173 DEBUG                    Connected to Server
16:01:28.223 DEBUG                    Sending HTTP GET /status_2 message.
16:01:28.223 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:33.493 DEBUG                    HTTP Status: 200 - OK
16:01:33.495 DEBUG                    Connect closed for Server
16:01:33.495 DEBUG                    Connect closed for Server
16:01:35.502 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:35.555 DEBUG                    Connected to Server
16:01:35.612 DEBUG                    Sending HTTP GET /status_2 message.
16:01:35.613 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:35.718 DEBUG                    HTTP Status: 200 - OK
16:01:35.719 DEBUG                    Connect closed for Server
16:01:35.729 DEBUG                    Connect closed for Server
16:01:37.719 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:37.770 DEBUG                    Connected to Server
16:01:37.820 DEBUG                    Sending HTTP GET /status_2 message.
16:01:37.820 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:37.896 DEBUG                    HTTP Status: 200 - OK
16:01:37.897 DEBUG                    Connect closed for Server
16:01:37.897 DEBUG                    Connect closed for Server
16:01:39.899 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:39.950 DEBUG                    Connected to Server
16:01:40.000 DEBUG                    Sending HTTP GET /status_2 message.
16:01:40.000 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:40.120 DEBUG                    HTTP Status: 200 - OK
16:01:40.121 DEBUG                    Connect closed for Server
16:01:40.121 DEBUG                    Connect closed for Server
16:01:42.121 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:42.171 DEBUG                    Connected to Server
16:01:42.221 DEBUG                    Sending HTTP GET /status_2 message.
16:01:42.222 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:42.300 DEBUG                    HTTP Status: 200 - OK
16:01:42.301 DEBUG                    Connect closed for Server
16:01:42.302 DEBUG                    Connect closed for Server
16:01:44.301 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:44.352 DEBUG                    Connected to Server
16:01:44.402 DEBUG                    Sending HTTP GET /status_2 message.
16:01:44.402 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:44.525 DEBUG                    HTTP Status: 200 - OK
16:01:44.525 DEBUG                    Connect closed for Server
16:01:44.526 DEBUG                    Connect closed for Server
16:01:46.525 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:46.576 DEBUG                    Connected to Server
16:01:46.626 DEBUG                    Sending HTTP GET /status_2 message.
16:01:46.626 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:46.700 DEBUG                    HTTP Status: 200 - OK
16:01:46.700 DEBUG                    Connect closed for Server
16:01:46.700 DEBUG                    Connect closed for Server
16:01:48.700 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:48.751 DEBUG                    Connected to Server
16:01:48.800 DEBUG                    Sending HTTP GET /status_2 message.
16:01:48.801 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:48.936 DEBUG                    HTTP Status: 200 - OK
16:01:48.937 DEBUG                    Connect closed for Server
16:01:48.937 DEBUG                    Connect closed for Server
16:01:50.937 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:50.987 DEBUG                    Connected to Server
16:01:51.037 DEBUG                    Sending HTTP GET /status_2 message.
16:01:51.037 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:51.103 DEBUG                    HTTP Status: 200 - OK
16:01:51.103 DEBUG                    Connect closed for Server
16:01:51.104 DEBUG                    Connect closed for Server
16:01:53.103 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:53.159 DEBUG                    Connected to Server
16:01:53.204 DEBUG                    Sending HTTP GET /status_2 message.
16:01:53.204 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:53.303 DEBUG                    HTTP Status: 200 - OK
16:01:53.304 DEBUG                    Connect closed for Server
16:01:53.304 DEBUG                    Connect closed for Server
16:01:55.304 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:55.354 DEBUG                    Connected to Server
16:01:55.404 DEBUG                    Sending HTTP GET /status_2 message.
16:01:55.405 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:55.526 DEBUG                    HTTP Status: 200 - OK
16:01:55.526 DEBUG                    Connect closed for Server
16:01:55.527 DEBUG                    Connect closed for Server
16:01:57.526 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:57.577 DEBUG                    Connected to Server
16:01:57.627 DEBUG                    Sending HTTP GET /status_2 message.
16:01:57.627 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:57.710 DEBUG                    HTTP Status: 200 - OK
16:01:57.711 DEBUG                    Connect closed for Server
16:01:57.711 DEBUG                    Connect closed for Server
16:01:59.711 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:01:59.762 DEBUG                    Connected to Server
16:01:59.811 DEBUG                    Sending HTTP GET /status_2 message.
16:01:59.812 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:01:59.927 DEBUG                    HTTP Status: 200 - OK
16:01:59.928 DEBUG                    Connect closed for Server
16:01:59.928 DEBUG                    Connect closed for Server
16:02:01.518 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:52752782023806827929435745510380101931875315426869786614976249563839289452138016063890982417350490725427803966171863764510034994267244746785894024050938219341363543596957536465060340491781077539865120758950793425290758719931025183
|                                                     x = 1338834925330122532797336127349988184801990709999625574287651331035830075346713519488162163701964304424102323158704
|                                                     y = 23737867711200710394772173404322115206383244242311180606421104551022243002073201211640112919777184709521812710098719
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:23872435730237811790044066973023866461058384760964394346250210515981487335384672661732753132622314641070803755345440
|                                                 s = long384:36878650012382531276180627149981779545448479803302289157653154082565161920202990659912404211528134791364817619239292
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112160127Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 11L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x758503a0c64f56dc555cfc640524a293a2a172d9392d9c02b6b8b640acbc65574a457fc5ac097e3d79460cfaa23163e7)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:29481095120189856202670444233004977010266827710381879643736266087172338727628105860456785606496612881015909745894245
|                                                 s = long384:20508110087814427572575961151428430233265851481008083507511217058528756452709921468377477489547353196819480434577103
16:02:01.519 DEBUG                    IR: Handling Certificate Signing Request.
16:02:01.520 DEBUG                    Generating InfCA certificate (serialNumber: 20002L)
16:02:01.527 DEBUG                    Generating certificate signature for serial: 20002
16:02:01.534 DEBUG                    Creating SKD message file /tmp/infca.resp
16:02:01.537 DEBUG                    Generating message signature using cert with serial: 87600
16:02:01.568 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0xd48c45a5d17a071f-->0xc9020cefbb66368c
|                                             0x4d9c203c49db7226-->0x8b9de492d07d6392-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112160201Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:52752782023806827929435745510380101931875315426869786614976249563839289452138016063890982417350490725427803966171863764510034994267244746785894024050938219341363543596957536465060340491781077539865120758950793425290758719931025183
|                                                         x = 1338834925330122532797336127349988184801990709999625574287651331035830075346713519488162163701964304424102323158704
|                                                         y = 23737867711200710394772173404322115206383244242311180606421104551022243002073201211640112919777184709521812710098719
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xd48c45a5d17a071f)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:29370474990427945374817496479716995680662897793479975300167422322908695545326835533119124231272886996223554870042121
|                                                     s = long384:23051391491581059615495481244294862158340124181672863968989059579933940538169958712655072925176068415364112237499839
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 87600L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112160113Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1133148682134547815435730452665233029471740626029115991018818882962646547247189738933443654436822913399974368611599950560252110352391275426661521205946921211113943114058541565138111115019454140018961698908462655879548696846753559078
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x8b9de492d07d6392)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x4d9c203c49db7226)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:10505379582491514884269697817888497706887104457960301830190851930296559817203624057472407322302566045241099729256512
|                                                     s = long384:9543175118229928309363043778549306857606793256329122459163027263051989863449994562907303742983338645353045591248620
|                                                 [1.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 81208L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112160113Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:7810882995061007265449333001495039155426673792330306492901128266719095789676149052234437796026960900829351553080005544780811541808918206261615147590980514611599958855898571146532970764461831395806535373557555576550909628760548242
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x8b9de492d07d6392)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:25922868017321986320563896630061857090765297188567344709947956672384331591060795673566349186503376590675104620137046
|                                                     s = long384:21334372804158576662779333120525057500970596331971629496124291653419659433904948768776052078299489644769160518522786
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x4d9c203c49db7226)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112160201Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 11L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:22025892944501103639876643816000417186165077660455517728060112525727962191772632932745015100492595916737633235624390
|                                                 s = long384:28278344970236864113075246118014161600157569986513861293571349275965623583527101273726172954652526615085558093270603
16:02:01.928 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:01.979 DEBUG                    Connected to Server
16:02:02.028 DEBUG                    Sending HTTP GET /status_2 message.
16:02:02.029 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:02.093 DEBUG                    HTTP Status: 200 - OK
16:02:02.093 DEBUG                    Connect closed for Server
16:02:02.094 DEBUG                    Connect closed for Server
16:02:04.093 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:04.144 DEBUG                    Connected to Server
16:02:04.194 DEBUG                    Sending HTTP GET /status_2 message.
16:02:04.194 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:04.323 DEBUG                    HTTP Status: 200 - OK
16:02:04.324 DEBUG                    Connect closed for Server
16:02:04.325 DEBUG                    Connect closed for Server
16:02:06.324 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:06.374 DEBUG                    Connected to Server
16:02:06.424 DEBUG                    Sending HTTP GET /status_2 message.
16:02:06.425 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:06.513 DEBUG                    HTTP Status: 200 - OK
16:02:06.514 DEBUG                    Connect closed for Server
16:02:06.515 DEBUG                    Connect closed for Server
16:02:08.514 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:08.565 DEBUG                    Connected to Server
16:02:08.615 DEBUG                    Sending HTTP GET /status_2 message.
16:02:08.615 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:08.687 DEBUG                    HTTP Status: 200 - OK
16:02:08.692 DEBUG                    Connect closed for Server
16:02:08.693 DEBUG                    Connect closed for Server
16:02:09.459 DEBUG                    cmd optimus > keydir
16:02:09.505 DEBUG                    cmd optimus > keydir /tmp/
16:02:10.692 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:10.742 DEBUG                    Connected to Server
16:02:10.792 DEBUG                    Sending HTTP GET /status_2 message.
16:02:10.793 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:10.923 DEBUG                    HTTP Status: 200 - OK
16:02:10.930 DEBUG                    Connect closed for Server
16:02:10.930 DEBUG                    Connect closed for Server
16:02:12.930 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:12.981 DEBUG                    Connected to Server
16:02:13.030 DEBUG                    Sending HTTP GET /status_2 message.
16:02:13.031 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:13.089 DEBUG                    HTTP Status: 200 - OK
16:02:13.096 DEBUG                    Connect closed for Server
16:02:13.097 DEBUG                    Connect closed for Server
16:02:15.095 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:15.146 DEBUG                    Connected to Server
16:02:15.196 DEBUG                    Sending HTTP GET /status_2 message.
16:02:15.196 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:15.319 DEBUG                    HTTP Status: 200 - OK
16:02:15.320 DEBUG                    Connect closed for Server
16:02:15.320 DEBUG                    Connect closed for Server
16:02:17.320 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:17.370 DEBUG                    Connected to Server
16:02:17.420 DEBUG                    Sending HTTP GET /status_2 message.
16:02:17.421 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:17.519 DEBUG                    HTTP Status: 200 - OK
16:02:17.520 DEBUG                    Connect closed for Server
16:02:17.524 DEBUG                    Connect closed for Server
16:02:19.520 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:19.571 DEBUG                    Connected to Server
16:02:19.621 DEBUG                    Sending HTTP GET /status_2 message.
16:02:19.621 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:19.722 DEBUG                    HTTP Status: 200 - OK
16:02:19.723 DEBUG                    Connect closed for Server
16:02:19.723 DEBUG                    Connect closed for Server
16:02:21.722 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:21.773 DEBUG                    Connected to Server
16:02:21.823 DEBUG                    Sending HTTP GET /status_2 message.
16:02:21.824 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:21.920 DEBUG                    HTTP Status: 200 - OK
16:02:21.921 DEBUG                    Connect closed for Server
16:02:21.921 DEBUG                    Connect closed for Server
16:02:23.922 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:23.931 DEBUG                    cmd optimus > keydir ../Keys/
16:02:24.104 DEBUG                    Received SKD message:
|                                     KeyPackageFile:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = List:
|                                             [0]:
|                                                 OneAsymmetricKey:
|                                                     version == 0
|                                                     privateKeyAlgorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     privateKey = ECPrivateKey:
|                                                         version = 1L
|                                                         privateKey = Octets(0xa96bb68b6d69d95c2ae27f24a0348383e3c5172f1cf9c8d3681149126c0ff3d552e1eb3bbfc1191dce62cb3abc6002d1)
|                                                     attributes:
|                                                       [0] = UserCertificateAttr:
|                                                         id == OID(userCertificate:2.5.4.36)
|                                                         userCertificate = Certificate:
|                                                             tbsCertificate = TBSCertificate:
|                                                                 version == 2
|                                                                 serialNumber = 16L
|                                                                 signatureAlgorithmID = AlgorithmIdentifier:
|                                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                 issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 validity = 170112000000Z..99991231235959Z
|                                                                 subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                     algorithm = AlgorithmIdentifier:
|                                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                         parameters = ECParameters:
|                                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                     subjectPublicKey = long768:754794407976122049802774963752758363724231717434045262787715819250456799810408837430827390413894524674762189673748400812998471045221684484186542557181468024954455650230656916681810987987823302992013446211455610266229472142566888280
|                                                                     x = 19156243065744969158219003091667321160458173878121200347330167627168889525760366087710862740317754661516648086097480
|                                                                     y = 2761525568199868270219833831649771196848655283289439222243485314384342185840753374449542172582224980336493282464600
|                                                                 _extensions = CertificateExtensions
|                                                                   [0] AuthorityKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                         keyIdentifier = Octets(0x22a77704edb41358)
|                                                                   [1] SubjectKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                         id = Octets(0x22a77704edb41358)
|                                                                   [2] KeyUsage_CertExt:
|                                                                         extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                         critical = True
|                                                                         uses = ['digitalSignature']
|                                                                   [3] CertificatePolicies_CertExt:
|                                                                         extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                         critical = True
|                                                                         policies:
|                                                                           [0] = PolicyInformation:
|                                                                             id = OID(1.2.826.0.1145.0.1.0.3)
|                                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                             signature = Signature:
|                                                                 r = long384:31319414150342144690378975836667766041917389912432268425070500663654800892639032045803178709737505126843256321670448
|                                                                 s = long384:6267286275983208414607035065523894851291114840725061649010635274612598845080392478808364230100141535492923379536786
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                               [1] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0xe6abc812ae23a9389161f20d5354b02526b286ace0c38e771beb0b51f42ca73f8803998fda9e235045dd3d9279f3b971)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:15785067754011589291344050581306527399171766826432185211836880221245874264866902774406008174545293903586350757436037
|                                                 s = long384:26746143647766299875611515493703785340854357583520905109149028221169270854931246614990044685879797176504811624471765
16:02:24.105 DEBUG                    Added keymat FACT-IA: serial=16 auth=0x22a77704edb41358 subj=0x22a77704edb41358
16:02:24.106 DEBUG                    UUT Control: Applying all recent configuration changes
16:02:24.107 DEBUG                    Connected to Server
16:02:24.107 DEBUG                    Sending HTTP GET /status_2 message.
16:02:24.108 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:24.130 INFO    Test:            124 : [icm-issue-infia-mckm-inv-ext-req] The MCKM
|                                           sends a CSR for an InfIA certificate with an
|                                           invalid ExtensionReq attribute and receives
|                                           a error response.
16:02:24.147 DEBUG                          MCKM requesting Inf IA from ICM.
16:02:24.156 INFO                           SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
16:02:24.201 DEBUG                          Generating message signature using cert with serial: 16
16:02:24.240 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0155000,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:139455152107779884078649800628997642098868833844517207764856809520439532549495072492541144783949319007457713189580072463260017837425639661688096479813317265358498586061627427508304867772876349165830326438308237989435072916696584557
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['nonRepudiation']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.7
|                                                                             [1] = 1.2.826.0.1145.0.10.6
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:31780901449003819194600766096430494779275683535696650069826484872428471478122728002571410654790834618693595471408842
|                                                       s = long384:34907761857407416998342578073005997630054869462688880184107575338448912453959721770146734275074996993705759830750297
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x22a77704edb41358-->0x22a77704edb41358
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 16L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:754794407976122049802774963752758363724231717434045262787715819250456799810408837430827390413894524674762189673748400812998471045221684484186542557181468024954455650230656916681810987987823302992013446211455610266229472142566888280
|                                                               x = 19156243065744969158219003091667321160458173878121200347330167627168889525760366087710862740317754661516648086097480
|                                                               y = 2761525568199868270219833831649771196848655283289439222243485314384342185840753374449542172582224980336493282464600
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x22a77704edb41358)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x22a77704edb41358)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:31319414150342144690378975836667766041917389912432268425070500663654800892639032045803178709737505126843256321670448
|                                                           s = long384:6267286275983208414607035065523894851291114840725061649010635274612598845080392478808364230100141535492923379536786
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x22a77704edb41358)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112160224Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x1f7ede7e1388504032406f481ba5447cc0c0f2c59678d9851268b66fc34a97d960afc06d395072858320504451bcdb3e)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xbd54df3f72b045ef)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:33270672806318146201748566589192384683228257178419687899309677376604462965679831505788078040621985001361085311594110
|                                                       s = long384:23743099035820772315913051922250973714617821694682411736399944615793073452701170344612031770408976632174379313460041
16:02:24.272 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:24.273 INFO                           SKD: Client ---> Server CMC-request (1343 bytes)
16:02:24.274 INFO                           Sent CSR for Inf IA certificate.
16:02:24.276 DEBUG                          HTTP Status: 200 - OK
16:02:24.280 DEBUG                          Connect closed for Server
16:02:24.282 DEBUG                          Connect closed for Server
16:02:24.324 DEBUG                          Connected to Server
16:02:24.374 DEBUG                          Sending HTTP POST /fullcmc message.
16:02:24.375 DEBUG                          Removing HTTP POST /fullcmc message from Q.
16:02:24.565 DEBUG                          HTTP Status: 200 - OK
16:02:24.566 INFO                           SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (1766 bytes)
16:02:24.801 DEBUG                          Received SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = Integer(1)
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = Integer(2)
|                                                           otherInfo = OtherStatusInfo:
|                                                               failInfo = Integer(2)
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                               x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                               y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1de6a414dda88f8b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                           s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 82825L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                               x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                               y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2eb4fc66f0202ec8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                           s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112160224Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xbd54df3f72b045ef)
|                                                           msgCount = 1L
|                                                     [4] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=,CN=
|                                                     [5] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xa398ffd4f2bd9a659ddc4da37aa54c2932303954638e852702d71cd1596bc4938e47fc0a9368ac931413a36a58a68d9b)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:33198518964740162951397878494305360266471199006127958070648832551914995786857071330731556997571499040780584026925760
|                                                       s = long384:37237117778762949565774382565917978497250732404239333986374734752396358245427472956904283148353512285482632165469102
16:02:24.802 INFO                           MCKM: Handling incoming CertificateSigningResponse
16:02:24.806 INFO                           #> 0.1. Check request is displayed with correct status
16:02:24.812 DEBUG                          Connect closed for Server
16:02:24.813 DEBUG                          Connect closed for Server
16:02:26.278 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:26.329 DEBUG                          Connected to Server
16:02:26.379 DEBUG                          Sending HTTP GET /status_2 message.
16:02:26.381 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:02:26.510 DEBUG                          HTTP Status: 200 - OK
16:02:26.511 DEBUG                          Connect closed for Server
16:02:26.518 DEBUG                          Connect closed for Server
16:02:28.511 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:28.568 DEBUG                          Connected to Server
16:02:28.612 DEBUG                          Sending HTTP GET /status_2 message.
16:02:28.614 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:02:28.739 DEBUG                          HTTP Status: 200 - OK
16:02:28.741 DEBUG                          Connect closed for Server
16:02:28.752 DEBUG                          Connect closed for Server
16:02:29.651 INFO                           #> 1. Check an error was received.
16:02:29.670 INFO    Test:                  PASS
16:02:29.839 DEBUG                    Tearing down mock HTTP servers
16:02:29.842 DEBUG                    Connect closed for Server
16:02:29.843 DEBUG                    Connect closed for Server
16:02:30.744 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:30.795 DEBUG                    Connected to Server
16:02:30.844 DEBUG                    Sending HTTP GET /status_2 message.
16:02:30.845 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:30.966 DEBUG                    HTTP Status: 200 - OK
16:02:30.967 DEBUG                    Connect closed for Server
16:02:30.967 DEBUG                    Connect closed for Server
16:02:32.967 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:33.018 DEBUG                    Connected to Server
16:02:33.068 DEBUG                    Sending HTTP GET /status_2 message.
16:02:33.069 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:33.224 DEBUG                    HTTP Status: 200 - OK
16:02:33.225 DEBUG                    Connect closed for Server
16:02:33.226 DEBUG                    Connect closed for Server
16:02:35.225 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:35.276 DEBUG                    Connected to Server
16:02:35.326 DEBUG                    Sending HTTP GET /status_2 message.
16:02:35.326 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:35.402 DEBUG                    HTTP Status: 200 - OK
16:02:35.403 DEBUG                    Connect closed for Server
16:02:35.403 DEBUG                    Connect closed for Server
16:02:37.403 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:37.454 DEBUG                    Connected to Server
16:02:37.503 DEBUG                    Sending HTTP GET /status_2 message.
16:02:37.504 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:37.619 DEBUG                    HTTP Status: 200 - OK
16:02:37.620 DEBUG                    Connect closed for Server
16:02:37.620 DEBUG                    Connect closed for Server
16:02:39.197 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:02:39.197 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:02:39.210 DEBUG                    Generating certificate signature for serial: 87492
16:02:39.216 DEBUG                    Added keymat IR-INF-CA: serial=87492 auth=0xc9020cefbb66368c subj=0x05b98863cae2f8f9
16:02:39.228 DEBUG                    Generating certificate signature for serial: 82303
16:02:39.233 DEBUG                    Added keymat IR-INF-IA: serial=82303 auth=0x05b98863cae2f8f9 subj=0x672395202a682b6a
16:02:39.246 DEBUG                    Generating certificate signature for serial: 80034
16:02:39.252 DEBUG                    Added keymat IR-INF-CRL-CA: serial=80034 auth=0xc9020cefbb66368c subj=0x7933b807b70b5bfc
16:02:39.264 DEBUG                    Generating certificate signature for serial: 87210
16:02:39.270 DEBUG                    Added keymat IR-INF-CRL-IA: serial=87210 auth=0x7933b807b70b5bfc subj=0x5f116b39026e5c01
16:02:39.281 DEBUG                    Generating certificate signature for serial: 5
16:02:39.287 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x614e9c11d43cf165 subj=0x614e9c11d43cf165
16:02:39.295 DEBUG                    Generating message signature using cert with serial: 82303
16:02:39.332 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:02:39.385 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x614e9c11d43cf165 subj=0x614e9c11d43cf165
16:02:39.391 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:02:39.409 DEBUG                    Generating message signature using cert with serial: 5
16:02:39.469 DEBUG                    IR: Handling Certificate Signing Request.
16:02:39.469 DEBUG                    Creating temporary CA cert to issue IA
16:02:39.482 DEBUG                    Generating certificate signature for serial: 80700
16:02:39.488 DEBUG                    Added keymat IR-INF-CA-TMP: serial=80700 auth=0xc9020cefbb66368c subj=0x49d1813b801cfaa4
16:02:39.489 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:02:39.495 DEBUG                    Generating certificate signature for serial: 20000
16:02:39.501 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:02:39.505 DEBUG                    Generating message signature using cert with serial: 82303
16:02:39.628 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:02:39.628 DEBUG                    Received Inf IA response
16:02:39.629 DEBUG                    Added keymat IR-INF-CA: serial=80700 auth=0xc9020cefbb66368c subj=0x49d1813b801cfaa4
16:02:39.629 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x49d1813b801cfaa4 subj=0xb3aa216bc1635f84
16:02:39.639 DEBUG                    Generating certificate signature for serial: 5
16:02:39.645 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x220658a6ec1a473a subj=0x220658a6ec1a473a
16:02:39.654 DEBUG                    Generating message signature using cert with serial: 20000
16:02:39.691 DEBUG                    Creating SKD message file /tmp/icmCaReq
16:02:39.708 DEBUG                    Generating message signature using cert with serial: 20000
16:02:39.792 DEBUG                    IR: Handling Certificate Signing Request.
16:02:39.793 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
16:02:39.800 DEBUG                    Generating certificate signature for serial: 20001
16:02:39.807 DEBUG                    Creating SKD message file /tmp/icmCaResp
16:02:39.810 DEBUG                    Generating message signature using cert with serial: 82303
16:02:39.912 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:02:39.913 DEBUG                    Received Inf CA response
16:02:39.913 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x8253302ad75a787d
16:02:39.914 INFO                     Listening for ('128.10.1.4', 80)
16:02:39.919 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:02:39.923 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:02:39.923 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:02:39.978 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x220658a6ec1a473a subj=0x220658a6ec1a473a
16:02:39.984 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:02:40.002 DEBUG                    Generating message signature using cert with serial: 5
16:02:40.061 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:02:40.068 DEBUG                    Generating certificate signature for serial: 20000
16:02:40.075 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:02:40.078 DEBUG                    Generating message signature using cert with serial: 20000
16:02:40.198 DEBUG                    Received Inf IA response
16:02:40.199 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x8253302ad75a787d
16:02:40.199 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x8253302ad75a787d subj=0xd69c8e08c838eeea
16:02:40.203 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:02:40.208 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:02:40.259 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x220658a6ec1a473a subj=0x220658a6ec1a473a
16:02:40.259 INFO                     Listening for ('128.10.1.6', 80)
16:02:40.259 DEBUG                    MCKM requesting Inf IA from ICM.
16:02:40.265 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
16:02:40.282 DEBUG                    Generating message signature using cert with serial: 5
16:02:40.301 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:02:40.301 INFO                     SKD: Client ---> Server CMC-request (1343 bytes)
16:02:40.301 INFO                     Sent CSR for Inf IA certificate.
16:02:40.302 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:40.302 DEBUG                    112045584: Connect accepted from Client
16:02:40.351 DEBUG                    Connected to Server
16:02:40.352 DEBUG                    Connected to Server
16:02:40.401 DEBUG                    Sending HTTP POST /fullcmc message.
16:02:40.402 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:02:40.402 DEBUG                    Sending HTTP GET /status_2 message.
16:02:40.403 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:40.452 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:02:40.453 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
16:02:40.459 DEBUG                    Generating certificate signature for serial: 20001
16:02:40.468 DEBUG                    Generating message signature using cert with serial: 20000
16:02:40.522 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:02:40.524 DEBUG                    HTTP Status: 200 - OK
16:02:40.525 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3137 bytes)
16:02:40.589 INFO                     MCKM: Handling incoming CertificateSigningResponse
16:02:40.589 DEBUG                    Received Inf IA response
16:02:40.589 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x8253302ad75a787d
16:02:40.590 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x8253302ad75a787d subj=0xb729de6cd9f487dd
16:02:40.590 DEBUG                    HTTP Status: 200 - OK
16:02:40.590 DEBUG                    Connect closed for Server
16:02:40.591 DEBUG                    Connect closed for Server
16:02:42.310 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:02:42.409 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x220658a6ec1a473a subj=0x220658a6ec1a473a
16:02:42.410 DEBUG                    CKA requesting Inf IA from ICM.
16:02:42.420 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
16:02:42.452 DEBUG                    Generating message signature using cert with serial: 5
16:02:42.488 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:02:42.489 INFO                     SKD: Client ---> Server CMC-request (1331 bytes)
16:02:42.490 INFO                     Sent CSR for Inf IA certificate.
16:02:42.491 DEBUG                    112045584: Connect accepted from Client
16:02:42.491 DEBUG                    Connect closed for Server
16:02:42.492 DEBUG                    Connect closed for Server
16:02:42.540 DEBUG                    Connected to Server
16:02:42.590 DEBUG                    Sending HTTP POST /fullcmc message.
16:02:42.590 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:02:42.591 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:42.643 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:02:42.644 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
16:02:42.651 DEBUG                    Generating certificate signature for serial: 20002
16:02:42.661 DEBUG                    Generating message signature using cert with serial: 20000
16:02:42.724 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:02:42.725 DEBUG                    Connected to Server
16:02:42.725 DEBUG                    Sending HTTP GET /status_2 message.
16:02:42.725 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:42.726 DEBUG                    HTTP Status: 200 - OK
16:02:42.727 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3126 bytes)
16:02:42.802 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
16:02:42.802 DEBUG                    Received Inf IA response
16:02:42.802 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x8253302ad75a787d
16:02:42.803 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x8253302ad75a787d subj=0xcea85e2210e6dc95
16:02:42.803 DEBUG                    HTTP Status: 200 - OK
16:02:42.804 DEBUG                    Connect closed for Server
16:02:42.804 DEBUG                    Connect closed for Server
16:02:44.805 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:44.856 DEBUG                    Connected to Server
16:02:44.906 DEBUG                    Sending HTTP GET /status_2 message.
16:02:44.911 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:44.991 DEBUG                    HTTP Status: 200 - OK
16:02:44.991 DEBUG                    Connect closed for Server
16:02:44.992 DEBUG                    Connect closed for Server
16:02:46.696 DEBUG                    ########## Mocks complete ##########
16:02:46.992 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:47.044 DEBUG                    Connected to Server
16:02:47.093 DEBUG                    Sending HTTP GET /status_2 message.
16:02:47.094 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:47.198 DEBUG                    HTTP Status: 200 - OK
16:02:47.199 DEBUG                    Connect closed for Server
16:02:47.199 DEBUG                    Connect closed for Server
16:02:48.263 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:02:48.263 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:02:49.198 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:49.253 DEBUG                    Connected to Server
16:02:49.299 DEBUG                    Sending HTTP GET /status_2 message.
16:02:49.300 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:49.424 DEBUG                    HTTP Status: 200 - OK
16:02:49.426 DEBUG                    Connect closed for Server
16:02:49.427 DEBUG                    Connect closed for Server
16:02:49.996 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:02:49.996 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:02:51.425 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:51.484 DEBUG                    Connected to Server
16:02:51.525 DEBUG                    Sending HTTP GET /status_2 message.
16:02:51.526 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:51.612 DEBUG                    HTTP Status: 200 - OK
16:02:51.613 DEBUG                    Connect closed for Server
16:02:51.613 DEBUG                    Connect closed for Server
16:02:53.612 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:53.663 DEBUG                    Connected to Server
16:02:53.713 DEBUG                    Sending HTTP GET /status_2 message.
16:02:53.714 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:53.832 DEBUG                    HTTP Status: 200 - OK
16:02:53.833 DEBUG                    Connect closed for Server
16:02:53.834 DEBUG                    Connect closed for Server
16:02:55.833 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:55.885 DEBUG                    Connected to Server
16:02:55.934 DEBUG                    Sending HTTP GET /status_2 message.
16:02:55.935 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:56.024 DEBUG                    HTTP Status: 200 - OK
16:02:56.025 DEBUG                    Connect closed for Server
16:02:56.025 DEBUG                    Connect closed for Server
16:02:58.024 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:02:58.076 DEBUG                    Connected to Server
16:02:58.126 DEBUG                    Sending HTTP GET /status_2 message.
16:02:58.126 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:02:58.237 DEBUG                    HTTP Status: 200 - OK
16:02:58.238 DEBUG                    Connect closed for Server
16:02:58.239 DEBUG                    Connect closed for Server
16:03:00.238 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:00.288 DEBUG                    Connected to Server
16:03:00.338 DEBUG                    Sending HTTP GET /status_2 message.
16:03:00.339 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:00.473 DEBUG                    HTTP Status: 200 - OK
16:03:00.474 DEBUG                    Connect closed for Server
16:03:00.475 DEBUG                    Connect closed for Server
16:03:02.474 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:02.525 DEBUG                    Connected to Server
16:03:02.575 DEBUG                    Sending HTTP GET /status_2 message.
16:03:02.576 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:08.605 DEBUG                    HTTP Status: 200 - OK
16:03:08.606 DEBUG                    Connect closed for Server
16:03:08.606 DEBUG                    Connect closed for Server
16:03:10.605 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:10.657 DEBUG                    Connected to Server
16:03:10.706 DEBUG                    Sending HTTP GET /status_2 message.
16:03:10.707 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:10.828 DEBUG                    HTTP Status: 200 - OK
16:03:10.829 DEBUG                    Connect closed for Server
16:03:10.829 DEBUG                    Connect closed for Server
16:03:12.828 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:12.880 DEBUG                    Connected to Server
16:03:12.929 DEBUG                    Sending HTTP GET /status_2 message.
16:03:12.930 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:13.119 DEBUG                    HTTP Status: 200 - OK
16:03:13.120 DEBUG                    Connect closed for Server
16:03:13.121 DEBUG                    Connect closed for Server
16:03:15.120 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:15.171 DEBUG                    Connected to Server
16:03:15.221 DEBUG                    Sending HTTP GET /status_2 message.
16:03:15.222 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:15.348 DEBUG                    HTTP Status: 200 - OK
16:03:15.349 DEBUG                    Connect closed for Server
16:03:15.350 DEBUG                    Connect closed for Server
16:03:17.349 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:17.400 DEBUG                    Connected to Server
16:03:17.449 DEBUG                    Sending HTTP GET /status_2 message.
16:03:17.450 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:17.634 DEBUG                    HTTP Status: 200 - OK
16:03:17.638 DEBUG                    Connect closed for Server
16:03:17.644 DEBUG                    Connect closed for Server
16:03:19.635 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:19.697 DEBUG                    Connected to Server
16:03:19.737 DEBUG                    Sending HTTP GET /status_2 message.
16:03:19.738 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:19.940 DEBUG                    HTTP Status: 200 - OK
16:03:19.941 DEBUG                    Connect closed for Server
16:03:19.942 DEBUG                    Connect closed for Server
16:03:21.941 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:21.994 DEBUG                    Connected to Server
16:03:22.041 DEBUG                    Sending HTTP GET /status_2 message.
16:03:22.042 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:22.236 DEBUG                    HTTP Status: 200 - OK
16:03:22.237 DEBUG                    Connect closed for Server
16:03:22.237 DEBUG                    Connect closed for Server
16:03:24.237 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:24.288 DEBUG                    Connected to Server
16:03:24.338 DEBUG                    Sending HTTP GET /status_2 message.
16:03:24.338 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:24.515 DEBUG                    HTTP Status: 200 - OK
16:03:24.516 DEBUG                    Connect closed for Server
16:03:24.517 DEBUG                    Connect closed for Server
16:03:26.516 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:26.567 DEBUG                    Connected to Server
16:03:26.617 DEBUG                    Sending HTTP GET /status_2 message.
16:03:26.617 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:26.732 DEBUG                    HTTP Status: 200 - OK
16:03:26.733 DEBUG                    Connect closed for Server
16:03:26.734 DEBUG                    Connect closed for Server
16:03:28.733 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:28.784 DEBUG                    Connected to Server
16:03:28.834 DEBUG                    Sending HTTP GET /status_2 message.
16:03:28.835 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:28.966 DEBUG                    HTTP Status: 200 - OK
16:03:28.967 DEBUG                    Connect closed for Server
16:03:28.977 DEBUG                    Connect closed for Server
16:03:30.967 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:31.017 DEBUG                    Connected to Server
16:03:31.067 DEBUG                    Sending HTTP GET /status_2 message.
16:03:31.068 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:31.201 DEBUG                    HTTP Status: 200 - OK
16:03:31.202 DEBUG                    Connect closed for Server
16:03:31.203 DEBUG                    Connect closed for Server
16:03:33.202 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:33.254 DEBUG                    Connected to Server
16:03:33.303 DEBUG                    Sending HTTP GET /status_2 message.
16:03:33.304 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:33.480 DEBUG                    HTTP Status: 200 - OK
16:03:33.481 DEBUG                    Connect closed for Server
16:03:33.482 DEBUG                    Connect closed for Server
16:03:35.481 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:35.532 DEBUG                    Connected to Server
16:03:35.582 DEBUG                    Sending HTTP GET /status_2 message.
16:03:35.583 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:35.745 DEBUG                    HTTP Status: 200 - OK
16:03:35.746 DEBUG                    Connect closed for Server
16:03:35.746 DEBUG                    Connect closed for Server
16:03:37.746 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:37.796 DEBUG                    Connected to Server
16:03:37.846 DEBUG                    Sending HTTP GET /status_2 message.
16:03:37.847 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:37.961 DEBUG                    HTTP Status: 200 - OK
16:03:37.962 DEBUG                    Connect closed for Server
16:03:37.962 DEBUG                    Connect closed for Server
16:03:39.964 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:40.015 DEBUG                    Connected to Server
16:03:40.064 DEBUG                    Sending HTTP GET /status_2 message.
16:03:40.065 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:40.238 DEBUG                    HTTP Status: 200 - OK
16:03:40.240 DEBUG                    Connect closed for Server
16:03:40.241 DEBUG                    Connect closed for Server
16:03:42.240 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:42.292 DEBUG                    Connected to Server
16:03:42.341 DEBUG                    Sending HTTP GET /status_2 message.
16:03:42.342 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:42.484 DEBUG                    HTTP Status: 200 - OK
16:03:42.485 DEBUG                    Connect closed for Server
16:03:42.486 DEBUG                    Connect closed for Server
16:03:44.485 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:44.540 DEBUG                    Connected to Server
16:03:44.586 DEBUG                    Sending HTTP GET /status_2 message.
16:03:44.587 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:44.806 DEBUG                    HTTP Status: 200 - OK
16:03:44.807 DEBUG                    Connect closed for Server
16:03:44.808 DEBUG                    Connect closed for Server
16:03:46.807 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:46.857 DEBUG                    Connected to Server
16:03:46.907 DEBUG                    Sending HTTP GET /status_2 message.
16:03:46.908 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:47.064 DEBUG                    HTTP Status: 200 - OK
16:03:47.068 DEBUG                    Connect closed for Server
16:03:47.085 DEBUG                    Connect closed for Server
16:03:49.065 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:49.115 DEBUG                    Connected to Server
16:03:49.165 DEBUG                    Sending HTTP GET /status_2 message.
16:03:49.166 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:49.300 DEBUG                    HTTP Status: 200 - OK
16:03:49.305 DEBUG                    Connect closed for Server
16:03:49.306 DEBUG                    Connect closed for Server
16:03:51.302 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:51.353 DEBUG                    Connected to Server
16:03:51.402 DEBUG                    Sending HTTP GET /status_2 message.
16:03:51.403 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:51.590 DEBUG                    HTTP Status: 200 - OK
16:03:51.595 DEBUG                    Connect closed for Server
16:03:51.597 DEBUG                    Connect closed for Server
16:03:53.590 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:53.642 DEBUG                    Connected to Server
16:03:53.696 DEBUG                    Sending HTTP GET /status_2 message.
16:03:53.698 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:53.826 DEBUG                    HTTP Status: 200 - OK
16:03:53.827 DEBUG                    Connect closed for Server
16:03:53.827 DEBUG                    Connect closed for Server
16:03:55.830 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:55.881 DEBUG                    Connected to Server
16:03:55.931 DEBUG                    Sending HTTP GET /status_2 message.
16:03:55.932 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:56.117 DEBUG                    HTTP Status: 200 - OK
16:03:56.118 DEBUG                    Connect closed for Server
16:03:56.119 DEBUG                    Connect closed for Server
16:03:58.118 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:03:58.172 DEBUG                    Connected to Server
16:03:58.219 DEBUG                    Sending HTTP GET /status_2 message.
16:03:58.220 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:03:58.355 DEBUG                    HTTP Status: 200 - OK
16:03:58.355 DEBUG                    Connect closed for Server
16:03:58.356 DEBUG                    Connect closed for Server
16:04:00.355 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:00.406 DEBUG                    Connected to Server
16:04:00.456 DEBUG                    Sending HTTP GET /status_2 message.
16:04:00.457 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:00.649 DEBUG                    HTTP Status: 200 - OK
16:04:00.650 DEBUG                    Connect closed for Server
16:04:00.650 DEBUG                    Connect closed for Server
16:04:02.649 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:02.700 DEBUG                    Connected to Server
16:04:02.750 DEBUG                    Sending HTTP GET /status_2 message.
16:04:02.750 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:02.823 DEBUG                    HTTP Status: 200 - OK
16:04:02.824 DEBUG                    Connect closed for Server
16:04:02.824 DEBUG                    Connect closed for Server
16:04:03.113 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:822928122002286472327963161174938575226392210098996394184200017401783235770632901966470377100274346087618043422993050291734782923929607533942034961246462124519085302744167442665119096455009094474876313151036858411778350347080697864
|                                                     x = 20885437099331996703006539340665231597605943242867338598137782026169408620769053862228451171119084106864294986392389
|                                                     y = 12869704468780332867612606110377016596502577958263955722659935233864543542156265378018699054278375372729434003474440
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:2988361675633550027447626661937880635456041763363011655441795090728375493521116647161995232214771256897644759523915
|                                                 s = long384:20085999896356365944450961756608846039990132343048622033344629349779111869747009847313508217358486246834868191478058
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112160258Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 12L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x10e6e4d0eac59a19bb71856d26e3f07506fd15f4c9e8cadd43b1313ae3a175a40fd550b2813722326f5f3a02a38badb6)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:29889157271909953165833787425454496948301634213962393272803193933153836779447148535019288748533723329720550026176044
|                                                 s = long384:10129133267464293569324311432582426415263426131767904400358570577293738860630479766253663488466753733674843954544560
16:04:03.115 DEBUG                    IR: Handling Certificate Signing Request.
16:04:03.115 DEBUG                    Generating InfCA certificate (serialNumber: 20002L)
16:04:03.124 DEBUG                    Generating certificate signature for serial: 20002
16:04:03.131 DEBUG                    Creating SKD message file /tmp/infca.resp
16:04:03.134 DEBUG                    Generating message signature using cert with serial: 82303
16:04:03.169 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0x672395202a682b6a-->0x05b98863cae2f8f9-->0xc9020cefbb66368c
|                                             0xb21386b5ea580808-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82303L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112160239Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:793738151991253146917273674451012307919757585635611582277983437767813985404843721941906009554299388030475855009752912988644605088463533613745945452627347435732271230465758245503498440104201796224410704192760994634994900317231393642
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x05b98863cae2f8f9)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x672395202a682b6a)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:32776375667266728396288450250179048612584622664804575944020922242127535073164948799902809659878554376919957367742988
|                                                     s = long384:27830046806434656334834287957332426059065628573487731599353811745556482450030836316708505714898795231380511949097759
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 87492L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112160239Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1134115201334911138138991814623433329236074480751938650307371742155450075681714843347997922282036921080259439753812035138532884902016560749562526274072285608153814138495020447509540704804337755240384938899255914567546857100163610873
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x05b98863cae2f8f9)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:26755382205635119363922263576452150356261810938561849076451426924474641154173259211945963444010598465219668798612991
|                                                     s = long384:21365584714022200196177290456821734296077862875177754285304392883755128549836057452591336065075718344205415080273548
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112160403Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:822928122002286472327963161174938575226392210098996394184200017401783235770632901966470377100274346087618043422993050291734782923929607533942034961246462124519085302744167442665119096455009094474876313151036858411778350347080697864
|                                                         x = 20885437099331996703006539340665231597605943242867338598137782026169408620769053862228451171119084106864294986392389
|                                                         y = 12869704468780332867612606110377016596502577958263955722659935233864543542156265378018699054278375372729434003474440
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xb21386b5ea580808)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:2222270623944945104220078328635327326989799928778769813775189620643594819209013678945840003053916607975242879663076
|                                                     s = long384:31254845804833935265347711419904949629902079004009079474215609131055897777217970555645394220795156370260051930735993
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x672395202a682b6a)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112160403Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 12L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:17554313372211069345491674969728879560298951795536914496150655813640459504348795339759565891059814506713087432627375
|                                                 s = long384:13724024640865637989306883596607128015183959091350520371337159050267945602273166370684118025582138689620303032337089
16:04:04.823 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:04.875 DEBUG                    Connected to Server
16:04:04.924 DEBUG                    Sending HTTP GET /status_2 message.
16:04:04.925 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:05.014 DEBUG                    HTTP Status: 200 - OK
16:04:05.015 DEBUG                    Connect closed for Server
16:04:05.015 DEBUG                    Connect closed for Server
16:04:07.015 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:07.065 DEBUG                    Connected to Server
16:04:07.115 DEBUG                    Sending HTTP GET /status_2 message.
16:04:07.116 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:07.235 DEBUG                    HTTP Status: 200 - OK
16:04:07.235 DEBUG                    Connect closed for Server
16:04:07.236 DEBUG                    Connect closed for Server
16:04:09.236 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:09.287 DEBUG                    Connected to Server
16:04:09.337 DEBUG                    Sending HTTP GET /status_2 message.
16:04:09.338 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:09.450 DEBUG                    HTTP Status: 200 - OK
16:04:09.451 DEBUG                    Connect closed for Server
16:04:09.453 DEBUG                    Connect closed for Server
16:04:11.451 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:11.501 DEBUG                    Connected to Server
16:04:11.551 DEBUG                    Sending HTTP GET /status_2 message.
16:04:11.552 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:11.633 DEBUG                    HTTP Status: 200 - OK
16:04:11.633 DEBUG                    Connect closed for Server
16:04:11.634 DEBUG                    Connect closed for Server
16:04:13.633 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:13.685 DEBUG                    Connected to Server
16:04:13.734 DEBUG                    Sending HTTP GET /status_2 message.
16:04:13.734 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:13.807 DEBUG                    HTTP Status: 200 - OK
16:04:13.807 DEBUG                    Connect closed for Server
16:04:13.813 DEBUG                    Connect closed for Server
16:04:14.981 DEBUG                    cmd optimus > keydir
16:04:15.030 DEBUG                    cmd optimus > keydir /tmp/
16:04:15.807 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:15.858 DEBUG                    Connected to Server
16:04:15.908 DEBUG                    Sending HTTP GET /status_2 message.
16:04:15.909 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:16.021 DEBUG                    HTTP Status: 200 - OK
16:04:16.022 DEBUG                    Connect closed for Server
16:04:16.028 DEBUG                    Connect closed for Server
16:04:18.022 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:18.073 DEBUG                    Connected to Server
16:04:18.136 DEBUG                    Sending HTTP GET /status_2 message.
16:04:18.137 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:18.213 DEBUG                    HTTP Status: 200 - OK
16:04:18.214 DEBUG                    Connect closed for Server
16:04:18.214 DEBUG                    Connect closed for Server
16:04:20.214 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:20.265 DEBUG                    Connected to Server
16:04:20.315 DEBUG                    Sending HTTP GET /status_2 message.
16:04:20.321 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:20.437 DEBUG                    HTTP Status: 200 - OK
16:04:20.438 DEBUG                    Connect closed for Server
16:04:20.438 DEBUG                    Connect closed for Server
16:04:22.439 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:22.490 DEBUG                    Connected to Server
16:04:22.540 DEBUG                    Sending HTTP GET /status_2 message.
16:04:22.540 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:22.613 DEBUG                    HTTP Status: 200 - OK
16:04:22.614 DEBUG                    Connect closed for Server
16:04:22.614 DEBUG                    Connect closed for Server
16:04:24.614 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:24.665 DEBUG                    Connected to Server
16:04:24.714 DEBUG                    Sending HTTP GET /status_2 message.
16:04:24.715 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:24.789 DEBUG                    HTTP Status: 200 - OK
16:04:24.790 DEBUG                    Connect closed for Server
16:04:24.790 DEBUG                    Connect closed for Server
16:04:26.789 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:26.840 DEBUG                    Connected to Server
16:04:26.890 DEBUG                    Sending HTTP GET /status_2 message.
16:04:26.890 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:27.023 DEBUG                    HTTP Status: 200 - OK
16:04:27.025 DEBUG                    Connect closed for Server
16:04:27.025 DEBUG                    Connect closed for Server
16:04:29.025 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:29.076 DEBUG                    Connected to Server
16:04:29.125 DEBUG                    Sending HTTP GET /status_2 message.
16:04:29.126 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:29.228 DEBUG                    HTTP Status: 200 - OK
16:04:29.229 DEBUG                    Connect closed for Server
16:04:29.230 DEBUG                    Connect closed for Server
16:04:31.229 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:31.281 DEBUG                    Connected to Server
16:04:31.330 DEBUG                    Sending HTTP GET /status_2 message.
16:04:31.331 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:31.389 DEBUG                    HTTP Status: 200 - OK
16:04:31.390 DEBUG                    Connect closed for Server
16:04:31.390 DEBUG                    Connect closed for Server
16:04:31.650 DEBUG                    cmd optimus > keydir ../Keys/
16:04:31.769 DEBUG                    Received SKD message:
|                                     KeyPackageFile:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = List:
|                                             [0]:
|                                                 OneAsymmetricKey:
|                                                     version == 0
|                                                     privateKeyAlgorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     privateKey = ECPrivateKey:
|                                                         version = 1L
|                                                         privateKey = Octets(0xabf489b4afa7e9c464625aa8b2bde31328bc47dcab5498be6db068a9e01c45315ec013a088b836d8653beb3c0aac3f0d)
|                                                     attributes:
|                                                       [0] = UserCertificateAttr:
|                                                         id == OID(userCertificate:2.5.4.36)
|                                                         userCertificate = Certificate:
|                                                             tbsCertificate = TBSCertificate:
|                                                                 version == 2
|                                                                 serialNumber = 17L
|                                                                 signatureAlgorithmID = AlgorithmIdentifier:
|                                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                 issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 validity = 170112000000Z..99991231235959Z
|                                                                 subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                     algorithm = AlgorithmIdentifier:
|                                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                         parameters = ECParameters:
|                                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                     subjectPublicKey = long768:1079547668490149712666076215600108425161045555552380422319312451454872306410284713045336728242804447548408560486309459868812124401761074137614926011627497466144408543985549114105110592535989603408306992074112608372568342443854110571
|                                                                     x = 27398291932377159612149635485147795963150322971409561960841870672164651381534315915488442454142569734561781992666256
|                                                                     y = 34457005090013567667885226330046146256578688369693420240545766785560460515556052826056733742958486843820476524109675
|                                                                 _extensions = CertificateExtensions
|                                                                   [0] AuthorityKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                         keyIdentifier = Octets(0x54fb47ae7e039f6b)
|                                                                   [1] SubjectKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                         id = Octets(0x54fb47ae7e039f6b)
|                                                                   [2] KeyUsage_CertExt:
|                                                                         extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                         critical = True
|                                                                         uses = ['digitalSignature']
|                                                                   [3] CertificatePolicies_CertExt:
|                                                                         extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                         critical = True
|                                                                         policies:
|                                                                           [0] = PolicyInformation:
|                                                                             id = OID(1.2.826.0.1145.0.1.0.3)
|                                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                             signature = Signature:
|                                                                 r = long384:33629666898654933776940765417793733341356977077056932945735648131736313390329470529235979009858688221036318665265377
|                                                                 s = long384:21539273601773262184298901706884791480066317391785248589765481417466061853823533895631329796814639553774752362469370
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                               [1] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0xe0244beadd3efd2d20c56e43a5e7eb457651964c9d0bd4d9ef61a059be4279adcd1db3d7bf67ea97d7d3ecf370d825d2)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:18152037844994694182408942534306440743770051542395038204638061144490264329889189677453562370501634266068582436415832
|                                                 s = long384:5022879012344909679683992347663238639838209218877214925362781228620067744930210852755394979732912797446996130858629
16:04:31.769 DEBUG                    Added keymat FACT-IA: serial=17 auth=0x54fb47ae7e039f6b subj=0x54fb47ae7e039f6b
16:04:31.770 DEBUG                    UUT Control: Applying all recent configuration changes
16:04:31.793 INFO    Test:            126 : [icm-issue-infia-mckm-invalid-esn] The MCKM
|                                           sends a CSR for an InfIA certificate with an
|                                           out of range serial number to the ICM and
|                                           receives a error response.
16:04:31.804 DEBUG                          MCKM requesting Inf IA from ICM.
16:04:31.812 INFO                           SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
16:04:31.857 DEBUG                          Generating message signature using cert with serial: 17
16:04:31.889 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF99999AA,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:793489357430809529545269169590591084496241156507784493592658582578820896549385433510823616938485950571851307555431560290030673657248436187591516757850427475503414485780859034494051439280162832762831295341234264729738003424980129128
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.7
|                                                                             [1] = 1.2.826.0.1145.0.10.6
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:11275226248792463978561268154530078265990792658633647398771063442544637587375019377555277378973580979630014751786609
|                                                       s = long384:4010503241545956433192045357814146193096896655200817866036601649887355206172230354031580038069388671547037729617374
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x54fb47ae7e039f6b-->0x54fb47ae7e039f6b
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 17L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1079547668490149712666076215600108425161045555552380422319312451454872306410284713045336728242804447548408560486309459868812124401761074137614926011627497466144408543985549114105110592535989603408306992074112608372568342443854110571
|                                                               x = 27398291932377159612149635485147795963150322971409561960841870672164651381534315915488442454142569734561781992666256
|                                                               y = 34457005090013567667885226330046146256578688369693420240545766785560460515556052826056733742958486843820476524109675
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x54fb47ae7e039f6b)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x54fb47ae7e039f6b)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:33629666898654933776940765417793733341356977077056932945735648131736313390329470529235979009858688221036318665265377
|                                                           s = long384:21539273601773262184298901706884791480066317391785248589765481417466061853823533895631329796814639553774752362469370
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x54fb47ae7e039f6b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112160431Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x88283853d53095c400971c1c66801749a18e7d039c21422c7d2c25a5969393e03da339b04cd93b4fbb97f737504a7164)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x5f75adf4aab7c7e0)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:36298996298911921966480457632902397189351331169857602168486305710630875354244587475547617764313734266228624205822135
|                                                       s = long384:14497448646385191647910209107497797215256382663481581524543785071686015300539277688616701182732977874348164562823245
16:04:31.909 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:31.910 INFO                           SKD: Client ---> Server CMC-request (1341 bytes)
16:04:31.910 INFO                           Sent CSR for Inf IA certificate.
16:04:31.960 DEBUG                          Connected to Server
16:04:32.011 DEBUG                          Sending HTTP POST /fullcmc message.
16:04:32.012 DEBUG                          Removing HTTP POST /fullcmc message from Q.
16:04:32.219 DEBUG                          HTTP Status: 200 - OK
16:04:32.220 INFO                           SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (1765 bytes)
16:04:32.363 DEBUG                          Received SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = Integer(1)
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = Integer(2)
|                                                           otherInfo = OtherStatusInfo:
|                                                               failInfo = Integer(2)
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                               x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                               y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1de6a414dda88f8b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                           s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 82825L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                               x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                               y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2eb4fc66f0202ec8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                           s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112160432Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x5f75adf4aab7c7e0)
|                                                           msgCount = 1L
|                                                     [4] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=,CN=
|                                                     [5] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xa398ffd4f2bd9a659ddc4da37aa54c2932303954638e852702d71cd1596bc4938e47fc0a9368ac931413a36a58a68d9b)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:19406786008958309750047956876045471610520375703323135106552186997405164337914391198886741651430619059241546210126071
|                                                       s = long384:24157086391511398428200391391407441778074559978879115935454093033556654489350089906245571642753422868518883082078215
16:04:32.363 INFO                           MCKM: Handling incoming CertificateSigningResponse
16:04:32.365 DEBUG                          Connect closed for Server
16:04:32.369 INFO                           #> 0.1. Check request is displayed with correct status
16:04:32.373 DEBUG                          Connect closed for Server
16:04:33.391 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:33.442 DEBUG                          Connected to Server
16:04:33.492 DEBUG                          Sending HTTP GET /status_2 message.
16:04:33.493 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:04:33.620 DEBUG                          HTTP Status: 200 - OK
16:04:33.621 DEBUG                          Connect closed for Server
16:04:33.621 DEBUG                          Connect closed for Server
16:04:35.620 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:35.672 DEBUG                          Connected to Server
16:04:35.722 DEBUG                          Sending HTTP GET /status_2 message.
16:04:35.723 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:04:35.733 INFO                           #> 1. Check an error was received.
16:04:35.751 INFO    Test:                  PASS
16:04:35.912 DEBUG                    Tearing down mock HTTP servers
16:04:35.914 DEBUG                    Connect closed for Server
16:04:35.915 DEBUG                    HTTP Status: 200 - OK
16:04:35.916 DEBUG                    Connect closed for Server
16:04:35.916 DEBUG                    Connect closed for Server
16:04:35.916 DEBUG                    Connect closed for Server
16:04:37.918 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:37.974 DEBUG                    Connected to Server
16:04:38.024 DEBUG                    Sending HTTP GET /status_2 message.
16:04:38.024 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:38.202 DEBUG                    HTTP Status: 200 - OK
16:04:38.203 DEBUG                    Connect closed for Server
16:04:38.203 DEBUG                    Connect closed for Server
16:04:40.203 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:40.253 DEBUG                    Connected to Server
16:04:40.303 DEBUG                    Sending HTTP GET /status_2 message.
16:04:40.304 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:40.424 DEBUG                    HTTP Status: 200 - OK
16:04:40.425 DEBUG                    Connect closed for Server
16:04:40.425 DEBUG                    Connect closed for Server
16:04:42.425 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:42.479 DEBUG                    Connected to Server
16:04:42.527 DEBUG                    Sending HTTP GET /status_2 message.
16:04:42.528 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:42.587 DEBUG                    HTTP Status: 200 - OK
16:04:42.587 DEBUG                    Connect closed for Server
16:04:42.587 DEBUG                    Connect closed for Server
16:04:44.587 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:44.638 DEBUG                    Connected to Server
16:04:44.688 DEBUG                    Sending HTTP GET /status_2 message.
16:04:44.693 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:44.848 DEBUG                    HTTP Status: 200 - OK
16:04:44.849 DEBUG                    Connect closed for Server
16:04:44.850 DEBUG                    Connect closed for Server
16:04:45.080 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:04:45.081 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:04:45.093 DEBUG                    Generating certificate signature for serial: 81063
16:04:45.098 DEBUG                    Added keymat IR-INF-CA: serial=81063 auth=0xc9020cefbb66368c subj=0x8810f7fab46bf7d5
16:04:45.110 DEBUG                    Generating certificate signature for serial: 88412
16:04:45.116 DEBUG                    Added keymat IR-INF-IA: serial=88412 auth=0x8810f7fab46bf7d5 subj=0x43da90638f16dc37
16:04:45.128 DEBUG                    Generating certificate signature for serial: 89473
16:04:45.134 DEBUG                    Added keymat IR-INF-CRL-CA: serial=89473 auth=0xc9020cefbb66368c subj=0x44149d81a987b0de
16:04:45.147 DEBUG                    Generating certificate signature for serial: 86383
16:04:45.152 DEBUG                    Added keymat IR-INF-CRL-IA: serial=86383 auth=0x44149d81a987b0de subj=0x0977fde312dd7b77
16:04:45.163 DEBUG                    Generating certificate signature for serial: 5
16:04:45.169 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x005204b970e4f85c subj=0x005204b970e4f85c
16:04:45.177 DEBUG                    Generating message signature using cert with serial: 88412
16:04:45.212 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:04:45.263 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x005204b970e4f85c subj=0x005204b970e4f85c
16:04:45.270 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:04:45.287 DEBUG                    Generating message signature using cert with serial: 5
16:04:45.353 DEBUG                    IR: Handling Certificate Signing Request.
16:04:45.353 DEBUG                    Creating temporary CA cert to issue IA
16:04:45.366 DEBUG                    Generating certificate signature for serial: 89008
16:04:45.372 DEBUG                    Added keymat IR-INF-CA-TMP: serial=89008 auth=0xc9020cefbb66368c subj=0x47f98dff339b117a
16:04:45.373 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:04:45.380 DEBUG                    Generating certificate signature for serial: 20000
16:04:45.387 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:04:45.392 DEBUG                    Generating message signature using cert with serial: 88412
16:04:45.532 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:04:45.533 DEBUG                    Received Inf IA response
16:04:45.533 DEBUG                    Added keymat IR-INF-CA: serial=89008 auth=0xc9020cefbb66368c subj=0x47f98dff339b117a
16:04:45.533 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x47f98dff339b117a subj=0xd25b1757e0fcf823
16:04:45.545 DEBUG                    Generating certificate signature for serial: 5
16:04:45.551 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xef9189716b6b9650 subj=0xef9189716b6b9650
16:04:45.561 DEBUG                    Generating message signature using cert with serial: 20000
16:04:45.601 DEBUG                    Creating SKD message file /tmp/icmCaReq
16:04:45.628 DEBUG                    Generating message signature using cert with serial: 20000
16:04:45.747 DEBUG                    IR: Handling Certificate Signing Request.
16:04:45.747 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
16:04:45.754 DEBUG                    Generating certificate signature for serial: 20001
16:04:45.761 DEBUG                    Creating SKD message file /tmp/icmCaResp
16:04:45.765 DEBUG                    Generating message signature using cert with serial: 88412
16:04:45.873 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:04:45.874 DEBUG                    Received Inf CA response
16:04:45.874 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xe58a7fa954952a59
16:04:45.874 INFO                     Listening for ('128.10.1.4', 80)
16:04:45.879 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:04:45.883 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:04:45.883 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:04:45.935 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xef9189716b6b9650 subj=0xef9189716b6b9650
16:04:45.941 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:04:45.959 DEBUG                    Generating message signature using cert with serial: 5
16:04:46.019 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:04:46.026 DEBUG                    Generating certificate signature for serial: 20000
16:04:46.033 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:04:46.036 DEBUG                    Generating message signature using cert with serial: 20000
16:04:46.157 DEBUG                    Received Inf IA response
16:04:46.158 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xe58a7fa954952a59
16:04:46.158 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0xe58a7fa954952a59 subj=0x9524977e11ca988a
16:04:46.166 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:04:46.172 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:04:46.243 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xef9189716b6b9650 subj=0xef9189716b6b9650
16:04:46.243 INFO                     Listening for ('128.10.1.6', 80)
16:04:46.243 DEBUG                    MCKM requesting Inf IA from ICM.
16:04:46.249 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
16:04:46.266 DEBUG                    Generating message signature using cert with serial: 5
16:04:46.300 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:04:46.300 INFO                     SKD: Client ---> Server CMC-request (1342 bytes)
16:04:46.301 INFO                     Sent CSR for Inf IA certificate.
16:04:46.302 DEBUG                    112132432: Connect accepted from Client
16:04:46.351 DEBUG                    Connected to Server
16:04:46.401 DEBUG                    Sending HTTP POST /fullcmc message.
16:04:46.402 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:04:46.455 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:04:46.455 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
16:04:46.463 DEBUG                    Generating certificate signature for serial: 20001
16:04:46.472 DEBUG                    Generating message signature using cert with serial: 20000
16:04:46.538 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:04:46.540 DEBUG                    HTTP Status: 200 - OK
16:04:46.540 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3139 bytes)
16:04:46.611 INFO                     MCKM: Handling incoming CertificateSigningResponse
16:04:46.611 DEBUG                    Received Inf IA response
16:04:46.612 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xe58a7fa954952a59
16:04:46.612 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0xe58a7fa954952a59 subj=0xf89703e3a4484677
16:04:46.849 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:46.900 DEBUG                    Connected to Server
16:04:46.951 DEBUG                    Sending HTTP GET /status_2 message.
16:04:46.951 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:46.991 DEBUG                    HTTP Status: 200 - OK
16:04:46.991 DEBUG                    Connect closed for Server
16:04:46.992 DEBUG                    Connect closed for Server
16:04:48.309 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:04:48.383 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xef9189716b6b9650 subj=0xef9189716b6b9650
16:04:48.383 DEBUG                    CKA requesting Inf IA from ICM.
16:04:48.389 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
16:04:48.406 DEBUG                    Generating message signature using cert with serial: 5
16:04:48.425 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:04:48.425 INFO                     SKD: Client ---> Server CMC-request (1331 bytes)
16:04:48.425 INFO                     Sent CSR for Inf IA certificate.
16:04:48.426 DEBUG                    112132432: Connect accepted from Client
16:04:48.426 DEBUG                    Connect closed for Server
16:04:48.427 DEBUG                    Connect closed for Server
16:04:48.476 DEBUG                    Connected to Server
16:04:48.526 DEBUG                    Sending HTTP POST /fullcmc message.
16:04:48.526 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:04:48.595 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:04:48.596 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
16:04:48.608 DEBUG                    Generating certificate signature for serial: 20002
16:04:48.618 DEBUG                    Generating message signature using cert with serial: 20000
16:04:48.696 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:04:48.697 DEBUG                    HTTP Status: 200 - OK
16:04:48.697 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3128 bytes)
16:04:48.771 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
16:04:48.772 DEBUG                    Received Inf IA response
16:04:48.772 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xe58a7fa954952a59
16:04:48.772 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0xe58a7fa954952a59 subj=0x41521f1e46e8b9ba
16:04:48.993 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:49.044 DEBUG                    Connected to Server
16:04:49.095 DEBUG                    Sending HTTP GET /status_2 message.
16:04:49.095 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:49.190 DEBUG                    HTTP Status: 200 - OK
16:04:49.191 DEBUG                    Connect closed for Server
16:04:49.191 DEBUG                    Connect closed for Server
16:04:51.191 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:51.242 DEBUG                    Connected to Server
16:04:51.293 DEBUG                    Sending HTTP GET /status_2 message.
16:04:51.294 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:51.389 DEBUG                    HTTP Status: 200 - OK
16:04:51.390 DEBUG                    Connect closed for Server
16:04:51.391 DEBUG                    Connect closed for Server
16:04:52.630 DEBUG                    ########## Mocks complete ##########
16:04:53.390 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:53.445 DEBUG                    Connected to Server
16:04:53.494 DEBUG                    Sending HTTP GET /status_2 message.
16:04:53.495 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:53.610 DEBUG                    HTTP Status: 200 - OK
16:04:53.611 DEBUG                    Connect closed for Server
16:04:53.612 DEBUG                    Connect closed for Server
16:04:53.928 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:04:53.929 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:04:55.170 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:04:55.171 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:04:55.611 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:55.662 DEBUG                    Connected to Server
16:04:55.712 DEBUG                    Sending HTTP GET /status_2 message.
16:04:55.712 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:55.841 DEBUG                    HTTP Status: 200 - OK
16:04:55.842 DEBUG                    Connect closed for Server
16:04:55.842 DEBUG                    Connect closed for Server
16:04:57.841 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:04:57.892 DEBUG                    Connected to Server
16:04:57.944 DEBUG                    Sending HTTP GET /status_2 message.
16:04:57.944 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:04:57.989 DEBUG                    HTTP Status: 200 - OK
16:04:57.990 DEBUG                    Connect closed for Server
16:04:57.996 DEBUG                    Connect closed for Server
16:04:59.990 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:00.040 DEBUG                    Connected to Server
16:05:00.090 DEBUG                    Sending HTTP GET /status_2 message.
16:05:00.091 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:00.196 DEBUG                    HTTP Status: 200 - OK
16:05:00.196 DEBUG                    Connect closed for Server
16:05:00.204 DEBUG                    Connect closed for Server
16:05:02.200 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:02.251 DEBUG                    Connected to Server
16:05:02.301 DEBUG                    Sending HTTP GET /status_2 message.
16:05:02.302 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:02.417 DEBUG                    HTTP Status: 200 - OK
16:05:02.417 DEBUG                    Connect closed for Server
16:05:02.418 DEBUG                    Connect closed for Server
16:05:04.418 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:04.468 DEBUG                    Connected to Server
16:05:04.518 DEBUG                    Sending HTTP GET /status_2 message.
16:05:04.519 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:11.009 DEBUG                    HTTP Status: 200 - OK
16:05:11.010 DEBUG                    Connect closed for Server
16:05:11.011 DEBUG                    Connect closed for Server
16:05:13.010 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:13.061 DEBUG                    Connected to Server
16:05:13.110 DEBUG                    Sending HTTP GET /status_2 message.
16:05:13.111 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:13.211 DEBUG                    HTTP Status: 200 - OK
16:05:13.211 DEBUG                    Connect closed for Server
16:05:13.212 DEBUG                    Connect closed for Server
16:05:15.211 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:15.262 DEBUG                    Connected to Server
16:05:15.312 DEBUG                    Sending HTTP GET /status_2 message.
16:05:15.313 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:15.482 DEBUG                    HTTP Status: 200 - OK
16:05:15.483 DEBUG                    Connect closed for Server
16:05:15.484 DEBUG                    Connect closed for Server
16:05:17.483 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:17.534 DEBUG                    Connected to Server
16:05:17.584 DEBUG                    Sending HTTP GET /status_2 message.
16:05:17.584 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:17.719 DEBUG                    HTTP Status: 200 - OK
16:05:17.720 DEBUG                    Connect closed for Server
16:05:17.720 DEBUG                    Connect closed for Server
16:05:19.720 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:19.770 DEBUG                    Connected to Server
16:05:19.820 DEBUG                    Sending HTTP GET /status_2 message.
16:05:19.821 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:19.913 DEBUG                    HTTP Status: 200 - OK
16:05:19.914 DEBUG                    Connect closed for Server
16:05:19.914 DEBUG                    Connect closed for Server
16:05:21.913 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:21.965 DEBUG                    Connected to Server
16:05:22.014 DEBUG                    Sending HTTP GET /status_2 message.
16:05:22.014 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:22.113 DEBUG                    HTTP Status: 200 - OK
16:05:22.113 DEBUG                    Connect closed for Server
16:05:22.114 DEBUG                    Connect closed for Server
16:05:24.113 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:24.164 DEBUG                    Connected to Server
16:05:24.214 DEBUG                    Sending HTTP GET /status_2 message.
16:05:24.215 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:24.301 DEBUG                    HTTP Status: 200 - OK
16:05:24.301 DEBUG                    Connect closed for Server
16:05:24.302 DEBUG                    Connect closed for Server
16:05:26.301 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:26.352 DEBUG                    Connected to Server
16:05:26.402 DEBUG                    Sending HTTP GET /status_2 message.
16:05:26.402 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:26.522 DEBUG                    HTTP Status: 200 - OK
16:05:26.522 DEBUG                    Connect closed for Server
16:05:26.523 DEBUG                    Connect closed for Server
16:05:28.522 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:28.573 DEBUG                    Connected to Server
16:05:28.624 DEBUG                    Sending HTTP GET /status_2 message.
16:05:28.624 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:28.752 DEBUG                    HTTP Status: 200 - OK
16:05:28.752 DEBUG                    Connect closed for Server
16:05:28.753 DEBUG                    Connect closed for Server
16:05:30.752 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:30.804 DEBUG                    Connected to Server
16:05:30.853 DEBUG                    Sending HTTP GET /status_2 message.
16:05:30.853 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:30.936 DEBUG                    HTTP Status: 200 - OK
16:05:30.937 DEBUG                    Connect closed for Server
16:05:30.937 DEBUG                    Connect closed for Server
16:05:32.937 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:32.987 DEBUG                    Connected to Server
16:05:33.037 DEBUG                    Sending HTTP GET /status_2 message.
16:05:33.038 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:33.090 DEBUG                    HTTP Status: 200 - OK
16:05:33.090 DEBUG                    Connect closed for Server
16:05:33.091 DEBUG                    Connect closed for Server
16:05:35.090 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:35.141 DEBUG                    Connected to Server
16:05:35.191 DEBUG                    Sending HTTP GET /status_2 message.
16:05:35.192 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:35.353 DEBUG                    HTTP Status: 200 - OK
16:05:35.354 DEBUG                    Connect closed for Server
16:05:35.354 DEBUG                    Connect closed for Server
16:05:37.354 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:37.405 DEBUG                    Connected to Server
16:05:37.455 DEBUG                    Sending HTTP GET /status_2 message.
16:05:37.455 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:37.533 DEBUG                    HTTP Status: 200 - OK
16:05:37.534 DEBUG                    Connect closed for Server
16:05:37.534 DEBUG                    Connect closed for Server
16:05:39.535 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:39.586 DEBUG                    Connected to Server
16:05:39.636 DEBUG                    Sending HTTP GET /status_2 message.
16:05:39.636 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:39.705 DEBUG                    HTTP Status: 200 - OK
16:05:39.706 DEBUG                    Connect closed for Server
16:05:39.706 DEBUG                    Connect closed for Server
16:05:41.706 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:41.756 DEBUG                    Connected to Server
16:05:41.807 DEBUG                    Sending HTTP GET /status_2 message.
16:05:41.807 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:41.901 DEBUG                    HTTP Status: 200 - OK
16:05:41.902 DEBUG                    Connect closed for Server
16:05:41.902 DEBUG                    Connect closed for Server
16:05:43.902 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:43.953 DEBUG                    Connected to Server
16:05:44.003 DEBUG                    Sending HTTP GET /status_2 message.
16:05:44.003 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:44.130 DEBUG                    HTTP Status: 200 - OK
16:05:44.131 DEBUG                    Connect closed for Server
16:05:44.131 DEBUG                    Connect closed for Server
16:05:46.131 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:46.182 DEBUG                    Connected to Server
16:05:46.232 DEBUG                    Sending HTTP GET /status_2 message.
16:05:46.232 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:46.301 DEBUG                    HTTP Status: 200 - OK
16:05:46.302 DEBUG                    Connect closed for Server
16:05:46.302 DEBUG                    Connect closed for Server
16:05:48.301 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:48.352 DEBUG                    Connected to Server
16:05:48.402 DEBUG                    Sending HTTP GET /status_2 message.
16:05:48.403 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:48.542 DEBUG                    HTTP Status: 200 - OK
16:05:48.544 DEBUG                    Connect closed for Server
16:05:48.544 DEBUG                    Connect closed for Server
16:05:50.544 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:50.595 DEBUG                    Connected to Server
16:05:50.645 DEBUG                    Sending HTTP GET /status_2 message.
16:05:50.645 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:50.731 DEBUG                    HTTP Status: 200 - OK
16:05:50.732 DEBUG                    Connect closed for Server
16:05:50.733 DEBUG                    Connect closed for Server
16:05:52.732 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:52.783 DEBUG                    Connected to Server
16:05:52.832 DEBUG                    Sending HTTP GET /status_2 message.
16:05:52.833 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:52.942 DEBUG                    HTTP Status: 200 - OK
16:05:52.949 DEBUG                    Connect closed for Server
16:05:52.950 DEBUG                    Connect closed for Server
16:05:53.623 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:365063396891401095094946363923358632444487759949810453679084476288694415827769731500130658827995946109079678760473363397568204037728438321743520667319389211711509675697158029588886177897976376878872917754717734016623871372728460235
|                                                     x = 9265096682432545624636275705033438827146225474595587683130894786084382574231575293555055375515646927293585743003680
|                                                     y = 2880794141469707178863379920807687286035360498548930312570158437353835145237010145435668310789045200107044111377355
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:10123573053835316490880056100277968718443105328721623498559688668095407150091896097935807107038440069366534394953195
|                                                 s = long384:30610428506430030597648122649750848052772468367721337949801108726815563243969345730860958384246268990759088665352252
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112160501Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 13L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x0d4343ee94283dad5b701a51a7fb7a2df05c030515e74a6c143a43df409ed14bdad7e4b71843d8d455079a89e3d69f7f)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:4603163783485907763802200915388374630807389437833936068550737816361703525092059048030565623283382554311232857460818
|                                                 s = long384:37824013162320971263970032855979948945500088809694793449235696871039616031708774542506857585900412840596180325826082
16:05:53.624 DEBUG                    IR: Handling Certificate Signing Request.
16:05:53.625 DEBUG                    Generating InfCA certificate (serialNumber: 20002L)
16:05:53.632 DEBUG                    Generating certificate signature for serial: 20002
16:05:53.638 DEBUG                    Creating SKD message file /tmp/infca.resp
16:05:53.641 DEBUG                    Generating message signature using cert with serial: 88412
16:05:53.673 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0x43da90638f16dc37-->0x8810f7fab46bf7d5-->0xc9020cefbb66368c
|                                             0x9fd3883a8703e3cb-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 88412L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112160445Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:951426019468576720963006162471004310616089620912444755444358643470867604915986317226948156701204190145373641731360345726065641543260371211586481838452448278740046477774306213794273818524557130761001385549551765788995947677229702199
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x8810f7fab46bf7d5)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x43da90638f16dc37)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:37842131900566315500931334826097814835349471711636464382232616740953041633299797810344002814663739577227545067782790
|                                                     s = long384:13660955481359554301660927897653957181300690774402574699200275092343022818002875053546485749395552739703994080804747
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 81063L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112160445Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1016353990026428210082131757701981105011607801180370791914220401650259451577535032743025500063113440874765543463893789734406926541592253739102733601453318100384132714222237733235923891883500067110290686495226947509624358606060910549
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x8810f7fab46bf7d5)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:31378487892152519082319560009643545674296191085102468719025340030710057191841074457589554682278258500519181935711053
|                                                     s = long384:36332431364818536573391723335947941437625937809259631892751421689302698487230889576854096217140265540904727038795654
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112160553Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:365063396891401095094946363923358632444487759949810453679084476288694415827769731500130658827995946109079678760473363397568204037728438321743520667319389211711509675697158029588886177897976376878872917754717734016623871372728460235
|                                                         x = 9265096682432545624636275705033438827146225474595587683130894786084382574231575293555055375515646927293585743003680
|                                                         y = 2880794141469707178863379920807687286035360498548930312570158437353835145237010145435668310789045200107044111377355
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x9fd3883a8703e3cb)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:15237448025798618001184686127291352750117365287117757700480435960749443643914347326869465541621538262256532190251084
|                                                     s = long384:33525428609092895689636579920545751358916593363298443775272957323818304808646029935373743422725719431782523509260498
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x43da90638f16dc37)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112160553Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 13L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:5681197721656296807689398747514405184730635084022599879782875942881995709436747206599475644460541813070239161810968
|                                                 s = long384:21554493432455898558881976546994798523027470663406510655306813531868332625507821013082515081336006080248209575999444
16:05:54.943 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:54.993 DEBUG                    Connected to Server
16:05:55.043 DEBUG                    Sending HTTP GET /status_2 message.
16:05:55.044 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:55.094 DEBUG                    HTTP Status: 200 - OK
16:05:55.095 DEBUG                    Connect closed for Server
16:05:55.095 DEBUG                    Connect closed for Server
16:05:57.094 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:57.145 DEBUG                    Connected to Server
16:05:57.195 DEBUG                    Sending HTTP GET /status_2 message.
16:05:57.196 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:57.308 DEBUG                    HTTP Status: 200 - OK
16:05:57.309 DEBUG                    Connect closed for Server
16:05:57.310 DEBUG                    Connect closed for Server
16:05:59.309 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:05:59.360 DEBUG                    Connected to Server
16:05:59.409 DEBUG                    Sending HTTP GET /status_2 message.
16:05:59.410 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:05:59.497 DEBUG                    HTTP Status: 200 - OK
16:05:59.498 DEBUG                    Connect closed for Server
16:05:59.498 DEBUG                    Connect closed for Server
16:06:01.498 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:01.549 DEBUG                    Connected to Server
16:06:01.603 DEBUG                    Sending HTTP GET /status_2 message.
16:06:01.605 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:01.699 DEBUG                    HTTP Status: 200 - OK
16:06:01.700 DEBUG                    Connect closed for Server
16:06:01.708 DEBUG                    Connect closed for Server
16:06:03.699 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:03.750 DEBUG                    Connected to Server
16:06:03.800 DEBUG                    Sending HTTP GET /status_2 message.
16:06:03.801 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:03.912 DEBUG                    HTTP Status: 200 - OK
16:06:03.913 DEBUG                    Connect closed for Server
16:06:03.913 DEBUG                    Connect closed for Server
16:06:04.285 DEBUG                    cmd optimus > keydir
16:06:04.336 DEBUG                    cmd optimus > keydir /tmp/
16:06:05.913 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:05.964 DEBUG                    Connected to Server
16:06:06.014 DEBUG                    Sending HTTP GET /status_2 message.
16:06:06.016 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:06.095 DEBUG                    HTTP Status: 200 - OK
16:06:06.095 DEBUG                    Connect closed for Server
16:06:06.095 DEBUG                    Connect closed for Server
16:06:08.095 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:08.146 DEBUG                    Connected to Server
16:06:08.196 DEBUG                    Sending HTTP GET /status_2 message.
16:06:08.196 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:08.296 DEBUG                    HTTP Status: 200 - OK
16:06:08.297 DEBUG                    Connect closed for Server
16:06:08.304 DEBUG                    Connect closed for Server
16:06:10.304 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:10.364 DEBUG                    Connected to Server
16:06:10.404 DEBUG                    Sending HTTP GET /status_2 message.
16:06:10.405 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:10.539 DEBUG                    HTTP Status: 200 - OK
16:06:10.540 DEBUG                    Connect closed for Server
16:06:10.540 DEBUG                    Connect closed for Server
16:06:12.540 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:12.591 DEBUG                    Connected to Server
16:06:12.641 DEBUG                    Sending HTTP GET /status_2 message.
16:06:12.641 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:12.696 DEBUG                    HTTP Status: 200 - OK
16:06:12.696 DEBUG                    Connect closed for Server
16:06:12.697 DEBUG                    Connect closed for Server
16:06:14.697 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:14.747 DEBUG                    Connected to Server
16:06:14.797 DEBUG                    Sending HTTP GET /status_2 message.
16:06:14.798 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:14.893 DEBUG                    HTTP Status: 200 - OK
16:06:14.894 DEBUG                    Connect closed for Server
16:06:14.895 DEBUG                    Connect closed for Server
16:06:16.894 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:16.945 DEBUG                    Connected to Server
16:06:16.995 DEBUG                    Sending HTTP GET /status_2 message.
16:06:16.996 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:17.119 DEBUG                    HTTP Status: 200 - OK
16:06:17.120 DEBUG                    Connect closed for Server
16:06:17.121 DEBUG                    Connect closed for Server
16:06:19.119 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:19.170 DEBUG                    Connected to Server
16:06:19.220 DEBUG                    Sending HTTP GET /status_2 message.
16:06:19.221 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:19.288 DEBUG                    HTTP Status: 200 - OK
16:06:19.289 DEBUG                    Connect closed for Server
16:06:19.289 DEBUG                    Connect closed for Server
16:06:19.632 DEBUG                    cmd optimus > keydir ../Keys/
16:06:19.751 DEBUG                    Received SKD message:
|                                     KeyPackageFile:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = List:
|                                             [0]:
|                                                 OneAsymmetricKey:
|                                                     version == 0
|                                                     privateKeyAlgorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     privateKey = ECPrivateKey:
|                                                         version = 1L
|                                                         privateKey = Octets(0x4696b23111af0eb32579874484c974025de6c4013ff6b241f452c1bd2034cb8f77cf43c71038df4aa78a620d04c11788)
|                                                     attributes:
|                                                       [0] = UserCertificateAttr:
|                                                         id == OID(userCertificate:2.5.4.36)
|                                                         userCertificate = Certificate:
|                                                             tbsCertificate = TBSCertificate:
|                                                                 version == 2
|                                                                 serialNumber = 18L
|                                                                 signatureAlgorithmID = AlgorithmIdentifier:
|                                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                 issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 validity = 170112000000Z..99991231235959Z
|                                                                 subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                     algorithm = AlgorithmIdentifier:
|                                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                         parameters = ECParameters:
|                                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                     subjectPublicKey = long768:410013912644053874066002162796490076388527576623324210091459878143237047223895961982570194679129235760974896708859948249918448624389615134790763759852004052876364119725163510003871938694193178731746965780319584818036409352589787547
|                                                                     x = 10405914627808281893316755495094006605161858140443088425622583044233450609025264384489793307362552033216831225632500
|                                                                     y = 35934241061811426995252044246613787437188958796995509880362781118673884524637748940976106896872193401166353928667547
|                                                                 _extensions = CertificateExtensions
|                                                                   [0] AuthorityKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                         keyIdentifier = Octets(0x4097c0137925c19b)
|                                                                   [1] SubjectKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                         id = Octets(0x4097c0137925c19b)
|                                                                   [2] KeyUsage_CertExt:
|                                                                         extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                         critical = True
|                                                                         uses = ['digitalSignature']
|                                                                   [3] CertificatePolicies_CertExt:
|                                                                         extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                         critical = True
|                                                                         policies:
|                                                                           [0] = PolicyInformation:
|                                                                             id = OID(1.2.826.0.1145.0.1.0.3)
|                                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                             signature = Signature:
|                                                                 r = long384:27359514544806566386160829095147129613676671216023717751215330517461175229478661069893782820748445867034939647426649
|                                                                 s = long384:1227731102945452040369550787371845409377897333506732856969838942743561158791688813426813786164854111069961054792090
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                               [1] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x0ae03fbef76ae34230171d9cbf0a08198654a2cc7e5ccb151255b6abd517b60acdc5f6c3913b932a6173f82a9ac76eb1)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:33651947884995851040788562917871369252370175563577944476548177748583599034006596353234189822319815007277363741568673
|                                                 s = long384:12036392275862883716582933936716944701393981601397176810691711820749548893698515817838435515224987347042333099171487
16:06:19.752 DEBUG                    Added keymat FACT-IA: serial=18 auth=0x4097c0137925c19b subj=0x4097c0137925c19b
16:06:19.752 DEBUG                    UUT Control: Applying all recent configuration changes
16:06:19.776 INFO    Test:            127 : [icm-issue-infia-mckm-invalid-dev-func] The
|                                           MCKM sends a CSR for an InfIA certificate
|                                           with an invalid DeviceFunction attribute and
|                                           receives a error response.
16:06:19.788 DEBUG                          MCKM requesting Inf IA from ICM.
16:06:19.795 INFO                           SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
16:06:19.835 DEBUG                          Generating message signature using cert with serial: 18
16:06:19.867 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0155000,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:1292716810765241852805016146485772661857052782323424729188883354364091295088000711651978772683032783472861711678977765374717567683172393711790466427650778461515749032547336149893079432843080619189748906021722702202941224225997855285
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.8
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:34101413685151228191538572886413761119528897855121284456832459342132861823292058511489610354556676734146639364983080
|                                                       s = long384:261859937045679055801465524133650672990677071927023163379182290919600523126504732240525889397876736390030928462981
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x4097c0137925c19b-->0x4097c0137925c19b
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 18L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:410013912644053874066002162796490076388527576623324210091459878143237047223895961982570194679129235760974896708859948249918448624389615134790763759852004052876364119725163510003871938694193178731746965780319584818036409352589787547
|                                                               x = 10405914627808281893316755495094006605161858140443088425622583044233450609025264384489793307362552033216831225632500
|                                                               y = 35934241061811426995252044246613787437188958796995509880362781118673884524637748940976106896872193401166353928667547
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x4097c0137925c19b)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x4097c0137925c19b)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:27359514544806566386160829095147129613676671216023717751215330517461175229478661069893782820748445867034939647426649
|                                                           s = long384:1227731102945452040369550787371845409377897333506732856969838942743561158791688813426813786164854111069961054792090
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x4097c0137925c19b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112160619Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xd7e716b3331a3bcc798f3ee28f5e810e6286f867467c6a539bea7fdbb1b0439cc877372a448bb34c3872c5769aaf5c1c)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x3fba5d680795d17f)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:21550517622226061630979531856483992247797233236375795905136768519647720226120344368163543801412802240147513960611550
|                                                       s = long384:34756486196240027692899554384322216159383958603170353206389469915154443171643347227165594164670050045748688992076775
16:06:19.888 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:19.889 INFO                           SKD: Client ---> Server CMC-request (1330 bytes)
16:06:19.889 INFO                           Sent CSR for Inf IA certificate.
16:06:19.939 DEBUG                          Connected to Server
16:06:19.989 DEBUG                          Sending HTTP POST /fullcmc message.
16:06:19.990 DEBUG                          Removing HTTP POST /fullcmc message from Q.
16:06:20.203 DEBUG                          HTTP Status: 200 - OK
16:06:20.204 INFO                           SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (1764 bytes)
16:06:20.346 DEBUG                          Received SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = Integer(1)
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = Integer(2)
|                                                           otherInfo = OtherStatusInfo:
|                                                               failInfo = Integer(2)
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                               x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                               y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1de6a414dda88f8b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                           s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 82825L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                               x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                               y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2eb4fc66f0202ec8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                           s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112160620Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x3fba5d680795d17f)
|                                                           msgCount = 1L
|                                                     [4] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=,CN=
|                                                     [5] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xa398ffd4f2bd9a659ddc4da37aa54c2932303954638e852702d71cd1596bc4938e47fc0a9368ac931413a36a58a68d9b)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:8400187126221113584259815294877704407307977167635598938274745687064736296937263367997564152837445376730949416694245
|                                                       s = long384:13774907741732886181367899807508729267039373810770477889116678163481350967183949349706413867417205382971624415132323
16:06:20.347 INFO                           MCKM: Handling incoming CertificateSigningResponse
16:06:20.349 DEBUG                          Connect closed for Server
16:06:20.352 INFO                           #> 0.1. Check request is displayed with correct status
16:06:20.356 DEBUG                          Connect closed for Server
16:06:21.289 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:21.341 DEBUG                          Connected to Server
16:06:21.391 DEBUG                          Sending HTTP GET /status_2 message.
16:06:21.392 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:06:21.492 DEBUG                          HTTP Status: 200 - OK
16:06:21.494 DEBUG                          Connect closed for Server
16:06:21.494 DEBUG                          Connect closed for Server
16:06:23.493 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:23.549 DEBUG                          Connected to Server
16:06:23.594 DEBUG                          Sending HTTP GET /status_2 message.
16:06:23.595 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:06:23.696 DEBUG                          HTTP Status: 200 - OK
16:06:23.697 DEBUG                          Connect closed for Server
16:06:23.698 DEBUG                          Connect closed for Server
16:06:24.127 INFO                           #> 1. Check an error was received.
16:06:24.146 INFO    Test:                  PASS
16:06:24.301 DEBUG                    Tearing down mock HTTP servers
16:06:24.304 DEBUG                    Connect closed for Server
16:06:24.305 DEBUG                    Connect closed for Server
16:06:25.699 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:25.751 DEBUG                    Connected to Server
16:06:25.801 DEBUG                    Sending HTTP GET /status_2 message.
16:06:25.802 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:25.921 DEBUG                    HTTP Status: 200 - OK
16:06:25.922 DEBUG                    Connect closed for Server
16:06:25.922 DEBUG                    Connect closed for Server
16:06:27.922 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:27.973 DEBUG                    Connected to Server
16:06:28.023 DEBUG                    Sending HTTP GET /status_2 message.
16:06:28.023 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:28.093 DEBUG                    HTTP Status: 200 - OK
16:06:28.093 DEBUG                    Connect closed for Server
16:06:28.094 DEBUG                    Connect closed for Server
16:06:30.093 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:30.144 DEBUG                    Connected to Server
16:06:30.195 DEBUG                    Sending HTTP GET /status_2 message.
16:06:30.195 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:30.290 DEBUG                    HTTP Status: 200 - OK
16:06:30.291 DEBUG                    Connect closed for Server
16:06:30.291 DEBUG                    Connect closed for Server
16:06:32.291 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:32.341 DEBUG                    Connected to Server
16:06:32.391 DEBUG                    Sending HTTP GET /status_2 message.
16:06:32.392 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:32.496 DEBUG                    HTTP Status: 200 - OK
16:06:32.497 DEBUG                    Connect closed for Server
16:06:32.498 DEBUG                    Connect closed for Server
16:06:32.701 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:06:32.701 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:06:32.713 DEBUG                    Generating certificate signature for serial: 80242
16:06:32.719 DEBUG                    Added keymat IR-INF-CA: serial=80242 auth=0xc9020cefbb66368c subj=0x220bf020626bffff
16:06:32.730 DEBUG                    Generating certificate signature for serial: 89527
16:06:32.736 DEBUG                    Added keymat IR-INF-IA: serial=89527 auth=0x220bf020626bffff subj=0xce98882e3742a3bb
16:06:32.748 DEBUG                    Generating certificate signature for serial: 89232
16:06:32.754 DEBUG                    Added keymat IR-INF-CRL-CA: serial=89232 auth=0xc9020cefbb66368c subj=0x37cea9f34c0fdab4
16:06:32.766 DEBUG                    Generating certificate signature for serial: 87053
16:06:32.771 DEBUG                    Added keymat IR-INF-CRL-IA: serial=87053 auth=0x37cea9f34c0fdab4 subj=0x81beb0b3400900ce
16:06:32.782 DEBUG                    Generating certificate signature for serial: 5
16:06:32.787 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x1fcf7dcd5da1e5c9 subj=0x1fcf7dcd5da1e5c9
16:06:32.796 DEBUG                    Generating message signature using cert with serial: 89527
16:06:32.830 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:06:32.882 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x1fcf7dcd5da1e5c9 subj=0x1fcf7dcd5da1e5c9
16:06:32.888 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:06:32.904 DEBUG                    Generating message signature using cert with serial: 5
16:06:32.964 DEBUG                    IR: Handling Certificate Signing Request.
16:06:32.964 DEBUG                    Creating temporary CA cert to issue IA
16:06:32.976 DEBUG                    Generating certificate signature for serial: 82575
16:06:32.981 DEBUG                    Added keymat IR-INF-CA-TMP: serial=82575 auth=0xc9020cefbb66368c subj=0x0479494edbecce83
16:06:32.982 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:06:32.988 DEBUG                    Generating certificate signature for serial: 20000
16:06:32.994 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:06:32.997 DEBUG                    Generating message signature using cert with serial: 89527
16:06:33.113 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:06:33.114 DEBUG                    Received Inf IA response
16:06:33.114 DEBUG                    Added keymat IR-INF-CA: serial=82575 auth=0xc9020cefbb66368c subj=0x0479494edbecce83
16:06:33.114 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x0479494edbecce83 subj=0x34288818cf5b6a18
16:06:33.124 DEBUG                    Generating certificate signature for serial: 5
16:06:33.130 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x737e82f4bbdf410e subj=0x737e82f4bbdf410e
16:06:33.138 DEBUG                    Generating message signature using cert with serial: 20000
16:06:33.173 DEBUG                    Creating SKD message file /tmp/icmCaReq
16:06:33.190 DEBUG                    Generating message signature using cert with serial: 20000
16:06:33.272 DEBUG                    IR: Handling Certificate Signing Request.
16:06:33.272 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
16:06:33.279 DEBUG                    Generating certificate signature for serial: 20001
16:06:33.285 DEBUG                    Creating SKD message file /tmp/icmCaResp
16:06:33.288 DEBUG                    Generating message signature using cert with serial: 89527
16:06:33.384 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:06:33.384 DEBUG                    Received Inf CA response
16:06:33.385 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x9d8cb769fa4aecfa
16:06:33.385 INFO                     Listening for ('128.10.1.4', 80)
16:06:33.389 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:06:33.393 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:06:33.394 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:06:33.446 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x737e82f4bbdf410e subj=0x737e82f4bbdf410e
16:06:33.452 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:06:33.469 DEBUG                    Generating message signature using cert with serial: 5
16:06:33.528 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:06:33.535 DEBUG                    Generating certificate signature for serial: 20000
16:06:33.541 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:06:33.544 DEBUG                    Generating message signature using cert with serial: 20000
16:06:33.662 DEBUG                    Received Inf IA response
16:06:33.662 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x9d8cb769fa4aecfa
16:06:33.663 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x9d8cb769fa4aecfa subj=0x536b2e30ee954626
16:06:33.667 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:06:33.671 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:06:33.720 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x737e82f4bbdf410e subj=0x737e82f4bbdf410e
16:06:33.721 INFO                     Listening for ('128.10.1.6', 80)
16:06:33.721 DEBUG                    MCKM requesting Inf IA from ICM.
16:06:33.727 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
16:06:33.743 DEBUG                    Generating message signature using cert with serial: 5
16:06:33.761 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:06:33.761 INFO                     SKD: Client ---> Server CMC-request (1339 bytes)
16:06:33.761 INFO                     Sent CSR for Inf IA certificate.
16:06:33.762 DEBUG                    105427152: Connect accepted from Client
16:06:33.811 DEBUG                    Connected to Server
16:06:33.863 DEBUG                    Sending HTTP POST /fullcmc message.
16:06:33.864 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:06:33.912 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:06:33.913 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
16:06:33.920 DEBUG                    Generating certificate signature for serial: 20001
16:06:33.931 DEBUG                    Generating message signature using cert with serial: 20000
16:06:33.993 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:06:33.995 DEBUG                    HTTP Status: 200 - OK
16:06:33.995 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3135 bytes)
16:06:34.065 INFO                     MCKM: Handling incoming CertificateSigningResponse
16:06:34.065 DEBUG                    Received Inf IA response
16:06:34.065 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x9d8cb769fa4aecfa
16:06:34.066 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x9d8cb769fa4aecfa subj=0x5776e398a2c9041c
16:06:34.497 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:34.548 DEBUG                    Connected to Server
16:06:34.598 DEBUG                    Sending HTTP GET /status_2 message.
16:06:34.598 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:34.690 DEBUG                    HTTP Status: 200 - OK
16:06:34.691 DEBUG                    Connect closed for Server
16:06:34.691 DEBUG                    Connect closed for Server
16:06:35.770 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:06:35.836 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x737e82f4bbdf410e subj=0x737e82f4bbdf410e
16:06:35.837 DEBUG                    CKA requesting Inf IA from ICM.
16:06:35.843 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
16:06:35.861 DEBUG                    Generating message signature using cert with serial: 5
16:06:35.880 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:06:35.881 INFO                     SKD: Client ---> Server CMC-request (1331 bytes)
16:06:35.881 INFO                     Sent CSR for Inf IA certificate.
16:06:35.882 DEBUG                    105427152: Connect accepted from Client
16:06:35.882 DEBUG                    Connect closed for Server
16:06:35.882 DEBUG                    Connect closed for Server
16:06:35.933 DEBUG                    Connected to Server
16:06:35.982 DEBUG                    Sending HTTP POST /fullcmc message.
16:06:35.982 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:06:36.026 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:06:36.027 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
16:06:36.035 DEBUG                    Generating certificate signature for serial: 20002
16:06:36.045 DEBUG                    Generating message signature using cert with serial: 20000
16:06:36.104 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:06:36.106 DEBUG                    HTTP Status: 200 - OK
16:06:36.106 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3125 bytes)
16:06:36.174 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
16:06:36.175 DEBUG                    Received Inf IA response
16:06:36.175 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x9d8cb769fa4aecfa
16:06:36.175 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x9d8cb769fa4aecfa subj=0x15d14c50c8adf924
16:06:36.691 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:36.743 DEBUG                    Connected to Server
16:06:36.792 DEBUG                    Sending HTTP GET /status_2 message.
16:06:36.792 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:36.890 DEBUG                    HTTP Status: 200 - OK
16:06:36.890 DEBUG                    Connect closed for Server
16:06:36.890 DEBUG                    Connect closed for Server
16:06:38.891 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:38.942 DEBUG                    Connected to Server
16:06:38.992 DEBUG                    Sending HTTP GET /status_2 message.
16:06:38.992 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:39.090 DEBUG                    HTTP Status: 200 - OK
16:06:39.091 DEBUG                    Connect closed for Server
16:06:39.092 DEBUG                    Connect closed for Server
16:06:40.087 DEBUG                    ########## Mocks complete ##########
16:06:41.091 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:41.142 DEBUG                    Connected to Server
16:06:41.143 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:06:41.144 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:06:41.192 DEBUG                    Sending HTTP GET /status_2 message.
16:06:41.192 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:41.197 DEBUG                    HTTP Status: 200 - OK
16:06:41.198 DEBUG                    Connect closed for Server
16:06:41.199 DEBUG                    Connect closed for Server
16:06:42.255 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:06:42.255 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:06:43.199 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:43.251 DEBUG                    Connected to Server
16:06:43.300 DEBUG                    Sending HTTP GET /status_2 message.
16:06:43.301 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:43.396 DEBUG                    HTTP Status: 200 - OK
16:06:43.396 DEBUG                    Connect closed for Server
16:06:43.397 DEBUG                    Connect closed for Server
16:06:45.396 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:45.447 DEBUG                    Connected to Server
16:06:45.497 DEBUG                    Sending HTTP GET /status_2 message.
16:06:45.497 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:45.643 DEBUG                    HTTP Status: 200 - OK
16:06:45.722 DEBUG                    Connect closed for Server
16:06:45.722 DEBUG                    Connect closed for Server
16:06:47.644 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:47.695 DEBUG                    Connected to Server
16:06:47.745 DEBUG                    Sending HTTP GET /status_2 message.
16:06:47.745 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:47.787 DEBUG                    HTTP Status: 200 - OK
16:06:47.788 DEBUG                    Connect closed for Server
16:06:47.788 DEBUG                    Connect closed for Server
16:06:49.788 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:49.838 DEBUG                    Connected to Server
16:06:49.888 DEBUG                    Sending HTTP GET /status_2 message.
16:06:49.889 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:50.003 DEBUG                    HTTP Status: 200 - OK
16:06:50.004 DEBUG                    Connect closed for Server
16:06:50.005 DEBUG                    Connect closed for Server
16:06:52.004 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:06:52.055 DEBUG                    Connected to Server
16:06:52.105 DEBUG                    Sending HTTP GET /status_2 message.
16:06:52.105 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:06:58.616 DEBUG                    HTTP Status: 200 - OK
16:06:58.616 DEBUG                    Connect closed for Server
16:06:58.617 DEBUG                    Connect closed for Server
16:07:00.616 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:00.667 DEBUG                    Connected to Server
16:07:00.717 DEBUG                    Sending HTTP GET /status_2 message.
16:07:00.717 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:00.814 DEBUG                    HTTP Status: 200 - OK
16:07:00.815 DEBUG                    Connect closed for Server
16:07:00.817 DEBUG                    Connect closed for Server
16:07:02.815 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:02.865 DEBUG                    Connected to Server
16:07:02.917 DEBUG                    Sending HTTP GET /status_2 message.
16:07:02.918 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:03.030 DEBUG                    HTTP Status: 200 - OK
16:07:03.031 DEBUG                    Connect closed for Server
16:07:03.031 DEBUG                    Connect closed for Server
16:07:05.031 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:05.085 DEBUG                    Connected to Server
16:07:05.140 DEBUG                    Sending HTTP GET /status_2 message.
16:07:05.141 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:05.294 DEBUG                    HTTP Status: 200 - OK
16:07:05.294 DEBUG                    Connect closed for Server
16:07:05.295 DEBUG                    Connect closed for Server
16:07:07.294 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:07.345 DEBUG                    Connected to Server
16:07:07.395 DEBUG                    Sending HTTP GET /status_2 message.
16:07:07.396 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:07.501 DEBUG                    HTTP Status: 200 - OK
16:07:07.502 DEBUG                    Connect closed for Server
16:07:07.503 DEBUG                    Connect closed for Server
16:07:09.502 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:09.553 DEBUG                    Connected to Server
16:07:09.603 DEBUG                    Sending HTTP GET /status_2 message.
16:07:09.603 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:09.700 DEBUG                    HTTP Status: 200 - OK
16:07:09.701 DEBUG                    Connect closed for Server
16:07:09.702 DEBUG                    Connect closed for Server
16:07:11.702 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:11.754 DEBUG                    Connected to Server
16:07:11.804 DEBUG                    Sending HTTP GET /status_2 message.
16:07:11.804 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:11.912 DEBUG                    HTTP Status: 200 - OK
16:07:11.912 DEBUG                    Connect closed for Server
16:07:11.914 DEBUG                    Connect closed for Server
16:07:13.912 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:13.963 DEBUG                    Connected to Server
16:07:14.013 DEBUG                    Sending HTTP GET /status_2 message.
16:07:14.013 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:14.136 DEBUG                    HTTP Status: 200 - OK
16:07:14.137 DEBUG                    Connect closed for Server
16:07:14.137 DEBUG                    Connect closed for Server
16:07:16.136 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:16.189 DEBUG                    Connected to Server
16:07:16.238 DEBUG                    Sending HTTP GET /status_2 message.
16:07:16.239 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:16.292 DEBUG                    HTTP Status: 200 - OK
16:07:16.293 DEBUG                    Connect closed for Server
16:07:16.293 DEBUG                    Connect closed for Server
16:07:18.293 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:18.343 DEBUG                    Connected to Server
16:07:18.393 DEBUG                    Sending HTTP GET /status_2 message.
16:07:18.393 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:18.524 DEBUG                    HTTP Status: 200 - OK
16:07:18.525 DEBUG                    Connect closed for Server
16:07:18.526 DEBUG                    Connect closed for Server
16:07:20.525 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:20.576 DEBUG                    Connected to Server
16:07:20.625 DEBUG                    Sending HTTP GET /status_2 message.
16:07:20.626 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:20.697 DEBUG                    HTTP Status: 200 - OK
16:07:20.698 DEBUG                    Connect closed for Server
16:07:20.698 DEBUG                    Connect closed for Server
16:07:22.697 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:22.748 DEBUG                    Connected to Server
16:07:22.798 DEBUG                    Sending HTTP GET /status_2 message.
16:07:22.799 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:22.913 DEBUG                    HTTP Status: 200 - OK
16:07:22.914 DEBUG                    Connect closed for Server
16:07:22.914 DEBUG                    Connect closed for Server
16:07:24.915 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:24.966 DEBUG                    Connected to Server
16:07:25.016 DEBUG                    Sending HTTP GET /status_2 message.
16:07:25.017 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:25.103 DEBUG                    HTTP Status: 200 - OK
16:07:25.104 DEBUG                    Connect closed for Server
16:07:25.104 DEBUG                    Connect closed for Server
16:07:27.104 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:27.154 DEBUG                    Connected to Server
16:07:27.204 DEBUG                    Sending HTTP GET /status_2 message.
16:07:27.205 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:27.350 DEBUG                    HTTP Status: 200 - OK
16:07:27.351 DEBUG                    Connect closed for Server
16:07:27.351 DEBUG                    Connect closed for Server
16:07:29.351 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:29.402 DEBUG                    Connected to Server
16:07:29.452 DEBUG                    Sending HTTP GET /status_2 message.
16:07:29.452 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:29.613 DEBUG                    HTTP Status: 200 - OK
16:07:29.614 DEBUG                    Connect closed for Server
16:07:29.615 DEBUG                    Connect closed for Server
16:07:31.615 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:31.667 DEBUG                    Connected to Server
16:07:31.723 DEBUG                    Sending HTTP GET /status_2 message.
16:07:31.723 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:31.850 DEBUG                    HTTP Status: 200 - OK
16:07:31.850 DEBUG                    Connect closed for Server
16:07:31.851 DEBUG                    Connect closed for Server
16:07:33.850 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:33.901 DEBUG                    Connected to Server
16:07:33.951 DEBUG                    Sending HTTP GET /status_2 message.
16:07:33.951 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:34.042 DEBUG                    HTTP Status: 200 - OK
16:07:34.042 DEBUG                    Connect closed for Server
16:07:34.043 DEBUG                    Connect closed for Server
16:07:36.042 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:36.093 DEBUG                    Connected to Server
16:07:36.144 DEBUG                    Sending HTTP GET /status_2 message.
16:07:36.145 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:36.214 DEBUG                    HTTP Status: 200 - OK
16:07:36.215 DEBUG                    Connect closed for Server
16:07:36.216 DEBUG                    Connect closed for Server
16:07:38.215 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:38.266 DEBUG                    Connected to Server
16:07:38.315 DEBUG                    Sending HTTP GET /status_2 message.
16:07:38.316 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:38.420 DEBUG                    HTTP Status: 200 - OK
16:07:38.422 DEBUG                    Connect closed for Server
16:07:38.422 DEBUG                    Connect closed for Server
16:07:39.583 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:970546355995601023899436498552893599186815487603333082875531000882524128226144548957068895319828334842518695139560919979759427847169849396476349999659307919153668080803631970994034941044984744427036894055094904290549545080065912308
|                                                     x = 24631902019354838299358631591286873490887022531371161078714699551112218663236018109446017876920531377832657819860351
|                                                     y = 19125452031921558429368337580294979740481868479189349943150917781661080440095958088238638876599688067795597302459892
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:3323207654510755978947181679190957375698345514785493710207543092665194648749656922227829356766236912596638298622803
|                                                 s = long384:29022159695988489834222071156098141352019003411983882524603607783654463884643329896535602076773594764275851753612774
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112160649Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 14L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0xc838e4dcbbbfdd0d1da13dda8b8af94a1dae7e7407e8c4ce17a2f7ff6447b26d7c9ca109aba62656747e537ce2de0ec6)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:1584416226986659649334395215307079637816492120919523720242685659415030816018480129905408982687264261077554679284226
|                                                 s = long384:36939695296242319227145467993903328448416706132722094276209208201407051206602646732601707587752687298271008338914887
16:07:39.584 DEBUG                    IR: Handling Certificate Signing Request.
16:07:39.585 DEBUG                    Generating InfCA certificate (serialNumber: 20002L)
16:07:39.591 DEBUG                    Generating certificate signature for serial: 20002
16:07:39.598 DEBUG                    Creating SKD message file /tmp/infca.resp
16:07:39.601 DEBUG                    Generating message signature using cert with serial: 89527
16:07:39.632 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0xce98882e3742a3bb-->0x220bf020626bffff-->0xc9020cefbb66368c
|                                             0x23fa000eefac6df4-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 89527L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112160632Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:937359592924754955793394172060413790461910720003483880970253808904499742353300641491307676741680309091983817743619155062410233023435152239377849439980171647160600533052399214900138217746178811943014916008811200107312773279711929275
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x220bf020626bffff)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xce98882e3742a3bb)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:5525537116833242262708659411233216912449181440317670541364525633242740065829447614443101218703934032655729614588867
|                                                     s = long384:10843852222806902434336687039203860492521828356785216677897524812611337494677588003691654273660285322863598695340582
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 80242L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112160632Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1544225898364057995344779221594681446709013545395127630379259623025917499125850844720517901068053294188363728632183915468712403335729641501846092793793568595238167139333028061729756682743748687433507493224357115145265768813011140607
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x220bf020626bffff)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:38491830403104856458165277807610726959958078788975760219000256111581898752980297001585051715460452193904759699202766
|                                                     s = long384:39277465348935552619940472879906303383603743271812644309361450515078905894160412734562602889112951850495417676106360
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112160739Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:970546355995601023899436498552893599186815487603333082875531000882524128226144548957068895319828334842518695139560919979759427847169849396476349999659307919153668080803631970994034941044984744427036894055094904290549545080065912308
|                                                         x = 24631902019354838299358631591286873490887022531371161078714699551112218663236018109446017876920531377832657819860351
|                                                         y = 19125452031921558429368337580294979740481868479189349943150917781661080440095958088238638876599688067795597302459892
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x23fa000eefac6df4)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:11578851529255552113212935835264611135651261227557591489363770708785851586739147259671249506014191417838905933025200
|                                                     s = long384:30456805097859548143238376605357883021515132940934810915391174452577975151642580995721779013662913587565613033564340
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0xce98882e3742a3bb)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112160739Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 14L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:7242452661606365211022864605618725511644472084182039020701243309648261206137649224188795115562187685208983333869586
|                                                 s = long384:4434756074960237745210302947872444215393583643186562735987674103964761670594769085560179226232800711776694503975094
16:07:40.422 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:40.473 DEBUG                    Connected to Server
16:07:40.522 DEBUG                    Sending HTTP GET /status_2 message.
16:07:40.523 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:40.587 DEBUG                    HTTP Status: 200 - OK
16:07:40.587 DEBUG                    Connect closed for Server
16:07:40.588 DEBUG                    Connect closed for Server
16:07:42.587 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:42.639 DEBUG                    Connected to Server
16:07:42.688 DEBUG                    Sending HTTP GET /status_2 message.
16:07:42.689 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:42.810 DEBUG                    HTTP Status: 200 - OK
16:07:42.811 DEBUG                    Connect closed for Server
16:07:42.812 DEBUG                    Connect closed for Server
16:07:44.811 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:44.862 DEBUG                    Connected to Server
16:07:44.912 DEBUG                    Sending HTTP GET /status_2 message.
16:07:44.912 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:45.039 DEBUG                    HTTP Status: 200 - OK
16:07:45.039 DEBUG                    Connect closed for Server
16:07:45.048 DEBUG                    Connect closed for Server
16:07:47.044 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:47.103 DEBUG                    Connected to Server
16:07:47.144 DEBUG                    Sending HTTP GET /status_2 message.
16:07:47.145 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:47.201 DEBUG                    HTTP Status: 200 - OK
16:07:47.202 DEBUG                    Connect closed for Server
16:07:47.202 DEBUG                    Connect closed for Server
16:07:49.204 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:49.255 DEBUG                    Connected to Server
16:07:49.304 DEBUG                    Sending HTTP GET /status_2 message.
16:07:49.305 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:49.404 DEBUG                    HTTP Status: 200 - OK
16:07:49.405 DEBUG                    Connect closed for Server
16:07:49.406 DEBUG                    Connect closed for Server
16:07:49.995 DEBUG                    cmd optimus > keydir
16:07:50.017 DEBUG                    cmd optimus > keydir /tmp/
16:07:51.405 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:51.455 DEBUG                    Connected to Server
16:07:51.505 DEBUG                    Sending HTTP GET /status_2 message.
16:07:51.506 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:51.631 DEBUG                    HTTP Status: 200 - OK
16:07:51.632 DEBUG                    Connect closed for Server
16:07:51.632 DEBUG                    Connect closed for Server
16:07:53.632 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:53.682 DEBUG                    Connected to Server
16:07:53.732 DEBUG                    Sending HTTP GET /status_2 message.
16:07:53.733 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:53.828 DEBUG                    HTTP Status: 200 - OK
16:07:53.829 DEBUG                    Connect closed for Server
16:07:53.829 DEBUG                    Connect closed for Server
16:07:55.828 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:55.884 DEBUG                    Connected to Server
16:07:55.929 DEBUG                    Sending HTTP GET /status_2 message.
16:07:55.929 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:55.991 DEBUG                    HTTP Status: 200 - OK
16:07:55.992 DEBUG                    Connect closed for Server
16:07:55.992 DEBUG                    Connect closed for Server
16:07:57.992 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:07:58.042 DEBUG                    Connected to Server
16:07:58.092 DEBUG                    Sending HTTP GET /status_2 message.
16:07:58.093 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:07:58.223 DEBUG                    HTTP Status: 200 - OK
16:07:58.223 DEBUG                    Connect closed for Server
16:07:58.224 DEBUG                    Connect closed for Server
16:08:00.223 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:00.274 DEBUG                    Connected to Server
16:08:00.324 DEBUG                    Sending HTTP GET /status_2 message.
16:08:00.324 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:00.412 DEBUG                    HTTP Status: 200 - OK
16:08:00.413 DEBUG                    Connect closed for Server
16:08:00.413 DEBUG                    Connect closed for Server
16:08:02.413 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:02.464 DEBUG                    Connected to Server
16:08:02.513 DEBUG                    Sending HTTP GET /status_2 message.
16:08:02.514 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:02.607 DEBUG                    HTTP Status: 200 - OK
16:08:02.608 DEBUG                    Connect closed for Server
16:08:02.608 DEBUG                    Connect closed for Server
16:08:04.609 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:04.660 DEBUG                    Connected to Server
16:08:04.711 DEBUG                    Sending HTTP GET /status_2 message.
16:08:04.712 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:04.789 DEBUG                    HTTP Status: 200 - OK
16:08:04.789 DEBUG                    Connect closed for Server
16:08:04.790 DEBUG                    Connect closed for Server
16:08:05.427 DEBUG                    cmd optimus > keydir ../Keys/
16:08:05.565 DEBUG                    Received SKD message:
|                                     KeyPackageFile:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = List:
|                                             [0]:
|                                                 OneAsymmetricKey:
|                                                     version == 0
|                                                     privateKeyAlgorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     privateKey = ECPrivateKey:
|                                                         version = 1L
|                                                         privateKey = Octets(0xe97a04fcb9f317683d818b83dc93b0d2ba208d29a436c660715384057cb4aa330bcba63681d8b9c7adaf1e829b26a94e)
|                                                     attributes:
|                                                       [0] = UserCertificateAttr:
|                                                         id == OID(userCertificate:2.5.4.36)
|                                                         userCertificate = Certificate:
|                                                             tbsCertificate = TBSCertificate:
|                                                                 version == 2
|                                                                 serialNumber = 19L
|                                                                 signatureAlgorithmID = AlgorithmIdentifier:
|                                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                 issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 validity = 170112000000Z..99991231235959Z
|                                                                 subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                     algorithm = AlgorithmIdentifier:
|                                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                         parameters = ECParameters:
|                                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                     subjectPublicKey = long768:801998740225430223898727017680390004607663799906449653157535481829817834458338215658422695378503853071853516931847929827672896695858199903501939663973472279381287798244820388030035856935217940618750571828311635891958328263713156870
|                                                                     x = 20354261562925644559757597927945786960326370694093160593206431151054663395484321262746477101390567057435222634397043
|                                                                     y = 1004034009157672646530432100529941370593945116886177817598711661706068240291568073794642007904359201403434980011782
|                                                                 _extensions = CertificateExtensions
|                                                                   [0] AuthorityKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                         keyIdentifier = Octets(0x98ebf0a6ffc2ef06)
|                                                                   [1] SubjectKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                         id = Octets(0x98ebf0a6ffc2ef06)
|                                                                   [2] KeyUsage_CertExt:
|                                                                         extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                         critical = True
|                                                                         uses = ['digitalSignature']
|                                                                   [3] CertificatePolicies_CertExt:
|                                                                         extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                         critical = True
|                                                                         policies:
|                                                                           [0] = PolicyInformation:
|                                                                             id = OID(1.2.826.0.1145.0.1.0.3)
|                                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                             signature = Signature:
|                                                                 r = long384:21797123793672486871835368027513182191034180995350504542531444026127462874399334011578156845123431455810500797852209
|                                                                 s = long384:17389929753201978904800639567570045443461382233790439629696331757957989583350111935869763297658427388074733608824832
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                               [1] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x2c1753f5f312f778fbfe4d1626cc4471965cbc58f88f311bd22b6df001b5f363fd7eb8eb65cd51a02c4970c2631819b8)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:38446810016864995229673512856716424455210191388409434055284718272311404740668665401223987354976365078903121180655709
|                                                 s = long384:24940274179349446801707392001351059359104080962531107572466346483837128143539213028522092899709838396776712390882768
16:08:05.566 DEBUG                    Added keymat FACT-IA: serial=19 auth=0x98ebf0a6ffc2ef06 subj=0x98ebf0a6ffc2ef06
16:08:05.566 DEBUG                    UUT Control: Applying all recent configuration changes
16:08:05.590 INFO    Test:            128 : [icm-issue-infia-mckm-missing-dev-func] The
|                                           MCKM sends a CSR for an InfIA certificate
|                                           with no DeviceFunction attribute and
|                                           receives a error response.
16:08:05.602 DEBUG                          MCKM requesting Inf IA from ICM.
16:08:05.610 INFO                           SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
16:08:05.658 DEBUG                          Generating message signature using cert with serial: 19
16:08:05.699 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0155000,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:392487626851058545718401728851574672621488621677165387733634587155017429059182233336553436551466360748822568382462206779662501424953477525782045068647839240542353240358368542992525744245505408771538286700038113014824562909264572624
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:17972361404790314569709201277287376243662397705653279128190158230358970504451006976541207739008092803594647849982190
|                                                       s = long384:10274442179366119031100797401079606769509984929627994870074822080295028030455732699039245492568776218235953328657303
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x98ebf0a6ffc2ef06-->0x98ebf0a6ffc2ef06
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 19L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:801998740225430223898727017680390004607663799906449653157535481829817834458338215658422695378503853071853516931847929827672896695858199903501939663973472279381287798244820388030035856935217940618750571828311635891958328263713156870
|                                                               x = 20354261562925644559757597927945786960326370694093160593206431151054663395484321262746477101390567057435222634397043
|                                                               y = 1004034009157672646530432100529941370593945116886177817598711661706068240291568073794642007904359201403434980011782
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x98ebf0a6ffc2ef06)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x98ebf0a6ffc2ef06)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:21797123793672486871835368027513182191034180995350504542531444026127462874399334011578156845123431455810500797852209
|                                                           s = long384:17389929753201978904800639567570045443461382233790439629696331757957989583350111935869763297658427388074733608824832
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x98ebf0a6ffc2ef06)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112160805Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xa17a53e617155dc5a333a605cad2bee9c6a56347d1dd124c285b10d39446419026ac9aabbd75ee81a491a763a27aae20)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xb55d40d72e38f145)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:849037267196655230324637622634333157749546377598252302406946866021000458376621712068231950014969464665971106508412
|                                                       s = long384:34344876003559700958779666860113294604935112228994919628858063615452870888663709941425985894983154529098212560888826
16:08:05.723 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:05.725 INFO                           SKD: Client ---> Server CMC-request (1318 bytes)
16:08:05.725 INFO                           Sent CSR for Inf IA certificate.
16:08:05.775 DEBUG                          Connected to Server
16:08:05.825 DEBUG                          Sending HTTP POST /fullcmc message.
16:08:05.826 DEBUG                          Removing HTTP POST /fullcmc message from Q.
16:08:06.015 DEBUG                          HTTP Status: 200 - OK
16:08:06.016 INFO                           SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (1765 bytes)
16:08:06.197 DEBUG                          Received SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = Integer(1)
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = Integer(2)
|                                                           otherInfo = OtherStatusInfo:
|                                                               failInfo = Integer(2)
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                               x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                               y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1de6a414dda88f8b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                           s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 82825L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                               x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                               y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2eb4fc66f0202ec8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                           s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112160805Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0xb55d40d72e38f145)
|                                                           msgCount = 1L
|                                                     [4] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=,CN=
|                                                     [5] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xa398ffd4f2bd9a659ddc4da37aa54c2932303954638e852702d71cd1596bc4938e47fc0a9368ac931413a36a58a68d9b)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:27410661623820176558472245080619712599416444301526037058163584783104936455889245901981887787148730630104927269296917
|                                                       s = long384:18927377461129703646986123612438211847684584357183695566090743758286329601658235943613839291592500126523402326844545
16:08:06.198 INFO                           MCKM: Handling incoming CertificateSigningResponse
16:08:06.200 DEBUG                          Connect closed for Server
16:08:06.203 INFO                           #> 0.1. Check request is displayed with correct status
16:08:06.208 DEBUG                          Connect closed for Server
16:08:06.790 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:06.841 DEBUG                          Connected to Server
16:08:06.890 DEBUG                          Sending HTTP GET /status_2 message.
16:08:06.892 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:08:07.017 DEBUG                          HTTP Status: 200 - OK
16:08:07.018 DEBUG                          Connect closed for Server
16:08:07.018 DEBUG                          Connect closed for Server
16:08:09.017 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:09.068 DEBUG                          Connected to Server
16:08:09.122 DEBUG                          Sending HTTP GET /status_2 message.
16:08:09.123 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:08:09.214 DEBUG                          HTTP Status: 200 - OK
16:08:09.216 DEBUG                          Connect closed for Server
16:08:09.217 DEBUG                          Connect closed for Server
16:08:10.058 INFO                           #> 1. Check an error was received.
16:08:10.069 INFO    Test:                  PASS
16:08:10.214 DEBUG                    Tearing down mock HTTP servers
16:08:10.217 DEBUG                    Connect closed for Server
16:08:10.218 DEBUG                    Connect closed for Server
16:08:11.215 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:11.266 DEBUG                    Connected to Server
16:08:11.316 DEBUG                    Sending HTTP GET /status_2 message.
16:08:11.316 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:11.395 DEBUG                    HTTP Status: 200 - OK
16:08:11.395 DEBUG                    Connect closed for Server
16:08:11.396 DEBUG                    Connect closed for Server
16:08:13.395 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:13.446 DEBUG                    Connected to Server
16:08:13.496 DEBUG                    Sending HTTP GET /status_2 message.
16:08:13.496 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:13.603 DEBUG                    HTTP Status: 200 - OK
16:08:13.604 DEBUG                    Connect closed for Server
16:08:13.604 DEBUG                    Connect closed for Server
16:08:15.604 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:15.655 DEBUG                    Connected to Server
16:08:15.704 DEBUG                    Sending HTTP GET /status_2 message.
16:08:15.705 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:15.812 DEBUG                    HTTP Status: 200 - OK
16:08:15.812 DEBUG                    Connect closed for Server
16:08:15.813 DEBUG                    Connect closed for Server
16:08:17.813 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:17.866 DEBUG                    Connected to Server
16:08:17.914 DEBUG                    Sending HTTP GET /status_2 message.
16:08:17.915 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:17.987 DEBUG                    HTTP Status: 200 - OK
16:08:17.988 DEBUG                    Connect closed for Server
16:08:17.996 DEBUG                    Connect closed for Server
16:08:18.438 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:08:18.439 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:08:18.455 DEBUG                    Generating certificate signature for serial: 88247
16:08:18.463 DEBUG                    Added keymat IR-INF-CA: serial=88247 auth=0xc9020cefbb66368c subj=0x3e95ba93a584b71a
16:08:18.477 DEBUG                    Generating certificate signature for serial: 86746
16:08:18.483 DEBUG                    Added keymat IR-INF-IA: serial=86746 auth=0x3e95ba93a584b71a subj=0xd396ac35e085f732
16:08:18.497 DEBUG                    Generating certificate signature for serial: 87330
16:08:18.506 DEBUG                    Added keymat IR-INF-CRL-CA: serial=87330 auth=0xc9020cefbb66368c subj=0x94e143a1eb3e991e
16:08:18.520 DEBUG                    Generating certificate signature for serial: 85488
16:08:18.527 DEBUG                    Added keymat IR-INF-CRL-IA: serial=85488 auth=0x94e143a1eb3e991e subj=0xa52cabba4b03095c
16:08:18.539 DEBUG                    Generating certificate signature for serial: 5
16:08:18.545 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x4c81b17240163c95 subj=0x4c81b17240163c95
16:08:18.560 DEBUG                    Generating message signature using cert with serial: 86746
16:08:18.603 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:08:18.661 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x4c81b17240163c95 subj=0x4c81b17240163c95
16:08:18.667 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:08:18.685 DEBUG                    Generating message signature using cert with serial: 5
16:08:18.752 DEBUG                    IR: Handling Certificate Signing Request.
16:08:18.752 DEBUG                    Creating temporary CA cert to issue IA
16:08:18.766 DEBUG                    Generating certificate signature for serial: 88338
16:08:18.772 DEBUG                    Added keymat IR-INF-CA-TMP: serial=88338 auth=0xc9020cefbb66368c subj=0x031bbf219c75d55d
16:08:18.772 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:08:18.779 DEBUG                    Generating certificate signature for serial: 20000
16:08:18.786 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:08:18.789 DEBUG                    Generating message signature using cert with serial: 86746
16:08:18.952 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:08:18.953 DEBUG                    Received Inf IA response
16:08:18.953 DEBUG                    Added keymat IR-INF-CA: serial=88338 auth=0xc9020cefbb66368c subj=0x031bbf219c75d55d
16:08:18.953 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x031bbf219c75d55d subj=0x52e5c2994220b396
16:08:18.964 DEBUG                    Generating certificate signature for serial: 5
16:08:18.970 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x3d534302f56050be subj=0x3d534302f56050be
16:08:18.979 DEBUG                    Generating message signature using cert with serial: 20000
16:08:19.014 DEBUG                    Creating SKD message file /tmp/icmCaReq
16:08:19.032 DEBUG                    Generating message signature using cert with serial: 20000
16:08:19.115 DEBUG                    IR: Handling Certificate Signing Request.
16:08:19.116 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
16:08:19.122 DEBUG                    Generating certificate signature for serial: 20001
16:08:19.129 DEBUG                    Creating SKD message file /tmp/icmCaResp
16:08:19.132 DEBUG                    Generating message signature using cert with serial: 86746
16:08:19.229 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:08:19.230 DEBUG                    Received Inf CA response
16:08:19.230 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x4b338067ec7db4ab
16:08:19.230 INFO                     Listening for ('128.10.1.4', 80)
16:08:19.235 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:08:19.239 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:08:19.239 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:08:19.291 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x3d534302f56050be subj=0x3d534302f56050be
16:08:19.297 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:08:19.314 DEBUG                    Generating message signature using cert with serial: 5
16:08:19.371 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:08:19.378 DEBUG                    Generating certificate signature for serial: 20000
16:08:19.384 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:08:19.387 DEBUG                    Generating message signature using cert with serial: 20000
16:08:19.504 DEBUG                    Received Inf IA response
16:08:19.504 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x4b338067ec7db4ab
16:08:19.505 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x4b338067ec7db4ab subj=0x55b688fee8cda1c2
16:08:19.509 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:08:19.513 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:08:19.563 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x3d534302f56050be subj=0x3d534302f56050be
16:08:19.564 INFO                     Listening for ('128.10.1.6', 80)
16:08:19.564 DEBUG                    MCKM requesting Inf IA from ICM.
16:08:19.570 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
16:08:19.587 DEBUG                    Generating message signature using cert with serial: 5
16:08:19.605 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:08:19.605 INFO                     SKD: Client ---> Server CMC-request (1341 bytes)
16:08:19.606 INFO                     Sent CSR for Inf IA certificate.
16:08:19.606 DEBUG                    105557456: Connect accepted from Client
16:08:19.656 DEBUG                    Connected to Server
16:08:19.707 DEBUG                    Sending HTTP POST /fullcmc message.
16:08:19.707 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:08:19.752 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:08:19.753 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
16:08:19.760 DEBUG                    Generating certificate signature for serial: 20001
16:08:19.770 DEBUG                    Generating message signature using cert with serial: 20000
16:08:19.824 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:08:19.825 DEBUG                    HTTP Status: 200 - OK
16:08:19.825 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3139 bytes)
16:08:19.902 INFO                     MCKM: Handling incoming CertificateSigningResponse
16:08:19.903 DEBUG                    Received Inf IA response
16:08:19.903 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x4b338067ec7db4ab
16:08:19.903 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x4b338067ec7db4ab subj=0xf9dffc03c5dd4639
16:08:19.989 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:20.040 DEBUG                    Connected to Server
16:08:20.089 DEBUG                    Sending HTTP GET /status_2 message.
16:08:20.090 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:20.190 DEBUG                    HTTP Status: 200 - OK
16:08:20.191 DEBUG                    Connect closed for Server
16:08:20.192 DEBUG                    Connect closed for Server
16:08:21.613 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:08:21.693 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x3d534302f56050be subj=0x3d534302f56050be
16:08:21.694 DEBUG                    CKA requesting Inf IA from ICM.
16:08:21.703 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
16:08:21.725 DEBUG                    Generating message signature using cert with serial: 5
16:08:21.746 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:08:21.747 INFO                     SKD: Client ---> Server CMC-request (1330 bytes)
16:08:21.747 INFO                     Sent CSR for Inf IA certificate.
16:08:21.748 DEBUG                    105557456: Connect accepted from Client
16:08:21.748 DEBUG                    Connect closed for Server
16:08:21.748 DEBUG                    Connect closed for Server
16:08:21.797 DEBUG                    Connected to Server
16:08:21.848 DEBUG                    Sending HTTP POST /fullcmc message.
16:08:21.848 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:08:21.897 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:08:21.897 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
16:08:21.905 DEBUG                    Generating certificate signature for serial: 20002
16:08:21.915 DEBUG                    Generating message signature using cert with serial: 20000
16:08:21.980 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:08:21.981 DEBUG                    HTTP Status: 200 - OK
16:08:21.981 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3128 bytes)
16:08:22.046 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
16:08:22.046 DEBUG                    Received Inf IA response
16:08:22.047 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x4b338067ec7db4ab
16:08:22.047 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x4b338067ec7db4ab subj=0x257d14eb1f7d2120
16:08:22.191 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:22.241 DEBUG                    Connected to Server
16:08:22.291 DEBUG                    Sending HTTP GET /status_2 message.
16:08:22.292 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:22.389 DEBUG                    HTTP Status: 200 - OK
16:08:22.390 DEBUG                    Connect closed for Server
16:08:22.390 DEBUG                    Connect closed for Server
16:08:24.390 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:24.441 DEBUG                    Connected to Server
16:08:24.492 DEBUG                    Sending HTTP GET /status_2 message.
16:08:24.492 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:24.589 DEBUG                    HTTP Status: 200 - OK
16:08:24.590 DEBUG                    Connect closed for Server
16:08:24.590 DEBUG                    Connect closed for Server
16:08:25.953 DEBUG                    ########## Mocks complete ##########
16:08:26.590 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:26.641 DEBUG                    Connected to Server
16:08:26.691 DEBUG                    Sending HTTP GET /status_2 message.
16:08:26.691 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:26.814 DEBUG                    HTTP Status: 200 - OK
16:08:26.814 DEBUG                    Connect closed for Server
16:08:26.815 DEBUG                    Connect closed for Server
16:08:27.098 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:08:27.099 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:08:28.230 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:08:28.230 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:08:28.815 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:28.866 DEBUG                    Connected to Server
16:08:28.916 DEBUG                    Sending HTTP GET /status_2 message.
16:08:28.916 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:29.040 DEBUG                    HTTP Status: 200 - OK
16:08:29.043 DEBUG                    Connect closed for Server
16:08:29.045 DEBUG                    Connect closed for Server
16:08:31.040 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:31.091 DEBUG                    Connected to Server
16:08:31.141 DEBUG                    Sending HTTP GET /status_2 message.
16:08:31.142 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:31.211 DEBUG                    HTTP Status: 200 - OK
16:08:31.212 DEBUG                    Connect closed for Server
16:08:31.213 DEBUG                    Connect closed for Server
16:08:33.212 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:33.263 DEBUG                    Connected to Server
16:08:33.313 DEBUG                    Sending HTTP GET /status_2 message.
16:08:33.313 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:33.393 DEBUG                    HTTP Status: 200 - OK
16:08:33.394 DEBUG                    Connect closed for Server
16:08:33.395 DEBUG                    Connect closed for Server
16:08:35.394 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:35.454 DEBUG                    Connected to Server
16:08:35.496 DEBUG                    Sending HTTP GET /status_2 message.
16:08:35.496 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:35.650 DEBUG                    HTTP Status: 200 - OK
16:08:35.651 DEBUG                    Connect closed for Server
16:08:35.651 DEBUG                    Connect closed for Server
16:08:37.650 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:37.701 DEBUG                    Connected to Server
16:08:37.751 DEBUG                    Sending HTTP GET /status_2 message.
16:08:37.751 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:46.486 DEBUG                    HTTP Status: 200 - OK
16:08:46.539 DEBUG                    Connect closed for Server
16:08:46.540 DEBUG                    Connect closed for Server
16:08:48.487 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:48.544 DEBUG                    Connected to Server
16:08:48.587 DEBUG                    Sending HTTP GET /status_2 message.
16:08:48.588 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:48.725 DEBUG                    HTTP Status: 200 - OK
16:08:48.725 DEBUG                    Connect closed for Server
16:08:48.726 DEBUG                    Connect closed for Server
16:08:50.725 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:50.776 DEBUG                    Connected to Server
16:08:50.826 DEBUG                    Sending HTTP GET /status_2 message.
16:08:50.832 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:50.900 DEBUG                    HTTP Status: 200 - OK
16:08:50.901 DEBUG                    Connect closed for Server
16:08:50.901 DEBUG                    Connect closed for Server
16:08:52.901 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:52.951 DEBUG                    Connected to Server
16:08:53.001 DEBUG                    Sending HTTP GET /status_2 message.
16:08:53.002 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:53.130 DEBUG                    HTTP Status: 200 - OK
16:08:53.131 DEBUG                    Connect closed for Server
16:08:53.131 DEBUG                    Connect closed for Server
16:08:55.131 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:55.181 DEBUG                    Connected to Server
16:08:55.231 DEBUG                    Sending HTTP GET /status_2 message.
16:08:55.232 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:55.306 DEBUG                    HTTP Status: 200 - OK
16:08:55.306 DEBUG                    Connect closed for Server
16:08:55.307 DEBUG                    Connect closed for Server
16:08:57.306 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:57.358 DEBUG                    Connected to Server
16:08:57.407 DEBUG                    Sending HTTP GET /status_2 message.
16:08:57.407 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:57.549 DEBUG                    HTTP Status: 200 - OK
16:08:57.550 DEBUG                    Connect closed for Server
16:08:57.551 DEBUG                    Connect closed for Server
16:08:59.550 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:08:59.605 DEBUG                    Connected to Server
16:08:59.653 DEBUG                    Sending HTTP GET /status_2 message.
16:08:59.654 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:08:59.735 DEBUG                    HTTP Status: 200 - OK
16:08:59.736 DEBUG                    Connect closed for Server
16:08:59.737 DEBUG                    Connect closed for Server
16:09:01.736 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:01.786 DEBUG                    Connected to Server
16:09:01.836 DEBUG                    Sending HTTP GET /status_2 message.
16:09:01.837 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:01.923 DEBUG                    HTTP Status: 200 - OK
16:09:01.924 DEBUG                    Connect closed for Server
16:09:01.924 DEBUG                    Connect closed for Server
16:09:03.924 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:03.975 DEBUG                    Connected to Server
16:09:04.024 DEBUG                    Sending HTTP GET /status_2 message.
16:09:04.025 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:04.111 DEBUG                    HTTP Status: 200 - OK
16:09:04.111 DEBUG                    Connect closed for Server
16:09:04.112 DEBUG                    Connect closed for Server
16:09:06.111 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:06.162 DEBUG                    Connected to Server
16:09:06.211 DEBUG                    Sending HTTP GET /status_2 message.
16:09:06.212 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:06.337 DEBUG                    HTTP Status: 200 - OK
16:09:06.337 DEBUG                    Connect closed for Server
16:09:06.338 DEBUG                    Connect closed for Server
16:09:08.339 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:08.390 DEBUG                    Connected to Server
16:09:08.440 DEBUG                    Sending HTTP GET /status_2 message.
16:09:08.441 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:08.549 DEBUG                    HTTP Status: 200 - OK
16:09:08.550 DEBUG                    Connect closed for Server
16:09:08.550 DEBUG                    Connect closed for Server
16:09:10.550 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:10.601 DEBUG                    Connected to Server
16:09:10.651 DEBUG                    Sending HTTP GET /status_2 message.
16:09:10.651 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:10.743 DEBUG                    HTTP Status: 200 - OK
16:09:10.744 DEBUG                    Connect closed for Server
16:09:10.744 DEBUG                    Connect closed for Server
16:09:12.744 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:12.795 DEBUG                    Connected to Server
16:09:12.845 DEBUG                    Sending HTTP GET /status_2 message.
16:09:12.845 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:12.940 DEBUG                    HTTP Status: 200 - OK
16:09:12.941 DEBUG                    Connect closed for Server
16:09:12.941 DEBUG                    Connect closed for Server
16:09:14.940 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:14.991 DEBUG                    Connected to Server
16:09:15.041 DEBUG                    Sending HTTP GET /status_2 message.
16:09:15.041 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:15.121 DEBUG                    HTTP Status: 200 - OK
16:09:15.121 DEBUG                    Connect closed for Server
16:09:15.122 DEBUG                    Connect closed for Server
16:09:17.121 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:17.172 DEBUG                    Connected to Server
16:09:17.222 DEBUG                    Sending HTTP GET /status_2 message.
16:09:17.222 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:17.374 DEBUG                    HTTP Status: 200 - OK
16:09:17.375 DEBUG                    Connect closed for Server
16:09:17.376 DEBUG                    Connect closed for Server
16:09:19.375 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:19.432 DEBUG                    Connected to Server
16:09:19.476 DEBUG                    Sending HTTP GET /status_2 message.
16:09:19.477 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:19.609 DEBUG                    HTTP Status: 200 - OK
16:09:19.609 DEBUG                    Connect closed for Server
16:09:19.610 DEBUG                    Connect closed for Server
16:09:21.609 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:21.660 DEBUG                    Connected to Server
16:09:21.710 DEBUG                    Sending HTTP GET /status_2 message.
16:09:21.711 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:21.808 DEBUG                    HTTP Status: 200 - OK
16:09:21.816 DEBUG                    Connect closed for Server
16:09:21.816 DEBUG                    Connect closed for Server
16:09:23.816 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:23.867 DEBUG                    Connected to Server
16:09:23.917 DEBUG                    Sending HTTP GET /status_2 message.
16:09:23.918 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:23.998 DEBUG                    HTTP Status: 200 - OK
16:09:23.998 DEBUG                    Connect closed for Server
16:09:23.998 DEBUG                    Connect closed for Server
16:09:26.000 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:26.051 DEBUG                    Connected to Server
16:09:26.100 DEBUG                    Sending HTTP GET /status_2 message.
16:09:26.101 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:26.255 DEBUG                    HTTP Status: 200 - OK
16:09:26.256 DEBUG                    Connect closed for Server
16:09:26.257 DEBUG                    Connect closed for Server
16:09:28.255 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:28.306 DEBUG                    Connected to Server
16:09:28.356 DEBUG                    Sending HTTP GET /status_2 message.
16:09:28.356 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:28.538 DEBUG                    HTTP Status: 200 - OK
16:09:28.539 DEBUG                    Connect closed for Server
16:09:28.540 DEBUG                    Connect closed for Server
16:09:30.539 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:30.595 DEBUG                    Connected to Server
16:09:30.642 DEBUG                    Sending HTTP GET /status_2 message.
16:09:30.642 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:30.769 DEBUG                    HTTP Status: 200 - OK
16:09:30.770 DEBUG                    Connect closed for Server
16:09:30.773 DEBUG                    Connect closed for Server
16:09:32.770 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:32.820 DEBUG                    Connected to Server
16:09:32.870 DEBUG                    Sending HTTP GET /status_2 message.
16:09:32.871 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:33.024 DEBUG                    HTTP Status: 200 - OK
16:09:33.025 DEBUG                    Connect closed for Server
16:09:33.025 DEBUG                    Connect closed for Server
16:09:33.306 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:838772274666588760232337400960884143092101865842269207740828128165751853400558908270224547517596191428190201304442520245557589610325073959397133845352022125181867036060947440479124550994709156711355414243096496033139301776857015529
|                                                     x = 21287552478567486576699064564348291257200536083242384045134054619128754351190935891396425436192519989896730691158625
|                                                     y = 8588382704146870281193833491949439895983164798051962683518418469673290227332960575623112005114437391523124582327529
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:21842773634900446775231099491136083749697997428184544394140384045992454094416803452126297755176499189780090606846704
|                                                 s = long384:5255016848220439768937876256620516874716758886976846668705843272708008584616797171447339464149196292174928413558033
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112160835Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 15L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x3d4af6b87e716c14d6dc608839dd804705d3355540c9ef2e376dfd1f3b39ded3397bd9bd5fd01b48e643fc600aa39666)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:26290133451654559000113554022734404357600783932327225120781515599628300139733172700193548016240560529062532206260534
|                                                 s = long384:4119830151798032363456010955609427824654443597596790829245627983859788701045397358919424103417567673951619663719309
16:09:33.307 DEBUG                    IR: Handling Certificate Signing Request.
16:09:33.307 DEBUG                    Generating InfCA certificate (serialNumber: 20002L)
16:09:33.314 DEBUG                    Generating certificate signature for serial: 20002
16:09:33.320 DEBUG                    Creating SKD message file /tmp/infca.resp
16:09:33.323 DEBUG                    Generating message signature using cert with serial: 86746
16:09:33.355 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0xd396ac35e085f732-->0x3e95ba93a584b71a-->0xc9020cefbb66368c
|                                             0xefcae4d06008a4e9-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 86746L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112160818Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1310600701137345763075301061873363162096754362747837436711096738694108068690890569238104415889161865659967703536828745759079970057202430845227467159600286028801536593037132916620660180511011061038744349139430845728811875754018469682
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x3e95ba93a584b71a)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xd396ac35e085f732)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:39172134156614416894043366314972747166564499925219317971922425260628871100042158050620600137866393739703350022273692
|                                                     s = long384:29647890869965544831157325100722293305345565608616692528099135094235115354305803765125192012742624401846049824698314
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 88247L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112160818Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:820630359251594577973788286256421475845059297912866588709203764323449985718775318236415657340876736127976485372923432272202250894211390298647266193631953274186674941462386040737293359091550727410258666723097172284522601899557697306
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x3e95ba93a584b71a)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:12486826521042857639201252242401461810938926027286575157289142224246125843951700589887645591110506732630238599919558
|                                                     s = long384:37276040632096284882321051365650539065822425093232574202675408691967638475258740155870968524468940761787136806522601
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112160933Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:838772274666588760232337400960884143092101865842269207740828128165751853400558908270224547517596191428190201304442520245557589610325073959397133845352022125181867036060947440479124550994709156711355414243096496033139301776857015529
|                                                         x = 21287552478567486576699064564348291257200536083242384045134054619128754351190935891396425436192519989896730691158625
|                                                         y = 8588382704146870281193833491949439895983164798051962683518418469673290227332960575623112005114437391523124582327529
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xefcae4d06008a4e9)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:3806409475283094947812646447256856176407902472319934514047609487691023543335689391067688454125194771488396065439853
|                                                     s = long384:31223815345733991603597823747429877067080645251320883924925860182964186367927531897871711617736686370837636247467704
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0xd396ac35e085f732)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112160933Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 15L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:1956795332496233525925443258812912386263904935317537286489378346096831506951643305676669600931609302017976952733502
|                                                 s = long384:21121928036931349668270922651461786190977827252017043143352626658464919445693713024541026222396401487970492233679951
16:09:35.025 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:35.076 DEBUG                    Connected to Server
16:09:35.125 DEBUG                    Sending HTTP GET /status_2 message.
16:09:35.126 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:35.218 DEBUG                    HTTP Status: 200 - OK
16:09:35.223 DEBUG                    Connect closed for Server
16:09:35.223 DEBUG                    Connect closed for Server
16:09:37.223 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:37.273 DEBUG                    Connected to Server
16:09:37.324 DEBUG                    Sending HTTP GET /status_2 message.
16:09:37.324 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:37.407 DEBUG                    HTTP Status: 200 - OK
16:09:37.408 DEBUG                    Connect closed for Server
16:09:37.408 DEBUG                    Connect closed for Server
16:09:39.408 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:39.464 DEBUG                    Connected to Server
16:09:39.509 DEBUG                    Sending HTTP GET /status_2 message.
16:09:39.510 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:39.606 DEBUG                    HTTP Status: 200 - OK
16:09:39.606 DEBUG                    Connect closed for Server
16:09:39.606 DEBUG                    Connect closed for Server
16:09:41.606 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:41.657 DEBUG                    Connected to Server
16:09:41.707 DEBUG                    Sending HTTP GET /status_2 message.
16:09:41.707 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:41.791 DEBUG                    HTTP Status: 200 - OK
16:09:41.791 DEBUG                    Connect closed for Server
16:09:41.792 DEBUG                    Connect closed for Server
16:09:43.791 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:43.842 DEBUG                    Connected to Server
16:09:43.892 DEBUG                    Sending HTTP GET /status_2 message.
16:09:43.892 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:43.965 DEBUG                    cmd optimus > keydir
16:09:43.989 DEBUG                    HTTP Status: 200 - OK
16:09:43.990 DEBUG                    Connect closed for Server
16:09:43.990 DEBUG                    Connect closed for Server
16:09:44.011 DEBUG                    cmd optimus > keydir /tmp/
16:09:45.990 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:46.043 DEBUG                    Connected to Server
16:09:46.090 DEBUG                    Sending HTTP GET /status_2 message.
16:09:46.091 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:46.242 DEBUG                    HTTP Status: 200 - OK
16:09:46.247 DEBUG                    Connect closed for Server
16:09:46.248 DEBUG                    Connect closed for Server
16:09:48.243 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:48.293 DEBUG                    Connected to Server
16:09:48.343 DEBUG                    Sending HTTP GET /status_2 message.
16:09:48.344 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:48.406 DEBUG                    HTTP Status: 200 - OK
16:09:48.411 DEBUG                    Connect closed for Server
16:09:48.412 DEBUG                    Connect closed for Server
16:09:50.406 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:50.457 DEBUG                    Connected to Server
16:09:50.507 DEBUG                    Sending HTTP GET /status_2 message.
16:09:50.507 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:50.588 DEBUG                    HTTP Status: 200 - OK
16:09:50.589 DEBUG                    Connect closed for Server
16:09:50.589 DEBUG                    Connect closed for Server
16:09:52.589 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:52.640 DEBUG                    Connected to Server
16:09:52.690 DEBUG                    Sending HTTP GET /status_2 message.
16:09:52.690 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:52.797 DEBUG                    HTTP Status: 200 - OK
16:09:52.797 DEBUG                    Connect closed for Server
16:09:52.798 DEBUG                    Connect closed for Server
16:09:54.797 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:54.848 DEBUG                    Connected to Server
16:09:54.898 DEBUG                    Sending HTTP GET /status_2 message.
16:09:54.898 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:54.996 DEBUG                    HTTP Status: 200 - OK
16:09:54.997 DEBUG                    Connect closed for Server
16:09:54.998 DEBUG                    Connect closed for Server
16:09:56.997 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:57.048 DEBUG                    Connected to Server
16:09:57.098 DEBUG                    Sending HTTP GET /status_2 message.
16:09:57.098 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:57.219 DEBUG                    HTTP Status: 200 - OK
16:09:57.220 DEBUG                    Connect closed for Server
16:09:57.221 DEBUG                    Connect closed for Server
16:09:59.220 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:09:59.271 DEBUG                    Connected to Server
16:09:59.322 DEBUG                    Sending HTTP GET /status_2 message.
16:09:59.322 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:09:59.388 DEBUG                    HTTP Status: 200 - OK
16:09:59.390 DEBUG                    Connect closed for Server
16:09:59.390 DEBUG                    Connect closed for Server
16:09:59.887 DEBUG                    cmd optimus > keydir ../Keys/
16:10:00.024 DEBUG                    Received SKD message:
|                                     KeyPackageFile:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = List:
|                                             [0]:
|                                                 OneAsymmetricKey:
|                                                     version == 0
|                                                     privateKeyAlgorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     privateKey = ECPrivateKey:
|                                                         version = 1L
|                                                         privateKey = Octets(0x83e98bd97da4b26262bf50d160c545a73dc041c57a812c161a392bdf6a11e9eaaee4e935c964b42d43d43b062bf78614)
|                                                     attributes:
|                                                       [0] = UserCertificateAttr:
|                                                         id == OID(userCertificate:2.5.4.36)
|                                                         userCertificate = Certificate:
|                                                             tbsCertificate = TBSCertificate:
|                                                                 version == 2
|                                                                 serialNumber = 20L
|                                                                 signatureAlgorithmID = AlgorithmIdentifier:
|                                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                 issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 validity = 170112000000Z..99991231235959Z
|                                                                 subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                     algorithm = AlgorithmIdentifier:
|                                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                         parameters = ECParameters:
|                                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                     subjectPublicKey = long768:1468338705429868461392066150681096054771300329745032822832632184435683163266132316429923941805121566506571511308929766648645227144597229109462181247423665858468519438213406998037024971105853877632740917503367629639839746346530510040
|                                                                     x = 37265582318603622094458686660799259264344349134755658372341962724249944340758709061464880321035068524648935458239659
|                                                                     y = 8703184238359111944925989207741330807170322796267208740435241825024248657810155325688860608663494806887335861294296
|                                                                 _extensions = CertificateExtensions
|                                                                   [0] AuthorityKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                         keyIdentifier = Octets(0x579bdbca171e14d8)
|                                                                   [1] SubjectKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                         id = Octets(0x579bdbca171e14d8)
|                                                                   [2] KeyUsage_CertExt:
|                                                                         extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                         critical = True
|                                                                         uses = ['digitalSignature']
|                                                                   [3] CertificatePolicies_CertExt:
|                                                                         extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                         critical = True
|                                                                         policies:
|                                                                           [0] = PolicyInformation:
|                                                                             id = OID(1.2.826.0.1145.0.1.0.3)
|                                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                             signature = Signature:
|                                                                 r = long384:31628177934360172027572801183571129454497795370240460814623803333709953218814459813558133773844537189458635369332257
|                                                                 s = long384:23474409517464756623170710952796411838799042335767126955486908783700179897887866450961930914484733069705375144905083
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                               [1] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x314dad4537ffed7f970029e08918b8dab01081b853373f88f94d5439880009730db3f7b0e510e20e3d89bbd67d5da516)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:31424874587567305484099469470510379483036026145253384050553545409678876036276266217825075132552892113186321874141348
|                                                 s = long384:19318297003687814747033640776655547459917886801524905819171081438008218741609851110289893758512017139994194128226197
16:10:00.025 DEBUG                    Added keymat FACT-IA: serial=20 auth=0x579bdbca171e14d8 subj=0x579bdbca171e14d8
16:10:00.025 DEBUG                    UUT Control: Applying all recent configuration changes
16:10:00.049 INFO    Test:            129 : [icm-issue-infia-mckm-user-reject] The MCKM
|                                           sends a CSR for an InfIA certificate to the
|                                           ICM and the ICM operator rejects the
|                                           request.
16:10:00.060 INFO                           #> 1. MCKM requests a Inf IA from the ICM via HTTP and waits for a 202 ACCEPTED response.
16:10:00.060 DEBUG                          MCKM requesting Inf IA from ICM.
16:10:00.067 INFO                           SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
16:10:00.115 DEBUG                          Generating message signature using cert with serial: 20
16:10:00.149 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0155000,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:1303093978457829030088403787525067103613924704845394392507008842254782706824013314431199880921673607094537539565893207482110538846473223491946098243586089869735032910443873734588349421901687548747722242556574330592571607506230366879
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.7
|                                                                             [1] = 1.2.826.0.1145.0.10.6
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:25124394186729824182668765083483048424657266268877729955729158355163237578082265199398188613618908429286970488704297
|                                                       s = long384:15857502754289555200867314637169028224758026512753744402163752014665336147887912501645609298530757349866141465100199
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x579bdbca171e14d8-->0x579bdbca171e14d8
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1468338705429868461392066150681096054771300329745032822832632184435683163266132316429923941805121566506571511308929766648645227144597229109462181247423665858468519438213406998037024971105853877632740917503367629639839746346530510040
|                                                               x = 37265582318603622094458686660799259264344349134755658372341962724249944340758709061464880321035068524648935458239659
|                                                               y = 8703184238359111944925989207741330807170322796267208740435241825024248657810155325688860608663494806887335861294296
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x579bdbca171e14d8)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x579bdbca171e14d8)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:31628177934360172027572801183571129454497795370240460814623803333709953218814459813558133773844537189458635369332257
|                                                           s = long384:23474409517464756623170710952796411838799042335767126955486908783700179897887866450961930914484733069705375144905083
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x579bdbca171e14d8)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112161000Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xb21893ff7bb4df4adf9be4d0fbed8806ac41080e19198851c04f9ce399defd88a375984023063a503f443c3b015697a3)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x62525a3847f56514)
|                                                           msgCount = 1L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:25324753886147966973610932418697102424471807434142720644426802213444938180683667322986517384079486543019085426880150
|                                                       s = long384:4263693208878133124725079804321999523045193703269530417006691950177339980789113994083369377644140382647378237773611
16:10:00.170 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:00.170 INFO                           SKD: Client ---> Server CMC-request (1342 bytes)
16:10:00.171 INFO                           Sent CSR for Inf IA certificate.
16:10:00.221 DEBUG                          Connected to Server
16:10:00.271 DEBUG                          Sending HTTP POST /fullcmc message.
16:10:00.272 DEBUG                          Removing HTTP POST /fullcmc message from Q.
16:10:00.403 DEBUG                          HTTP Status: 202 - ACCEPTED
16:10:00.404 INFO                           #> 2. The ICM operator rejects the CSR request.
16:10:00.408 DEBUG                          Connect closed for Server
16:10:00.409 DEBUG                          Connect closed for Server
16:10:01.390 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:01.444 DEBUG                          Connected to Server
16:10:01.491 DEBUG                          Sending HTTP GET /status_2 message.
16:10:01.492 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:10:01.633 DEBUG                          HTTP Status: 200 - OK
16:10:01.635 DEBUG                          Connect closed for Server
16:10:01.636 DEBUG                          Connect closed for Server
16:10:02.404 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:02.459 DEBUG                          Connected to Server
16:10:02.508 DEBUG                          Sending HTTP GET /status_13 message.
16:10:02.514 DEBUG                          Removing HTTP GET /status_13 message from Q.
16:10:02.599 DEBUG                          HTTP Status: 200 - OK
16:10:02.600 DEBUG                          Connect closed for Server
16:10:02.606 DEBUG                          Connect closed for Server
16:10:03.634 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:03.685 DEBUG                          Connected to Server
16:10:03.735 DEBUG                          Sending HTTP GET /status_2 message.
16:10:03.735 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:10:03.810 DEBUG                          HTTP Status: 200 - OK
16:10:03.811 DEBUG                          Connect closed for Server
16:10:03.816 DEBUG                          Connect closed for Server
16:10:04.600 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:04.651 DEBUG                          Connected to Server
16:10:04.701 DEBUG                          Sending HTTP GET /status_13 message.
16:10:04.702 DEBUG                          Removing HTTP GET /status_13 message from Q.
16:10:04.823 DEBUG                          HTTP Status: 200 - OK
16:10:04.825 DEBUG                          Connect closed for Server
16:10:04.826 DEBUG                          Connect closed for Server
16:10:05.811 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:05.862 DEBUG                          Connected to Server
16:10:05.912 DEBUG                          Sending HTTP GET /status_2 message.
16:10:05.913 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:10:06.000 DEBUG                          HTTP Status: 200 - OK
16:10:06.001 DEBUG                          Connect closed for Server
16:10:06.001 DEBUG                          Connect closed for Server
16:10:06.824 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:06.880 DEBUG                          Connected to Server
16:10:06.926 DEBUG                          Sending HTTP GET /status_13 message.
16:10:06.927 DEBUG                          Removing HTTP GET /status_13 message from Q.
16:10:07.007 DEBUG                          HTTP Status: 200 - OK
16:10:07.013 DEBUG                          Connect closed for Server
16:10:07.014 DEBUG                          Connect closed for Server
16:10:08.001 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:08.053 DEBUG                          Connected to Server
16:10:08.102 DEBUG                          Sending HTTP GET /status_2 message.
16:10:08.102 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:10:08.208 DEBUG                          HTTP Status: 200 - OK
16:10:08.209 DEBUG                          Connect closed for Server
16:10:08.209 DEBUG                          Connect closed for Server
16:10:08.479 INFO                           #> 3. Wait for CertificateSigningResponse response containing error.
16:10:09.008 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:09.059 DEBUG                          Connected to Server
16:10:09.109 DEBUG                          Sending HTTP GET /status_13 message.
16:10:09.110 DEBUG                          Removing HTTP GET /status_13 message from Q.
16:10:09.190 DEBUG                          HTTP Status: 303 - SEE OTHER
16:10:09.191 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 2.0 second(s)
16:10:09.192 DEBUG                          Connect closed for Server
16:10:09.192 DEBUG                          Connect closed for Server
16:10:09.193 DEBUG                          Connect closed for Server
16:10:09.193 DEBUG                          Connect closed for Server
16:10:09.193 DEBUG                          Connect closed for Server
16:10:09.194 DEBUG                          Connect closed for Server
16:10:09.194 DEBUG                          Connect closed for Server
16:10:09.195 DEBUG                          Connect closed for Server
16:10:09.195 DEBUG                          Connect closed for Server
16:10:09.196 DEBUG                          Connect closed for Server
16:10:09.196 DEBUG                          Connect closed for Server
16:10:09.196 DEBUG                          Connect closed for Server
16:10:09.197 DEBUG                          Connect closed for Server
16:10:09.197 DEBUG                          Connect closed for Server
16:10:09.198 DEBUG                          Connect closed for Server
16:10:09.198 DEBUG                          Connect closed for Server
16:10:09.199 DEBUG                          Connect closed for Server
16:10:09.199 DEBUG                          Connect closed for Server
16:10:09.199 DEBUG                          Connect closed for Server
16:10:09.200 DEBUG                          Connect closed for Server
16:10:09.200 DEBUG                          Connect closed for Server
16:10:09.201 DEBUG                          Connect closed for Server
16:10:09.201 DEBUG                          Connect closed for Server
16:10:09.202 DEBUG                          Connect closed for Server
16:10:09.202 DEBUG                          Connect closed for Server
16:10:09.203 DEBUG                          Connect closed for Server
16:10:09.203 DEBUG                          Connect closed for Server
16:10:09.204 DEBUG                          Connect closed for Server
16:10:09.204 DEBUG                          Connect closed for Server
16:10:09.205 DEBUG                          Connect closed for Server
16:10:09.205 DEBUG                          Connect closed for Server
16:10:09.205 DEBUG                          Connect closed for Server
16:10:09.206 DEBUG                          Connect closed for Server
16:10:09.206 DEBUG                          Connect closed for Server
16:10:09.207 DEBUG                          Connect closed for Server
16:10:09.207 DEBUG                          Connect closed for Server
16:10:09.208 DEBUG                          Connect closed for Server
16:10:09.208 DEBUG                          Connect closed for Server
16:10:09.208 DEBUG                          Connect closed for Server
16:10:09.209 DEBUG                          Connect closed for Server
16:10:09.209 DEBUG                          Connect closed for Server
16:10:09.210 DEBUG                          Connect closed for Server
16:10:09.211 DEBUG                          Connect closed for Server
16:10:09.211 DEBUG                          Connect closed for Server
16:10:09.212 DEBUG                          Connect closed for Server
16:10:09.212 DEBUG                          Connect closed for Server
16:10:09.212 DEBUG                          Connect closed for Server
16:10:09.213 DEBUG                          Connect closed for Server
16:10:09.213 DEBUG                          Connect closed for Server
16:10:09.214 DEBUG                          Connect closed for Server
16:10:09.214 DEBUG                          Connect closed for Server
16:10:09.215 DEBUG                          Connect closed for Server
16:10:09.215 DEBUG                          Connect closed for Server
16:10:09.215 DEBUG                          Connect closed for Server
16:10:09.216 DEBUG                          Connect closed for Server
16:10:09.216 DEBUG                          Connect closed for Server
16:10:09.217 DEBUG                          Connect closed for Server
16:10:09.217 DEBUG                          Connect closed for Server
16:10:09.218 DEBUG                          Connect closed for Server
16:10:09.218 DEBUG                          Connect closed for Server
16:10:09.219 DEBUG                          Connect closed for Server
16:10:09.219 DEBUG                          Connect closed for Server
16:10:09.219 DEBUG                          Connect closed for Server
16:10:09.220 DEBUG                          Connect closed for Server
16:10:09.220 DEBUG                          Connect closed for Server
16:10:09.221 DEBUG                          Connect closed for Server
16:10:09.221 DEBUG                          Connect closed for Server
16:10:09.221 DEBUG                          Connect closed for Server
16:10:09.222 DEBUG                          Connect closed for Server
16:10:09.222 DEBUG                          Connect closed for Server
16:10:09.223 DEBUG                          Connect closed for Server
16:10:09.223 DEBUG                          Connect closed for Server
16:10:09.224 DEBUG                          Connect closed for Server
16:10:09.224 DEBUG                          Connect closed for Server
16:10:09.224 DEBUG                          Connect closed for Server
16:10:09.225 DEBUG                          Connect closed for Server
16:10:09.225 DEBUG                          Connect closed for Server
16:10:09.226 DEBUG                          Connect closed for Server
16:10:09.226 DEBUG                          Connect closed for Server
16:10:09.227 DEBUG                          Connect closed for Server
16:10:09.227 DEBUG                          Connect closed for Server
16:10:09.227 DEBUG                          Connect closed for Server
16:10:09.228 DEBUG                          Connect closed for Server
16:10:09.228 DEBUG                          Connect closed for Server
16:10:09.229 DEBUG                          Connect closed for Server
16:10:09.229 DEBUG                          Connect closed for Server
16:10:09.229 DEBUG                          Connect closed for Server
16:10:09.230 DEBUG                          Connect closed for Server
16:10:09.230 DEBUG                          Connect closed for Server
16:10:09.231 DEBUG                          Connect closed for Server
16:10:09.231 DEBUG                          Connect closed for Server
16:10:09.232 DEBUG                          Connect closed for Server
16:10:09.232 DEBUG                          Connect closed for Server
16:10:09.232 DEBUG                          Connect closed for Server
16:10:09.233 DEBUG                          Connect closed for Server
16:10:09.233 DEBUG                          Connect closed for Server
16:10:09.234 DEBUG                          Connect closed for Server
16:10:09.234 DEBUG                          Connect closed for Server
16:10:09.235 DEBUG                          Connect closed for Server
16:10:09.236 DEBUG                          Connect closed for Server
16:10:09.236 DEBUG                          Connect closed for Server
16:10:09.236 DEBUG                          Connect closed for Server
16:10:09.237 DEBUG                          Connect closed for Server
16:10:09.237 DEBUG                          Connect closed for Server
16:10:09.238 DEBUG                          Connect closed for Server
16:10:09.238 DEBUG                          Connect closed for Server
16:10:09.239 DEBUG                          Connect closed for Server
16:10:09.239 DEBUG                          Connect closed for Server
16:10:09.239 DEBUG                          Connect closed for Server
16:10:09.240 DEBUG                          Connect closed for Server
16:10:09.240 DEBUG                          Connect closed for Server
16:10:09.241 DEBUG                          Connect closed for Server
16:10:09.241 DEBUG                          Connect closed for Server
16:10:09.242 DEBUG                          Connect closed for Server
16:10:09.243 DEBUG                          Connect closed for Server
16:10:09.243 DEBUG                          Connect closed for Server
16:10:09.244 DEBUG                          Connect closed for Server
16:10:09.245 DEBUG                          Connect closed for Server
16:10:09.246 DEBUG                          Connect closed for Server
16:10:09.246 DEBUG                          Connect closed for Server
16:10:09.247 DEBUG                          Connect closed for Server
16:10:09.247 DEBUG                          Connect closed for Server
16:10:09.247 DEBUG                          Connect closed for Server
16:10:09.248 DEBUG                          Connect closed for Server
16:10:09.248 DEBUG                          Connect closed for Server
16:10:09.249 DEBUG                          Connect closed for Server
16:10:09.249 DEBUG                          Connect closed for Server
16:10:09.250 DEBUG                          Connect closed for Server
16:10:09.250 DEBUG                          Connect closed for Server
16:10:09.251 DEBUG                          Connect closed for Server
16:10:09.251 DEBUG                          Connect closed for Server
16:10:09.251 DEBUG                          Connect closed for Server
16:10:09.252 DEBUG                          Connect closed for Server
16:10:09.252 DEBUG                          Connect closed for Server
16:10:09.253 DEBUG                          Connect closed for Server
16:10:09.253 DEBUG                          Connect closed for Server
16:10:09.254 DEBUG                          Connect closed for Server
16:10:09.254 DEBUG                          Connect closed for Server
16:10:09.254 DEBUG                          Connect closed for Server
16:10:09.255 DEBUG                          Connect closed for Server
16:10:09.255 DEBUG                          Connect closed for Server
16:10:09.256 DEBUG                          Connect closed for Server
16:10:09.256 DEBUG                          Connect closed for Server
16:10:09.256 DEBUG                          Connect closed for Server
16:10:09.257 DEBUG                          Connect closed for Server
16:10:09.257 DEBUG                          Connect closed for Server
16:10:09.258 DEBUG                          Connect closed for Server
16:10:09.258 DEBUG                          Connect closed for Server
16:10:09.258 DEBUG                          Connect closed for Server
16:10:09.259 DEBUG                          Connect closed for Server
16:10:09.259 DEBUG                          Connect closed for Server
16:10:09.260 DEBUG                          Connect closed for Server
16:10:09.260 DEBUG                          Connect closed for Server
16:10:09.261 DEBUG                          Connect closed for Server
16:10:09.261 DEBUG                          Connect closed for Server
16:10:09.261 DEBUG                          Connect closed for Server
16:10:09.262 DEBUG                          Connect closed for Server
16:10:09.262 DEBUG                          Connect closed for Server
16:10:09.263 DEBUG                          Connect closed for Server
16:10:09.263 DEBUG                          Connect closed for Server
16:10:09.264 DEBUG                          Connect closed for Server
16:10:09.264 DEBUG                          Connect closed for Server
16:10:09.264 DEBUG                          Connect closed for Server
16:10:09.265 DEBUG                          Connect closed for Server
16:10:09.265 DEBUG                          Connect closed for Server
16:10:09.266 DEBUG                          Connect closed for Server
16:10:09.266 DEBUG                          Connect closed for Server
16:10:09.266 DEBUG                          Connect closed for Server
16:10:09.267 DEBUG                          Connect closed for Server
16:10:09.267 DEBUG                          Connect closed for Server
16:10:09.268 DEBUG                          Connect closed for Server
16:10:09.268 DEBUG                          Connect closed for Server
16:10:09.269 DEBUG                          Connect closed for Server
16:10:09.269 DEBUG                          Connect closed for Server
16:10:09.269 DEBUG                          Connect closed for Server
16:10:09.270 DEBUG                          Connect closed for Server
16:10:09.271 DEBUG                          Connect closed for Server
16:10:09.271 DEBUG                          Connect closed for Server
16:10:09.272 DEBUG                          Connect closed for Server
16:10:09.272 DEBUG                          Connect closed for Server
16:10:09.272 DEBUG                          Connect closed for Server
16:10:09.273 DEBUG                          Connect closed for Server
16:10:09.273 DEBUG                          Connect closed for Server
16:10:09.274 DEBUG                          Connect closed for Server
16:10:09.274 DEBUG                          Connect closed for Server
16:10:09.275 DEBUG                          Connect closed for Server
16:10:09.275 DEBUG                          Connect closed for Server
16:10:09.275 DEBUG                          Connect closed for Server
16:10:09.276 DEBUG                          Connect closed for Server
16:10:09.276 DEBUG                          Connect closed for Server
16:10:09.277 DEBUG                          Connect closed for Server
16:10:09.277 DEBUG                          Connect closed for Server
16:10:09.277 DEBUG                          Connect closed for Server
16:10:09.278 DEBUG                          Connect closed for Server
16:10:09.278 DEBUG                          Connect closed for Server
16:10:09.279 DEBUG                          Connect closed for Server
16:10:09.279 DEBUG                          Connect closed for Server
16:10:09.279 DEBUG                          Connect closed for Server
16:10:09.280 DEBUG                          Connect closed for Server
16:10:09.281 DEBUG                          Connect closed for Server
16:10:09.281 DEBUG                          Connect closed for Server
16:10:09.282 DEBUG                          Connect closed for Server
16:10:09.282 DEBUG                          Connect closed for Server
16:10:09.282 DEBUG                          Connect closed for Server
16:10:09.283 DEBUG                          Connect closed for Server
16:10:09.283 DEBUG                          Connect closed for Server
16:10:09.284 DEBUG                          Connect closed for Server
16:10:09.284 DEBUG                          Connect closed for Server
16:10:09.284 DEBUG                          Connect closed for Server
16:10:09.285 DEBUG                          Connect closed for Server
16:10:09.286 DEBUG                          Connect closed for Server
16:10:09.286 DEBUG                          Connect closed for Server
16:10:09.286 DEBUG                          Connect closed for Server
16:10:09.287 DEBUG                          Connect closed for Server
16:10:09.287 DEBUG                          Connect closed for Server
16:10:09.288 DEBUG                          Connect closed for Server
16:10:09.288 DEBUG                          Connect closed for Server
16:10:09.288 DEBUG                          Connect closed for Server
16:10:09.289 DEBUG                          Connect closed for Server
16:10:09.289 DEBUG                          Connect closed for Server
16:10:09.290 DEBUG                          Connect closed for Server
16:10:09.290 DEBUG                          Connect closed for Server
16:10:09.291 DEBUG                          Connect closed for Server
16:10:09.291 DEBUG                          Connect closed for Server
16:10:09.292 DEBUG                          Connected to Server
16:10:09.292 DEBUG                          Sending HTTP GET /fetch_13 message.
16:10:09.293 DEBUG                          Removing HTTP GET /fetch_13 message from Q.
16:10:09.390 DEBUG                          HTTP Status: 200 - OK
16:10:09.390 INFO                           SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (1764 bytes)
16:10:09.507 DEBUG                          Received SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = Integer(1)
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = Integer(2)
|                                                           otherInfo = OtherStatusInfo:
|                                                               failInfo = Integer(2)
|                                               certificates (1 chains, 2 certificates) = 
|                                                 Chains summary:
|                                                   0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                               x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                               y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1de6a414dda88f8b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                           s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 82825L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                               x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                               y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2eb4fc66f0202ec8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                           s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112161004Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x62525a3847f56514)
|                                                           msgCount = 1L
|                                                     [4] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=,CN=
|                                                     [5] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0xa398ffd4f2bd9a659ddc4da37aa54c2932303954638e852702d71cd1596bc4938e47fc0a9368ac931413a36a58a68d9b)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:18540921127229477551055421108281406460290512286646429715143719165145045080720667787430929529270393236839826138045796
|                                                       s = long384:11317033183146795300151925825763985438188386159604923636328532587095465660127503825443787858393478088473043267518610
16:10:09.507 INFO                           MCKM: Handling incoming CertificateSigningResponse
16:10:09.519 INFO    Test:                  PASS
16:10:09.657 DEBUG                    Tearing down mock HTTP servers
16:10:09.660 DEBUG                    Connect closed for Server
16:10:09.661 DEBUG                    Connect closed for Server
16:10:09.662 DEBUG                    Connect closed for Server
16:10:09.662 DEBUG                    Connect closed for Server
16:10:10.208 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:10.260 DEBUG                    Connected to Server
16:10:10.309 DEBUG                    Sending HTTP GET /status_2 message.
16:10:10.310 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:10.411 DEBUG                    HTTP Status: 200 - OK
16:10:10.412 DEBUG                    Connect closed for Server
16:10:10.412 DEBUG                    Connect closed for Server
16:10:12.412 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:12.463 DEBUG                    Connected to Server
16:10:12.513 DEBUG                    Sending HTTP GET /status_2 message.
16:10:12.513 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:12.617 DEBUG                    HTTP Status: 200 - OK
16:10:12.617 DEBUG                    Connect closed for Server
16:10:12.618 DEBUG                    Connect closed for Server
16:10:14.617 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:14.669 DEBUG                    Connected to Server
16:10:14.717 DEBUG                    Sending HTTP GET /status_2 message.
16:10:14.718 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:14.790 DEBUG                    HTTP Status: 200 - OK
16:10:14.796 DEBUG                    Connect closed for Server
16:10:14.797 DEBUG                    Connect closed for Server
16:10:16.790 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:16.841 DEBUG                    Connected to Server
16:10:16.894 DEBUG                    Sending HTTP GET /status_2 message.
16:10:16.894 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:17.025 DEBUG                    HTTP Status: 200 - OK
16:10:17.026 DEBUG                    Connect closed for Server
16:10:17.027 DEBUG                    Connect closed for Server
16:10:17.827 INFO    Suite:       Tests for ICM issuing InfIA certificate to a MR
16:10:17.837 INFO    Suite:         ICM Infrastructure IA certificate issuing to MR
|                                   tests.
16:10:17.852 INFO                     Memory (RSS) before suite setup: 120.61 MByte  (3.24)
16:10:17.859 INFO                     Memory (Virt) before suite setup: 666.76 MByte  (3.14)
16:10:17.867 INFO                     Memory (RSS) after suite setup: 120.61 MByte  (0.00)
16:10:17.873 INFO                     Memory (Virt) after suite setup: 666.76 MByte  (0.00)
16:10:18.021 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:10:18.022 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:10:18.035 DEBUG                    Generating certificate signature for serial: 87063
16:10:18.041 DEBUG                    Added keymat IR-INF-CA: serial=87063 auth=0xc9020cefbb66368c subj=0xa0e23bfd7880e472
16:10:18.053 DEBUG                    Generating certificate signature for serial: 82575
16:10:18.061 DEBUG                    Added keymat IR-INF-IA: serial=82575 auth=0xa0e23bfd7880e472 subj=0x5e9e7554572758e1
16:10:18.074 DEBUG                    Generating certificate signature for serial: 83140
16:10:18.079 DEBUG                    Added keymat IR-INF-CRL-CA: serial=83140 auth=0xc9020cefbb66368c subj=0x58eecd1a1a23c182
16:10:18.093 DEBUG                    Generating certificate signature for serial: 80451
16:10:18.099 DEBUG                    Added keymat IR-INF-CRL-IA: serial=80451 auth=0x58eecd1a1a23c182 subj=0xec0b7da4501062f3
16:10:18.110 DEBUG                    Generating certificate signature for serial: 5
16:10:18.116 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xf903f32a4bd79dd2 subj=0xf903f32a4bd79dd2
16:10:18.125 DEBUG                    Generating message signature using cert with serial: 82575
16:10:18.161 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:10:18.213 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xf903f32a4bd79dd2 subj=0xf903f32a4bd79dd2
16:10:18.219 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:10:18.236 DEBUG                    Generating message signature using cert with serial: 5
16:10:18.294 DEBUG                    IR: Handling Certificate Signing Request.
16:10:18.295 DEBUG                    Creating temporary CA cert to issue IA
16:10:18.307 DEBUG                    Generating certificate signature for serial: 81850
16:10:18.313 DEBUG                    Added keymat IR-INF-CA-TMP: serial=81850 auth=0xc9020cefbb66368c subj=0x7c3694b592930315
16:10:18.313 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:10:18.320 DEBUG                    Generating certificate signature for serial: 20000
16:10:18.326 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:10:18.329 DEBUG                    Generating message signature using cert with serial: 82575
16:10:18.448 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:10:18.449 DEBUG                    Received Inf IA response
16:10:18.449 DEBUG                    Added keymat IR-INF-CA: serial=81850 auth=0xc9020cefbb66368c subj=0x7c3694b592930315
16:10:18.449 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x7c3694b592930315 subj=0x0587d55a2ca48a69
16:10:18.460 DEBUG                    Generating certificate signature for serial: 5
16:10:18.466 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x042dbe63d6098f4a subj=0x042dbe63d6098f4a
16:10:18.475 DEBUG                    Generating message signature using cert with serial: 20000
16:10:18.511 DEBUG                    Creating SKD message file /tmp/icmCaReq
16:10:18.529 DEBUG                    Generating message signature using cert with serial: 20000
16:10:18.613 DEBUG                    IR: Handling Certificate Signing Request.
16:10:18.614 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
16:10:18.621 DEBUG                    Generating certificate signature for serial: 20001
16:10:18.627 DEBUG                    Creating SKD message file /tmp/icmCaResp
16:10:18.630 DEBUG                    Generating message signature using cert with serial: 82575
16:10:18.726 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:10:18.727 DEBUG                    Received Inf CA response
16:10:18.727 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x49afafb5d2e5a9b9
16:10:18.727 INFO                     Listening for ('128.10.1.4', 80)
16:10:18.731 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:10:18.735 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:10:18.736 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:10:18.786 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x042dbe63d6098f4a subj=0x042dbe63d6098f4a
16:10:18.792 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:10:18.809 DEBUG                    Generating message signature using cert with serial: 5
16:10:18.867 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:10:18.873 DEBUG                    Generating certificate signature for serial: 20000
16:10:18.880 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:10:18.883 DEBUG                    Generating message signature using cert with serial: 20000
16:10:18.998 DEBUG                    Received Inf IA response
16:10:18.998 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x49afafb5d2e5a9b9
16:10:18.998 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x49afafb5d2e5a9b9 subj=0x3a844dff78943ee2
16:10:19.003 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:10:19.007 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:10:19.057 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x042dbe63d6098f4a subj=0x042dbe63d6098f4a
16:10:19.057 INFO                     Listening for ('128.10.1.6', 80)
16:10:19.058 DEBUG                    MCKM requesting Inf IA from ICM.
16:10:19.063 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
16:10:19.080 DEBUG                    Generating message signature using cert with serial: 5
16:10:19.099 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:10:19.099 INFO                     SKD: Client ---> Server CMC-request (1341 bytes)
16:10:19.100 INFO                     Sent CSR for Inf IA certificate.
16:10:19.100 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:19.101 DEBUG                    110728592: Connect accepted from Client
16:10:19.150 DEBUG                    Connected to Server
16:10:19.150 DEBUG                    Connected to Server
16:10:19.201 DEBUG                    Sending HTTP POST /fullcmc message.
16:10:19.201 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:10:19.201 DEBUG                    Sending HTTP GET /status_2 message.
16:10:19.202 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:19.249 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:10:19.249 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
16:10:19.256 DEBUG                    Generating certificate signature for serial: 20001
16:10:19.267 DEBUG                    Generating message signature using cert with serial: 20000
16:10:19.345 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:10:19.347 DEBUG                    HTTP Status: 200 - OK
16:10:19.347 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3141 bytes)
16:10:19.426 INFO                     MCKM: Handling incoming CertificateSigningResponse
16:10:19.426 DEBUG                    Received Inf IA response
16:10:19.426 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x49afafb5d2e5a9b9
16:10:19.427 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x49afafb5d2e5a9b9 subj=0x8043b9166cd7602d
16:10:19.427 DEBUG                    HTTP Status: 200 - OK
16:10:19.428 DEBUG                    Connect closed for Server
16:10:19.428 DEBUG                    Connect closed for Server
16:10:21.105 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:10:21.156 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x042dbe63d6098f4a subj=0x042dbe63d6098f4a
16:10:21.156 DEBUG                    CKA requesting Inf IA from ICM.
16:10:21.162 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
16:10:21.179 DEBUG                    Generating message signature using cert with serial: 5
16:10:21.199 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:10:21.199 INFO                     SKD: Client ---> Server CMC-request (1331 bytes)
16:10:21.199 INFO                     Sent CSR for Inf IA certificate.
16:10:21.200 DEBUG                    110728592: Connect accepted from Client
16:10:21.200 DEBUG                    Connect closed for Server
16:10:21.201 DEBUG                    Connect closed for Server
16:10:21.251 DEBUG                    Connected to Server
16:10:21.299 DEBUG                    Sending HTTP POST /fullcmc message.
16:10:21.300 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:10:21.342 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:10:21.342 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
16:10:21.349 DEBUG                    Generating certificate signature for serial: 20002
16:10:21.359 DEBUG                    Generating message signature using cert with serial: 20000
16:10:21.414 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:10:21.415 DEBUG                    HTTP Status: 200 - OK
16:10:21.416 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3130 bytes)
16:10:21.480 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
16:10:21.480 DEBUG                    Received Inf IA response
16:10:21.480 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x49afafb5d2e5a9b9
16:10:21.480 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x49afafb5d2e5a9b9 subj=0xd7d93d6246bb1005
16:10:21.481 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:21.531 DEBUG                    Connected to Server
16:10:21.582 DEBUG                    Sending HTTP GET /status_2 message.
16:10:21.582 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:21.589 DEBUG                    HTTP Status: 200 - OK
16:10:21.589 DEBUG                    Connect closed for Server
16:10:21.589 DEBUG                    Connect closed for Server
16:10:23.589 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:23.640 DEBUG                    Connected to Server
16:10:23.690 DEBUG                    Sending HTTP GET /status_2 message.
16:10:23.691 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:23.791 DEBUG                    HTTP Status: 200 - OK
16:10:23.792 DEBUG                    Connect closed for Server
16:10:23.792 DEBUG                    Connect closed for Server
16:10:25.403 DEBUG                    ########## Mocks complete ##########
16:10:25.792 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:25.843 DEBUG                    Connected to Server
16:10:25.892 DEBUG                    Sending HTTP GET /status_2 message.
16:10:25.893 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:25.989 DEBUG                    HTTP Status: 200 - OK
16:10:25.989 DEBUG                    Connect closed for Server
16:10:25.996 DEBUG                    Connect closed for Server
16:10:26.405 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:10:26.406 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:10:27.510 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:10:27.510 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:10:27.989 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:28.040 DEBUG                    Connected to Server
16:10:28.090 DEBUG                    Sending HTTP GET /status_2 message.
16:10:28.090 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:28.213 DEBUG                    HTTP Status: 200 - OK
16:10:28.222 DEBUG                    Connect closed for Server
16:10:28.222 DEBUG                    Connect closed for Server
16:10:30.221 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:30.272 DEBUG                    Connected to Server
16:10:30.322 DEBUG                    Sending HTTP GET /status_2 message.
16:10:30.322 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:30.393 DEBUG                    HTTP Status: 200 - OK
16:10:30.393 DEBUG                    Connect closed for Server
16:10:30.394 DEBUG                    Connect closed for Server
16:10:32.394 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:32.446 DEBUG                    Connected to Server
16:10:32.494 DEBUG                    Sending HTTP GET /status_2 message.
16:10:32.495 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:32.628 DEBUG                    HTTP Status: 200 - OK
16:10:32.628 DEBUG                    Connect closed for Server
16:10:32.628 DEBUG                    Connect closed for Server
16:10:34.628 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:34.679 DEBUG                    Connected to Server
16:10:34.729 DEBUG                    Sending HTTP GET /status_2 message.
16:10:34.729 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:34.803 DEBUG                    HTTP Status: 200 - OK
16:10:34.803 DEBUG                    Connect closed for Server
16:10:34.804 DEBUG                    Connect closed for Server
16:10:36.803 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:36.854 DEBUG                    Connected to Server
16:10:36.904 DEBUG                    Sending HTTP GET /status_2 message.
16:10:36.904 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:46.450 DEBUG                    HTTP Status: 200 - OK
16:10:46.450 DEBUG                    Connect closed for Server
16:10:46.451 DEBUG                    Connect closed for Server
16:10:48.450 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:48.501 DEBUG                    Connected to Server
16:10:48.551 DEBUG                    Sending HTTP GET /status_2 message.
16:10:48.552 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:48.588 DEBUG                    HTTP Status: 200 - OK
16:10:48.589 DEBUG                    Connect closed for Server
16:10:48.590 DEBUG                    Connect closed for Server
16:10:50.589 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:50.641 DEBUG                    Connected to Server
16:10:50.689 DEBUG                    Sending HTTP GET /status_2 message.
16:10:50.690 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:50.826 DEBUG                    HTTP Status: 200 - OK
16:10:50.827 DEBUG                    Connect closed for Server
16:10:50.827 DEBUG                    Connect closed for Server
16:10:52.826 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:52.877 DEBUG                    Connected to Server
16:10:52.927 DEBUG                    Sending HTTP GET /status_2 message.
16:10:52.928 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:53.009 DEBUG                    HTTP Status: 200 - OK
16:10:53.010 DEBUG                    Connect closed for Server
16:10:53.010 DEBUG                    Connect closed for Server
16:10:55.010 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:55.061 DEBUG                    Connected to Server
16:10:55.111 DEBUG                    Sending HTTP GET /status_2 message.
16:10:55.112 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:55.228 DEBUG                    HTTP Status: 200 - OK
16:10:55.228 DEBUG                    Connect closed for Server
16:10:55.229 DEBUG                    Connect closed for Server
16:10:57.229 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:57.295 DEBUG                    Connected to Server
16:10:57.335 DEBUG                    Sending HTTP GET /status_2 message.
16:10:57.336 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:57.399 DEBUG                    HTTP Status: 200 - OK
16:10:57.400 DEBUG                    Connect closed for Server
16:10:57.406 DEBUG                    Connect closed for Server
16:10:59.403 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:10:59.457 DEBUG                    Connected to Server
16:10:59.504 DEBUG                    Sending HTTP GET /status_2 message.
16:10:59.505 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:10:59.635 DEBUG                    HTTP Status: 200 - OK
16:10:59.635 DEBUG                    Connect closed for Server
16:10:59.636 DEBUG                    Connect closed for Server
16:11:01.635 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:01.686 DEBUG                    Connected to Server
16:11:01.743 DEBUG                    Sending HTTP GET /status_2 message.
16:11:01.744 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:01.935 DEBUG                    HTTP Status: 200 - OK
16:11:01.935 DEBUG                    Connect closed for Server
16:11:01.936 DEBUG                    Connect closed for Server
16:11:03.935 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:03.986 DEBUG                    Connected to Server
16:11:04.036 DEBUG                    Sending HTTP GET /status_2 message.
16:11:04.036 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:04.123 DEBUG                    HTTP Status: 200 - OK
16:11:04.124 DEBUG                    Connect closed for Server
16:11:04.124 DEBUG                    Connect closed for Server
16:11:06.124 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:06.175 DEBUG                    Connected to Server
16:11:06.224 DEBUG                    Sending HTTP GET /status_2 message.
16:11:06.225 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:06.316 DEBUG                    HTTP Status: 200 - OK
16:11:06.317 DEBUG                    Connect closed for Server
16:11:06.318 DEBUG                    Connect closed for Server
16:11:08.317 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:08.368 DEBUG                    Connected to Server
16:11:08.417 DEBUG                    Sending HTTP GET /status_2 message.
16:11:08.418 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:08.496 DEBUG                    HTTP Status: 200 - OK
16:11:08.497 DEBUG                    Connect closed for Server
16:11:08.497 DEBUG                    Connect closed for Server
16:11:10.504 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:10.554 DEBUG                    Connected to Server
16:11:10.604 DEBUG                    Sending HTTP GET /status_2 message.
16:11:10.605 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:10.741 DEBUG                    HTTP Status: 200 - OK
16:11:10.741 DEBUG                    Connect closed for Server
16:11:10.741 DEBUG                    Connect closed for Server
16:11:12.741 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:12.792 DEBUG                    Connected to Server
16:11:12.842 DEBUG                    Sending HTTP GET /status_2 message.
16:11:12.842 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:13.022 DEBUG                    HTTP Status: 200 - OK
16:11:13.023 DEBUG                    Connect closed for Server
16:11:13.023 DEBUG                    Connect closed for Server
16:11:15.023 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:15.074 DEBUG                    Connected to Server
16:11:15.123 DEBUG                    Sending HTTP GET /status_2 message.
16:11:15.124 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:15.226 DEBUG                    HTTP Status: 200 - OK
16:11:15.227 DEBUG                    Connect closed for Server
16:11:15.228 DEBUG                    Connect closed for Server
16:11:17.227 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:17.277 DEBUG                    Connected to Server
16:11:17.327 DEBUG                    Sending HTTP GET /status_2 message.
16:11:17.327 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:17.432 DEBUG                    HTTP Status: 200 - OK
16:11:17.433 DEBUG                    Connect closed for Server
16:11:17.433 DEBUG                    Connect closed for Server
16:11:19.439 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:19.492 DEBUG                    Connected to Server
16:11:19.543 DEBUG                    Sending HTTP GET /status_2 message.
16:11:19.544 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:19.701 DEBUG                    HTTP Status: 200 - OK
16:11:19.701 DEBUG                    Connect closed for Server
16:11:19.701 DEBUG                    Connect closed for Server
16:11:21.701 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:21.751 DEBUG                    Connected to Server
16:11:21.801 DEBUG                    Sending HTTP GET /status_2 message.
16:11:21.802 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:21.904 DEBUG                    HTTP Status: 200 - OK
16:11:21.904 DEBUG                    Connect closed for Server
16:11:21.905 DEBUG                    Connect closed for Server
16:11:23.904 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:23.955 DEBUG                    Connected to Server
16:11:24.005 DEBUG                    Sending HTTP GET /status_2 message.
16:11:24.005 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:24.112 DEBUG                    HTTP Status: 200 - OK
16:11:24.112 DEBUG                    Connect closed for Server
16:11:24.113 DEBUG                    Connect closed for Server
16:11:26.112 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:26.163 DEBUG                    Connected to Server
16:11:26.213 DEBUG                    Sending HTTP GET /status_2 message.
16:11:26.213 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:26.312 DEBUG                    HTTP Status: 200 - OK
16:11:26.313 DEBUG                    Connect closed for Server
16:11:26.314 DEBUG                    Connect closed for Server
16:11:28.313 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:28.367 DEBUG                    Connected to Server
16:11:28.414 DEBUG                    Sending HTTP GET /status_2 message.
16:11:28.415 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:28.490 DEBUG                    HTTP Status: 200 - OK
16:11:28.491 DEBUG                    Connect closed for Server
16:11:28.492 DEBUG                    Connect closed for Server
16:11:30.491 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:30.541 DEBUG                    Connected to Server
16:11:30.591 DEBUG                    Sending HTTP GET /status_2 message.
16:11:30.592 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:30.717 DEBUG                    HTTP Status: 200 - OK
16:11:30.717 DEBUG                    Connect closed for Server
16:11:30.718 DEBUG                    Connect closed for Server
16:11:32.717 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:32.769 DEBUG                    Connected to Server
16:11:32.818 DEBUG                    Sending HTTP GET /status_2 message.
16:11:32.818 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:32.945 DEBUG                    HTTP Status: 200 - OK
16:11:32.954 DEBUG                    Connect closed for Server
16:11:32.955 DEBUG                    Connect closed for Server
16:11:33.616 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:876735982751595285192402460670474421041275887743332806038263564773754060454310931475257931279301137127030705295533550382278411812007555437554600474140306706493800528431169721665527979331819073976403079117113974444766256628707178490
|                                                     x = 22251049309053250847536744415129503323202777299983129034092169971531246373952794154805687624610903603552052410386120
|                                                     y = 38804747633093109847397834030529252739764162389441507458619332421055024585102870554161022690051336128644784879384570
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:34247029299352065346144170271754099610148890363005505875002411364864207480930872375566958307149021054279207014953449
|                                                 s = long384:29354608248714651279950901375924526233172513059024929688986965902932215095908012139238729283610449511924368094857447
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112161034Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 16L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x3cc26077d9440efab1ae1b5781506073fd84847160b52a65313f2ebaa952722e7155c72c5452fc1d2db4808deffe99fd)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:25167744845097759050602414846359138394594166419498178430098782205308462219190291190836611556486913442481743681563567
|                                                 s = long384:9684438997355645525833494341532619907369178340612128874594299415189403239530874132872855945156164824086911984841665
16:11:33.618 DEBUG                    IR: Handling Certificate Signing Request.
16:11:33.618 DEBUG                    Generating InfCA certificate (serialNumber: 20002L)
16:11:33.625 DEBUG                    Generating certificate signature for serial: 20002
16:11:33.632 DEBUG                    Creating SKD message file /tmp/infca.resp
16:11:33.636 DEBUG                    Generating message signature using cert with serial: 82575
16:11:33.670 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0x5e9e7554572758e1-->0xa0e23bfd7880e472-->0xc9020cefbb66368c
|                                             0xa5358105401137fa-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82575L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112161018Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1299679613240463785424742067266935906922800435341298842529963215324849236016073068383123794198409409714447853421011774804657742803208240516548863796768325046021926983248959334400334953885694475276257172460017971474643050232050833633
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xa0e23bfd7880e472)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x5e9e7554572758e1)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:17630653776889512060935509457003209591548373626161457239642709217248123328349854921088576034780460036705549342426179
|                                                     s = long384:32545057696786643574306468020777703950013456024880575559433622670155143077519723004581197958629069392041271330258716
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 87063L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112161018Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1477463139077248229249180554857414003435798090884112278355254267217516263836722735137055311014151981931823190411833216924677731324004637718986103378313474249186709658713431259990797788973931998693123836505805283016065741509527397490
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xa0e23bfd7880e472)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:2610570610473705778679541547490962792880902377538173086943664903094646518554628711364326481184438894798822038682680
|                                                     s = long384:17792674462672809407821681438596966423399947669359688325211718004369395552811768775698702020192937190051257203408263
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112161133Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:876735982751595285192402460670474421041275887743332806038263564773754060454310931475257931279301137127030705295533550382278411812007555437554600474140306706493800528431169721665527979331819073976403079117113974444766256628707178490
|                                                         x = 22251049309053250847536744415129503323202777299983129034092169971531246373952794154805687624610903603552052410386120
|                                                         y = 38804747633093109847397834030529252739764162389441507458619332421055024585102870554161022690051336128644784879384570
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xa5358105401137fa)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:5221487676081248042909945898962913048512050116461565801827368413423482343234399438965487973105777864390225031499152
|                                                     s = long384:35255745834290144753124411021368749732165875351400149363308883592086783518307830573913878426494458562550174853377777
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x5e9e7554572758e1)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112161133Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 16L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:36237975551157317763103825943259371430953410299989636934622571665608007171336832128754161335311789236855061619879430
|                                                 s = long384:5296105627159839035304536318899223805767580684494673248889919647643309762826968198291320501170915649118300416765698
16:11:34.946 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:34.996 DEBUG                    Connected to Server
16:11:35.047 DEBUG                    Sending HTTP GET /status_2 message.
16:11:35.048 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:35.096 DEBUG                    HTTP Status: 200 - OK
16:11:35.100 DEBUG                    Connect closed for Server
16:11:35.100 DEBUG                    Connect closed for Server
16:11:37.103 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:37.154 DEBUG                    Connected to Server
16:11:37.203 DEBUG                    Sending HTTP GET /status_2 message.
16:11:37.204 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:37.307 DEBUG                    HTTP Status: 200 - OK
16:11:37.307 DEBUG                    Connect closed for Server
16:11:37.308 DEBUG                    Connect closed for Server
16:11:39.307 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:39.358 DEBUG                    Connected to Server
16:11:39.408 DEBUG                    Sending HTTP GET /status_2 message.
16:11:39.408 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:39.511 DEBUG                    HTTP Status: 200 - OK
16:11:39.512 DEBUG                    Connect closed for Server
16:11:39.512 DEBUG                    Connect closed for Server
16:11:41.512 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:41.562 DEBUG                    Connected to Server
16:11:41.612 DEBUG                    Sending HTTP GET /status_2 message.
16:11:41.613 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:41.729 DEBUG                    HTTP Status: 200 - OK
16:11:41.729 DEBUG                    Connect closed for Server
16:11:41.736 DEBUG                    Connect closed for Server
16:11:43.729 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:43.780 DEBUG                    Connected to Server
16:11:43.830 DEBUG                    Sending HTTP GET /status_2 message.
16:11:43.830 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:43.930 DEBUG                    HTTP Status: 200 - OK
16:11:43.932 DEBUG                    Connect closed for Server
16:11:43.932 DEBUG                    Connect closed for Server
16:11:45.233 DEBUG                    cmd optimus > keydir
16:11:45.251 DEBUG                    cmd optimus > keydir /tmp/
16:11:45.931 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:45.982 DEBUG                    Connected to Server
16:11:46.032 DEBUG                    Sending HTTP GET /status_2 message.
16:11:46.032 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:46.103 DEBUG                    HTTP Status: 200 - OK
16:11:46.104 DEBUG                    Connect closed for Server
16:11:46.104 DEBUG                    Connect closed for Server
16:11:48.104 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:48.154 DEBUG                    Connected to Server
16:11:48.204 DEBUG                    Sending HTTP GET /status_2 message.
16:11:48.205 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:48.324 DEBUG                    HTTP Status: 200 - OK
16:11:48.325 DEBUG                    Connect closed for Server
16:11:48.325 DEBUG                    Connect closed for Server
16:11:50.325 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:50.375 DEBUG                    Connected to Server
16:11:50.425 DEBUG                    Sending HTTP GET /status_2 message.
16:11:50.426 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:50.496 DEBUG                    HTTP Status: 200 - OK
16:11:50.496 DEBUG                    Connect closed for Server
16:11:50.497 DEBUG                    Connect closed for Server
16:11:52.496 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:52.548 DEBUG                    Connected to Server
16:11:52.597 DEBUG                    Sending HTTP GET /status_2 message.
16:11:52.597 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:52.693 DEBUG                    HTTP Status: 200 - OK
16:11:52.694 DEBUG                    Connect closed for Server
16:11:52.694 DEBUG                    Connect closed for Server
16:11:54.693 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:54.744 DEBUG                    Connected to Server
16:11:54.794 DEBUG                    Sending HTTP GET /status_2 message.
16:11:54.795 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:54.906 DEBUG                    HTTP Status: 200 - OK
16:11:54.907 DEBUG                    Connect closed for Server
16:11:54.907 DEBUG                    Connect closed for Server
16:11:56.907 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:56.957 DEBUG                    Connected to Server
16:11:57.007 DEBUG                    Sending HTTP GET /status_2 message.
16:11:57.008 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:57.097 DEBUG                    HTTP Status: 200 - OK
16:11:57.097 DEBUG                    Connect closed for Server
16:11:57.098 DEBUG                    Connect closed for Server
16:11:59.098 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:11:59.148 DEBUG                    Connected to Server
16:11:59.199 DEBUG                    Sending HTTP GET /status_2 message.
16:11:59.199 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:11:59.301 DEBUG                    HTTP Status: 200 - OK
16:11:59.302 DEBUG                    Connect closed for Server
16:11:59.302 DEBUG                    Connect closed for Server
16:12:01.302 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:01.353 DEBUG                    Connected to Server
16:12:01.404 DEBUG                    Sending HTTP GET /status_2 message.
16:12:01.404 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:12:01.508 DEBUG                    HTTP Status: 200 - OK
16:12:01.510 DEBUG                    Connect closed for Server
16:12:01.510 DEBUG                    Connect closed for Server
16:12:03.185 DEBUG                    cmd optimus > keydir ../Keys/
16:12:03.303 DEBUG                    Received SKD message:
|                                     KeyPackageFile:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = List:
|                                             [0]:
|                                                 OneAsymmetricKey:
|                                                     version == 0
|                                                     privateKeyAlgorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     privateKey = ECPrivateKey:
|                                                         version = 1L
|                                                         privateKey = Octets(0x639bca3f319b61577a17dfe4397e4c9b5c503b5e0a39b1c9780a4dab3874bf6e430f05e0eeddbab19ceeb71325a64f82)
|                                                     attributes:
|                                                       [0] = UserCertificateAttr:
|                                                         id == OID(userCertificate:2.5.4.36)
|                                                         userCertificate = Certificate:
|                                                             tbsCertificate = TBSCertificate:
|                                                                 version == 2
|                                                                 serialNumber = 21L
|                                                                 signatureAlgorithmID = AlgorithmIdentifier:
|                                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                 issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 validity = 170112000000Z..99991231235959Z
|                                                                 subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                     algorithm = AlgorithmIdentifier:
|                                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                         parameters = ECParameters:
|                                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                     subjectPublicKey = long768:311352165349553041499165436284714968506428085506578702294641178295529040219189433594322763578445238193232077653909281409949113603810235311696794021271435232384358773521145238903992246289062044548859341344534757312146113895553698941
|                                                                     x = 7901936865794504624286012410946235106706644946527289991756671045438316538105072555204953008404813284842219056047636
|                                                                     y = 38935864345156223981406032190266703454098698065605441129365525583643904544683138548046562093258763553861063602211965
|                                                                 _extensions = CertificateExtensions
|                                                                   [0] AuthorityKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                         keyIdentifier = Octets(0xe0bb003a803a0c7d)
|                                                                   [1] SubjectKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                         id = Octets(0xe0bb003a803a0c7d)
|                                                                   [2] KeyUsage_CertExt:
|                                                                         extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                         critical = True
|                                                                         uses = ['digitalSignature']
|                                                                   [3] CertificatePolicies_CertExt:
|                                                                         extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                         critical = True
|                                                                         policies:
|                                                                           [0] = PolicyInformation:
|                                                                             id = OID(1.2.826.0.1145.0.1.0.3)
|                                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                             signature = Signature:
|                                                                 r = long384:4220374386001273825463960874381957902156232958547631805446039859859819405029329945226874017250182387759452945786721
|                                                                 s = long384:15530732793125356915899717584812611724069905667943999584629416798016086031192924103709604062838697248023976638433586
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                               [1] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0xd361b74b2a1f66ab9e0863a670565cea3976fd57f19285c6b4ba461c9bc73b1e8840dc22797e776417c02a60abe3415d)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:7100033931926025719027807356211377530342381974737685981865153729323290591017730618185033698818815044249643947724929
|                                                 s = long384:38413300373501426206636745323431644763276632742455017011582623458334861909984598716088222111991969547299357507143958
16:12:03.304 DEBUG                    Added keymat FACT-IA: serial=21 auth=0xe0bb003a803a0c7d subj=0xe0bb003a803a0c7d
16:12:03.304 DEBUG                    UUT Control: Applying all recent configuration changes
16:12:03.327 INFO    Test:            131 : [icm-issue-infia-mr-cert-success] The MR
|                                           sends a valid CSR for an InfIA certificate
|                                           from the ICM using file transfer and
|                                           receives a valid response.
16:12:03.338 INFO                           #> 0.1. Create CSR from MR for a Inf IA and write to a file.
16:12:03.346 DEBUG                          Creating SKD message file /tmp/icm_infia.csr
16:12:03.385 DEBUG                          Generating message signature using cert with serial: 21
16:12:03.418 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF0166000,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:760226036346987033682860406789339234351824215127281096314996440188358055274265565305545346549448274453689277034617304126724705861726984415557555514956475293339571442310179464916758120209981609349040513462482439305368833484187653850
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.5
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:14602576042682813401005285637428443256335654463295852402852822787463866609475093995937767480842541391318700346600012
|                                                       s = long384:36066310031568390132672420747516192258029562015402402577366938059977830001743095076059159908541014883763303187271975
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0xe0bb003a803a0c7d-->0xe0bb003a803a0c7d
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 21L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:311352165349553041499165436284714968506428085506578702294641178295529040219189433594322763578445238193232077653909281409949113603810235311696794021271435232384358773521145238903992246289062044548859341344534757312146113895553698941
|                                                               x = 7901936865794504624286012410946235106706644946527289991756671045438316538105072555204953008404813284842219056047636
|                                                               y = 38935864345156223981406032190266703454098698065605441129365525583643904544683138548046562093258763553861063602211965
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xe0bb003a803a0c7d)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xe0bb003a803a0c7d)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:4220374386001273825463960874381957902156232958547631805446039859859819405029329945226874017250182387759452945786721
|                                                           s = long384:15530732793125356915899717584812611724069905667943999584629416798016086031192924103709604062838697248023976638433586
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0xe0bb003a803a0c7d)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112161203Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x9a649d4192bd4e60b04f4825771eba6c863d06a7fd29fe199422871a355ed9bf970733c52b64c06ae37dadf2eee3db87)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x154146b57ed9c705)
|                                                           msgCount = 0L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:28671886157244100159724894564519573421866014685129031982565463079668950275406524279348170805790551827093209861647815
|                                                       s = long384:10852702066524326882778515394986007654760376836232481095351630872827584356443987932685803889426967987278242331188083
16:12:03.439 INFO                           #> 0.2. Load the CSR into the ICM.
16:12:03.509 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:03.563 DEBUG                          Connected to Server
16:12:03.610 DEBUG                          Sending HTTP GET /status_2 message.
16:12:03.611 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:03.689 DEBUG                          HTTP Status: 200 - OK
16:12:03.690 DEBUG                          Connect closed for Server
16:12:03.693 DEBUG                          Connect closed for Server
16:12:05.689 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:05.741 DEBUG                          Connected to Server
16:12:05.791 DEBUG                          Sending HTTP GET /status_2 message.
16:12:05.792 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:05.922 DEBUG                          HTTP Status: 200 - OK
16:12:05.923 DEBUG                          Connect closed for Server
16:12:05.923 DEBUG                          Connect closed for Server
16:12:07.922 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:07.973 DEBUG                          Connected to Server
16:12:08.023 DEBUG                          Sending HTTP GET /status_2 message.
16:12:08.024 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:08.119 DEBUG                          HTTP Status: 200 - OK
16:12:08.120 DEBUG                          Connect closed for Server
16:12:08.121 DEBUG                          Connect closed for Server
16:12:10.122 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:10.176 DEBUG                          Connected to Server
16:12:10.223 DEBUG                          Sending HTTP GET /status_2 message.
16:12:10.224 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:10.306 DEBUG                          HTTP Status: 200 - OK
16:12:10.307 DEBUG                          Connect closed for Server
16:12:10.308 DEBUG                          Connect closed for Server
16:12:12.104 INFO                           #> 0.3. Check that the operator is able to view a list of imported CSRs as well as the data relevant to the new request.
16:12:12.307 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:12.358 DEBUG                          Connected to Server
16:12:12.408 DEBUG                          Sending HTTP GET /status_2 message.
16:12:12.409 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:12.512 DEBUG                          HTTP Status: 200 - OK
16:12:12.513 DEBUG                          Connect closed for Server
16:12:12.520 DEBUG                          Connect closed for Server
16:12:13.011 INFO                           #> 0.4. The ICM operator approves the CSR.
16:12:14.513 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:14.564 DEBUG                          Connected to Server
16:12:14.613 DEBUG                          Sending HTTP GET /status_2 message.
16:12:14.614 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:14.703 DEBUG                          HTTP Status: 200 - OK
16:12:14.704 DEBUG                          Connect closed for Server
16:12:14.705 DEBUG                          Connect closed for Server
16:12:16.704 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:16.756 DEBUG                          Connected to Server
16:12:16.806 DEBUG                          Sending HTTP GET /status_2 message.
16:12:16.806 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:16.917 DEBUG                          HTTP Status: 200 - OK
16:12:16.918 DEBUG                          Connect closed for Server
16:12:16.919 DEBUG                          Connect closed for Server
16:12:18.918 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:18.969 DEBUG                          Connected to Server
16:12:19.025 DEBUG                          Sending HTTP GET /status_2 message.
16:12:19.025 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:19.118 DEBUG                          HTTP Status: 200 - OK
16:12:19.120 DEBUG                          Connect closed for Server
16:12:19.127 DEBUG                          Connect closed for Server
16:12:21.119 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:21.170 DEBUG                          Connected to Server
16:12:21.222 DEBUG                          Sending HTTP GET /status_2 message.
16:12:21.222 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:21.323 DEBUG                          HTTP Status: 200 - OK
16:12:21.325 DEBUG                          Connect closed for Server
16:12:21.332 DEBUG                          Connect closed for Server
16:12:23.332 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:23.384 DEBUG                          Connected to Server
16:12:23.433 DEBUG                          Sending HTTP GET /status_2 message.
16:12:23.434 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:23.528 DEBUG                          HTTP Status: 200 - OK
16:12:23.529 DEBUG                          Connect closed for Server
16:12:23.530 DEBUG                          Connect closed for Server
16:12:25.529 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:25.580 DEBUG                          Connected to Server
16:12:25.630 DEBUG                          Sending HTTP GET /status_2 message.
16:12:25.631 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:25.702 DEBUG                          HTTP Status: 200 - OK
16:12:25.704 DEBUG                          Connect closed for Server
16:12:25.704 DEBUG                          Connect closed for Server
16:12:27.703 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:27.754 DEBUG                          Connected to Server
16:12:27.805 DEBUG                          Sending HTTP GET /status_2 message.
16:12:27.806 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:27.924 DEBUG                          HTTP Status: 200 - OK
16:12:27.926 DEBUG                          Connect closed for Server
16:12:27.926 DEBUG                          Connect closed for Server
16:12:29.934 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:29.990 DEBUG                          Connected to Server
16:12:30.036 DEBUG                          Sending HTTP GET /status_2 message.
16:12:30.037 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:30.133 DEBUG                          HTTP Status: 200 - OK
16:12:30.134 DEBUG                          Connect closed for Server
16:12:30.134 DEBUG                          Connect closed for Server
16:12:31.343 INFO                           #> 0.5. A response is exported from the ICM and imported into the test harness and decoded.
16:12:32.133 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:32.185 DEBUG                          Connected to Server
16:12:32.235 DEBUG                          Sending HTTP GET /status_2 message.
16:12:32.236 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:32.323 DEBUG                          HTTP Status: 200 - OK
16:12:32.325 DEBUG                          Connect closed for Server
16:12:32.327 DEBUG                          Connect closed for Server
16:12:34.324 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:34.375 DEBUG                          Connected to Server
16:12:34.425 DEBUG                          Sending HTTP GET /status_2 message.
16:12:34.425 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:44.102 DEBUG                          HTTP Status: 200 - OK
16:12:44.103 DEBUG                          Connect closed for Server
16:12:44.104 DEBUG                          Connect closed for Server
16:12:46.102 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:46.153 DEBUG                          Connected to Server
16:12:46.204 DEBUG                          Sending HTTP GET /status_2 message.
16:12:46.205 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:46.335 DEBUG                          HTTP Status: 200 - OK
16:12:46.337 DEBUG                          Connect closed for Server
16:12:46.337 DEBUG                          Connect closed for Server
16:12:48.336 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:48.388 DEBUG                          Connected to Server
16:12:48.437 DEBUG                          Sending HTTP GET /status_2 message.
16:12:48.438 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:48.502 DEBUG                          HTTP Status: 200 - OK
16:12:48.504 DEBUG                          Connect closed for Server
16:12:48.510 DEBUG                          Connect closed for Server
16:12:50.503 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:50.555 DEBUG                          Connected to Server
16:12:50.604 DEBUG                          Sending HTTP GET /status_2 message.
16:12:50.605 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:50.817 DEBUG                          HTTP Status: 200 - OK
16:12:50.818 DEBUG                          Connect closed for Server
16:12:50.820 DEBUG                          Connect closed for Server
16:12:52.818 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:52.872 DEBUG                          Connected to Server
16:12:52.919 DEBUG                          Sending HTTP GET /status_2 message.
16:12:52.920 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:53.035 DEBUG                          HTTP Status: 200 - OK
16:12:53.037 DEBUG                          Connect closed for Server
16:12:53.038 DEBUG                          Connect closed for Server
16:12:55.036 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:55.088 DEBUG                          Connected to Server
16:12:55.137 DEBUG                          Sending HTTP GET /status_2 message.
16:12:55.138 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:55.209 DEBUG                          HTTP Status: 200 - OK
16:12:55.210 DEBUG                          Connect closed for Server
16:12:55.211 DEBUG                          Connect closed for Server
16:12:57.211 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:57.274 DEBUG                          Connected to Server
16:12:57.312 DEBUG                          Sending HTTP GET /status_2 message.
16:12:57.313 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:57.427 DEBUG                          HTTP Status: 200 - OK
16:12:57.428 DEBUG                          Connect closed for Server
16:12:57.437 DEBUG                          Connect closed for Server
16:12:59.428 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:12:59.479 DEBUG                          Connected to Server
16:12:59.533 DEBUG                          Sending HTTP GET /status_2 message.
16:12:59.534 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:12:59.701 DEBUG                          HTTP Status: 200 - OK
16:12:59.702 DEBUG                          Connect closed for Server
16:12:59.703 DEBUG                          Connect closed for Server
16:13:01.704 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:01.756 DEBUG                          Connected to Server
16:13:01.806 DEBUG                          Sending HTTP GET /status_2 message.
16:13:01.807 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:01.893 DEBUG                          HTTP Status: 200 - OK
16:13:01.896 DEBUG                          Connect closed for Server
16:13:01.905 DEBUG                          Connect closed for Server
16:13:03.894 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:03.946 DEBUG                          Connected to Server
16:13:03.995 DEBUG                          Sending HTTP GET /status_2 message.
16:13:03.996 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:04.107 DEBUG                          HTTP Status: 200 - OK
16:13:04.109 DEBUG                          Connect closed for Server
16:13:04.110 DEBUG                          Connect closed for Server
16:13:06.108 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:06.160 DEBUG                          Connected to Server
16:13:06.209 DEBUG                          Sending HTTP GET /status_2 message.
16:13:06.210 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:06.310 DEBUG                          HTTP Status: 200 - OK
16:13:06.318 DEBUG                          Connect closed for Server
16:13:06.320 DEBUG                          Connect closed for Server
16:13:08.311 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:08.362 DEBUG                          Connected to Server
16:13:08.412 DEBUG                          Sending HTTP GET /status_2 message.
16:13:08.413 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:08.537 DEBUG                          HTTP Status: 200 - OK
16:13:08.538 DEBUG                          Connect closed for Server
16:13:08.543 DEBUG                          Connect closed for Server
16:13:10.538 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:10.590 DEBUG                          Connected to Server
16:13:10.644 DEBUG                          Sending HTTP GET /status_2 message.
16:13:10.645 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:10.710 DEBUG                          HTTP Status: 200 - OK
16:13:10.712 DEBUG                          Connect closed for Server
16:13:10.712 DEBUG                          Connect closed for Server
16:13:12.711 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:12.763 DEBUG                          Connected to Server
16:13:12.812 DEBUG                          Sending HTTP GET /status_2 message.
16:13:12.813 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:12.913 DEBUG                          HTTP Status: 200 - OK
16:13:12.914 DEBUG                          Connect closed for Server
16:13:12.915 DEBUG                          Connect closed for Server
16:13:14.914 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:14.965 DEBUG                          Connected to Server
16:13:15.015 DEBUG                          Sending HTTP GET /status_2 message.
16:13:15.016 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:15.124 DEBUG                          HTTP Status: 200 - OK
16:13:15.126 DEBUG                          Connect closed for Server
16:13:15.127 DEBUG                          Connect closed for Server
16:13:17.125 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:17.176 DEBUG                          Connected to Server
16:13:17.226 DEBUG                          Sending HTTP GET /status_2 message.
16:13:17.227 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:17.334 DEBUG                          HTTP Status: 200 - OK
16:13:17.335 DEBUG                          Connect closed for Server
16:13:17.335 DEBUG                          Connect closed for Server
16:13:19.335 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:19.386 DEBUG                          Connected to Server
16:13:19.436 DEBUG                          Sending HTTP GET /status_2 message.
16:13:19.437 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:19.637 DEBUG                          HTTP Status: 200 - OK
16:13:19.638 DEBUG                          Connect closed for Server
16:13:19.639 DEBUG                          Connect closed for Server
16:13:21.638 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:21.689 DEBUG                          Connected to Server
16:13:21.739 DEBUG                          Sending HTTP GET /status_2 message.
16:13:21.742 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:21.922 DEBUG                          HTTP Status: 200 - OK
16:13:21.922 DEBUG                          Connect closed for Server
16:13:21.923 DEBUG                          Connect closed for Server
16:13:23.922 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:23.974 DEBUG                          Connected to Server
16:13:24.023 DEBUG                          Sending HTTP GET /status_2 message.
16:13:24.024 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:24.175 DEBUG                          HTTP Status: 200 - OK
16:13:24.184 DEBUG                          Connect closed for Server
16:13:24.185 DEBUG                          Connect closed for Server
16:13:26.176 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:26.228 DEBUG                          Connected to Server
16:13:26.277 DEBUG                          Sending HTTP GET /status_2 message.
16:13:26.278 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:26.406 DEBUG                          HTTP Status: 200 - OK
16:13:26.407 DEBUG                          Connect closed for Server
16:13:26.413 DEBUG                          Connect closed for Server
16:13:28.407 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:28.458 DEBUG                          Connected to Server
16:13:28.508 DEBUG                          Sending HTTP GET /status_2 message.
16:13:28.509 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:28.605 DEBUG                          HTTP Status: 200 - OK
16:13:28.606 DEBUG                          Connect closed for Server
16:13:28.606 DEBUG                          Connect closed for Server
16:13:30.606 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:30.659 DEBUG                          Connected to Server
16:13:30.706 DEBUG                          Sending HTTP GET /status_2 message.
16:13:30.707 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:30.799 DEBUG                          HTTP Status: 200 - OK
16:13:30.799 DEBUG                          Connect closed for Server
16:13:30.805 DEBUG                          Connect closed for Server
16:13:32.800 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:32.851 DEBUG                          Connected to Server
16:13:32.901 DEBUG                          Sending HTTP GET /status_2 message.
16:13:32.901 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:33.011 DEBUG                          HTTP Status: 200 - OK
16:13:33.013 DEBUG                          Connect closed for Server
16:13:33.014 DEBUG                          Connect closed for Server
16:13:35.012 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:35.063 DEBUG                          Connected to Server
16:13:35.113 DEBUG                          Sending HTTP GET /status_2 message.
16:13:35.114 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:35.188 DEBUG                          HTTP Status: 200 - OK
16:13:35.189 DEBUG                          Connect closed for Server
16:13:35.190 DEBUG                          Connect closed for Server
16:13:37.195 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:37.246 DEBUG                          Connected to Server
16:13:37.296 DEBUG                          Sending HTTP GET /status_2 message.
16:13:37.298 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:13:37.431 DEBUG                          HTTP Status: 200 - OK
16:13:37.433 DEBUG                          Connect closed for Server
16:13:37.433 DEBUG                          Connect closed for Server
16:13:39.203 DEBUG                          Received SKD message:
|                                           CertificateSigningResponse:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = PKIResponse:
|                                                   controlSequence:
|                                                     [0] = TaggedAttribute:
|                                                       bodyPartID = Integer(1)
|                                                       attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                       attrValues = CMCStatusInfoV2:
|                                                           cMCStatus = Integer(0)
|                                               certificates (2 chains, 4 certificates) = 
|                                                 Chains summary:
|                                                   0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                                   0x16ab3b12caca56da-->0xa5358105401137fa-->0xc9020cefbb66368c
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                               x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                               y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                           _extensions = CertificateExtensions
|                                                             [0] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.3
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x1de6a414dda88f8b)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                           s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                       [0.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 82825L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112155131Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                               x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                               y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                           _extensions = CertificateExtensions
|                                                             [0] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                             [1] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [2] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x2eb4fc66f0202ec8)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   critical = True
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0123456'
|                                                                           endEsn = 'D8EFF0123456'
|                                                                       deviceFunctions = OIDList[1]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                           s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                                   Chain[1] =
|                                                       [1.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 22L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112151225Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0166000,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:760226036346987033682860406789339234351824215127281096314996440188358055274265565305545346549448274453689277034617304126724705861726984415557555514956475293339571442310179464916758120209981609349040513462482439305368833484187653850
|                                                               x = 19294094634616657995658764337353703803785649318852639210542492939484134265456242653376143006651295346256334689163715
|                                                               y = 19134923648986899432256656351452117558607609124220506920402340050288012243328211677203397537407258383038110883272410
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xa5358105401137fa)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x16ab3b12caca56da)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] SubjectDirectoryAttributes_CertExt:
|                                                                   extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                   attributes:
|                                                                     [0] = DeviceFunctionAttribute:
|                                                                       id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                       deviceFunctions:
|                                                                         [0] = 1.2.826.0.1145.0.10.5
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:17525508461104676503302664531261758999056634621587633933749787539367480256726834907122352588072910301021070038014299
|                                                           s = long384:13856765530787074536621051532737390283548916317521534394456405598208250402971288583032856339103618559449222938332579
|                                                       [1.1] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 20002L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                           validity = 170112161133Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:876735982751595285192402460670474421041275887743332806038263564773754060454310931475257931279301137127030705295533550382278411812007555437554600474140306706493800528431169721665527979331819073976403079117113974444766256628707178490
|                                                               x = 22251049309053250847536744415129503323202777299983129034092169971531246373952794154805687624610903603552052410386120
|                                                               y = 38804747633093109847397834030529252739764162389441507458619332421055024585102870554161022690051336128644784879384570
|                                                           _extensions = CertificateExtensions
|                                                             [0] CertificateConstraints_CertExt:
|                                                                   extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                   constraints = CertificateConstraints:
|                                                                       range = EsnRange:
|                                                                           startEsn = 'D8EFF0000000'
|                                                                           endEsn = 'D8EFF9999999'
|                                                                       deviceFunctions = OIDList[5]:
|                                                                         0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                         1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                         2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                         3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                         4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                             [1] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                             [2] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.4)
|                                                             [3] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0xa5358105401137fa)
|                                                             [4] CRLDistributionPoints_CertExt:
|                                                                   extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                                   distributionPoints:
|                                                                     [0] = DistributionPoint:
|                                                                       cRLIssuer:
|                                                                         [0] = GeneralName:
|                                                                           directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                             [5] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['keyCertSign']
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:5221487676081248042909945898962913048512050116461565801827368413423482343234399438965487973105777864390225031499152
|                                                           s = long384:35255745834290144753124411021368749732165875351400149363308883592086783518307830573913878426494458562550174853377777
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                                     [1] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = False
|                                                           responseExpected = False
|                                                     [2] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112161226Z)
|                                                     [3] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x154146b57ed9c705)
|                                                           msgCount = 0L
|                                                     [4] = DestinationAttribute:
|                                                       id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                       name = Name: SN=,CN=
|                                                     [5] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:29203533256969641883256378027375885612278638966870918532859858206914250977470777369698930834767092066359128513364210
|                                                       s = long384:33392800382032237557597979929830549633351484121341356897295010758755498968657476173749777422377394226053923499630626
16:13:39.207 INFO                           #> 0.6. Check that CSR response is signed by the ICM and includes new Inf IA with the MR device function.
16:13:39.253 ERROR   Test:                  FAIL
16:13:39.261 ERROR                          Test failed
16:13:39.261 ERROR                          Received invalid certificate start time: 12/01/2017 15:12:25.
|                                           Expecting a time between: 12/01/2017 15:12:39 - 12/01/2017 15:14:39.
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/Assertions.py: __call__
|                                              337 :         if addDetails is not None:
|                                              338 :             details += "\n" + addDetails()
|                                              339 :
|                                           ==>340 :         raise Errors.Failure(details, altStack=kwargs.pop("altStack", None))
|                                              341 :
|                                              342 :
|                                              343 : def _failAlways(asserter, *args, **kwargs):
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/Assertions.py: failUnlessInRange
|                                              575 :     return _failUnlessInRange(minVal, maxVal, actual, *args, **kwargs)
|                                           ../../checks/tg/certs/cert_check.py: checkInfCertPeriod
|                                              474 :                                                       timeToStr(upperBound)))
|                                           ../../checks/tg/certs/issue/infia.py: _invoke
|                                              199 :         cert_check.checkInfCertPeriod(infIa)
|                                           ../../checks/__init__.py: __call__
|                                              461 :             ret = self._invoke(*args, **kwargs)
|                                           ../../test_support/skdbase.py: runSuccessChecksOnRequestingInfIa
|                                              374 :                                                 policy)
|                                           test_issue_mr_infia.py: _issueInfIaAndPerformChecks
|                                              156 :                                                expDevFunc, "ICM")
|                                           test_issue_mr_infia.py: issueInfIaCertSuccess
|                                              179 :         self._issueInfIaAndPerformChecks(isInteractive=False)
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/testspec.py: run
|                                              357 :             func(*args, **kwargs)
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/testspec.py: runAndTrace
|                                              76  :         runTracer.run(func, args, kwargs)
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/Manager.py: _invoke
|                                              1181:                 self.spec.runAndTrace(self._func)
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/Manager.py: __call__
|                                              1238:                 if self._runner:
|                                              1239:                     ret = self._runner.callFunc(id(self), "_invoke")
|                                              1240:                 else:
|                                           ==>1241:                     ret = self._invoke()
|                                              1242:             else:
|                                              1243:                 print("Do Nowt!!!!")
|                                              1244:         except testKillers as self.origExc:
16:13:39.404 DEBUG                    Tearing down mock HTTP servers
16:13:39.407 DEBUG                    Connect closed for Server
16:13:39.408 DEBUG                    Connect closed for Server
16:13:39.432 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:39.483 DEBUG                    Connected to Server
16:13:39.533 DEBUG                    Sending HTTP GET /status_2 message.
16:13:39.534 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:13:39.749 DEBUG                    HTTP Status: 200 - OK
16:13:39.749 DEBUG                    Connect closed for Server
16:13:39.750 DEBUG                    Connect closed for Server
16:13:41.750 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:41.801 DEBUG                    Connected to Server
16:13:41.851 DEBUG                    Sending HTTP GET /status_2 message.
16:13:41.851 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:13:41.888 DEBUG                    HTTP Status: 200 - OK
16:13:41.889 DEBUG                    Connect closed for Server
16:13:41.889 DEBUG                    Connect closed for Server
16:13:43.889 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:43.940 DEBUG                    Connected to Server
16:13:43.990 DEBUG                    Sending HTTP GET /status_2 message.
16:13:43.990 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:13:44.122 DEBUG                    HTTP Status: 200 - OK
16:13:44.123 DEBUG                    Connect closed for Server
16:13:44.123 DEBUG                    Connect closed for Server
16:13:46.123 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:46.174 DEBUG                    Connected to Server
16:13:46.224 DEBUG                    Sending HTTP GET /status_2 message.
16:13:46.224 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:13:46.310 DEBUG                    HTTP Status: 200 - OK
16:13:46.311 DEBUG                    Connect closed for Server
16:13:46.312 DEBUG                    Connect closed for Server
16:13:48.311 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:48.363 DEBUG                    Connected to Server
16:13:48.412 DEBUG                    Sending HTTP GET /status_2 message.
16:13:48.412 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:13:48.519 DEBUG                    HTTP Status: 200 - OK
16:13:48.519 DEBUG                    Connect closed for Server
16:13:48.520 DEBUG                    Connect closed for Server
16:13:50.519 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:50.570 DEBUG                    Connected to Server
16:13:50.620 DEBUG                    Sending HTTP GET /status_2 message.
16:13:50.621 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:13:50.735 DEBUG                    HTTP Status: 200 - OK
16:13:50.736 DEBUG                    Connect closed for Server
16:13:50.736 DEBUG                    Connect closed for Server
16:13:51.820 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:13:51.820 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:13:51.832 DEBUG                    Generating certificate signature for serial: 88999
16:13:51.838 DEBUG                    Added keymat IR-INF-CA: serial=88999 auth=0xc9020cefbb66368c subj=0x224fc47c1908101b
16:13:51.849 DEBUG                    Generating certificate signature for serial: 82119
16:13:51.856 DEBUG                    Added keymat IR-INF-IA: serial=82119 auth=0x224fc47c1908101b subj=0xf75d9f601f8737f6
16:13:51.868 DEBUG                    Generating certificate signature for serial: 86837
16:13:51.873 DEBUG                    Added keymat IR-INF-CRL-CA: serial=86837 auth=0xc9020cefbb66368c subj=0xb23374ae03dc16a9
16:13:51.886 DEBUG                    Generating certificate signature for serial: 84808
16:13:51.891 DEBUG                    Added keymat IR-INF-CRL-IA: serial=84808 auth=0xb23374ae03dc16a9 subj=0x3971714e496e55e2
16:13:51.902 DEBUG                    Generating certificate signature for serial: 5
16:13:51.907 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x065009e8d18f3326 subj=0x065009e8d18f3326
16:13:51.916 DEBUG                    Generating message signature using cert with serial: 82119
16:13:51.951 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:13:52.001 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x065009e8d18f3326 subj=0x065009e8d18f3326
16:13:52.007 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:13:52.024 DEBUG                    Generating message signature using cert with serial: 5
16:13:52.082 DEBUG                    IR: Handling Certificate Signing Request.
16:13:52.082 DEBUG                    Creating temporary CA cert to issue IA
16:13:52.095 DEBUG                    Generating certificate signature for serial: 85750
16:13:52.101 DEBUG                    Added keymat IR-INF-CA-TMP: serial=85750 auth=0xc9020cefbb66368c subj=0xdac20db93cbb0f44
16:13:52.101 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:13:52.107 DEBUG                    Generating certificate signature for serial: 20000
16:13:52.114 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:13:52.117 DEBUG                    Generating message signature using cert with serial: 82119
16:13:52.234 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:13:52.234 DEBUG                    Received Inf IA response
16:13:52.235 DEBUG                    Added keymat IR-INF-CA: serial=85750 auth=0xc9020cefbb66368c subj=0xdac20db93cbb0f44
16:13:52.235 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0xdac20db93cbb0f44 subj=0xcaa0a1c9d885423c
16:13:52.245 DEBUG                    Generating certificate signature for serial: 5
16:13:52.251 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x6979b28a11a33e53 subj=0x6979b28a11a33e53
16:13:52.260 DEBUG                    Generating message signature using cert with serial: 20000
16:13:52.296 DEBUG                    Creating SKD message file /tmp/icmCaReq
16:13:52.314 DEBUG                    Generating message signature using cert with serial: 20000
16:13:52.397 DEBUG                    IR: Handling Certificate Signing Request.
16:13:52.398 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
16:13:52.404 DEBUG                    Generating certificate signature for serial: 20001
16:13:52.411 DEBUG                    Creating SKD message file /tmp/icmCaResp
16:13:52.414 DEBUG                    Generating message signature using cert with serial: 82119
16:13:52.510 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:13:52.510 DEBUG                    Received Inf CA response
16:13:52.510 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x82b0cf531cc68597
16:13:52.510 INFO                     Listening for ('128.10.1.4', 80)
16:13:52.515 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:13:52.519 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:13:52.519 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:13:52.570 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x6979b28a11a33e53 subj=0x6979b28a11a33e53
16:13:52.576 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:13:52.593 DEBUG                    Generating message signature using cert with serial: 5
16:13:52.651 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:13:52.658 DEBUG                    Generating certificate signature for serial: 20000
16:13:52.664 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:13:52.667 DEBUG                    Generating message signature using cert with serial: 20000
16:13:52.783 DEBUG                    Received Inf IA response
16:13:52.784 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x82b0cf531cc68597
16:13:52.784 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x82b0cf531cc68597 subj=0x2bcc6a0e4675400f
16:13:52.788 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:13:52.792 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:13:52.842 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x6979b28a11a33e53 subj=0x6979b28a11a33e53
16:13:52.843 INFO                     Listening for ('128.10.1.6', 80)
16:13:52.843 DEBUG                    MCKM requesting Inf IA from ICM.
16:13:52.849 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
16:13:52.865 DEBUG                    Generating message signature using cert with serial: 5
16:13:52.884 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:13:52.884 INFO                     SKD: Client ---> Server CMC-request (1340 bytes)
16:13:52.884 INFO                     Sent CSR for Inf IA certificate.
16:13:52.885 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:52.885 DEBUG                    110748624: Connect accepted from Client
16:13:52.936 DEBUG                    Connected to Server
16:13:52.936 DEBUG                    Connected to Server
16:13:52.985 DEBUG                    Sending HTTP POST /fullcmc message.
16:13:52.986 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:13:52.986 DEBUG                    Sending HTTP GET /status_2 message.
16:13:52.987 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:13:53.037 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:13:53.038 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
16:13:53.044 DEBUG                    Generating certificate signature for serial: 20001
16:13:53.054 DEBUG                    Generating message signature using cert with serial: 20000
16:13:53.111 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:13:53.112 DEBUG                    HTTP Status: 200 - OK
16:13:53.113 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3135 bytes)
16:13:53.180 INFO                     MCKM: Handling incoming CertificateSigningResponse
16:13:53.181 DEBUG                    Received Inf IA response
16:13:53.181 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x82b0cf531cc68597
16:13:53.181 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x82b0cf531cc68597 subj=0x03973390dac62f6c
16:13:53.182 DEBUG                    HTTP Status: 200 - OK
16:13:53.182 DEBUG                    Connect closed for Server
16:13:53.183 DEBUG                    Connect closed for Server
16:13:54.896 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:13:54.969 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x6979b28a11a33e53 subj=0x6979b28a11a33e53
16:13:54.969 DEBUG                    CKA requesting Inf IA from ICM.
16:13:54.975 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
16:13:54.993 DEBUG                    Generating message signature using cert with serial: 5
16:13:55.012 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:13:55.012 INFO                     SKD: Client ---> Server CMC-request (1331 bytes)
16:13:55.012 INFO                     Sent CSR for Inf IA certificate.
16:13:55.013 DEBUG                    110748624: Connect accepted from Client
16:13:55.013 DEBUG                    Connect closed for Server
16:13:55.014 DEBUG                    Connect closed for Server
16:13:55.063 DEBUG                    Connected to Server
16:13:55.113 DEBUG                    Sending HTTP POST /fullcmc message.
16:13:55.113 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:13:55.174 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:13:55.174 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
16:13:55.181 DEBUG                    Generating certificate signature for serial: 20002
16:13:55.190 DEBUG                    Generating message signature using cert with serial: 20000
16:13:55.254 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:13:55.255 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:55.256 DEBUG                    HTTP Status: 200 - OK
16:13:55.258 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3126 bytes)
16:13:55.323 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
16:13:55.324 DEBUG                    Received Inf IA response
16:13:55.324 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x82b0cf531cc68597
16:13:55.324 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x82b0cf531cc68597 subj=0x34a79532d9e557a7
16:13:55.325 DEBUG                    Connected to Server
16:13:55.355 DEBUG                    Sending HTTP GET /status_2 message.
16:13:55.356 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:13:55.387 DEBUG                    HTTP Status: 200 - OK
16:13:55.388 DEBUG                    Connect closed for Server
16:13:55.388 DEBUG                    Connect closed for Server
16:13:57.388 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:57.439 DEBUG                    Connected to Server
16:13:57.489 DEBUG                    Sending HTTP GET /status_2 message.
16:13:57.490 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:13:57.589 DEBUG                    HTTP Status: 200 - OK
16:13:57.589 DEBUG                    Connect closed for Server
16:13:57.589 DEBUG                    Connect closed for Server
16:13:59.218 DEBUG                    ########## Mocks complete ##########
16:13:59.589 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:13:59.640 DEBUG                    Connected to Server
16:13:59.694 DEBUG                    Sending HTTP GET /status_2 message.
16:13:59.694 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:13:59.820 DEBUG                    HTTP Status: 200 - OK
16:13:59.821 DEBUG                    Connect closed for Server
16:13:59.822 DEBUG                    Connect closed for Server
16:14:00.201 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:14:00.201 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:14:01.327 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:14:01.327 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:14:01.824 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:01.875 DEBUG                    Connected to Server
16:14:01.924 DEBUG                    Sending HTTP GET /status_2 message.
16:14:01.925 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:01.995 DEBUG                    HTTP Status: 200 - OK
16:14:01.995 DEBUG                    Connect closed for Server
16:14:01.995 DEBUG                    Connect closed for Server
16:14:03.995 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:04.046 DEBUG                    Connected to Server
16:14:04.096 DEBUG                    Sending HTTP GET /status_2 message.
16:14:04.096 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:04.197 DEBUG                    HTTP Status: 200 - OK
16:14:04.198 DEBUG                    Connect closed for Server
16:14:04.198 DEBUG                    Connect closed for Server
16:14:06.198 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:06.248 DEBUG                    Connected to Server
16:14:06.298 DEBUG                    Sending HTTP GET /status_2 message.
16:14:06.299 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:06.418 DEBUG                    HTTP Status: 200 - OK
16:14:06.419 DEBUG                    Connect closed for Server
16:14:06.419 DEBUG                    Connect closed for Server
16:14:08.419 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:08.470 DEBUG                    Connected to Server
16:14:08.520 DEBUG                    Sending HTTP GET /status_2 message.
16:14:08.520 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:08.594 DEBUG                    HTTP Status: 200 - OK
16:14:08.595 DEBUG                    Connect closed for Server
16:14:08.595 DEBUG                    Connect closed for Server
16:14:10.595 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:10.646 DEBUG                    Connected to Server
16:14:10.696 DEBUG                    Sending HTTP GET /status_2 message.
16:14:10.696 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:23.228 DEBUG                    HTTP Status: 200 - OK
16:14:23.228 DEBUG                    Connect closed for Server
16:14:23.229 DEBUG                    Connect closed for Server
16:14:25.229 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:25.280 DEBUG                    Connected to Server
16:14:25.330 DEBUG                    Sending HTTP GET /status_2 message.
16:14:25.330 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:25.432 DEBUG                    HTTP Status: 200 - OK
16:14:25.432 DEBUG                    Connect closed for Server
16:14:25.433 DEBUG                    Connect closed for Server
16:14:27.432 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:27.483 DEBUG                    Connected to Server
16:14:27.533 DEBUG                    Sending HTTP GET /status_2 message.
16:14:27.533 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:27.653 DEBUG                    HTTP Status: 200 - OK
16:14:27.654 DEBUG                    Connect closed for Server
16:14:27.655 DEBUG                    Connect closed for Server
16:14:29.654 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:29.708 DEBUG                    Connected to Server
16:14:29.755 DEBUG                    Sending HTTP GET /status_2 message.
16:14:29.755 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:29.840 DEBUG                    HTTP Status: 200 - OK
16:14:29.841 DEBUG                    Connect closed for Server
16:14:29.841 DEBUG                    Connect closed for Server
16:14:31.841 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:31.891 DEBUG                    Connected to Server
16:14:31.942 DEBUG                    Sending HTTP GET /status_2 message.
16:14:31.943 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:32.142 DEBUG                    HTTP Status: 200 - OK
16:14:32.143 DEBUG                    Connect closed for Server
16:14:32.143 DEBUG                    Connect closed for Server
16:14:34.143 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:34.194 DEBUG                    Connected to Server
16:14:34.243 DEBUG                    Sending HTTP GET /status_2 message.
16:14:34.244 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:34.344 DEBUG                    HTTP Status: 200 - OK
16:14:34.344 DEBUG                    Connect closed for Server
16:14:34.344 DEBUG                    Connect closed for Server
16:14:36.344 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:36.395 DEBUG                    Connected to Server
16:14:36.445 DEBUG                    Sending HTTP GET /status_2 message.
16:14:36.445 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:36.513 DEBUG                    HTTP Status: 200 - OK
16:14:36.514 DEBUG                    Connect closed for Server
16:14:36.514 DEBUG                    Connect closed for Server
16:14:38.513 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:38.564 DEBUG                    Connected to Server
16:14:38.614 DEBUG                    Sending HTTP GET /status_2 message.
16:14:38.614 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:38.717 DEBUG                    HTTP Status: 200 - OK
16:14:38.718 DEBUG                    Connect closed for Server
16:14:38.719 DEBUG                    Connect closed for Server
16:14:40.718 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:40.769 DEBUG                    Connected to Server
16:14:40.818 DEBUG                    Sending HTTP GET /status_2 message.
16:14:40.819 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:40.912 DEBUG                    HTTP Status: 200 - OK
16:14:40.913 DEBUG                    Connect closed for Server
16:14:40.913 DEBUG                    Connect closed for Server
16:14:42.912 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:42.963 DEBUG                    Connected to Server
16:14:43.013 DEBUG                    Sending HTTP GET /status_2 message.
16:14:43.014 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:43.151 DEBUG                    HTTP Status: 200 - OK
16:14:43.152 DEBUG                    Connect closed for Server
16:14:43.152 DEBUG                    Connect closed for Server
16:14:45.158 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:45.209 DEBUG                    Connected to Server
16:14:45.258 DEBUG                    Sending HTTP GET /status_2 message.
16:14:45.259 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:45.394 DEBUG                    HTTP Status: 200 - OK
16:14:45.395 DEBUG                    Connect closed for Server
16:14:45.396 DEBUG                    Connect closed for Server
16:14:47.395 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:47.446 DEBUG                    Connected to Server
16:14:47.495 DEBUG                    Sending HTTP GET /status_2 message.
16:14:47.496 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:47.638 DEBUG                    HTTP Status: 200 - OK
16:14:47.639 DEBUG                    Connect closed for Server
16:14:47.639 DEBUG                    Connect closed for Server
16:14:49.639 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:49.694 DEBUG                    Connected to Server
16:14:49.744 DEBUG                    Sending HTTP GET /status_2 message.
16:14:49.745 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:49.829 DEBUG                    HTTP Status: 200 - OK
16:14:49.829 DEBUG                    Connect closed for Server
16:14:49.830 DEBUG                    Connect closed for Server
16:14:51.833 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:51.884 DEBUG                    Connected to Server
16:14:51.934 DEBUG                    Sending HTTP GET /status_2 message.
16:14:51.935 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:52.020 DEBUG                    HTTP Status: 200 - OK
16:14:52.021 DEBUG                    Connect closed for Server
16:14:52.021 DEBUG                    Connect closed for Server
16:14:54.021 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:54.072 DEBUG                    Connected to Server
16:14:54.121 DEBUG                    Sending HTTP GET /status_2 message.
16:14:54.122 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:54.225 DEBUG                    HTTP Status: 200 - OK
16:14:54.226 DEBUG                    Connect closed for Server
16:14:54.226 DEBUG                    Connect closed for Server
16:14:56.226 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:56.279 DEBUG                    Connected to Server
16:14:56.327 DEBUG                    Sending HTTP GET /status_2 message.
16:14:56.327 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:56.416 DEBUG                    HTTP Status: 200 - OK
16:14:56.417 DEBUG                    Connect closed for Server
16:14:56.417 DEBUG                    Connect closed for Server
16:14:58.417 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:14:58.473 DEBUG                    Connected to Server
16:14:58.518 DEBUG                    Sending HTTP GET /status_2 message.
16:14:58.519 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:14:58.607 DEBUG                    HTTP Status: 200 - OK
16:14:58.607 DEBUG                    Connect closed for Server
16:14:58.608 DEBUG                    Connect closed for Server
16:15:00.607 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:00.658 DEBUG                    Connected to Server
16:15:00.708 DEBUG                    Sending HTTP GET /status_2 message.
16:15:00.709 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:00.822 DEBUG                    HTTP Status: 200 - OK
16:15:00.823 DEBUG                    Connect closed for Server
16:15:00.824 DEBUG                    Connect closed for Server
16:15:02.823 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:02.874 DEBUG                    Connected to Server
16:15:02.924 DEBUG                    Sending HTTP GET /status_2 message.
16:15:02.924 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:03.009 DEBUG                    HTTP Status: 200 - OK
16:15:03.009 DEBUG                    Connect closed for Server
16:15:03.010 DEBUG                    Connect closed for Server
16:15:05.009 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:05.060 DEBUG                    Connected to Server
16:15:05.110 DEBUG                    Sending HTTP GET /status_2 message.
16:15:05.110 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:05.203 DEBUG                    HTTP Status: 200 - OK
16:15:05.204 DEBUG                    Connect closed for Server
16:15:05.204 DEBUG                    Connect closed for Server
16:15:07.204 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:07.255 DEBUG                    Connected to Server
16:15:07.305 DEBUG                    Sending HTTP GET /status_2 message.
16:15:07.305 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:07.444 DEBUG                    HTTP Status: 200 - OK
16:15:07.445 DEBUG                    Connect closed for Server
16:15:07.445 DEBUG                    Connect closed for Server
16:15:09.445 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:09.496 DEBUG                    Connected to Server
16:15:09.546 DEBUG                    Sending HTTP GET /status_2 message.
16:15:09.547 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:09.624 DEBUG                    HTTP Status: 200 - OK
16:15:09.624 DEBUG                    Connect closed for Server
16:15:09.625 DEBUG                    Connect closed for Server
16:15:11.624 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:11.675 DEBUG                    Connected to Server
16:15:11.725 DEBUG                    Sending HTTP GET /status_2 message.
16:15:11.726 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:11.794 DEBUG                    HTTP Status: 200 - OK
16:15:11.795 DEBUG                    Connect closed for Server
16:15:11.795 DEBUG                    Connect closed for Server
16:15:13.794 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:13.845 DEBUG                    Connected to Server
16:15:13.895 DEBUG                    Sending HTTP GET /status_2 message.
16:15:13.896 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:13.997 DEBUG                    HTTP Status: 200 - OK
16:15:13.998 DEBUG                    Connect closed for Server
16:15:13.999 DEBUG                    Connect closed for Server
16:15:15.998 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:16.049 DEBUG                    Connected to Server
16:15:16.104 DEBUG                    Sending HTTP GET /status_2 message.
16:15:16.105 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:16.222 DEBUG                    HTTP Status: 200 - OK
16:15:16.224 DEBUG                    Connect closed for Server
16:15:16.225 DEBUG                    Connect closed for Server
16:15:18.224 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:18.275 DEBUG                    Connected to Server
16:15:18.397 DEBUG                    Received SKD message:
|                                     CertificateSigningRequest:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = CertificationRequest:
|                                             certificationRequestInfo = CertificationRequestInfo:
|                                                 version == 0
|                                                 subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                     algorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     subjectPublicKey = long768:1367225778752569641015550446284967143535928002493835635758279529538721980725466349546324537947958352618563372053536475868512270253684346511686306096645887998571481768800542782980486026656483932938772976011217931436096266890863450214
|                                                     x = 34699395049526159182929085983933286656170084341487587907269074652141403835424812649652012860005219883477547335372630
|                                                     y = 5920172062841938716834882597834307457896850016033809127751571132340967320423065288744098742655472368665727474604134
|                                                 attributes:
|                                                   [0] = SKDCertReqTypeAttribute:
|                                                     id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                     type = OID(id_SKDCertReqType_InfCA:1.2.826.0.1145.0.8.22.9)
|                                                   [1] = ExtensionReqAttribute:
|                                                     id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                     extns = List:
|                                                         [0]:
|                                                             KeyUsage_CertExt:
|                                                                 extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                 critical = True
|                                                                 uses = ['keyCertSign']
|                                                         [1]:
|                                                             BasicConstraints_CertExt:
|                                                                 extnID == OID(id_ce_basicConstraints:2.5.29.19)
|                                                                 critical = True
|                                                                 constraints = BasicConstraints:
|                                                                     cA = True
|                                                                     pathLenConstraint = 0L
|                                                         [2]:
|                                                             CertificateConstraints_CertExt:
|                                                                 extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                                 constraints = CertificateConstraints:
|                                                                     range = EsnRange:
|                                                                         startEsn = 'D8EFF0000000'
|                                                                         endEsn = 'D8EFF9999999'
|                                                                     deviceFunctions = OIDList[5]:
|                                                                       0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                       1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                       2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                       3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                       4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = Signature:
|                                                 r = long384:28679614530821855573322913961198021764438643886977464144632017081735065678210060854680400843661049437001311237387358
|                                                 s = long384:19799702411197341776555675787100886732737134866364748390469191843554319773888513208739879230304693852396099106785711
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                               [1] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = True
|                                                     responseExpected = True
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112161409Z)
|                                               [3] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 17L
|                                               [4] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x2d2dd72eaa02b969b5d99f16bcf07652e748bcd8aebd9e5ec7b1e39c1334b8a7114e811beed0db2bbdb62f441d6770b3)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:1359138278911167559228638310337702939598056483324294047047352087176800409979501392040221025185893978230568320560929
|                                                 s = long384:5384491569511255765976005223239567663582151997410647985062227921109464316456682784609991350772656408919824894095007
16:15:18.398 DEBUG                    Sending HTTP GET /status_2 message.
16:15:18.398 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:18.399 DEBUG                    IR: Handling Certificate Signing Request.
16:15:18.400 DEBUG                    Generating InfCA certificate (serialNumber: 20002L)
16:15:18.407 DEBUG                    Generating certificate signature for serial: 20002
16:15:18.414 DEBUG                    Creating SKD message file /tmp/infca.resp
16:15:18.417 DEBUG                    Generating message signature using cert with serial: 82119
16:15:18.450 DEBUG                    Sending SKD message:
|                                     CertificateSigningResponse:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = PKIResponse:
|                                             controlSequence:
|                                               [0] = TaggedAttribute:
|                                                 bodyPartID = 1L
|                                                 attrType = OID(id_cmc_statusInfoV2:1.3.6.1.5.5.7.7.25)
|                                                 attrValues = CMCStatusInfoV2:
|                                                     cMCStatus = 0
|                                         certificates (2 chains, 3 certificates) = 
|                                           Chains summary:
|                                             0xf75d9f601f8737f6-->0x224fc47c1908101b-->0xc9020cefbb66368c
|                                             0xae83d8b350bc1866-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82119L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112161351Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1090148721149798547579817531721980128308365896156075414989015994148640782172786774016211404517324760075729934156755824163156691748369865851969668351526407262223339405484733462741623272815107817359610204593792853537119347076766316534
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x224fc47c1908101b)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xf75d9f601f8737f6)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.4
|                                                                   [1] = 1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:20023048153974242410188697595188279265271725179486877841890054292789570826194430336407864443560333036919094344761842
|                                                     s = long384:9913479154827072352348604695945405969855098934707892641839359210072643142692744773281376125938866336499797056253745
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 88999L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112161351Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1142913733191802602394556119204295987804419909184559806078522636517065936598390031385694787206818182840839885297515369465300424577386063968607655495153479654728454829860730017949084152924739359378284849726558479717398484246522761243
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x224fc47c1908101b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[2]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_bondstoneIR:1.2.826.0.1145.0.10.4
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:36620943320080077336858000976191769947682092865714839541462706285355800515447265137643479023518778326696453609419920
|                                                     s = long384:7396547197313498935269594509932261280809822355831274144673362187991071570397710028272727672670333186682979936031793
|                                             Chain[1] =
|                                                 [1.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112161518Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1367225778752569641015550446284967143535928002493835635758279529538721980725466349546324537947958352618563372053536475868512270253684346511686306096645887998571481768800542782980486026656483932938772976011217931436096266890863450214
|                                                         x = 34699395049526159182929085983933286656170084341487587907269074652141403835424812649652012860005219883477547335372630
|                                                         y = 5920172062841938716834882597834307457896850016033809127751571132340967320423065288744098742655472368665727474604134
|                                                     _extensions = CertificateExtensions
|                                                       [0] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0000000'
|                                                                     endEsn = 'D8EFF9999999'
|                                                                 deviceFunctions = OIDList[5]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                                   1: id_missionRoot:1.2.826.0.1145.0.10.5
|                                                                   2: id_missionCertMgr:1.2.826.0.1145.0.10.6
|                                                                   3: id_missionKeyMgr:1.2.826.0.1145.0.10.7
|                                                                   4: id_endCryptoUnit:1.2.826.0.1145.0.10.1
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0xae83d8b350bc1866)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:19777748284053095533782355213477206577289072744957501283639754915679762935018544481613667907923932026725042498854886
|                                                     s = long384:33620394347650284040879772300901678886273233088578160105089191726206546450628532257536320282812712792932623037959024
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0xf75d9f601f8737f6)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = DestinationAttribute:
|                                                 id == OID(id_at_SKDDestination:1.2.826.0.1145.0.8.20.0)
|                                                 name = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                               [1] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_cct_PKIResponse:1.3.6.1.5.5.7.12.3)
|                                               [2] = SigningTimeAttribute:
|                                                 id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                 time = UTCTime(170112161518Z)
|                                               [3] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x47a6f21e521a5175a500b37ccfbb39944a717aaabfabc081e3d5ce6bd3fa4bdc2e8671656474d41faaaef5139b0a1d52)
|                                               [4] = ExchangeAttribute:
|                                                 id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                 exchange = SKDExchange:
|                                                     exchangeID = ExchangeID: certReq
|                                                     requestMessage = False
|                                                     responseExpected = False
|                                               [5] = MessageIDAttribute:
|                                                 id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                 messageID = SKDMessageID:
|                                                     stateID = Octets(0xac58964a99ac7b0a)
|                                                     msgCount = 17L
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:30680469820443913226455770615788655957683231963460465370627585777161519342325977089116056855689213925351978470887265
|                                                 s = long384:25848854639313282058497586199733237945324969896872650687685916129208478722192734092749409310354112328059781841363562
16:15:18.513 DEBUG                    HTTP Status: 200 - OK
16:15:18.514 DEBUG                    Connect closed for Server
16:15:18.514 DEBUG                    Connect closed for Server
16:15:20.519 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:20.569 DEBUG                    Connected to Server
16:15:20.619 DEBUG                    Sending HTTP GET /status_2 message.
16:15:20.620 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:20.711 DEBUG                    HTTP Status: 200 - OK
16:15:20.716 DEBUG                    Connect closed for Server
16:15:20.717 DEBUG                    Connect closed for Server
16:15:22.716 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:22.767 DEBUG                    Connected to Server
16:15:22.817 DEBUG                    Sending HTTP GET /status_2 message.
16:15:22.817 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:22.913 DEBUG                    HTTP Status: 200 - OK
16:15:22.914 DEBUG                    Connect closed for Server
16:15:22.914 DEBUG                    Connect closed for Server
16:15:24.913 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:24.964 DEBUG                    Connected to Server
16:15:25.014 DEBUG                    Sending HTTP GET /status_2 message.
16:15:25.015 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:25.142 DEBUG                    HTTP Status: 200 - OK
16:15:25.143 DEBUG                    Connect closed for Server
16:15:25.143 DEBUG                    Connect closed for Server
16:15:27.142 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:27.193 DEBUG                    Connected to Server
16:15:27.243 DEBUG                    Sending HTTP GET /status_2 message.
16:15:27.244 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:27.307 DEBUG                    HTTP Status: 200 - OK
16:15:27.308 DEBUG                    Connect closed for Server
16:15:27.308 DEBUG                    Connect closed for Server
16:15:29.307 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:29.358 DEBUG                    Connected to Server
16:15:29.408 DEBUG                    Sending HTTP GET /status_2 message.
16:15:29.408 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:29.523 DEBUG                    HTTP Status: 200 - OK
16:15:29.524 DEBUG                    Connect closed for Server
16:15:29.525 DEBUG                    Connect closed for Server
16:15:30.154 DEBUG                    cmd optimus > keydir
16:15:30.205 DEBUG                    cmd optimus > keydir /tmp/
16:15:31.524 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:31.575 DEBUG                    Connected to Server
16:15:31.625 DEBUG                    Sending HTTP GET /status_2 message.
16:15:31.625 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:31.704 DEBUG                    HTTP Status: 200 - OK
16:15:31.704 DEBUG                    Connect closed for Server
16:15:31.705 DEBUG                    Connect closed for Server
16:15:33.704 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:33.755 DEBUG                    Connected to Server
16:15:33.805 DEBUG                    Sending HTTP GET /status_2 message.
16:15:33.806 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:33.906 DEBUG                    HTTP Status: 200 - OK
16:15:33.907 DEBUG                    Connect closed for Server
16:15:33.907 DEBUG                    Connect closed for Server
16:15:35.907 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:35.957 DEBUG                    Connected to Server
16:15:36.007 DEBUG                    Sending HTTP GET /status_2 message.
16:15:36.008 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:36.132 DEBUG                    HTTP Status: 200 - OK
16:15:36.133 DEBUG                    Connect closed for Server
16:15:36.133 DEBUG                    Connect closed for Server
16:15:38.133 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:38.184 DEBUG                    Connected to Server
16:15:38.233 DEBUG                    Sending HTTP GET /status_2 message.
16:15:38.234 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:38.345 DEBUG                    HTTP Status: 200 - OK
16:15:38.345 DEBUG                    Connect closed for Server
16:15:38.346 DEBUG                    Connect closed for Server
16:15:40.347 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:40.398 DEBUG                    Connected to Server
16:15:40.448 DEBUG                    Sending HTTP GET /status_2 message.
16:15:40.449 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:40.524 DEBUG                    HTTP Status: 200 - OK
16:15:40.525 DEBUG                    Connect closed for Server
16:15:40.526 DEBUG                    Connect closed for Server
16:15:42.528 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:42.579 DEBUG                    Connected to Server
16:15:42.629 DEBUG                    Sending HTTP GET /status_2 message.
16:15:42.629 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:42.696 DEBUG                    HTTP Status: 200 - OK
16:15:42.704 DEBUG                    Connect closed for Server
16:15:42.704 DEBUG                    Connect closed for Server
16:15:44.703 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:44.754 DEBUG                    Connected to Server
16:15:44.804 DEBUG                    Sending HTTP GET /status_2 message.
16:15:44.805 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:44.938 DEBUG                    HTTP Status: 200 - OK
16:15:44.939 DEBUG                    Connect closed for Server
16:15:44.939 DEBUG                    Connect closed for Server
16:15:46.939 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:46.990 DEBUG                    Connected to Server
16:15:47.044 DEBUG                    Sending HTTP GET /status_2 message.
16:15:47.049 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:47.153 DEBUG                    HTTP Status: 200 - OK
16:15:47.154 DEBUG                    Connect closed for Server
16:15:47.155 DEBUG                    Connect closed for Server
16:15:49.154 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:49.205 DEBUG                    Connected to Server
16:15:49.254 DEBUG                    Sending HTTP GET /status_2 message.
16:15:49.255 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:49.412 DEBUG                    HTTP Status: 200 - OK
16:15:49.413 DEBUG                    Connect closed for Server
16:15:49.414 DEBUG                    Connect closed for Server
16:15:51.413 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:51.472 DEBUG                    Connected to Server
16:15:51.520 DEBUG                    Sending HTTP GET /status_2 message.
16:15:51.520 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:51.628 DEBUG                    HTTP Status: 200 - OK
16:15:51.629 DEBUG                    Connect closed for Server
16:15:51.629 DEBUG                    Connect closed for Server
16:15:53.629 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:53.680 DEBUG                    Connected to Server
16:15:53.731 DEBUG                    Sending HTTP GET /status_2 message.
16:15:53.732 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:15:53.791 DEBUG                    HTTP Status: 200 - OK
16:15:53.794 DEBUG                    Connect closed for Server
16:15:53.795 DEBUG                    Connect closed for Server
16:15:54.042 DEBUG                    cmd optimus > keydir ../Keys/
16:15:54.229 DEBUG                    Received SKD message:
|                                     KeyPackageFile:
|                                         version == 3
|                                         digestAlgorithm = AlgorithmIdentifier:
|                                             algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                         eContent = List:
|                                             [0]:
|                                                 OneAsymmetricKey:
|                                                     version == 0
|                                                     privateKeyAlgorithm = AlgorithmIdentifier:
|                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                         parameters = ECParameters:
|                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                     privateKey = ECPrivateKey:
|                                                         version = 1L
|                                                         privateKey = Octets(0xb7ba6ff00ea0eb260114aa7fe01c1c537c6c739336ef8355605e2f6c60cd95e1a675ee04c611eb6c4f52972bb8914453)
|                                                     attributes:
|                                                       [0] = UserCertificateAttr:
|                                                         id == OID(userCertificate:2.5.4.36)
|                                                         userCertificate = Certificate:
|                                                             tbsCertificate = TBSCertificate:
|                                                                 version == 2
|                                                                 serialNumber = 23L
|                                                                 signatureAlgorithmID = AlgorithmIdentifier:
|                                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                                 issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 validity = 170112000000Z..99991231235959Z
|                                                                 subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                                 subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                                     algorithm = AlgorithmIdentifier:
|                                                                         algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                         parameters = ECParameters:
|                                                                             namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                                     subjectPublicKey = long768:688653034869229570632691818761377466163518887349805683965937783189468590952374532100850484924868399457065629006516972875890767207613344990178311283995524597074882369135406419703579848391271911966291075371411336753061161790105536968
|                                                                     x = 17477613485890103468280271893423506325125357253407091894147767470929448229151457030999046275102912413720572084046999
|                                                                     y = 32394777262576045824880979206245392340010528494100327863086549557335291599952787041147411632769655668248349131491784
|                                                                 _extensions = CertificateExtensions
|                                                                   [0] AuthorityKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                         keyIdentifier = Octets(0x010b921af73549c8)
|                                                                   [1] SubjectKeyIdentifier_CertExt:
|                                                                         extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                         id = Octets(0x010b921af73549c8)
|                                                                   [2] KeyUsage_CertExt:
|                                                                         extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                         critical = True
|                                                                         uses = ['digitalSignature']
|                                                                   [3] CertificatePolicies_CertExt:
|                                                                         extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                         critical = True
|                                                                         policies:
|                                                                           [0] = PolicyInformation:
|                                                                             id = OID(1.2.826.0.1145.0.1.0.3)
|                                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                             signature = Signature:
|                                                                 r = long384:29910855267227513389055367221161400686241716464966358867307254047503264432879565897333192454548924374452585084662689
|                                                                 s = long384:11844552726204207445013239336216107126887916566108289457983330324058866324172873054982393600890127156260501911055951
|                                         certificates (1 chains, 2 certificates) = 
|                                           Chains summary:
|                                             0x1de6a414dda88f8b-->0x2eb4fc66f0202ec8-->0xc9020cefbb66368c
|                                           Chains details:
|                                             Chain[0] =
|                                                 [0.0] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 20002L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0123456,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:1021545805797909210826835025207440033071019025687094011490435992721519994638983824713072876510599826186421777635939462737569673689713475098158232024262194819344284154304401225602354736817000527273424729398726115677161927622900879243
|                                                         x = 25926238392688410934240255458872720950729285444475314752151553074599332672506796044944510887853998184491088816084075
|                                                         y = 3274486344043927067711776825645334207821719611284251754133014092996674147064616904074524286141641966933167999324043
|                                                     _extensions = CertificateExtensions
|                                                       [0] SubjectDirectoryAttributes_CertExt:
|                                                             extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                             attributes:
|                                                               [0] = DeviceFunctionAttribute:
|                                                                 id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                 deviceFunctions:
|                                                                   [0] = 1.2.826.0.1145.0.10.3
|                                                       [1] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0x2eb4fc66f0202ec8)
|                                                       [2] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x1de6a414dda88f8b)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['digitalSignature']
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:14175357905408002163498712024199065102777866285775047525243173775283135740529021367336350618018984602922889283399771
|                                                     s = long384:33494755799751616076320639665728848031819503704016018963819381207777441423812918495144322789244963880410881681442527
|                                                 [0.1] = Certificate:
|                                                 tbsCertificate = TBSCertificate:
|                                                     version == 2
|                                                     serialNumber = 82825L
|                                                     signatureAlgorithmID = AlgorithmIdentifier:
|                                                         algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                     issuer = Name: C=GB,OU=UKKPA,CN=PRIME Dev Inf TA,O=CESG
|                                                     validity = 170112155131Z..99991231235959Z
|                                                     subject = Name: SN=D8EFF0188000,CN=2.16.840.1.101.2.1.17
|                                                     subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                         algorithm = AlgorithmIdentifier:
|                                                             algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                             parameters = ECParameters:
|                                                                 namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                         subjectPublicKey = long768:813897215696863633484823515993376231466506257959712730056688168506600216208001938482663860810636066376441206358200609155329183937171485588751839182590232278627631243367881803194312445233600946451083814342725790305344666259762982600
|                                                         x = 20656237949917893490645739382705186301717823119310653144217638958054110932402633566569561505540352684595993175929142
|                                                         y = 7184196927612558537271577900714018363677812147565827554344293776486301946409052616613105049715894020230109307350728
|                                                     _extensions = CertificateExtensions
|                                                       [0] KeyUsage_CertExt:
|                                                             extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                             critical = True
|                                                             uses = ['keyCertSign']
|                                                       [1] CertificatePolicies_CertExt:
|                                                             extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                             critical = True
|                                                             policies:
|                                                               [0] = PolicyInformation:
|                                                                 id = OID(1.2.826.0.1145.0.1.0.4)
|                                                       [2] AuthorityKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                             keyIdentifier = Octets(0xc9020cefbb66368c)
|                                                       [3] SubjectKeyIdentifier_CertExt:
|                                                             extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                             id = Octets(0x2eb4fc66f0202ec8)
|                                                       [4] CRLDistributionPoints_CertExt:
|                                                             extnID == OID(id_ce_cRLDistributionPoints:2.5.29.31)
|                                                             distributionPoints:
|                                                               [0] = DistributionPoint:
|                                                                 cRLIssuer:
|                                                                   [0] = GeneralName:
|                                                                     directoryName = Name: C=GB,OU=KPA,CN=CRL Issuer,O=gov
|                                                       [5] CertificateConstraints_CertExt:
|                                                             extnID == OID(id_ce_certificateConstraints:1.2.826.0.1145.0.11.1)
|                                                             critical = True
|                                                             constraints = CertificateConstraints:
|                                                                 range = EsnRange:
|                                                                     startEsn = 'D8EFF0123456'
|                                                                     endEsn = 'D8EFF0123456'
|                                                                 deviceFunctions = OIDList[1]:
|                                                                   0: id_bondstoneICM:1.2.826.0.1145.0.10.3
|                                                 signatureAlgorithm = AlgorithmIdentifier:
|                                                     algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                 signature = Signature:
|                                                     r = long384:16856443321808439727687639376745532967130247098152364333619712534796783861451931298490538888232698714454720773208948
|                                                     s = long384:7653284383854980185284460768156383874634334112262313907535500454137768081084063920481401015495559458175532957433430
|                                         signerInfo = SignerInfo:
|                                             version == 3
|                                             sid = SignerIdentifier:
|                                                 subjectKeyIdentifier = Octets(0x1de6a414dda88f8b)
|                                             digestAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                             signedAttrs:
|                                               [0] = ContentTypeAttribute:
|                                                 id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                 type = OID(id_ct_KP_aKeyPackage:2.16.840.1.101.2.1.2.78.5)
|                                               [1] = MessageDigestAttribute:
|                                                 id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                 digest = Octets(0x6ae7cfbc0f6cfbd6d48efd98e346616c4a56d714b098362818c22b5e5cc2484cdca5717916dadf4980ba1b5529b0e97f)
|                                             signatureAlgorithm = AlgorithmIdentifier:
|                                                 algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                             signature = OctSignature:
|                                                 r = long384:15087373680166063477419516673352607435743073944173153622349135863454626519691771704038383695190179256346365699921270
|                                                 s = long384:4253610626427358141693162929049239559493276390740792748278199926132275605872575056774087293584400239114377275272763
16:15:54.230 DEBUG                    Added keymat FACT-IA: serial=23 auth=0x010b921af73549c8 subj=0x010b921af73549c8
16:15:54.230 DEBUG                    UUT Control: Applying all recent configuration changes
16:15:54.256 INFO    Test:            136 : [icm-issue-infia-mr-invalid-esn] The MR
|                                           sends a CSR for an InfIA certificate with an
|                                           out of range serial number to the ICM and
|                                           receives a error response.
16:15:54.282 DEBUG                          Creating SKD message file /tmp/icm_infia.csr
16:15:54.333 DEBUG                          Generating message signature using cert with serial: 23
16:15:54.392 DEBUG                          Sending SKD message:
|                                           CertificateSigningRequest:
|                                               version == 3
|                                               digestAlgorithm = AlgorithmIdentifier:
|                                                   algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                               eContent = CertificationRequest:
|                                                   certificationRequestInfo = CertificationRequestInfo:
|                                                       version == 0
|                                                       subject = Name: SN=D8EFF99999AA,CN=2.16.840.1.101.2.1.17
|                                                       subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                           algorithm = AlgorithmIdentifier:
|                                                               algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                               parameters = ECParameters:
|                                                                   namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                           subjectPublicKey = long768:1166623382847266491272453045190077000105222169192423360259678575147265024100607796186025375510707514078172088854757921879147462333459157406058097226397964421886218087520093515426393051694913530549513407092689837085206128342036343181
|                                                       attributes:
|                                                         [0] = SKDCertReqTypeAttribute:
|                                                           id == OID(id_at_SKDCertReqType:1.2.826.0.1145.0.8.20.13)
|                                                           type = OID(id_SKDCertReqType_InfIA:1.2.826.0.1145.0.8.22.0)
|                                                         [1] = ExtensionReqAttribute:
|                                                           id == OID(id_ExtensionReq:1.2.840.113549.1.9.14)
|                                                           extns = List:
|                                                               [0]:
|                                                                   KeyUsage_CertExt:
|                                                                       extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                       critical = True
|                                                                       uses = ['digitalSignature']
|                                                               [1]:
|                                                                   SubjectDirectoryAttributes_CertExt:
|                                                                       extnID == OID(id_ce_subjectDirectoryAttributes:2.5.29.9)
|                                                                       attributes:
|                                                                         [0] = DeviceFunctionAttribute:
|                                                                           id == OID(id_deviceFunction:1.2.826.0.1145.0.3.2)
|                                                                           deviceFunctions:
|                                                                             [0] = 1.2.826.0.1145.0.10.5
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = Signature:
|                                                       r = long384:28844330551842371963367156240373428871083973103774721666166134955677152629275542033150764502415594232222319720925843
|                                                       s = long384:1507649557356474511978714680704635289416092532273261234416742184913991077632992730840859010775467966524769221046358
|                                               certificates (1 chains, 1 certificates) = 
|                                                 Chains summary:
|                                                   0x010b921af73549c8-->0x010b921af73549c8
|                                                 Chains details:
|                                                   Chain[0] =
|                                                       [0.0] = Certificate:
|                                                       tbsCertificate = TBSCertificate:
|                                                           version == 2
|                                                           serialNumber = 23L
|                                                           signatureAlgorithmID = AlgorithmIdentifier:
|                                                               algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                           issuer = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           validity = 170112000000Z..99991231235959Z
|                                                           subject = Name: SN=D8EFF0000005,CN=2.16.840.1.101.2.1.17
|                                                           subjectPublicKeyInfo = SubjectPublicKeyInfo:
|                                                               algorithm = AlgorithmIdentifier:
|                                                                   algorithm = OID(id_ecPublicKey:1.2.840.10045.2.1)
|                                                                   parameters = ECParameters:
|                                                                       namedCurve = OID(secp384r1:1.3.132.0.34)
|                                                               subjectPublicKey = long768:688653034869229570632691818761377466163518887349805683965937783189468590952374532100850484924868399457065629006516972875890767207613344990178311283995524597074882369135406419703579848391271911966291075371411336753061161790105536968
|                                                               x = 17477613485890103468280271893423506325125357253407091894147767470929448229151457030999046275102912413720572084046999
|                                                               y = 32394777262576045824880979206245392340010528494100327863086549557335291599952787041147411632769655668248349131491784
|                                                           _extensions = CertificateExtensions
|                                                             [0] AuthorityKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_authorityKeyIdentifier:2.5.29.35)
|                                                                   keyIdentifier = Octets(0x010b921af73549c8)
|                                                             [1] SubjectKeyIdentifier_CertExt:
|                                                                   extnID == OID(id_ce_subjectKeyIdentifier:2.5.29.14)
|                                                                   id = Octets(0x010b921af73549c8)
|                                                             [2] KeyUsage_CertExt:
|                                                                   extnID == OID(id_ce_keyUsage:2.5.29.15)
|                                                                   critical = True
|                                                                   uses = ['digitalSignature']
|                                                             [3] CertificatePolicies_CertExt:
|                                                                   extnID == OID(id_ce_certificatePolicies:2.5.29.32)
|                                                                   critical = True
|                                                                   policies:
|                                                                     [0] = PolicyInformation:
|                                                                       id = OID(1.2.826.0.1145.0.1.0.3)
|                                                       signatureAlgorithm = AlgorithmIdentifier:
|                                                           algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                       signature = Signature:
|                                                           r = long384:29910855267227513389055367221161400686241716464966358867307254047503264432879565897333192454548924374452585084662689
|                                                           s = long384:11844552726204207445013239336216107126887916566108289457983330324058866324172873054982393600890127156260501911055951
|                                               signerInfo = SignerInfo:
|                                                   version == 3
|                                                   sid = SignerIdentifier:
|                                                       subjectKeyIdentifier = Octets(0x010b921af73549c8)
|                                                   digestAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(id_sha384:2.16.840.1.101.3.4.2.2)
|                                                   signedAttrs:
|                                                     [0] = ContentTypeAttribute:
|                                                       id == OID(id_contentType:1.2.840.113549.1.9.3)
|                                                       type = OID(id_cct_PKIData:1.3.6.1.5.5.7.12.2)
|                                                     [1] = SigningTimeAttribute:
|                                                       id == OID(id_signingTime:1.2.840.113549.1.9.5)
|                                                       time = UTCTime(170112161554Z)
|                                                     [2] = MessageDigestAttribute:
|                                                       id == OID(id_messageDigest:1.2.840.113549.1.9.4)
|                                                       digest = Octets(0x796a0144709fccf214899429d14a3004d480a7239abae393b6e36eda2f206259a19234c6c977d524db1fec3a9782305e)
|                                                     [3] = ExchangeAttribute:
|                                                       id == OID(id_at_SKDExchange:1.2.826.0.1145.0.8.20.14)
|                                                       exchange = SKDExchange:
|                                                           exchangeID = ExchangeID: certReq
|                                                           requestMessage = True
|                                                           responseExpected = True
|                                                     [4] = MessageIDAttribute:
|                                                       id == OID(id_at_SKDMessageId:1.2.826.0.1145.0.8.20.15)
|                                                       messageID = SKDMessageID:
|                                                           stateID = Octets(0x667fb98013550532)
|                                                           msgCount = 0L
|                                                   signatureAlgorithm = AlgorithmIdentifier:
|                                                       algorithm = OID(ecdsa_with_SHA384:1.2.840.10045.4.3.3)
|                                                   signature = OctSignature:
|                                                       r = long384:11889255251677910288844595053448799999017407824251815556722784942715863893517642637082894397894086249870523506528306
|                                                       s = long384:23505703450923495867532630973397186663362869078927654546422896155593380336856385145967199483328885220913535579848189
16:15:54.426 INFO                           #> 0.1. Load the CSR into the ICM.
16:15:55.791 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:55.843 DEBUG                          Connected to Server
16:15:55.893 DEBUG                          Sending HTTP GET /status_2 message.
16:15:55.894 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:15:56.130 DEBUG                          HTTP Status: 200 - OK
16:15:56.132 DEBUG                          Connect closed for Server
16:15:56.142 DEBUG                          Connect closed for Server
16:15:58.132 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:15:58.185 DEBUG                          Connected to Server
16:15:58.237 DEBUG                          Sending HTTP GET /status_2 message.
16:15:58.239 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:15:58.346 DEBUG                          HTTP Status: 200 - OK
16:15:58.348 DEBUG                          Connect closed for Server
16:15:58.362 DEBUG                          Connect closed for Server
16:16:00.352 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:16:00.404 DEBUG                          Connected to Server
16:16:00.454 DEBUG                          Sending HTTP GET /status_2 message.
16:16:00.455 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:16:00.629 DEBUG                          HTTP Status: 200 - OK
16:16:00.631 DEBUG                          Connect closed for Server
16:16:00.631 DEBUG                          Connect closed for Server
16:16:02.640 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:16:02.694 DEBUG                          Connected to Server
16:16:02.742 DEBUG                          Sending HTTP GET /status_2 message.
16:16:02.745 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:16:02.852 DEBUG                          HTTP Status: 200 - OK
16:16:02.853 DEBUG                          Connect closed for Server
16:16:02.854 DEBUG                          Connect closed for Server
16:16:04.854 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:16:04.905 DEBUG                          Connected to Server
16:16:04.956 DEBUG                          Sending HTTP GET /status_2 message.
16:16:04.957 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:16:05.119 DEBUG                          HTTP Status: 200 - OK
16:16:05.120 DEBUG                          Connect closed for Server
16:16:05.129 DEBUG                          Connect closed for Server
16:16:07.119 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:16:07.171 DEBUG                          Connected to Server
16:16:07.223 DEBUG                          Sending HTTP GET /status_2 message.
16:16:07.225 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:16:07.301 DEBUG                          HTTP Status: 200 - OK
16:16:07.302 DEBUG                          Connect closed for Server
16:16:07.302 DEBUG                          Connect closed for Server
16:16:07.670 INFO                           #> 0.2. Check request is displayed with correct status
16:16:09.162 INFO                           #> 0.3. The ICM produces a rejected error response that is exported
16:16:09.301 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:16:09.360 DEBUG                          Connected to Server
16:16:09.404 DEBUG                          Sending HTTP GET /status_2 message.
16:16:09.405 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:16:09.539 DEBUG                          HTTP Status: 200 - OK
16:16:09.540 DEBUG                          Connect closed for Server
16:16:09.541 DEBUG                          Connect closed for Server
16:16:11.540 INFO                           Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:16:11.592 DEBUG                          Connected to Server
16:16:11.642 DEBUG                          Sending HTTP GET /status_2 message.
16:16:11.643 DEBUG                          Removing HTTP GET /status_2 message from Q.
16:16:31.275 DEBUG             SNMP WALK Error indication: No SNMP response received before timeout
16:16:31.309 ERROR   Test:                  FAIL
16:16:31.327 ERROR                          Test failed
16:16:31.329 ERROR                          Unhandled exception occurred:
|                                             TypeError:unhashable instance
|                                           ../../test_support/snmp.py: _waitForCommandResponse
|                                              878 :                     "\n      Status = %s"
|                                              879 :                     "\n      Indication = %s",
|                                              880 :                     self._curOID,
|                                           ==>881 :                     _snmpErrorStatusCodes.get(errorStatus, errorStatus),
|                                              882 :                     errorIndication)
|                                              883 :             self.addToFailedOids(self._curOID)
|                                              884 :         if (str(errorIndication) ==
|                                           ../../test_support/snmp.py: walk
|                                              928 :         ret, _, _ = self._waitForCommandResponse()
|                                           ../../test_support/snmp.py: _sendWalkRequest
|                                              1896:         return self._server.walk(oid, elePrefixOid)
|                                           ../../test_support/snmp.py: invoke
|                                              1612:             return func(self, *args, **kwargs)
|                                           ../../test_support/snmp.py: _getExistingTable
|                                              1958:         lines = self._sendWalkRequest(tableOid, elePrefixOid)
|                                           ../../test_support/snmp.py: getTable
|                                              1701:                                              tableOid, changedOid)
|                                           <string>: _SKD_SNMPConnection_BsDev__getTable
|                                              5   : <no context>
|                                           ../../test_support/plugins/snmp/skd.py: exportDataTolist
|                                              558 :         table = self.__getTable("bsFileExportTable")
|                                           ../../test_support/plugins/snmp/skd.py: exportDataToFile
|                                              538 :         exportData = self.exportDataTolist(fileIndex)
|                                           ../../test_support/plugins/snmp/icm.py: exportInfIAResponse
|                                              239 :             self.exportDataToFile(exportIndex, filePath)
|                                           ../../test_support/function/icm.py: exportInfIAResponse
|                                              87  :         return self._uut.exportInfIAResponse(ecu, filePath, csrStatus)
|                                           test_issue_mr_infia.py: sendMalformedCsrForInfIa
|                                              78  :                                                        "responseSuccessful")
|                                           test_issue_mr_infia.py: issueInfIaCertEsnError
|                                              274 :                                                        self.icmtInvalidEsnValue)
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/testspec.py: run
|                                              357 :             func(*args, **kwargs)
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/testspec.py: runAndTrace
|                                              76  :         runTracer.run(func, args, kwargs)
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/Manager.py: _invoke
|                                              1181:                 self.spec.runAndTrace(self._func)
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/Manager.py: __call__
|                                              1238:                 if self._runner:
|                                              1239:                     ret = self._runner.callFunc(id(self), "_invoke")
|                                              1240:                 else:
|                                           ==>1241:                     ret = self._invoke()
|                                              1242:             else:
|                                              1243:                 print("Do Nowt!!!!")
|                                              1244:         except testKillers as self.origExc:
16:16:31.495 DEBUG                    Tearing down mock HTTP servers
16:16:31.498 DEBUG                    Connect closed for Server
16:16:31.499 DEBUG                    Connect closed for Server
16:16:35.001 DEBUG                    HTTP Status: 200 - OK
16:16:35.002 DEBUG                    Connect closed for Server
16:16:35.003 DEBUG                    Connect closed for Server
16:16:37.002 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:16:37.053 DEBUG                    Connected to Server
16:16:37.102 DEBUG                    Sending HTTP GET /status_2 message.
16:16:37.110 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:16:37.285 DEBUG                    HTTP Status: 200 - OK
16:16:37.285 DEBUG                    Connect closed for Server
16:16:37.286 DEBUG                    Connect closed for Server
16:16:39.286 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:16:39.340 DEBUG                    Connected to Server
16:16:39.387 DEBUG                    Sending HTTP GET /status_2 message.
16:16:39.388 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:16:39.648 DEBUG                    HTTP Status: 200 - OK
16:16:39.652 DEBUG                    Connect closed for Server
16:16:39.653 DEBUG                    Connect closed for Server
16:16:41.649 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:16:41.700 DEBUG                    Connected to Server
16:16:41.750 DEBUG                    Sending HTTP GET /status_2 message.
16:16:41.751 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:16:41.920 DEBUG                    HTTP Status: 200 - OK
16:16:41.921 DEBUG                    Connect closed for Server
16:16:41.922 DEBUG                    Connect closed for Server
16:16:43.921 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:16:43.972 DEBUG                    Connected to Server
16:16:44.022 DEBUG                    Sending HTTP GET /status_2 message.
16:16:44.023 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:16:44.087 DEBUG                    HTTP Status: 200 - OK
16:16:44.089 DEBUG                    Connect closed for Server
16:16:44.090 DEBUG                    Connect closed for Server
16:16:46.090 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:16:46.141 DEBUG                    Connected to Server
16:16:46.197 DEBUG                    Sending HTTP GET /status_2 message.
16:16:46.197 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:16:46.345 DEBUG                    HTTP Status: 200 - OK
16:16:46.345 DEBUG                    Connect closed for Server
16:16:46.346 DEBUG                    Connect closed for Server
16:16:48.345 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:16:48.396 DEBUG                    Connected to Server
16:16:48.446 DEBUG                    Sending HTTP GET /status_2 message.
16:16:48.447 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:16:48.493 DEBUG                    HTTP Status: 200 - OK
16:16:48.494 DEBUG                    Connect closed for Server
16:16:48.495 DEBUG                    Connect closed for Server
16:16:50.495 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:16:50.546 DEBUG                    Connected to Server
16:16:50.596 DEBUG                    Sending HTTP GET /status_2 message.
16:16:50.596 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:16:50.716 DEBUG                    HTTP Status: 200 - OK
16:16:50.718 DEBUG                    Connect closed for Server
16:16:50.718 DEBUG                    Connect closed for Server
16:16:52.718 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:16:52.769 DEBUG                    Connected to Server
16:16:52.819 DEBUG                    Sending HTTP GET /status_2 message.
16:16:52.820 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:16:52.889 DEBUG                    HTTP Status: 200 - OK
16:16:52.894 DEBUG                    Connect closed for Server
16:16:52.895 DEBUG                    Connect closed for Server
16:16:54.511 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:16:54.511 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:16:54.531 DEBUG                    Generating certificate signature for serial: 89700
16:16:54.541 DEBUG                    Added keymat IR-INF-CA: serial=89700 auth=0xc9020cefbb66368c subj=0x3eb6bf640cd4340d
16:16:54.560 DEBUG                    Generating certificate signature for serial: 84270
16:16:54.568 DEBUG                    Added keymat IR-INF-IA: serial=84270 auth=0x3eb6bf640cd4340d subj=0xe39c359500bdbd96
16:16:54.592 DEBUG                    Generating certificate signature for serial: 83983
16:16:54.602 DEBUG                    Added keymat IR-INF-CRL-CA: serial=83983 auth=0xc9020cefbb66368c subj=0x570248ae9191dd77
16:16:54.626 DEBUG                    Generating certificate signature for serial: 81508
16:16:54.636 DEBUG                    Added keymat IR-INF-CRL-IA: serial=81508 auth=0x570248ae9191dd77 subj=0x89a77d50bde2a7b0
16:16:54.655 DEBUG                    Generating certificate signature for serial: 5
16:16:54.665 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x94374553a8152188 subj=0x94374553a8152188
16:16:54.682 DEBUG                    Generating message signature using cert with serial: 84270
16:16:54.753 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:16:54.847 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x94374553a8152188 subj=0x94374553a8152188
16:16:54.853 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:16:54.874 DEBUG                    Generating message signature using cert with serial: 5
16:16:54.950 DEBUG                    IR: Handling Certificate Signing Request.
16:16:54.950 DEBUG                    Creating temporary CA cert to issue IA
16:16:54.970 DEBUG                    Generating certificate signature for serial: 88864
16:16:54.978 DEBUG                    Added keymat IR-INF-CA-TMP: serial=88864 auth=0xc9020cefbb66368c subj=0xb7b7462a5fe758b4
16:16:54.979 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:16:54.986 DEBUG                    Generating certificate signature for serial: 20000
16:16:54.993 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:16:54.999 DEBUG                    Generating message signature using cert with serial: 84270
16:16:55.199 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:16:55.199 DEBUG                    Received Inf IA response
16:16:55.199 DEBUG                    Added keymat IR-INF-CA: serial=88864 auth=0xc9020cefbb66368c subj=0xb7b7462a5fe758b4
16:16:55.200 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0xb7b7462a5fe758b4 subj=0xe711f3d2e8bbae5b
16:16:55.211 DEBUG                    Generating certificate signature for serial: 5
16:16:55.218 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x3746358fe3d5f697 subj=0x3746358fe3d5f697
16:16:55.228 DEBUG                    Generating message signature using cert with serial: 20000
16:16:55.282 DEBUG                    Creating SKD message file /tmp/icmCaReq
16:16:55.304 DEBUG                    Generating message signature using cert with serial: 20000
16:16:55.437 DEBUG                    IR: Handling Certificate Signing Request.
16:16:55.438 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
16:16:55.446 DEBUG                    Generating certificate signature for serial: 20001
16:16:55.453 DEBUG                    Creating SKD message file /tmp/icmCaResp
16:16:55.456 DEBUG                    Generating message signature using cert with serial: 84270
16:16:55.645 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:16:55.645 DEBUG                    Received Inf CA response
16:16:55.645 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xc464d44c8fd5f3b9
16:16:55.646 INFO                     Listening for ('128.10.1.4', 80)
16:16:55.651 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:16:55.658 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:16:55.659 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:16:55.752 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x3746358fe3d5f697 subj=0x3746358fe3d5f697
16:16:55.762 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:16:55.791 DEBUG                    Generating message signature using cert with serial: 5
16:16:55.897 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:16:55.909 DEBUG                    Generating certificate signature for serial: 20000
16:16:55.920 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:16:55.924 DEBUG                    Generating message signature using cert with serial: 20000
16:16:56.093 DEBUG                    Received Inf IA response
16:16:56.093 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xc464d44c8fd5f3b9
16:16:56.093 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0xc464d44c8fd5f3b9 subj=0x793ad49082ea3492
16:16:56.099 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:16:56.107 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:16:56.186 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x3746358fe3d5f697 subj=0x3746358fe3d5f697
16:16:56.186 INFO                     Listening for ('128.10.1.6', 80)
16:16:56.187 DEBUG                    MCKM requesting Inf IA from ICM.
16:16:56.193 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
16:16:56.232 DEBUG                    Generating message signature using cert with serial: 5
16:16:56.266 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:16:56.266 INFO                     SKD: Client ---> Server CMC-request (1340 bytes)
16:16:56.267 INFO                     Sent CSR for Inf IA certificate.
16:16:56.267 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:16:56.268 DEBUG                    131901584: Connect accepted from Client
16:16:56.317 DEBUG                    Connected to Server
16:16:56.317 DEBUG                    Connected to Server
16:16:56.368 DEBUG                    Sending HTTP POST /fullcmc message.
16:16:56.369 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:16:56.369 DEBUG                    Sending HTTP GET /status_2 message.
16:16:56.369 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:16:56.424 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:16:56.425 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
16:16:56.441 DEBUG                    Generating certificate signature for serial: 20001
16:16:56.455 DEBUG                    Generating message signature using cert with serial: 20000
16:16:56.539 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:16:56.541 DEBUG                    HTTP Status: 200 - OK
16:16:56.542 DEBUG                    HTTP Status: 200 - OK
16:16:56.542 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3137 bytes)
16:16:56.662 INFO                     MCKM: Handling incoming CertificateSigningResponse
16:16:56.662 DEBUG                    Received Inf IA response
16:16:56.663 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xc464d44c8fd5f3b9
16:16:56.663 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0xc464d44c8fd5f3b9 subj=0x0cb48bed6c91151c
16:16:56.664 DEBUG                    Connect closed for Server
16:16:56.665 DEBUG                    Connect closed for Server
16:16:58.273 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:16:58.350 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x3746358fe3d5f697 subj=0x3746358fe3d5f697
16:16:58.351 DEBUG                    CKA requesting Inf IA from ICM.
16:16:58.358 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
16:16:58.389 DEBUG                    Generating message signature using cert with serial: 5
16:16:58.423 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:16:58.423 INFO                     SKD: Client ---> Server CMC-request (1332 bytes)
16:16:58.423 INFO                     Sent CSR for Inf IA certificate.
16:16:58.425 DEBUG                    131901584: Connect accepted from Client
16:16:58.425 DEBUG                    Connect closed for Server
16:16:58.425 DEBUG                    Connect closed for Server
16:16:58.475 DEBUG                    Connected to Server
16:16:58.524 DEBUG                    Sending HTTP POST /fullcmc message.
16:16:58.524 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:16:58.596 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:16:58.598 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
16:16:58.610 DEBUG                    Generating certificate signature for serial: 20002
16:16:58.628 DEBUG                    Generating message signature using cert with serial: 20000
16:16:58.734 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:16:58.735 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:16:58.736 DEBUG                    HTTP Status: 200 - OK
16:16:58.737 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3126 bytes)
16:16:58.854 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
16:16:58.855 DEBUG                    Received Inf IA response
16:16:58.855 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xc464d44c8fd5f3b9
16:16:58.856 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0xc464d44c8fd5f3b9 subj=0x2f66b687fd08a94b
16:16:58.857 DEBUG                    Connected to Server
16:16:58.857 DEBUG                    Sending HTTP GET /status_2 message.
16:16:58.863 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:16:58.895 DEBUG                    HTTP Status: 200 - OK
16:16:58.896 DEBUG                    Connect closed for Server
16:16:58.897 DEBUG                    Connect closed for Server
16:17:00.896 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:17:00.948 DEBUG                    Connected to Server
16:17:00.999 DEBUG                    Sending HTTP GET /status_2 message.
16:17:01.000 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:17:01.091 DEBUG                    HTTP Status: 200 - OK
16:17:01.092 DEBUG                    Connect closed for Server
16:17:01.092 DEBUG                    Connect closed for Server
16:17:02.630 DEBUG                    ########## Mocks complete ##########
16:17:03.092 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:17:03.143 DEBUG                    Connected to Server
16:17:03.192 DEBUG                    Sending HTTP GET /status_2 message.
16:17:03.193 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:17:03.327 DEBUG                    HTTP Status: 200 - OK
16:17:03.329 DEBUG                    Connect closed for Server
16:17:03.330 DEBUG                    Connect closed for Server
16:17:04.467 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:17:04.468 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:17:05.328 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:17:05.388 DEBUG                    Connected to Server
16:17:05.429 DEBUG                    Sending HTTP GET /status_2 message.
16:17:05.430 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:17:05.492 DEBUG                    HTTP Status: 200 - OK
16:17:05.493 DEBUG                    Connect closed for Server
16:17:05.494 DEBUG                    Connect closed for Server
16:17:06.215 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:17:06.215 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:17:07.494 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:17:07.544 DEBUG                    Connected to Server
16:17:07.595 DEBUG                    Sending HTTP GET /status_2 message.
16:17:07.596 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:17:07.717 DEBUG                    HTTP Status: 200 - OK
16:17:07.717 DEBUG                    Connect closed for Server
16:17:07.718 DEBUG                    Connect closed for Server
16:17:09.717 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:17:09.771 DEBUG                    Connected to Server
16:17:09.824 DEBUG                    Sending HTTP GET /status_2 message.
16:17:09.824 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:17:09.953 DEBUG                    HTTP Status: 200 - OK
16:17:09.954 DEBUG                    Connect closed for Server
16:17:09.954 DEBUG                    Connect closed for Server
16:17:11.953 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:17:12.005 DEBUG                    Connected to Server
16:17:12.055 DEBUG                    Sending HTTP GET /status_2 message.
16:17:12.056 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:17:12.211 DEBUG                    HTTP Status: 200 - OK
16:17:12.211 DEBUG                    Connect closed for Server
16:17:12.212 DEBUG                    Connect closed for Server
16:17:14.211 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:17:14.262 DEBUG                    Connected to Server
16:17:14.312 DEBUG                    Sending HTTP GET /status_2 message.
16:17:14.312 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:17:14.418 DEBUG                    HTTP Status: 200 - OK
16:17:14.419 DEBUG                    Connect closed for Server
16:17:14.419 DEBUG                    Connect closed for Server
16:17:16.419 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:17:16.470 DEBUG                    Connected to Server
16:17:16.519 DEBUG                    Sending HTTP GET /status_2 message.
16:17:16.520 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:17:16.622 DEBUG                    HTTP Status: 200 - OK
16:17:16.623 DEBUG                    Connect closed for Server
16:17:16.623 DEBUG                    Connect closed for Server
16:17:18.623 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:17:18.681 DEBUG                    Connected to Server
16:17:18.723 DEBUG                    Sending HTTP GET /status_2 message.
16:17:18.724 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:17:18.832 DEBUG                    HTTP Status: 200 - OK
16:17:18.832 DEBUG                    Connect closed for Server
16:17:18.832 DEBUG                    Connect closed for Server
16:17:20.832 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:17:20.888 DEBUG                    Connected to Server
16:17:20.933 DEBUG                    Sending HTTP GET /status_2 message.
16:17:20.934 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:17:21.111 DEBUG                    HTTP Status: 200 - OK
16:17:21.113 DEBUG                    Connect closed for Server
16:17:21.114 DEBUG                    Connect closed for Server
16:17:23.113 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:17:23.164 DEBUG                    Connected to Server
16:17:23.214 DEBUG                    Sending HTTP GET /status_2 message.
16:17:23.214 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:17:42.665 DEBUG             SNMP WALK Error indication: No SNMP response received before timeout
16:17:42.707 ERROR                          Test setUp failed
16:17:42.707 ERROR                          Unhandled exception occurred:
|                                             TypeError:unhashable instance
|                                           ../../test_support/snmp.py: _waitForCommandResponse
|                                              878 :                     "\n      Status = %s"
|                                              879 :                     "\n      Indication = %s",
|                                              880 :                     self._curOID,
|                                           ==>881 :                     _snmpErrorStatusCodes.get(errorStatus, errorStatus),
|                                              882 :                     errorIndication)
|                                              883 :             self.addToFailedOids(self._curOID)
|                                              884 :         if (str(errorIndication) ==
|                                           ../../test_support/snmp.py: walk
|                                              928 :         ret, _, _ = self._waitForCommandResponse()
|                                           ../../test_support/snmp.py: _sendWalkRequest
|                                              1896:         return self._server.walk(oid, elePrefixOid)
|                                           ../../test_support/snmp.py: invoke
|                                              1612:             return func(self, *args, **kwargs)
|                                           ../../test_support/snmp.py: _getExistingTable
|                                              1958:         lines = self._sendWalkRequest(tableOid, elePrefixOid)
|                                           ../../test_support/snmp.py: getTable
|                                              1701:                                              tableOid, changedOid)
|                                           <string>: _SKD_SNMPConnection_BsDev__getTable
|                                              5   : <no context>
|                                           ../../test_support/plugins/snmp/skd.py: exportDataTolist
|                                              558 :         table = self.__getTable("bsFileExportTable")
|                                           ../../test_support/plugins/snmp/skd.py: exportDataToFile
|                                              538 :         exportData = self.exportDataTolist(fileIndex)
|                                           ../../test_support/plugins/snmp/icm.py: requestInfCaCertFile
|                                              167 :             self.exportDataToFile(row.FileExportIndex, fileName)
|                                           ../../test_support/function/icm.py: requestInfCaCertFile
|                                              57  :         self._uut.requestInfCaCertFile(fileName, esnLower, esnUpper, devFunc)
|                                           ../../test_support/skdbase.py: loadIssuingCa
|                                              1519:                                                       'mkm', 'cka'])
|                                           ../../test_support/skdbase.py: setUpInfCerts
|                                              1468:         self.loadIssuingCa()
|                                           test_issue_mr_infia.py: setUpStage2
|                                              43  :         self.setUpInfCerts()
|                                           ../../test_support/fractalbase.py: setUp
|                                              291 :         self.setUpStage2()
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/Manager.py: _invoke
|                                              1184:                 self._func()
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/Manager.py: __call__
|                                              1238:                 if self._runner:
|                                              1239:                     ret = self._runner.callFunc(id(self), "_invoke")
|                                              1240:                 else:
|                                           ==>1241:                     ret = self._invoke()
|                                              1242:             else:
|                                              1243:                 print("Do Nowt!!!!")
|                                              1244:         except testKillers as self.origExc:
16:17:42.709 INFO    Test:            137 : [icm-issue-infia-mr-invalid-dev-func] The MR
|                                           sends a CSR for an InfIA certificate with an
|                                           invalid DeviceFunction attribute and
|                                           receives a error response.
16:17:42.710 ERROR   Test:                  BAD_SETUP
16:17:42.859 DEBUG                    Tearing down mock HTTP servers
16:17:42.862 DEBUG                    Connect closed for Server
16:17:42.862 DEBUG                    Connect closed for Server
16:17:48.640 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:17:48.640 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:17:48.660 DEBUG                    Generating certificate signature for serial: 85243
16:17:48.669 DEBUG                    Added keymat IR-INF-CA: serial=85243 auth=0xc9020cefbb66368c subj=0x330693c8bd0ad056
16:17:48.689 DEBUG                    Generating certificate signature for serial: 80139
16:17:48.699 DEBUG                    Added keymat IR-INF-IA: serial=80139 auth=0x330693c8bd0ad056 subj=0x596c7ef188a9d4ff
16:17:48.724 DEBUG                    Generating certificate signature for serial: 89579
16:17:48.736 DEBUG                    Added keymat IR-INF-CRL-CA: serial=89579 auth=0xc9020cefbb66368c subj=0x2966296a9929b660
16:17:48.757 DEBUG                    Generating certificate signature for serial: 87566
16:17:48.763 DEBUG                    Added keymat IR-INF-CRL-IA: serial=87566 auth=0x2966296a9929b660 subj=0x60b1e5f94a21bb8b
16:17:48.783 DEBUG                    Generating certificate signature for serial: 5
16:17:48.792 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x80160a1ce77655d6 subj=0x80160a1ce77655d6
16:17:48.807 DEBUG                    Generating message signature using cert with serial: 80139
16:17:48.866 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:17:48.932 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x80160a1ce77655d6 subj=0x80160a1ce77655d6
16:17:48.938 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:17:48.957 DEBUG                    Generating message signature using cert with serial: 5
16:17:49.040 DEBUG                    IR: Handling Certificate Signing Request.
16:17:49.041 DEBUG                    Creating temporary CA cert to issue IA
16:17:49.065 DEBUG                    Generating certificate signature for serial: 88831
16:17:49.075 DEBUG                    Added keymat IR-INF-CA-TMP: serial=88831 auth=0xc9020cefbb66368c subj=0x8d8aed6f9871f3a8
16:17:49.075 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:17:49.088 DEBUG                    Generating certificate signature for serial: 20000
16:17:49.100 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:17:49.105 DEBUG                    Generating message signature using cert with serial: 80139
16:17:49.261 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:17:49.262 DEBUG                    Received Inf IA response
16:17:49.262 DEBUG                    Added keymat IR-INF-CA: serial=88831 auth=0xc9020cefbb66368c subj=0x8d8aed6f9871f3a8
16:17:49.262 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x8d8aed6f9871f3a8 subj=0x4eeb121afc0d0ab9
16:17:49.280 DEBUG                    Generating certificate signature for serial: 5
16:17:49.286 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x5e11f6aac093d6c0 subj=0x5e11f6aac093d6c0
16:17:49.302 DEBUG                    Generating message signature using cert with serial: 20000
16:17:49.366 DEBUG                    Creating SKD message file /tmp/icmCaReq
16:17:49.395 DEBUG                    Generating message signature using cert with serial: 20000
16:17:49.543 DEBUG                    IR: Handling Certificate Signing Request.
16:17:49.545 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
16:17:49.557 DEBUG                    Generating certificate signature for serial: 20001
16:17:49.565 DEBUG                    Creating SKD message file /tmp/icmCaResp
16:17:49.568 DEBUG                    Generating message signature using cert with serial: 80139
16:17:49.697 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:17:49.698 DEBUG                    Received Inf CA response
16:17:49.698 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xc7f2efaa66cda6d7
16:17:49.699 INFO                     Listening for ('128.10.1.4', 80)
16:17:49.704 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:17:49.710 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:17:49.711 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:17:49.795 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x5e11f6aac093d6c0 subj=0x5e11f6aac093d6c0
16:17:49.805 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:17:49.833 DEBUG                    Generating message signature using cert with serial: 5
16:17:49.916 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:17:49.924 DEBUG                    Generating certificate signature for serial: 20000
16:17:49.932 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:17:49.936 DEBUG                    Generating message signature using cert with serial: 20000
16:17:50.108 DEBUG                    Received Inf IA response
16:17:50.108 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xc7f2efaa66cda6d7
16:17:50.109 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0xc7f2efaa66cda6d7 subj=0x9db0f754937aed41
16:17:50.117 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:17:50.124 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:17:50.206 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x5e11f6aac093d6c0 subj=0x5e11f6aac093d6c0
16:17:50.206 INFO                     Listening for ('128.10.1.6', 80)
16:17:50.207 DEBUG                    MCKM requesting Inf IA from ICM.
16:17:50.216 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
16:17:50.247 DEBUG                    Generating message signature using cert with serial: 5
16:17:50.280 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:17:50.280 INFO                     SKD: Client ---> Server CMC-request (1340 bytes)
16:17:50.281 INFO                     Sent CSR for Inf IA certificate.
16:17:50.282 DEBUG                    HTTP Status: 200 - OK
16:17:50.283 DEBUG                    Connect closed for Server
16:17:50.283 DEBUG                    131972048: Connect accepted from Client
16:17:50.286 DEBUG                    Connect closed for Server
16:17:50.330 DEBUG                    Connected to Server
16:17:50.387 DEBUG                    Sending HTTP POST /fullcmc message.
16:17:50.387 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:17:50.463 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:17:50.464 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
16:17:50.477 DEBUG                    Generating certificate signature for serial: 20001
16:17:50.493 DEBUG                    Generating message signature using cert with serial: 20000
16:17:50.564 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:17:50.565 DEBUG                    HTTP Status: 200 - OK
16:17:50.565 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3136 bytes)
16:17:50.638 INFO                     MCKM: Handling incoming CertificateSigningResponse
16:17:50.638 DEBUG                    Received Inf IA response
16:17:50.639 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xc7f2efaa66cda6d7
16:17:50.639 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0xc7f2efaa66cda6d7 subj=0x15c446172a74cd42
16:17:52.282 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:17:52.293 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:17:52.357 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x5e11f6aac093d6c0 subj=0x5e11f6aac093d6c0
16:17:52.357 DEBUG                    CKA requesting Inf IA from ICM.
16:17:52.364 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
16:17:52.383 DEBUG                    Generating message signature using cert with serial: 5
16:17:52.404 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:17:52.405 INFO                     SKD: Client ---> Server CMC-request (1328 bytes)
16:17:52.405 INFO                     Sent CSR for Inf IA certificate.
16:17:52.406 DEBUG                    Connected to Server
16:17:52.406 DEBUG                    Sending HTTP GET /status_2 message.
16:17:52.406 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:17:52.407 DEBUG                    131972048: Connect accepted from Client
16:17:52.408 DEBUG                    Connect closed for Server
16:17:52.409 DEBUG                    Connect closed for Server
16:17:52.456 DEBUG                    Connected to Server
16:17:52.488 DEBUG                    HTTP Status: 200 - OK
16:17:52.489 DEBUG                    Connect closed for Server
16:17:52.490 DEBUG                    Connect closed for Server
16:17:52.505 DEBUG                    Sending HTTP POST /fullcmc message.
16:17:52.506 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:17:52.572 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:17:52.573 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
16:17:52.586 DEBUG                    Generating certificate signature for serial: 20002
16:17:52.602 DEBUG                    Generating message signature using cert with serial: 20000
16:17:52.678 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:17:52.680 DEBUG                    HTTP Status: 200 - OK
16:17:52.681 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3125 bytes)
16:17:52.795 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
16:17:52.796 DEBUG                    Received Inf IA response
16:17:52.796 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0xc7f2efaa66cda6d7
16:17:52.797 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0xc7f2efaa66cda6d7 subj=0x7a4028469e304a4f
16:17:54.492 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:17:54.544 DEBUG                    Connected to Server
16:17:54.594 DEBUG                    Sending HTTP GET /status_2 message.
16:17:54.595 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:17:54.692 DEBUG                    HTTP Status: 200 - OK
16:17:54.693 DEBUG                    Connect closed for Server
16:17:54.693 DEBUG                    Connect closed for Server
16:17:56.614 DEBUG                    ########## Mocks complete ##########
16:17:56.704 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:17:56.755 DEBUG                    Connected to Server
16:17:56.805 DEBUG                    Sending HTTP GET /status_2 message.
16:17:56.805 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:17:56.945 DEBUG                    HTTP Status: 200 - OK
16:17:56.946 DEBUG                    Connect closed for Server
16:17:56.947 DEBUG                    Connect closed for Server
16:17:58.175 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:17:58.175 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:17:58.946 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:17:58.997 DEBUG                    Connected to Server
16:17:59.047 DEBUG                    Sending HTTP GET /status_2 message.
16:17:59.047 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:17:59.095 DEBUG                    HTTP Status: 200 - OK
16:17:59.096 DEBUG                    Connect closed for Server
16:17:59.096 DEBUG                    Connect closed for Server
16:17:59.631 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:17:59.632 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:18:01.095 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:01.146 DEBUG                    Connected to Server
16:18:01.200 DEBUG                    Sending HTTP GET /status_2 message.
16:18:01.201 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:01.293 DEBUG                    HTTP Status: 200 - OK
16:18:01.293 DEBUG                    Connect closed for Server
16:18:01.294 DEBUG                    Connect closed for Server
16:18:03.294 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:03.345 DEBUG                    Connected to Server
16:18:03.394 DEBUG                    Sending HTTP GET /status_2 message.
16:18:03.395 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:03.497 DEBUG                    HTTP Status: 200 - OK
16:18:03.497 DEBUG                    Connect closed for Server
16:18:03.498 DEBUG                    Connect closed for Server
16:18:05.498 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:05.550 DEBUG                    Connected to Server
16:18:05.599 DEBUG                    Sending HTTP GET /status_2 message.
16:18:05.600 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:05.749 DEBUG                    HTTP Status: 200 - OK
16:18:05.754 DEBUG                    Connect closed for Server
16:18:05.755 DEBUG                    Connect closed for Server
16:18:07.749 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:07.800 DEBUG                    Connected to Server
16:18:07.850 DEBUG                    Sending HTTP GET /status_2 message.
16:18:07.851 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:08.066 DEBUG                    HTTP Status: 200 - OK
16:18:08.067 DEBUG                    Connect closed for Server
16:18:08.068 DEBUG                    Connect closed for Server
16:18:10.068 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:10.118 DEBUG                    Connected to Server
16:18:10.168 DEBUG                    Sending HTTP GET /status_2 message.
16:18:10.169 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:10.313 DEBUG                    HTTP Status: 200 - OK
16:18:10.313 DEBUG                    Connect closed for Server
16:18:10.314 DEBUG                    Connect closed for Server
16:18:12.313 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:12.365 DEBUG                    Connected to Server
16:18:12.414 DEBUG                    Sending HTTP GET /status_2 message.
16:18:12.415 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:12.570 DEBUG                    HTTP Status: 200 - OK
16:18:12.570 DEBUG                    Connect closed for Server
16:18:12.571 DEBUG                    Connect closed for Server
16:18:14.576 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:14.628 DEBUG                    Connected to Server
16:18:14.676 DEBUG                    Sending HTTP GET /status_2 message.
16:18:14.677 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:14.807 DEBUG                    HTTP Status: 200 - OK
16:18:14.813 DEBUG                    Connect closed for Server
16:18:14.813 DEBUG                    Connect closed for Server
16:18:16.812 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:16.863 DEBUG                    Connected to Server
16:18:16.913 DEBUG                    Sending HTTP GET /status_2 message.
16:18:16.913 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:35.404 DEBUG             SNMP WALK Error indication: No SNMP response received before timeout
16:18:35.434 ERROR                          Test setUp failed
16:18:35.435 ERROR                          Unhandled exception occurred:
|                                             TypeError:unhashable instance
|                                           ../../test_support/snmp.py: _waitForCommandResponse
|                                              878 :                     "\n      Status = %s"
|                                              879 :                     "\n      Indication = %s",
|                                              880 :                     self._curOID,
|                                           ==>881 :                     _snmpErrorStatusCodes.get(errorStatus, errorStatus),
|                                              882 :                     errorIndication)
|                                              883 :             self.addToFailedOids(self._curOID)
|                                              884 :         if (str(errorIndication) ==
|                                           ../../test_support/snmp.py: walk
|                                              928 :         ret, _, _ = self._waitForCommandResponse()
|                                           ../../test_support/snmp.py: _sendWalkRequest
|                                              1896:         return self._server.walk(oid, elePrefixOid)
|                                           ../../test_support/snmp.py: invoke
|                                              1612:             return func(self, *args, **kwargs)
|                                           ../../test_support/snmp.py: _getExistingTable
|                                              1958:         lines = self._sendWalkRequest(tableOid, elePrefixOid)
|                                           ../../test_support/snmp.py: getTable
|                                              1701:                                              tableOid, changedOid)
|                                           <string>: _SKD_SNMPConnection_BsDev__getTable
|                                              5   : <no context>
|                                           ../../test_support/plugins/snmp/skd.py: exportDataTolist
|                                              558 :         table = self.__getTable("bsFileExportTable")
|                                           ../../test_support/plugins/snmp/skd.py: exportDataToFile
|                                              538 :         exportData = self.exportDataTolist(fileIndex)
|                                           ../../test_support/plugins/snmp/icm.py: requestInfCaCertFile
|                                              167 :             self.exportDataToFile(row.FileExportIndex, fileName)
|                                           ../../test_support/function/icm.py: requestInfCaCertFile
|                                              57  :         self._uut.requestInfCaCertFile(fileName, esnLower, esnUpper, devFunc)
|                                           ../../test_support/skdbase.py: loadIssuingCa
|                                              1519:                                                       'mkm', 'cka'])
|                                           ../../test_support/skdbase.py: setUpInfCerts
|                                              1468:         self.loadIssuingCa()
|                                           test_issue_mr_infia.py: setUpStage2
|                                              43  :         self.setUpInfCerts()
|                                           ../../test_support/fractalbase.py: setUp
|                                              291 :         self.setUpStage2()
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/Manager.py: _invoke
|                                              1184:                 self._func()
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/Manager.py: __call__
|                                              1238:                 if self._runner:
|                                              1239:                     ret = self._runner.callFunc(id(self), "_invoke")
|                                              1240:                 else:
|                                           ==>1241:                     ret = self._invoke()
|                                              1242:             else:
|                                              1243:                 print("Do Nowt!!!!")
|                                              1244:         except testKillers as self.origExc:
16:18:35.437 INFO    Test:            138 : [icm-issue-infia-mr-missing-dev-func] The MR
|                                           sends a CSR for an InfIA certificate with no
|                                           DeviceFunction attribute and receives a
|                                           error response.
16:18:35.438 ERROR   Test:                  BAD_SETUP
16:18:35.593 DEBUG                    Tearing down mock HTTP servers
16:18:35.598 DEBUG                    Connect closed for Server
16:18:35.599 DEBUG                    Connect closed for Server
16:18:38.549 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:18:38.550 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:18:38.564 DEBUG                    Generating certificate signature for serial: 81983
16:18:38.571 DEBUG                    Added keymat IR-INF-CA: serial=81983 auth=0xc9020cefbb66368c subj=0xa375761c0d3ce459
16:18:38.584 DEBUG                    Generating certificate signature for serial: 80196
16:18:38.591 DEBUG                    Added keymat IR-INF-IA: serial=80196 auth=0xa375761c0d3ce459 subj=0x533ede0b92576827
16:18:38.604 DEBUG                    Generating certificate signature for serial: 85014
16:18:38.612 DEBUG                    Added keymat IR-INF-CRL-CA: serial=85014 auth=0xc9020cefbb66368c subj=0x4f1727fe699a1010
16:18:38.635 DEBUG                    Generating certificate signature for serial: 88364
16:18:38.644 DEBUG                    Added keymat IR-INF-CRL-IA: serial=88364 auth=0x4f1727fe699a1010 subj=0xebc39dedd255727c
16:18:38.663 DEBUG                    Generating certificate signature for serial: 5
16:18:38.673 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x846bf3388872904e subj=0x846bf3388872904e
16:18:38.690 DEBUG                    Generating message signature using cert with serial: 80196
16:18:38.736 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:18:38.801 DEBUG                    Added keymat FACT-IA: serial=5 auth=0x846bf3388872904e subj=0x846bf3388872904e
16:18:38.808 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:18:38.828 DEBUG                    Generating message signature using cert with serial: 5
16:18:38.924 DEBUG                    IR: Handling Certificate Signing Request.
16:18:38.925 DEBUG                    Creating temporary CA cert to issue IA
16:18:38.939 DEBUG                    Generating certificate signature for serial: 84442
16:18:38.945 DEBUG                    Added keymat IR-INF-CA-TMP: serial=84442 auth=0xc9020cefbb66368c subj=0x20e81e42127becd6
16:18:38.946 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:18:38.954 DEBUG                    Generating certificate signature for serial: 20000
16:18:38.962 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:18:38.966 DEBUG                    Generating message signature using cert with serial: 80196
16:18:39.143 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:18:39.143 DEBUG                    Received Inf IA response
16:18:39.144 DEBUG                    Added keymat IR-INF-CA: serial=84442 auth=0xc9020cefbb66368c subj=0x20e81e42127becd6
16:18:39.144 DEBUG                    Added keymat ICM-INF-IA: serial=20000 auth=0x20e81e42127becd6 subj=0x0eb5cb10b7578761
16:18:39.155 DEBUG                    Generating certificate signature for serial: 5
16:18:39.161 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xddc899c44102252f subj=0xddc899c44102252f
16:18:39.170 DEBUG                    Generating message signature using cert with serial: 20000
16:18:39.217 DEBUG                    Creating SKD message file /tmp/icmCaReq
16:18:39.240 DEBUG                    Generating message signature using cert with serial: 20000
16:18:39.385 DEBUG                    IR: Handling Certificate Signing Request.
16:18:39.386 DEBUG                    Generating InfCA certificate (serialNumber: 20001L)
16:18:39.399 DEBUG                    Generating certificate signature for serial: 20001
16:18:39.410 DEBUG                    Creating SKD message file /tmp/icmCaResp
16:18:39.415 DEBUG                    Generating message signature using cert with serial: 80196
16:18:39.556 INFO                     SKD: IR ---> ICM CertificateSigningResponse
16:18:39.556 DEBUG                    Received Inf CA response
16:18:39.557 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x942ec3a5bd80b899
16:18:39.557 INFO                     Listening for ('128.10.1.4', 80)
16:18:39.561 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:18:39.566 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:18:39.566 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:18:39.623 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xddc899c44102252f subj=0xddc899c44102252f
16:18:39.632 DEBUG                    Creating SKD message file /tmp/icmIaReq
16:18:39.655 DEBUG                    Generating message signature using cert with serial: 5
16:18:39.720 DEBUG                    Generating InfIA certificate (serialNumber: 20000L)
16:18:39.733 DEBUG                    Generating certificate signature for serial: 20000
16:18:39.743 DEBUG                    Creating SKD message file /tmp/icmIaResp
16:18:39.749 DEBUG                    Generating message signature using cert with serial: 20000
16:18:39.885 DEBUG                    Received Inf IA response
16:18:39.886 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x942ec3a5bd80b899
16:18:39.886 DEBUG                    Added keymat MR-INF-IA: serial=20000 auth=0x942ec3a5bd80b899 subj=0xe273b84891413069
16:18:39.894 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:18:39.902 DEBUG                    Added keymat PKI-TA: serial=None auth=None subj=0x17fc0ad098cbf63a
16:18:39.980 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xddc899c44102252f subj=0xddc899c44102252f
16:18:39.981 INFO                     Listening for ('128.10.1.6', 80)
16:18:39.981 DEBUG                    MCKM requesting Inf IA from ICM.
16:18:39.987 INFO                     SKD: MCKM ---> Server POST CMC-request CSR type=Inf-IA
16:18:40.018 DEBUG                    Generating message signature using cert with serial: 5
16:18:40.042 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:18:40.042 INFO                     SKD: Client ---> Server CMC-request (1339 bytes)
16:18:40.043 INFO                     Sent CSR for Inf IA certificate.
16:18:40.043 DEBUG                    HTTP Status: 200 - OK
16:18:40.044 DEBUG                    Connect closed for Server
16:18:40.044 DEBUG                    112010576: Connect accepted from Client
16:18:40.045 DEBUG                    Connect closed for Server
16:18:40.093 DEBUG                    Connected to Server
16:18:40.144 DEBUG                    Sending HTTP POST /fullcmc message.
16:18:40.144 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:18:40.198 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:18:40.199 DEBUG                    Generating InfIA certificate (serialNumber: 20001L)
16:18:40.207 DEBUG                    Generating certificate signature for serial: 20001
16:18:40.217 DEBUG                    Generating message signature using cert with serial: 20000
16:18:40.287 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:18:40.288 DEBUG                    HTTP Status: 200 - OK
16:18:40.288 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3137 bytes)
16:18:40.367 INFO                     MCKM: Handling incoming CertificateSigningResponse
16:18:40.367 DEBUG                    Received Inf IA response
16:18:40.367 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x942ec3a5bd80b899
16:18:40.367 DEBUG                    Added keymat MCKM-INF-IA: serial=20001 auth=0x942ec3a5bd80b899 subj=0xfaa7643f16ffdcc0
16:18:42.044 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:42.056 DEBUG                    Added keymat INF-TA: serial=None auth=None subj=0xc9020cefbb66368c
16:18:42.118 DEBUG                    Added keymat FACT-IA: serial=5 auth=0xddc899c44102252f subj=0xddc899c44102252f
16:18:42.119 DEBUG                    CKA requesting Inf IA from ICM.
16:18:42.128 INFO                     SKD: CKA ---> Server POST CMC-request CSR type=Inf-IA
16:18:42.158 DEBUG                    Generating message signature using cert with serial: 5
16:18:42.177 INFO                     Initiate new connection to ('128.10.1.4', 80):80 in 0.0 second(s)
16:18:42.178 INFO                     SKD: Client ---> Server CMC-request (1328 bytes)
16:18:42.178 INFO                     Sent CSR for Inf IA certificate.
16:18:42.178 DEBUG                    Connected to Server
16:18:42.179 DEBUG                    Sending HTTP GET /status_2 message.
16:18:42.179 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:42.179 DEBUG                    112010576: Connect accepted from Client
16:18:42.180 DEBUG                    Connect closed for Server
16:18:42.181 DEBUG                    Connect closed for Server
16:18:42.197 DEBUG                    HTTP Status: 200 - OK
16:18:42.198 DEBUG                    Connect closed for Server
16:18:42.199 DEBUG                    Connect closed for Server
16:18:42.229 DEBUG                    Connected to Server
16:18:42.278 DEBUG                    Sending HTTP POST /fullcmc message.
16:18:42.279 DEBUG                    Removing HTTP POST /fullcmc message from Q.
16:18:42.345 INFO                     SKD: Client ---> ICM CertificateSigningRequest
16:18:42.346 DEBUG                    Generating InfIA certificate (serialNumber: 20002L)
16:18:42.358 DEBUG                    Generating certificate signature for serial: 20002
16:18:42.373 DEBUG                    Generating message signature using cert with serial: 20000
16:18:42.437 INFO                     SKD: None ---> Client ???? status=200 smimeType=CMC-response
16:18:42.439 DEBUG                    HTTP Status: 200 - OK
16:18:42.439 INFO                     SKD: Server ---> Client application/pkcs7-mime; smime-type=CMC-response (3125 bytes)
16:18:42.553 DEBUG                    CKA: Handling, ('CertificateSigningResponse',)
16:18:42.554 DEBUG                    Received Inf IA response
16:18:42.554 DEBUG                    Added keymat ICM-INF-CA: serial=20001 auth=0xc9020cefbb66368c subj=0x942ec3a5bd80b899
16:18:42.554 DEBUG                    Added keymat CKA-INF-IA: serial=20002 auth=0x942ec3a5bd80b899 subj=0xa7d9ef09d3a0eaba
16:18:44.199 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:44.250 DEBUG                    Connected to Server
16:18:44.303 DEBUG                    Sending HTTP GET /status_2 message.
16:18:44.304 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:44.388 DEBUG                    HTTP Status: 200 - OK
16:18:44.389 DEBUG                    Connect closed for Server
16:18:44.389 DEBUG                    Connect closed for Server
16:18:46.385 DEBUG                    ########## Mocks complete ##########
16:18:46.390 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:46.442 DEBUG                    Connected to Server
16:18:46.492 DEBUG                    Sending HTTP GET /status_2 message.
16:18:46.492 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:46.619 DEBUG                    HTTP Status: 200 - OK
16:18:46.619 DEBUG                    Connect closed for Server
16:18:46.620 DEBUG                    Connect closed for Server
16:18:47.889 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:18:47.890 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:18:48.619 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:48.674 DEBUG                    Connected to Server
16:18:48.721 DEBUG                    Sending HTTP GET /status_2 message.
16:18:48.722 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:48.849 DEBUG                    HTTP Status: 200 - OK
16:18:48.850 DEBUG                    Connect closed for Server
16:18:48.850 DEBUG                    Connect closed for Server
16:18:49.346 DEBUG                    Convert value '0x809edbde73a76b99' as OCTET STRING
16:18:49.346 DEBUG                    Convert value '0xe8ac84e7e4ca6960' as OCTET STRING
16:18:50.849 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:50.900 DEBUG                    Connected to Server
16:18:50.950 DEBUG                    Sending HTTP GET /status_2 message.
16:18:50.950 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:51.037 DEBUG                    HTTP Status: 200 - OK
16:18:51.038 DEBUG                    Connect closed for Server
16:18:51.044 DEBUG                    Connect closed for Server
16:18:53.038 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:53.089 DEBUG                    Connected to Server
16:18:53.139 DEBUG                    Sending HTTP GET /status_2 message.
16:18:53.140 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:53.228 DEBUG                    HTTP Status: 200 - OK
16:18:53.229 DEBUG                    Connect closed for Server
16:18:53.230 DEBUG                    Connect closed for Server
16:18:55.229 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:55.285 DEBUG                    Connected to Server
16:18:55.336 DEBUG                    Sending HTTP GET /status_2 message.
16:18:55.337 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:55.402 DEBUG                    HTTP Status: 200 - OK
16:18:55.408 DEBUG                    Connect closed for Server
16:18:55.408 DEBUG                    Connect closed for Server
16:18:57.413 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:57.464 DEBUG                    Connected to Server
16:18:57.514 DEBUG                    Sending HTTP GET /status_2 message.
16:18:57.515 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:57.660 DEBUG                    HTTP Status: 200 - OK
16:18:57.661 DEBUG                    Connect closed for Server
16:18:57.661 DEBUG                    Connect closed for Server
16:18:59.661 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:18:59.712 DEBUG                    Connected to Server
16:18:59.761 DEBUG                    Sending HTTP GET /status_2 message.
16:18:59.762 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:18:59.905 DEBUG                    HTTP Status: 200 - OK
16:18:59.907 DEBUG                    Connect closed for Server
16:18:59.907 DEBUG                    Connect closed for Server
16:19:01.906 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:19:01.959 DEBUG                    Connected to Server
16:19:02.013 DEBUG                    Sending HTTP GET /status_2 message.
16:19:02.014 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:19:02.144 DEBUG                    HTTP Status: 200 - OK
16:19:02.144 DEBUG                    Connect closed for Server
16:19:02.145 DEBUG                    Connect closed for Server
16:19:04.144 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:19:04.196 DEBUG                    Connected to Server
16:19:04.246 DEBUG                    Sending HTTP GET /status_2 message.
16:19:04.246 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:19:04.312 DEBUG                    HTTP Status: 200 - OK
16:19:04.313 DEBUG                    Connect closed for Server
16:19:04.313 DEBUG                    Connect closed for Server
16:19:06.313 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:19:06.365 DEBUG                    Connected to Server
16:19:06.413 DEBUG                    Sending HTTP GET /status_2 message.
16:19:06.414 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:19:06.525 DEBUG                    HTTP Status: 200 - OK
16:19:06.529 DEBUG                    Connect closed for Server
16:19:06.530 DEBUG                    Connect closed for Server
16:19:08.529 INFO                     Initiate new connection to ('128.10.1.2', 80):80 in 0.0 second(s)
16:19:08.585 DEBUG                    Connected to Server
16:19:08.630 DEBUG                    Sending HTTP GET /status_2 message.
16:19:08.630 DEBUG                    Removing HTTP GET /status_2 message from Q.
16:19:26.847 DEBUG             SNMP WALK Error indication: No SNMP response received before timeout
16:19:26.890 ERROR                          Test setUp failed
16:19:26.891 ERROR                          Unhandled exception occurred:
|                                             TypeError:unhashable instance
|                                           ../../test_support/snmp.py: _waitForCommandResponse
|                                              878 :                     "\n      Status = %s"
|                                              879 :                     "\n      Indication = %s",
|                                              880 :                     self._curOID,
|                                           ==>881 :                     _snmpErrorStatusCodes.get(errorStatus, errorStatus),
|                                              882 :                     errorIndication)
|                                              883 :             self.addToFailedOids(self._curOID)
|                                              884 :         if (str(errorIndication) ==
|                                           ../../test_support/snmp.py: walk
|                                              928 :         ret, _, _ = self._waitForCommandResponse()
|                                           ../../test_support/snmp.py: _sendWalkRequest
|                                              1896:         return self._server.walk(oid, elePrefixOid)
|                                           ../../test_support/snmp.py: invoke
|                                              1612:             return func(self, *args, **kwargs)
|                                           ../../test_support/snmp.py: _getExistingTable
|                                              1958:         lines = self._sendWalkRequest(tableOid, elePrefixOid)
|                                           ../../test_support/snmp.py: getTable
|                                              1701:                                              tableOid, changedOid)
|                                           <string>: _SKD_SNMPConnection_BsDev__getTable
|                                              5   : <no context>
|                                           ../../test_support/plugins/snmp/skd.py: exportDataTolist
|                                              558 :         table = self.__getTable("bsFileExportTable")
|                                           ../../test_support/plugins/snmp/skd.py: exportDataToFile
|                                              538 :         exportData = self.exportDataTolist(fileIndex)
|                                           ../../test_support/plugins/snmp/icm.py: requestInfCaCertFile
|                                              167 :             self.exportDataToFile(row.FileExportIndex, fileName)
|                                           ../../test_support/function/icm.py: requestInfCaCertFile
|                                              57  :         self._uut.requestInfCaCertFile(fileName, esnLower, esnUpper, devFunc)
|                                           ../../test_support/skdbase.py: loadIssuingCa
|                                              1519:                                                       'mkm', 'cka'])
|                                           ../../test_support/skdbase.py: setUpInfCerts
|                                              1468:         self.loadIssuingCa()
|                                           test_issue_mr_infia.py: setUpStage2
|                                              43  :         self.setUpInfCerts()
|                                           ../../test_support/fractalbase.py: setUp
|                                              291 :         self.setUpStage2()
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/Manager.py: _invoke
|                                              1184:                 self._func()
|                                           /usr/local/lib/python2.7/dist-packages/CleverSheep/Test/Tester/Manager.py: __call__
|                                              1238:                 if self._runner:
|                                              1239:                     ret = self._runner.callFunc(id(self), "_invoke")
|                                              1240:                 else:
|                                           ==>1241:                     ret = self._invoke()
|                                              1242:             else:
|                                              1243:                 print("Do Nowt!!!!")
|                                              1244:         except testKillers as self.origExc:
16:19:26.894 INFO    Test:            139 : [icm-issue-infia-mr-user-reject] The MR
|                                           sends a CSR for an InfIA certificate to the
|                                           ICM and the ICM operator rejects the
|                                           request.
16:19:26.895 ERROR   Test:                  BAD_SETUP
16:19:27.068 DEBUG                    Tearing down mock HTTP servers
16:19:27.073 DEBUG                    Connect closed for Server
16:19:27.073 DEBUG                    Connect closed for Server
16:19:34.897 INFO    
16:19:34.897 INFO    Summary of the entire run
16:19:35.116 INFO    Suite: All of the PRIME tests......................................  CHILD_FAIL
16:19:35.333 INFO    Suite:   All of the Optional Module tests..........................  CHILD_FAIL
16:19:35.369 INFO    Suite:     All the test for the ICM................................  CHILD_FAIL
16:19:35.372 INFO    Suite:       Tests for ICM/IR exchanges............................    PART_RUN
16:19:35.373 INFO    Suite:         ICM Inf CA certificate requesting tests.............    PART_RUN
16:19:35.374 INFO    Test:            70  : [icm-request-infca] An ICM will request an
|                                           Infrastructure CA certificate from an IR....        PASS
16:19:35.377 INFO    Suite:       Tests for ICM/IR exchanges............................    PART_RUN
16:19:35.379 INFO    Suite:         ICM Inf IA certificate requesting tests.............    PART_RUN
16:19:35.379 INFO    Test:            73  : [icm-request-infia] An ICM will request an
|                                           Infrastructure IA certificate from an IR,
|                                           signed by a factory certificate.............        PASS
16:19:35.382 INFO    Suite:       Tests for ICM HTTP requirements.......................  CHILD_FAIL
16:19:35.383 INFO    Suite:         Test that the ICM conforms to the HTTP requirements.  CHILD_FAIL
16:19:35.384 INFO    Test:            82  : [icm-http-unrecognised-uri] Verify that the
|                                           ICM returns a status code of 404 when a
|                                           request is sent to an unrecognised URI......        PASS
16:19:35.384 INFO    Test:            84  : [icm-http-async-approve] Verify that the ICM
|                                           correctly follows the asynchronous HTTP
|                                           message flow when it is ready to return a
|                                           response....................................        FAIL
16:19:35.385 INFO    Test:            85  : [icm-http-async-not-ready] Verify that the
|                                           ICM correctly follows the asynchronous HTTP
|                                           message flow when it is not ready to return
|                                           a response..................................        PASS
16:19:35.388 INFO    Suite:       Tests for ICM Inf IA processing.......................    PART_RUN
16:19:35.389 INFO    Suite:         ICM Infrastructure IA validity tests................    PART_RUN
16:19:35.390 INFO    Test:            86  : [icm-process-infia-esn-range] An ICM will
|                                           discard a message where the ESN of the
|                                           Infrastructure IA certificate is outside the
|                                           range of its CA certificate.................        PASS
16:19:35.393 INFO    Suite:       Tests for ICM processing..............................    PART_RUN
16:19:35.394 INFO    Suite:         ICM received message processing.....................    PART_RUN
16:19:35.394 INFO    Test:            91  : [icm-receive-invalid-sig] An ICM will reject
|                                           a message if the signature can not be
|                                           verified using the Inf IA certificate.......        PASS
16:19:35.395 INFO    Test:            92  : [icm-receive-invalid-chain] An ICM will
|                                           reject a message if the Inf IA can not be
|                                           chained back to the TA......................        PASS
16:19:35.395 INFO    Test:            94  : [icm-receive-invalid-keyid] An ICM will
|                                           reject a message unless the Subject Key
|                                           Identifier in the SignerInfos matches that
|                                           in the certificate..........................        PASS
16:19:35.398 INFO    Suite:       Tests for ICM SNMP....................................    PART_RUN
16:19:35.400 INFO    Suite:         ICM SNMP tests......................................    PART_RUN
16:19:35.400 INFO    Test:            102 : [icm-snmp-e2e-auth-priv] Confirm that the
|                                           UUT supports the use of end-to-end
|                                           authentication as specified in RFC 3414.....        PASS
16:19:35.401 INFO    Test:            104 : [icm-snmp-check-last-changed-and-table-
|                                           count] Check that Table Count and Last
|                                           Changed are updated.........................        PASS
16:19:35.404 INFO    Suite:       Tests for ICM issuing InfIA certificate to a CKA......    PART_RUN
16:19:35.405 INFO    Suite:         ICM Infrastructure IA certificate issuing to CKA
|                                   tests...............................................    PART_RUN
16:19:35.406 INFO    Test:            105 : [icm-issue-infia-cka-cert-success] The CKA
|                                           sends a valid CSR for an InfIA certificate
|                                           from the ICM using HTTP and receives a valid
|                                           response....................................        PASS
16:19:35.406 INFO    Test:            107 : [icm-issue-infia-cka-inv-ext-req] The CKA
|                                           sends a CSR for an InfIA certificate with an
|                                           invalid ExtensionReq attribute and receives
|                                           a error response............................        PASS
16:19:35.406 INFO    Test:            109 : [icm-issue-infia-cka-invalid-esn] The CKA
|                                           sends a CSR for an InfIA certificate with an
|                                           out of range serial number to the ICM and
|                                           receives a error response...................        PASS
16:19:35.407 INFO    Test:            110 : [icm-issue-infia-cka-invalid-dev-func] The
|                                           CKA sends a CSR for an InfIA certificate
|                                           with an invalid DeviceFunction attribute and
|                                           receives a error response...................        PASS
16:19:35.407 INFO    Test:            111 : [icm-issue-infia-cka-missing-dev-func] The
|                                           CKA sends a CSR for an InfIA certificate
|                                           with no DeviceFunction attribute and
|                                           receives a error response...................        PASS
16:19:35.408 INFO    Test:            112 : [icm-issue-infia-cka-user-reject] The CKA
|                                           sends a CSR for an InfIA certificate to the
|                                           ICM and the ICM operator rejects the
|                                           request.....................................        PASS
16:19:35.408 INFO    Test:            114 : [icm-issue-infia-cka-invalid-factory] The
|                                           CKA sends a CSR for an InfIA certificate to
|                                           the ICM using HTTP but it is signed by an
|                                           invalid Factory certificate so should not
|                                           receive a valid response....................        PASS
16:19:35.411 INFO    Suite:       Tests for ICM issuing InfIA certificate to a CKA......    PART_RUN
16:19:35.413 INFO    Suite:         ICM Factory IA certificate issuing to CKA tests.....    PART_RUN
16:19:35.413 INFO    Test:            116 : [icm-issue-factia-creation] The ICM allows
|                                           the user to request creation of Factory IA
|                                           certificates and receives a valid response..        PASS
16:19:35.413 INFO    Test:            117 : [icm-factia-export] The ICM allows the user
|                                           to request creation of a Factory IA
|                                           certificate and export it...................        PASS
16:19:35.416 INFO    Suite:       Tests for ICM issuing InfIA certificate to a MCKM.....    PART_RUN
16:19:35.418 INFO    Suite:         ICM Infrastructure IA certificate issuing to MCKM
|                                   tests...............................................    PART_RUN
16:19:35.418 INFO    Test:            121 : [icm-issue-infia-mckm-cert-success] The MCKM
|                                           sends a valid CSR for an InfIA certificate
|                                           from the ICM using HTTP and receives a valid
|                                           response....................................        PASS
16:19:35.419 INFO    Test:            124 : [icm-issue-infia-mckm-inv-ext-req] The MCKM
|                                           sends a CSR for an InfIA certificate with an
|                                           invalid ExtensionReq attribute and receives
|                                           a error response............................        PASS
16:19:35.419 INFO    Test:            126 : [icm-issue-infia-mckm-invalid-esn] The MCKM
|                                           sends a CSR for an InfIA certificate with an
|                                           out of range serial number to the ICM and
|                                           receives a error response...................        PASS
16:19:35.420 INFO    Test:            127 : [icm-issue-infia-mckm-invalid-dev-func] The
|                                           MCKM sends a CSR for an InfIA certificate
|                                           with an invalid DeviceFunction attribute and
|                                           receives a error response...................        PASS
16:19:35.420 INFO    Test:            128 : [icm-issue-infia-mckm-missing-dev-func] The
|                                           MCKM sends a CSR for an InfIA certificate
|                                           with no DeviceFunction attribute and
|                                           receives a error response...................        PASS
16:19:35.420 INFO    Test:            129 : [icm-issue-infia-mckm-user-reject] The MCKM
|                                           sends a CSR for an InfIA certificate to the
|                                           ICM and the ICM operator rejects the
|                                           request.....................................        PASS
16:19:35.424 INFO    Suite:       Tests for ICM issuing InfIA certificate to a MR.......  CHILD_FAIL
16:19:35.425 INFO    Suite:         ICM Infrastructure IA certificate issuing to MR
|                                   tests...............................................  CHILD_FAIL
16:19:35.425 INFO    Test:            131 : [icm-issue-infia-mr-cert-success] The MR
|                                           sends a valid CSR for an InfIA certificate
|                                           from the ICM using file transfer and
|                                           receives a valid response...................        FAIL
16:19:35.426 INFO    Test:            136 : [icm-issue-infia-mr-invalid-esn] The MR
|                                           sends a CSR for an InfIA certificate with an
|                                           out of range serial number to the ICM and
|                                           receives a error response...................        FAIL
16:19:35.426 INFO    Test:            137 : [icm-issue-infia-mr-invalid-dev-func] The MR
|                                           sends a CSR for an InfIA certificate with an
|                                           invalid DeviceFunction attribute and
|                                           receives a error response...................   BAD_SETUP
16:19:35.427 INFO    Test:            138 : [icm-issue-infia-mr-missing-dev-func] The MR
|                                           sends a CSR for an InfIA certificate with no
|                                           DeviceFunction attribute and receives a
|                                           error response..............................   BAD_SETUP
16:19:35.433 INFO    Test:            139 : [icm-issue-infia-mr-user-reject] The MR
|                                           sends a CSR for an InfIA certificate to the
|                                           ICM and the ICM operator rejects the
|                                           request.....................................   BAD_SETUP
16:19:35.435 INFO    
16:19:35.435 INFO    Summary of the failures
16:19:35.747 INFO    Suite: All of the PRIME tests......................................  CHILD_FAIL
16:19:36.039 INFO    Suite:   All of the Optional Module tests..........................  CHILD_FAIL
16:19:36.093 INFO    Suite:     All the test for the ICM................................  CHILD_FAIL
16:19:36.098 INFO    Suite:       Tests for ICM HTTP requirements.......................  CHILD_FAIL
16:19:36.101 INFO    Suite:         Test that the ICM conforms to the HTTP requirements.  CHILD_FAIL
16:19:36.101 INFO    Test:            84  : [icm-http-async-approve] Verify that the ICM
|                                           correctly follows the asynchronous HTTP
|                                           message flow when it is ready to return a
|                                           response....................................        FAIL
16:19:36.106 INFO    Suite:       Tests for ICM issuing InfIA certificate to a MR.......  CHILD_FAIL
16:19:36.109 INFO    Suite:         ICM Infrastructure IA certificate issuing to MR
|                                   tests...............................................  CHILD_FAIL
16:19:36.109 INFO    Test:            131 : [icm-issue-infia-mr-cert-success] The MR
|                                           sends a valid CSR for an InfIA certificate
|                                           from the ICM using file transfer and
|                                           receives a valid response...................        FAIL
16:19:36.110 INFO    Test:            136 : [icm-issue-infia-mr-invalid-esn] The MR
|                                           sends a CSR for an InfIA certificate with an
|                                           out of range serial number to the ICM and
|                                           receives a error response...................        FAIL
16:19:36.111 INFO    Test:            137 : [icm-issue-infia-mr-invalid-dev-func] The MR
|                                           sends a CSR for an InfIA certificate with an
|                                           invalid DeviceFunction attribute and
|                                           receives a error response...................   BAD_SETUP
16:19:36.112 INFO    Test:            138 : [icm-issue-infia-mr-missing-dev-func] The MR
|                                           sends a CSR for an InfIA certificate with no
|                                           DeviceFunction attribute and receives a
|                                           error response..............................   BAD_SETUP
16:19:36.115 INFO    Test:            139 : [icm-issue-infia-mr-user-reject] The MR
|                                           sends a CSR for an InfIA certificate to the
|                                           ICM and the ICM operator rejects the
|                                           request.....................................   BAD_SETUP
